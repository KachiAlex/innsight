[{"filePath":"C:\\innsight\\frontend\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\components\\ActivityTimeline.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\components\\Button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\components\\DepositPolicyModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\components\\EmptyState.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\components\\ErrorBoundary.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":70,"column":17,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[1797,1949],"text":"\r\n              We&apos;re sorry, but something unexpected happened. Please try refreshing the page or contact support if the problem persists.\r\n            "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[1797,1949],"text":"\r\n              We&lsquo;re sorry, but something unexpected happened. Please try refreshing the page or contact support if the problem persists.\r\n            "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[1797,1949],"text":"\r\n              We&#39;re sorry, but something unexpected happened. Please try refreshing the page or contact support if the problem persists.\r\n            "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[1797,1949],"text":"\r\n              We&rsquo;re sorry, but something unexpected happened. Please try refreshing the page or contact support if the problem persists.\r\n            "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Component, ErrorInfo, ReactNode } from 'react';\r\nimport { AlertCircle, RefreshCw } from 'lucide-react';\r\n\r\ninterface Props {\r\n  children: ReactNode;\r\n}\r\n\r\ninterface State {\r\n  hasError: boolean;\r\n  error: Error | null;\r\n}\r\n\r\nexport class ErrorBoundary extends Component<Props, State> {\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.state = {\r\n      hasError: false,\r\n      error: null,\r\n    };\r\n  }\r\n\r\n  static getDerivedStateFromError(error: Error): State {\r\n    return {\r\n      hasError: true,\r\n      error,\r\n    };\r\n  }\r\n\r\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\r\n    console.error('ErrorBoundary caught an error:', error, errorInfo);\r\n  }\r\n\r\n  handleReset = () => {\r\n    this.setState({\r\n      hasError: false,\r\n      error: null,\r\n    });\r\n    window.location.href = '/dashboard';\r\n  };\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return (\r\n        <div\r\n          style={{\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            minHeight: '100vh',\r\n            padding: '2rem',\r\n            background: '#f8fafc',\r\n          }}\r\n        >\r\n          <div\r\n            style={{\r\n              background: 'white',\r\n              borderRadius: '8px',\r\n              padding: '3rem',\r\n              maxWidth: '600px',\r\n              boxShadow: '0 4px 6px rgba(0,0,0,0.1)',\r\n              textAlign: 'center',\r\n            }}\r\n          >\r\n            <AlertCircle size={64} style={{ color: '#ef4444', margin: '0 auto 1.5rem' }} />\r\n            <h1 style={{ marginBottom: '1rem', color: '#1e293b', fontSize: '1.5rem' }}>\r\n              Something went wrong\r\n            </h1>\r\n            <p style={{ marginBottom: '2rem', color: '#64748b' }}>\r\n              We're sorry, but something unexpected happened. Please try refreshing the page or contact support if the problem persists.\r\n            </p>\r\n            {process.env.NODE_ENV === 'development' && this.state.error && (\r\n              <details\r\n                style={{\r\n                  marginBottom: '2rem',\r\n                  padding: '1rem',\r\n                  background: '#f1f5f9',\r\n                  borderRadius: '4px',\r\n                  textAlign: 'left',\r\n                  fontSize: '0.875rem',\r\n                }}\r\n              >\r\n                <summary style={{ cursor: 'pointer', fontWeight: '500', marginBottom: '0.5rem' }}>\r\n                  Error Details (Development Only)\r\n                </summary>\r\n                <pre\r\n                  style={{\r\n                    marginTop: '0.5rem',\r\n                    overflow: 'auto',\r\n                    color: '#ef4444',\r\n                    whiteSpace: 'pre-wrap',\r\n                  }}\r\n                >\r\n                  {this.state.error.toString()}\r\n                  {this.state.error.stack}\r\n                </pre>\r\n              </details>\r\n            )}\r\n            <button\r\n              onClick={this.handleReset}\r\n              style={{\r\n                display: 'inline-flex',\r\n                alignItems: 'center',\r\n                gap: '0.5rem',\r\n                padding: '0.75rem 1.5rem',\r\n                background: '#3b82f6',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '6px',\r\n                cursor: 'pointer',\r\n                fontSize: '1rem',\r\n                fontWeight: '500',\r\n              }}\r\n            >\r\n              <RefreshCw size={20} />\r\n              Go to Dashboard\r\n            </button>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\components\\FileUpload.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\components\\GuestFormModal.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'formData'. Either include it or remove the dependency array. You can also do a functional update 'setFormData(f => ...)' if you only need 'formData' in the 'setFormData' call.","line":51,"column":6,"nodeType":"ArrayExpression","endLine":51,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [formData, initialData]","fix":{"range":[1413,1426],"text":"[formData, initialData]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { X, User, Mail, MapPin, Calendar, Utensils, AlertCircle } from 'lucide-react';\r\nimport Button from './Button';\r\nimport toast from 'react-hot-toast';\r\n\r\ninterface GuestFormModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onSubmit: (data: any) => void;\r\n  initialData?: any;\r\n  isLoading?: boolean;\r\n}\r\n\r\nexport default function GuestFormModal({ isOpen, onClose, onSubmit, initialData, isLoading }: GuestFormModalProps) {\r\n  const [formData, setFormData] = useState({\r\n    name: '',\r\n    email: '',\r\n    phone: '',\r\n    idNumber: '',\r\n    dateOfBirth: '',\r\n    nationality: '',\r\n    address: '',\r\n    city: '',\r\n    state: '',\r\n    country: '',\r\n    postalCode: '',\r\n    preferredRoomType: '',\r\n    preferredFloor: '',\r\n    smokingPreference: false,\r\n    bedPreference: '',\r\n    pillowPreference: '',\r\n    dietaryRestrictions: [] as string[],\r\n    allergies: [] as string[],\r\n    specialRequests: '',\r\n    marketingOptIn: true,\r\n    emailOptIn: true,\r\n    smsOptIn: true,\r\n  });\r\n\r\n  const [dietaryInput, setDietaryInput] = useState('');\r\n  const [allergyInput, setAllergyInput] = useState('');\r\n\r\n  useEffect(() => {\r\n    if (initialData) {\r\n      setFormData({\r\n        ...formData,\r\n        ...initialData,\r\n        dateOfBirth: initialData.dateOfBirth ? new Date(initialData.dateOfBirth).toISOString().split('T')[0] : '',\r\n      });\r\n    }\r\n  }, [initialData]);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!formData.name.trim()) {\r\n      toast.error('Guest name is required');\r\n      return;\r\n    }\r\n    \r\n    if (!formData.email && !formData.phone) {\r\n      toast.error('Either email or phone is required');\r\n      return;\r\n    }\r\n\r\n    onSubmit(formData);\r\n  };\r\n\r\n  const addDietary = () => {\r\n    if (dietaryInput.trim() && !formData.dietaryRestrictions.includes(dietaryInput.trim())) {\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        dietaryRestrictions: [...prev.dietaryRestrictions, dietaryInput.trim()]\r\n      }));\r\n      setDietaryInput('');\r\n    }\r\n  };\r\n\r\n  const addAllergy = () => {\r\n    if (allergyInput.trim() && !formData.allergies.includes(allergyInput.trim())) {\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        allergies: [...prev.allergies, allergyInput.trim()]\r\n      }));\r\n      setAllergyInput('');\r\n    }\r\n  };\r\n\r\n  const removeDietary = (item: string) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      dietaryRestrictions: prev.dietaryRestrictions.filter(d => d !== item)\r\n    }));\r\n  };\r\n\r\n  const removeAllergy = (item: string) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      allergies: prev.allergies.filter(a => a !== item)\r\n    }));\r\n  };\r\n\r\n  return (\r\n    <div style={{\r\n      position: 'fixed',\r\n      top: 0,\r\n      left: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      zIndex: 1000,\r\n      padding: '1rem',\r\n    }}>\r\n      <div style={{\r\n        backgroundColor: 'white',\r\n        borderRadius: '12px',\r\n        maxWidth: '800px',\r\n        width: '100%',\r\n        maxHeight: '90vh',\r\n        overflow: 'auto',\r\n        boxShadow: '0 20px 25px -5px rgba(0, 0, 0, 0.1)',\r\n      }}>\r\n        {/* Header */}\r\n        <div style={{\r\n          padding: '1.5rem',\r\n          borderBottom: '1px solid #e2e8f0',\r\n          display: 'flex',\r\n          justifyContent: 'space-between',\r\n          alignItems: 'center',\r\n          position: 'sticky',\r\n          top: 0,\r\n          backgroundColor: 'white',\r\n          zIndex: 10,\r\n        }}>\r\n          <h2 style={{ margin: 0, fontSize: '1.5rem', color: '#1e293b' }}>\r\n            {initialData ? 'Edit Guest' : 'New Guest'}\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            style={{\r\n              background: 'none',\r\n              border: 'none',\r\n              cursor: 'pointer',\r\n              padding: '0.5rem',\r\n              color: '#64748b',\r\n            }}\r\n          >\r\n            <X size={24} />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Form */}\r\n        <form onSubmit={handleSubmit} style={{ padding: '1.5rem' }}>\r\n          {/* Basic Information */}\r\n          <div style={{ marginBottom: '2rem' }}>\r\n            <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1rem', color: '#1e293b', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n              <User size={20} />\r\n              Basic Information\r\n            </h3>\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '1rem' }}>\r\n              <div style={{ gridColumn: '1 / -1' }}>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  Full Name *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={formData.name}\r\n                  onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.625rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '1rem',\r\n                  }}\r\n                  required\r\n                />\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  Email\r\n                </label>\r\n                <input\r\n                  type=\"email\"\r\n                  value={formData.email}\r\n                  onChange={(e) => setFormData({ ...formData, email: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.625rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '1rem',\r\n                  }}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  Phone\r\n                </label>\r\n                <input\r\n                  type=\"tel\"\r\n                  value={formData.phone}\r\n                  onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.625rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '1rem',\r\n                  }}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  ID Number\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={formData.idNumber}\r\n                  onChange={(e) => setFormData({ ...formData, idNumber: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.625rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '1rem',\r\n                  }}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  Date of Birth\r\n                </label>\r\n                <input\r\n                  type=\"date\"\r\n                  value={formData.dateOfBirth}\r\n                  onChange={(e) => setFormData({ ...formData, dateOfBirth: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.625rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '1rem',\r\n                  }}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  Nationality\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={formData.nationality}\r\n                  onChange={(e) => setFormData({ ...formData, nationality: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.625rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '1rem',\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Address */}\r\n          <div style={{ marginBottom: '2rem' }}>\r\n            <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1rem', color: '#1e293b', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n              <MapPin size={20} />\r\n              Address\r\n            </h3>\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '1rem' }}>\r\n              <div style={{ gridColumn: '1 / -1' }}>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  Street Address\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={formData.address}\r\n                  onChange={(e) => setFormData({ ...formData, address: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.625rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '1rem',\r\n                  }}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  City\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={formData.city}\r\n                  onChange={(e) => setFormData({ ...formData, city: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.625rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '1rem',\r\n                  }}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  State/Province\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={formData.state}\r\n                  onChange={(e) => setFormData({ ...formData, state: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.625rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '1rem',\r\n                  }}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  Country\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={formData.country}\r\n                  onChange={(e) => setFormData({ ...formData, country: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.625rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '1rem',\r\n                  }}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  Postal Code\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={formData.postalCode}\r\n                  onChange={(e) => setFormData({ ...formData, postalCode: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.625rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '1rem',\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Preferences */}\r\n          <div style={{ marginBottom: '2rem' }}>\r\n            <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1rem', color: '#1e293b', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n              <Calendar size={20} />\r\n              Preferences\r\n            </h3>\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '1rem' }}>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  Preferred Room Type\r\n                </label>\r\n                <select\r\n                  value={formData.preferredRoomType}\r\n                  onChange={(e) => setFormData({ ...formData, preferredRoomType: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.625rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '1rem',\r\n                  }}\r\n                >\r\n                  <option value=\"\">Select...</option>\r\n                  <option value=\"single\">Single</option>\r\n                  <option value=\"double\">Double</option>\r\n                  <option value=\"suite\">Suite</option>\r\n                  <option value=\"deluxe\">Deluxe</option>\r\n                  <option value=\"family\">Family</option>\r\n                </select>\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  Preferred Floor\r\n                </label>\r\n                <input\r\n                  type=\"number\"\r\n                  value={formData.preferredFloor}\r\n                  onChange={(e) => setFormData({ ...formData, preferredFloor: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.625rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '1rem',\r\n                  }}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  Bed Preference\r\n                </label>\r\n                <select\r\n                  value={formData.bedPreference}\r\n                  onChange={(e) => setFormData({ ...formData, bedPreference: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.625rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '1rem',\r\n                  }}\r\n                >\r\n                  <option value=\"\">Select...</option>\r\n                  <option value=\"king\">King</option>\r\n                  <option value=\"queen\">Queen</option>\r\n                  <option value=\"twin\">Twin</option>\r\n                  <option value=\"double\">Double</option>\r\n                </select>\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  Pillow Preference\r\n                </label>\r\n                <select\r\n                  value={formData.pillowPreference}\r\n                  onChange={(e) => setFormData({ ...formData, pillowPreference: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.625rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '1rem',\r\n                  }}\r\n                >\r\n                  <option value=\"\">Select...</option>\r\n                  <option value=\"soft\">Soft</option>\r\n                  <option value=\"medium\">Medium</option>\r\n                  <option value=\"firm\">Firm</option>\r\n                </select>\r\n              </div>\r\n              <div style={{ gridColumn: '1 / -1' }}>\r\n                <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={formData.smokingPreference}\r\n                    onChange={(e) => setFormData({ ...formData, smokingPreference: e.target.checked })}\r\n                    style={{ width: '1.125rem', height: '1.125rem', cursor: 'pointer' }}\r\n                  />\r\n                  <span style={{ fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>Smoking Preference</span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Dietary & Allergies */}\r\n          <div style={{ marginBottom: '2rem' }}>\r\n            <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1rem', color: '#1e293b', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n              <Utensils size={20} />\r\n              Dietary & Allergies\r\n            </h3>\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '1rem' }}>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  Dietary Restrictions\r\n                </label>\r\n                <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '0.5rem' }}>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={dietaryInput}\r\n                    onChange={(e) => setDietaryInput(e.target.value)}\r\n                    onKeyPress={(e) => e.key === 'Enter' && (e.preventDefault(), addDietary())}\r\n                    placeholder=\"e.g., Vegetarian\"\r\n                    style={{\r\n                      flex: 1,\r\n                      padding: '0.5rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      fontSize: '0.875rem',\r\n                    }}\r\n                  />\r\n                  <Button type=\"button\" onClick={addDietary} size=\"sm\">Add</Button>\r\n                </div>\r\n                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>\r\n                  {formData.dietaryRestrictions.map((item, idx) => (\r\n                    <span\r\n                      key={idx}\r\n                      style={{\r\n                        display: 'inline-flex',\r\n                        alignItems: 'center',\r\n                        gap: '0.25rem',\r\n                        padding: '0.25rem 0.5rem',\r\n                        backgroundColor: '#fef3c7',\r\n                        color: '#92400e',\r\n                        borderRadius: '4px',\r\n                        fontSize: '0.75rem',\r\n                      }}\r\n                    >\r\n                      {item}\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => removeDietary(item)}\r\n                        style={{\r\n                          background: 'none',\r\n                          border: 'none',\r\n                          cursor: 'pointer',\r\n                          padding: 0,\r\n                          color: '#92400e',\r\n                        }}\r\n                      >\r\n                        <X size={12} />\r\n                      </button>\r\n                    </span>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'flex', alignItems: 'center', gap: '0.25rem', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  <AlertCircle size={16} color=\"#ef4444\" />\r\n                  Allergies\r\n                </label>\r\n                <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '0.5rem' }}>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={allergyInput}\r\n                    onChange={(e) => setAllergyInput(e.target.value)}\r\n                    onKeyPress={(e) => e.key === 'Enter' && (e.preventDefault(), addAllergy())}\r\n                    placeholder=\"e.g., Peanuts\"\r\n                    style={{\r\n                      flex: 1,\r\n                      padding: '0.5rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      fontSize: '0.875rem',\r\n                    }}\r\n                  />\r\n                  <Button type=\"button\" onClick={addAllergy} size=\"sm\" variant=\"secondary\">Add</Button>\r\n                </div>\r\n                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>\r\n                  {formData.allergies.map((item, idx) => (\r\n                    <span\r\n                      key={idx}\r\n                      style={{\r\n                        display: 'inline-flex',\r\n                        alignItems: 'center',\r\n                        gap: '0.25rem',\r\n                        padding: '0.25rem 0.5rem',\r\n                        backgroundColor: '#fee2e2',\r\n                        color: '#991b1b',\r\n                        borderRadius: '4px',\r\n                        fontSize: '0.75rem',\r\n                      }}\r\n                    >\r\n                      {item}\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => removeAllergy(item)}\r\n                        style={{\r\n                          background: 'none',\r\n                          border: 'none',\r\n                          cursor: 'pointer',\r\n                          padding: 0,\r\n                          color: '#991b1b',\r\n                        }}\r\n                      >\r\n                        <X size={12} />\r\n                      </button>\r\n                    </span>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n              <div style={{ gridColumn: '1 / -1' }}>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  Special Requests\r\n                </label>\r\n                <textarea\r\n                  value={formData.specialRequests}\r\n                  onChange={(e) => setFormData({ ...formData, specialRequests: e.target.value })}\r\n                  rows={3}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.625rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '1rem',\r\n                    fontFamily: 'inherit',\r\n                    resize: 'vertical',\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Marketing Preferences */}\r\n          <div style={{ marginBottom: '2rem' }}>\r\n            <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1rem', color: '#1e293b', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n              <Mail size={20} />\r\n              Marketing Preferences\r\n            </h3>\r\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>\r\n              <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={formData.marketingOptIn}\r\n                  onChange={(e) => setFormData({ ...formData, marketingOptIn: e.target.checked })}\r\n                  style={{ width: '1.125rem', height: '1.125rem', cursor: 'pointer' }}\r\n                />\r\n                <span style={{ fontSize: '0.875rem', color: '#374151' }}>Receive marketing communications</span>\r\n              </label>\r\n              <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={formData.emailOptIn}\r\n                  onChange={(e) => setFormData({ ...formData, emailOptIn: e.target.checked })}\r\n                  style={{ width: '1.125rem', height: '1.125rem', cursor: 'pointer' }}\r\n                />\r\n                <span style={{ fontSize: '0.875rem', color: '#374151' }}>Email notifications</span>\r\n              </label>\r\n              <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={formData.smsOptIn}\r\n                  onChange={(e) => setFormData({ ...formData, smsOptIn: e.target.checked })}\r\n                  style={{ width: '1.125rem', height: '1.125rem', cursor: 'pointer' }}\r\n                />\r\n                <span style={{ fontSize: '0.875rem', color: '#374151' }}>SMS notifications</span>\r\n              </label>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Actions */}\r\n          <div style={{ display: 'flex', gap: '1rem', justifyContent: 'flex-end', paddingTop: '1rem', borderTop: '1px solid #e2e8f0' }}>\r\n            <Button type=\"button\" variant=\"ghost\" onClick={onClose} disabled={isLoading}>\r\n              Cancel\r\n            </Button>\r\n            <Button type=\"submit\" disabled={isLoading}>\r\n              {isLoading ? 'Saving...' : initialData ? 'Update Guest' : 'Create Guest'}\r\n            </Button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\components\\GuestNotes.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\components\\Layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\components\\LoadingSkeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\components\\LoyaltyBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\components\\LoyaltySection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\components\\Pagination.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\components\\ProtectedRoute.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\components\\SearchInput.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\hooks\\useAsync.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\hooks\\useDebounce.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\lib\\api.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\lib\\publicApi.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\AlertsPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\AnalyticsDashboardPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadDashboardData'. Either include it or remove the dependency array.","line":71,"column":6,"nodeType":"ArrayExpression","endLine":71,"endColumn":30,"suggestions":[{"desc":"Update the dependencies array to be: [user.tenantId, period, loadDashboardData]","fix":{"range":[1734,1758],"text":"[user.tenantId, period, loadDashboardData]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Button from '../components/Button';\r\nimport {\r\n  BarChart3,\r\n  TrendingUp,\r\n  TrendingDown,\r\n  DollarSign,\r\n  Users,\r\n  Building,\r\n  Target,\r\n  AlertTriangle,\r\n  RefreshCw,\r\n  Download,\r\n  Filter,\r\n  Eye,\r\n  Activity\r\n} from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\n\r\ninterface DashboardMetrics {\r\n  period: {\r\n    start: string;\r\n    end: string;\r\n  };\r\n  revenue: {\r\n    totalRevenue: number;\r\n    roomRevenue: number;\r\n    roomServiceRevenue: number;\r\n    averageDailyRate: number;\r\n    changePercent: number;\r\n  };\r\n  occupancy: {\r\n    totalRooms: number;\r\n    occupiedRoomDays: number;\r\n    totalRoomDays: number;\r\n    occupancyRate: number;\r\n  };\r\n  satisfaction: {\r\n    totalRequests: number;\r\n    resolvedRequests: number;\r\n    resolutionRate: number;\r\n    urgentRequests: number;\r\n    urgentResolutionRate: number;\r\n    avgResolutionTime: number;\r\n  };\r\n  operational: {\r\n    housekeepingTasks: number;\r\n    maintenanceTickets: number;\r\n    guestRequests: number;\r\n    totalTasks: number;\r\n  };\r\n  alerts: any[];\r\n  trends: {\r\n    revenue: Array<{ date: string; revenue: number }>;\r\n    occupancy: Array<{ date: string; occupancyRate: number }>;\r\n  };\r\n}\r\n\r\n\r\nexport default function AnalyticsDashboardPage() {\r\n  const { user } = useAuthStore();\r\n  const [metrics, setMetrics] = useState<DashboardMetrics | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [period, setPeriod] = useState<'7d' | '30d' | '90d' | '1y'>('30d');\r\n  const [lastUpdated, setLastUpdated] = useState<Date>(new Date());\r\n\r\n  useEffect(() => {\r\n    loadDashboardData();\r\n  }, [user?.tenantId, period]);\r\n\r\n  const loadDashboardData = async () => {\r\n    if (!user?.tenantId) return;\r\n\r\n    try {\r\n      setLoading(true);\r\n      const response = await api.get(`/tenants/${user.tenantId}/analytics/dashboard?period=${period}`);\r\n      setMetrics(response.data.data);\r\n      setLastUpdated(new Date());\r\n    } catch (error) {\r\n      console.error('Error loading dashboard data:', error);\r\n      toast.error('Failed to load dashboard data');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const formatCurrency = (amount: number) => {\r\n    return new Intl.NumberFormat('en-NG', {\r\n      style: 'currency',\r\n      currency: 'NGN',\r\n      minimumFractionDigits: 0,\r\n      maximumFractionDigits: 0\r\n    }).format(amount);\r\n  };\r\n\r\n  const formatPercentage = (value: number) => {\r\n    return `${value.toFixed(1)}%`;\r\n  };\r\n\r\n  const getChangeIndicator = (change: number) => {\r\n    if (change > 0) {\r\n      return {\r\n        icon: TrendingUp,\r\n        color: '#10b981',\r\n        text: `+${change.toFixed(1)}%`\r\n      };\r\n    } else if (change < 0) {\r\n      return {\r\n        icon: TrendingDown,\r\n        color: '#ef4444',\r\n        text: `${change.toFixed(1)}%`\r\n      };\r\n    } else {\r\n      return {\r\n        icon: Activity,\r\n        color: '#6b7280',\r\n        text: '0%'\r\n      };\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (rate: number, thresholds: { good: number; warning: number }) => {\r\n    if (rate >= thresholds.good) return '#10b981';\r\n    if (rate >= thresholds.warning) return '#f59e0b';\r\n    return '#ef4444';\r\n  };\r\n\r\n  const periodOptions = [\r\n    { value: '7d', label: 'Last 7 days' },\r\n    { value: '30d', label: 'Last 30 days' },\r\n    { value: '90d', label: 'Last 90 days' },\r\n    { value: '1y', label: 'Last year' }\r\n  ];\r\n\r\n  if (loading) {\r\n    return (\r\n      <div style={{ padding: '2rem', textAlign: 'center' }}>\r\n        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '1rem' }}>\r\n          <RefreshCw size={24} style={{ animation: 'spin 1s linear infinite' }} />\r\n          <span>Loading analytics...</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div style={{ padding: '2rem', maxWidth: '1400px', margin: '0 auto' }}>\r\n      {/* Header */}\r\n      <div style={{\r\n        display: 'flex',\r\n        justifyContent: 'space-between',\r\n        alignItems: 'center',\r\n        marginBottom: '2rem'\r\n      }}>\r\n        <div>\r\n          <h1 style={{ fontSize: '2rem', fontWeight: 'bold', marginBottom: '0.5rem' }}>\r\n            Analytics Dashboard\r\n          </h1>\r\n          <p style={{ color: '#64748b' }}>\r\n            Business intelligence and performance metrics\r\n          </p>\r\n        </div>\r\n\r\n        <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>\r\n          <select\r\n            value={period}\r\n            onChange={(e) => setPeriod(e.target.value as any)}\r\n            style={{\r\n              padding: '0.5rem 1rem',\r\n              border: '1px solid #d1d5db',\r\n              borderRadius: '6px',\r\n              fontSize: '0.875rem',\r\n              background: 'white'\r\n            }}\r\n          >\r\n            {periodOptions.map(option => (\r\n              <option key={option.value} value={option.value}>\r\n                {option.label}\r\n              </option>\r\n            ))}\r\n          </select>\r\n\r\n          <Button variant=\"secondary\" onClick={loadDashboardData}>\r\n            <RefreshCw size={16} style={{ marginRight: '0.5rem' }} />\r\n            Refresh\r\n          </Button>\r\n\r\n          <Button variant=\"secondary\">\r\n            <Download size={16} style={{ marginRight: '0.5rem' }} />\r\n            Export\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Last Updated */}\r\n      <div style={{\r\n        background: 'white',\r\n        border: '1px solid #e2e8f0',\r\n        borderRadius: '8px',\r\n        padding: '1rem',\r\n        marginBottom: '2rem',\r\n        fontSize: '0.875rem',\r\n        color: '#64748b'\r\n      }}>\r\n        Last updated: {lastUpdated.toLocaleString()}\r\n      </div>\r\n\r\n      {metrics && (\r\n        <>\r\n          {/* Key Metrics Row */}\r\n          <div style={{\r\n            display: 'grid',\r\n            gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))',\r\n            gap: '1.5rem',\r\n            marginBottom: '2rem'\r\n          }}>\r\n            {/* Revenue Card */}\r\n            <div style={{\r\n              background: 'white',\r\n              border: '1px solid #e2e8f0',\r\n              borderRadius: '12px',\r\n              padding: '2rem',\r\n              position: 'relative',\r\n              overflow: 'hidden'\r\n            }}>\r\n              <div style={{\r\n                position: 'absolute',\r\n                top: '1rem',\r\n                right: '1rem',\r\n                width: '40px',\r\n                height: '40px',\r\n                background: '#dbeafe',\r\n                borderRadius: '8px',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center'\r\n              }}>\r\n                <DollarSign size={20} style={{ color: '#3b82f6' }} />\r\n              </div>\r\n\r\n              <div style={{ marginBottom: '1rem' }}>\r\n                <h3 style={{ fontSize: '0.875rem', fontWeight: '500', color: '#64748b', marginBottom: '0.5rem' }}>\r\n                  Total Revenue\r\n                </h3>\r\n                <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#1f2937' }}>\r\n                  {formatCurrency(metrics.revenue.totalRevenue)}\r\n                </div>\r\n              </div>\r\n\r\n              <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\r\n                <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                  vs previous period\r\n                </div>\r\n                {(() => {\r\n                  const indicator = getChangeIndicator(metrics.revenue.changePercent);\r\n                  const Icon = indicator.icon;\r\n                  return (\r\n                    <div style={{\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: '0.25rem',\r\n                      fontSize: '0.875rem',\r\n                      fontWeight: '500',\r\n                      color: indicator.color\r\n                    }}>\r\n                      <Icon size={14} />\r\n                      {indicator.text}\r\n                    </div>\r\n                  );\r\n                })()}\r\n              </div>\r\n\r\n              <div style={{ marginTop: '1rem', fontSize: '0.875rem', color: '#64748b' }}>\r\n                <div>Room Revenue: {formatCurrency(metrics.revenue.roomRevenue)}</div>\r\n                <div>Room Service: {formatCurrency(metrics.revenue.roomServiceRevenue)}</div>\r\n                <div>Avg Daily Rate: {formatCurrency(metrics.revenue.averageDailyRate)}</div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Occupancy Card */}\r\n            <div style={{\r\n              background: 'white',\r\n              border: '1px solid #e2e8f0',\r\n              borderRadius: '12px',\r\n              padding: '2rem',\r\n              position: 'relative',\r\n              overflow: 'hidden'\r\n            }}>\r\n              <div style={{\r\n                position: 'absolute',\r\n                top: '1rem',\r\n                right: '1rem',\r\n                width: '40px',\r\n                height: '40px',\r\n                background: '#dcfce7',\r\n                borderRadius: '8px',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center'\r\n              }}>\r\n                <Building size={20} style={{ color: '#10b981' }} />\r\n              </div>\r\n\r\n              <div style={{ marginBottom: '1rem' }}>\r\n                <h3 style={{ fontSize: '0.875rem', fontWeight: '500', color: '#64748b', marginBottom: '0.5rem' }}>\r\n                  Occupancy Rate\r\n                </h3>\r\n                <div style={{\r\n                  fontSize: '2rem',\r\n                  fontWeight: 'bold',\r\n                  color: getStatusColor(metrics.occupancy.occupancyRate, { good: 80, warning: 60 })\r\n                }}>\r\n                  {formatPercentage(metrics.occupancy.occupancyRate)}\r\n                </div>\r\n              </div>\r\n\r\n              <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                <div>Total Rooms: {metrics.occupancy.totalRooms}</div>\r\n                <div>Occupied: {metrics.occupancy.occupiedRoomDays} room-days</div>\r\n                <div>Total: {metrics.occupancy.totalRoomDays} room-days</div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Guest Satisfaction Card */}\r\n            <div style={{\r\n              background: 'white',\r\n              border: '1px solid #e2e8f0',\r\n              borderRadius: '12px',\r\n              padding: '2rem',\r\n              position: 'relative',\r\n              overflow: 'hidden'\r\n            }}>\r\n              <div style={{\r\n                position: 'absolute',\r\n                top: '1rem',\r\n                right: '1rem',\r\n                width: '40px',\r\n                height: '40px',\r\n                background: '#fef3c7',\r\n                borderRadius: '8px',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center'\r\n              }}>\r\n                <Users size={20} style={{ color: '#f59e0b' }} />\r\n              </div>\r\n\r\n              <div style={{ marginBottom: '1rem' }}>\r\n                <h3 style={{ fontSize: '0.875rem', fontWeight: '500', color: '#64748b', marginBottom: '0.5rem' }}>\r\n                  Guest Satisfaction\r\n                </h3>\r\n                <div style={{\r\n                  fontSize: '2rem',\r\n                  fontWeight: 'bold',\r\n                  color: getStatusColor(metrics.satisfaction.resolutionRate, { good: 90, warning: 75 })\r\n                }}>\r\n                  {formatPercentage(metrics.satisfaction.resolutionRate)}\r\n                </div>\r\n              </div>\r\n\r\n              <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                <div>Total Requests: {metrics.satisfaction.totalRequests}</div>\r\n                <div>Resolved: {metrics.satisfaction.resolvedRequests}</div>\r\n                <div>Urgent Resolution: {formatPercentage(metrics.satisfaction.urgentResolutionRate)}</div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Operational Efficiency Card */}\r\n            <div style={{\r\n              background: 'white',\r\n              border: '1px solid #e2e8f0',\r\n              borderRadius: '12px',\r\n              padding: '2rem',\r\n              position: 'relative',\r\n              overflow: 'hidden'\r\n            }}>\r\n              <div style={{\r\n                position: 'absolute',\r\n                top: '1rem',\r\n                right: '1rem',\r\n                width: '40px',\r\n                height: '40px',\r\n                background: '#e0e7ff',\r\n                borderRadius: '8px',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center'\r\n              }}>\r\n                <Target size={20} style={{ color: '#6366f1' }} />\r\n              </div>\r\n\r\n              <div style={{ marginBottom: '1rem' }}>\r\n                <h3 style={{ fontSize: '0.875rem', fontWeight: '500', color: '#64748b', marginBottom: '0.5rem' }}>\r\n                  Operational Tasks\r\n                </h3>\r\n                <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#1f2937' }}>\r\n                  {metrics.operational.totalTasks}\r\n                </div>\r\n              </div>\r\n\r\n              <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                <div>Housekeeping: {metrics.operational.housekeepingTasks}</div>\r\n                <div>Maintenance: {metrics.operational.maintenanceTickets}</div>\r\n                <div>Guest Requests: {metrics.operational.guestRequests}</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Charts Section */}\r\n          <div style={{\r\n            display: 'grid',\r\n            gridTemplateColumns: '1fr 1fr',\r\n            gap: '2rem',\r\n            marginBottom: '2rem'\r\n          }}>\r\n            {/* Revenue Trend Chart Placeholder */}\r\n            <div style={{\r\n              background: 'white',\r\n              border: '1px solid #e2e8f0',\r\n              borderRadius: '12px',\r\n              padding: '2rem'\r\n            }}>\r\n              <div style={{\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: '0.5rem',\r\n                marginBottom: '1.5rem'\r\n              }}>\r\n                <BarChart3 size={20} style={{ color: '#64748b' }} />\r\n                <h3 style={{ fontSize: '1.125rem', fontWeight: '600' }}>\r\n                  Revenue Trend\r\n                </h3>\r\n              </div>\r\n\r\n              <div style={{\r\n                height: '200px',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                background: '#f8fafc',\r\n                borderRadius: '8px',\r\n                color: '#64748b'\r\n              }}>\r\n                Chart visualization will be implemented here\r\n                <br />\r\n                Data points: {metrics.trends.revenue.length}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Occupancy Trend Chart Placeholder */}\r\n            <div style={{\r\n              background: 'white',\r\n              border: '1px solid #e2e8f0',\r\n              borderRadius: '12px',\r\n              padding: '2rem'\r\n            }}>\r\n              <div style={{\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: '0.5rem',\r\n                marginBottom: '1.5rem'\r\n              }}>\r\n                <TrendingUp size={20} style={{ color: '#64748b' }} />\r\n                <h3 style={{ fontSize: '1.125rem', fontWeight: '600' }}>\r\n                  Occupancy Trend\r\n                </h3>\r\n              </div>\r\n\r\n              <div style={{\r\n                height: '200px',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                background: '#f8fafc',\r\n                borderRadius: '8px',\r\n                color: '#64748b'\r\n              }}>\r\n                Chart visualization will be implemented here\r\n                <br />\r\n                Data points: {metrics.trends.occupancy.length}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Alerts Section */}\r\n          {metrics.alerts.length > 0 && (\r\n            <div style={{\r\n              background: 'white',\r\n              border: '1px solid #e2e8f0',\r\n              borderRadius: '12px',\r\n              padding: '2rem',\r\n              marginBottom: '2rem'\r\n            }}>\r\n              <div style={{\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: '0.5rem',\r\n                marginBottom: '1.5rem'\r\n              }}>\r\n                <AlertTriangle size={20} style={{ color: '#ef4444' }} />\r\n                <h3 style={{ fontSize: '1.125rem', fontWeight: '600' }}>\r\n                  Active Alerts ({metrics.alerts.length})\r\n                </h3>\r\n              </div>\r\n\r\n              <div style={{ display: 'grid', gap: '1rem' }}>\r\n                {metrics.alerts.slice(0, 3).map((alert: any, index: number) => (\r\n                  <div\r\n                    key={index}\r\n                    style={{\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: '1rem',\r\n                      padding: '1rem',\r\n                      background: '#fef2f2',\r\n                      border: '1px solid #fecaca',\r\n                      borderRadius: '8px'\r\n                    }}\r\n                  >\r\n                    <AlertTriangle size={20} style={{ color: '#ef4444', flexShrink: 0 }} />\r\n                    <div style={{ flex: 1 }}>\r\n                      <div style={{ fontWeight: '500', color: '#991b1b' }}>\r\n                        {alert.title}\r\n                      </div>\r\n                      <div style={{ fontSize: '0.875rem', color: '#7f1d1d' }}>\r\n                        {alert.message}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Detailed Metrics Grid */}\r\n          <div style={{\r\n            display: 'grid',\r\n            gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))',\r\n            gap: '2rem'\r\n          }}>\r\n            {/* Revenue Breakdown */}\r\n            <div style={{\r\n              background: 'white',\r\n              border: '1px solid #e2e8f0',\r\n              borderRadius: '12px',\r\n              padding: '2rem'\r\n            }}>\r\n              <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1.5rem' }}>\r\n                Revenue Breakdown\r\n              </h3>\r\n\r\n              <div style={{ display: 'grid', gap: '1rem' }}>\r\n                <div style={{\r\n                  display: 'flex',\r\n                  justifyContent: 'space-between',\r\n                  alignItems: 'center',\r\n                  padding: '1rem',\r\n                  background: '#f8fafc',\r\n                  borderRadius: '8px'\r\n                }}>\r\n                  <span style={{ color: '#64748b' }}>Room Revenue</span>\r\n                  <span style={{ fontWeight: '600' }}>\r\n                    {formatCurrency(metrics.revenue.roomRevenue)}\r\n                  </span>\r\n                </div>\r\n\r\n                <div style={{\r\n                  display: 'flex',\r\n                  justifyContent: 'space-between',\r\n                  alignItems: 'center',\r\n                  padding: '1rem',\r\n                  background: '#f8fafc',\r\n                  borderRadius: '8px'\r\n                }}>\r\n                  <span style={{ color: '#64748b' }}>Room Service</span>\r\n                  <span style={{ fontWeight: '600' }}>\r\n                    {formatCurrency(metrics.revenue.roomServiceRevenue)}\r\n                  </span>\r\n                </div>\r\n\r\n                <div style={{\r\n                  display: 'flex',\r\n                  justifyContent: 'space-between',\r\n                  alignItems: 'center',\r\n                  padding: '1rem',\r\n                  background: '#dbeafe',\r\n                  borderRadius: '8px'\r\n                }}>\r\n                  <span style={{ color: '#1e40af', fontWeight: '500' }}>Total Revenue</span>\r\n                  <span style={{ fontWeight: '700', color: '#1e40af' }}>\r\n                    {formatCurrency(metrics.revenue.totalRevenue)}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Performance Indicators */}\r\n            <div style={{\r\n              background: 'white',\r\n              border: '1px solid #e2e8f0',\r\n              borderRadius: '12px',\r\n              padding: '2rem'\r\n            }}>\r\n              <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1.5rem' }}>\r\n                Performance Indicators\r\n              </h3>\r\n\r\n              <div style={{ display: 'grid', gap: '1rem' }}>\r\n                <div style={{\r\n                  display: 'flex',\r\n                  justifyContent: 'space-between',\r\n                  alignItems: 'center',\r\n                  padding: '1rem',\r\n                  background: getStatusColor(metrics.occupancy.occupancyRate, { good: 80, warning: 60 }) + '15',\r\n                  borderRadius: '8px'\r\n                }}>\r\n                  <span style={{ color: '#64748b' }}>Occupancy Rate</span>\r\n                  <span style={{\r\n                    fontWeight: '600',\r\n                    color: getStatusColor(metrics.occupancy.occupancyRate, { good: 80, warning: 60 })\r\n                  }}>\r\n                    {formatPercentage(metrics.occupancy.occupancyRate)}\r\n                  </span>\r\n                </div>\r\n\r\n                <div style={{\r\n                  display: 'flex',\r\n                  justifyContent: 'space-between',\r\n                  alignItems: 'center',\r\n                  padding: '1rem',\r\n                  background: getStatusColor(metrics.satisfaction.resolutionRate, { good: 90, warning: 75 }) + '15',\r\n                  borderRadius: '8px'\r\n                }}>\r\n                  <span style={{ color: '#64748b' }}>Request Resolution</span>\r\n                  <span style={{\r\n                    fontWeight: '600',\r\n                    color: getStatusColor(metrics.satisfaction.resolutionRate, { good: 90, warning: 75 })\r\n                  }}>\r\n                    {formatPercentage(metrics.satisfaction.resolutionRate)}\r\n                  </span>\r\n                </div>\r\n\r\n                <div style={{\r\n                  display: 'flex',\r\n                  justifyContent: 'space-between',\r\n                  alignItems: 'center',\r\n                  padding: '1rem',\r\n                  background: '#f8fafc',\r\n                  borderRadius: '8px'\r\n                }}>\r\n                  <span style={{ color: '#64748b' }}>Avg Resolution Time</span>\r\n                  <span style={{ fontWeight: '600' }}>\r\n                    {metrics.satisfaction.avgResolutionTime > 0\r\n                      ? `${Math.round(metrics.satisfaction.avgResolutionTime)}h`\r\n                      : 'N/A'\r\n                    }\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Quick Actions */}\r\n            <div style={{\r\n              background: 'white',\r\n              border: '1px solid #e2e8f0',\r\n              borderRadius: '12px',\r\n              padding: '2rem'\r\n            }}>\r\n              <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1.5rem' }}>\r\n                Quick Actions\r\n              </h3>\r\n\r\n              <div style={{ display: 'grid', gap: '1rem' }}>\r\n                <Button variant=\"secondary\" style={{ justifyContent: 'flex-start' }}>\r\n                  <Eye size={16} style={{ marginRight: '0.5rem' }} />\r\n                  View Detailed Reports\r\n                </Button>\r\n\r\n                <Button variant=\"secondary\" style={{ justifyContent: 'flex-start' }}>\r\n                  <Filter size={16} style={{ marginRight: '0.5rem' }} />\r\n                  Custom Date Range\r\n                </Button>\r\n\r\n                <Button variant=\"secondary\" style={{ justifyContent: 'flex-start' }}>\r\n                  <Download size={16} style={{ marginRight: '0.5rem' }} />\r\n                  Export Data\r\n                </Button>\r\n\r\n                <Button variant=\"secondary\" style={{ justifyContent: 'flex-start' }}>\r\n                  <Target size={16} style={{ marginRight: '0.5rem' }} />\r\n                  Set Performance Goals\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\CalendarPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchCalendar' and 'fetchRooms'. Either include them or remove the dependency array.","line":75,"column":6,"nodeType":"ArrayExpression","endLine":75,"endColumn":51,"suggestions":[{"desc":"Update the dependencies array to be: [user, currentStartDate, daysToShow, filters, fetchCalendar, fetchRooms]","fix":{"range":[2437,2482],"text":"[user, currentStartDate, daysToShow, filters, fetchCalendar, fetchRooms]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from 'react';\nimport { useAuthStore } from '../store/authStore';\nimport { api } from '../lib/api';\nimport Layout from '../components/Layout';\nimport { ChevronLeft, ChevronRight, Calendar as CalendarIcon, Filter, Users } from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport { CardSkeleton } from '../components/LoadingSkeleton';\nimport { format, addDays, subDays, startOfDay, eachDayOfInterval, isSameDay, parseISO } from 'date-fns';\nimport { useNavigate } from 'react-router-dom';\n\ninterface CalendarData {\n  startDate: string;\n  endDate: string;\n  rooms: Array<{\n    room: {\n      id: string;\n      roomNumber: string;\n      roomType: string;\n      status: string;\n      maxOccupancy: number;\n    };\n    availability: Array<{\n      date: string;\n      status: 'available' | 'occupied' | 'check_in' | 'check_out' | 'blocked';\n      reservation: {\n        id: string;\n        guestName: string;\n        checkInDate: Date;\n        checkOutDate: Date;\n        status: string;\n        rate: number;\n        groupBookingId?: string | null;\n        groupBooking?: {\n          id: string;\n          groupBookingNumber: string;\n          groupName?: string | null;\n          totalRooms: number;\n        } | null;\n      } | null;\n    }>;\n  }>;\n}\n\nexport default function CalendarPage() {\n  const { user } = useAuthStore();\n  const navigate = useNavigate();\n  const [calendarData, setCalendarData] = useState<CalendarData | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [currentStartDate, setCurrentStartDate] = useState(startOfDay(new Date()));\n  const [daysToShow, setDaysToShow] = useState(14); // Show 2 weeks by default\n  const [selectedReservation, setSelectedReservation] = useState<any>(null);\n  const [showFilters, setShowFilters] = useState(false);\n  const [filters, setFilters] = useState({\n    roomType: '',\n    status: '',\n  });\n  const [draggedReservation, setDraggedReservation] = useState<{\n    reservationId: string;\n    roomId: string;\n    checkInDate: Date;\n    checkOutDate: Date;\n  } | null>(null);\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [createModalData, setCreateModalData] = useState<{\n    roomId: string;\n    checkInDate: string;\n    checkOutDate: string;\n  } | null>(null);\n  const [rooms, setRooms] = useState<any[]>([]);\n\n  useEffect(() => {\n    if (!user?.tenantId) return;\n    fetchCalendar();\n    fetchRooms();\n  }, [user, currentStartDate, daysToShow, filters]);\n\n  const fetchRooms = async () => {\n    try {\n      const response = await api.get(`/tenants/${user?.tenantId}/rooms`);\n      setRooms(response.data.data || []);\n    } catch (error) {\n      console.error('Failed to fetch rooms:', error);\n    }\n  };\n\n  const fetchCalendar = async () => {\n    try {\n      setLoading(true);\n      const endDate = addDays(currentStartDate, daysToShow - 1);\n      const params: any = {\n        startDate: format(currentStartDate, 'yyyy-MM-dd'),\n        endDate: format(endDate, 'yyyy-MM-dd'),\n      };\n      if (filters.roomType) params.roomType = filters.roomType;\n      if (filters.status) params.status = filters.status;\n\n      const response = await api.get(`/tenants/${user?.tenantId}/calendar`, { params });\n      setCalendarData(response.data.data);\n    } catch (error: any) {\n      console.error('Failed to fetch calendar:', error);\n      toast.error(error.response?.data?.message || 'Failed to fetch calendar');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handlePrevious = () => {\n    setCurrentStartDate(subDays(currentStartDate, daysToShow));\n  };\n\n  const handleNext = () => {\n    setCurrentStartDate(addDays(currentStartDate, daysToShow));\n  };\n\n  const handleToday = () => {\n    setCurrentStartDate(startOfDay(new Date()));\n  };\n\n  const handleDragStart = (e: React.DragEvent, reservation: any, roomId: string) => {\n    if (reservation.status === 'checked_out' || reservation.status === 'cancelled') {\n      e.preventDefault();\n      return;\n    }\n    setDraggedReservation({\n      reservationId: reservation.id,\n      roomId,\n      checkInDate: reservation.checkInDate,\n      checkOutDate: reservation.checkOutDate,\n    });\n    e.dataTransfer.effectAllowed = 'move';\n  };\n\n  const handleDragOver = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  };\n\n  const handleDrop = async (e: React.DragEvent, targetRoomId: string, targetDate: Date) => {\n    e.preventDefault();\n    if (!draggedReservation) return;\n\n    try {\n      const nights = Math.ceil(\n        (draggedReservation.checkOutDate.getTime() - draggedReservation.checkInDate.getTime()) / (1000 * 60 * 60 * 24)\n      );\n      const newCheckInDate = startOfDay(targetDate);\n      const newCheckOutDate = addDays(newCheckInDate, nights);\n\n      await api.post(`/tenants/${user?.tenantId}/calendar/move-reservation`, {\n        reservationId: draggedReservation.reservationId,\n        newRoomId: targetRoomId,\n        newCheckInDate: newCheckInDate.toISOString(),\n        newCheckOutDate: newCheckOutDate.toISOString(),\n      });\n\n      toast.success('Reservation moved successfully');\n      fetchCalendar();\n    } catch (error: any) {\n      console.error('Failed to move reservation:', error);\n      toast.error(error.response?.data?.message || 'Failed to move reservation');\n    } finally {\n      setDraggedReservation(null);\n    }\n  };\n\n  const handleCellClick = (roomId: string, date: Date, day: any) => {\n    if (day.status === 'available' && !day.reservation) {\n      const nextDay = addDays(date, 1);\n      setCreateModalData({\n        roomId,\n        checkInDate: format(date, \"yyyy-MM-dd'T'HH:mm\"),\n        checkOutDate: format(nextDay, \"yyyy-MM-dd'T'HH:mm\"),\n      });\n      setShowCreateModal(true);\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    const colors: Record<string, string> = {\n      available: '#d1fae5', // green-100\n      occupied: '#dbeafe', // blue-100\n      check_in: '#fef3c7', // yellow-100\n      check_out: '#fce7f3', // pink-100\n      blocked: '#fee2e2', // red-100\n    };\n    return colors[status] || '#f3f4f6';\n  };\n\n  const getStatusBorderColor = (status: string) => {\n    const colors: Record<string, string> = {\n      available: '#10b981', // green-500\n      occupied: '#3b82f6', // blue-500\n      check_in: '#f59e0b', // yellow-500\n      check_out: '#ec4899', // pink-500\n      blocked: '#ef4444', // red-500\n    };\n    return colors[status] || '#9ca3af';\n  };\n\n  const getStatusTextColor = (status: string) => {\n    const colors: Record<string, string> = {\n      available: '#065f46', // green-800\n      occupied: '#1e40af', // blue-800\n      check_in: '#92400e', // yellow-800\n      check_out: '#9f1239', // pink-800\n      blocked: '#991b1b', // red-800\n    };\n    return colors[status] || '#374151';\n  };\n\n  if (loading) {\n    return (\n      <Layout>\n        <div>\n          <CardSkeleton count={3} />\n        </div>\n      </Layout>\n    );\n  }\n\n  if (!calendarData) {\n    return (\n      <Layout>\n        <div style={{ textAlign: 'center', padding: '3rem' }}>\n          <CalendarIcon size={48} style={{ margin: '0 auto 1rem', opacity: 0.5, color: '#64748b' }} />\n          <p style={{ color: '#64748b' }}>No calendar data available</p>\n        </div>\n      </Layout>\n    );\n  }\n\n  const dates = eachDayOfInterval({\n    start: parseISO(calendarData.startDate),\n    end: parseISO(calendarData.endDate),\n  });\n\n  return (\n    <Layout>\n      <div>\n        {/* Header */}\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem', flexWrap: 'wrap', gap: '1rem' }}>\n          <h1 style={{ color: '#1e293b' }}>Room Calendar</h1>\n          <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>\n            <button\n              onClick={() => setShowFilters(!showFilters)}\n              style={{\n                padding: '0.5rem 1rem',\n                border: '1px solid #e2e8f0',\n                borderRadius: '6px',\n                background: 'white',\n                color: '#64748b',\n                cursor: 'pointer',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '0.5rem',\n              }}\n            >\n              <Filter size={16} />\n              Filters\n            </button>\n            <select\n              value={daysToShow}\n              onChange={(e) => setDaysToShow(Number(e.target.value))}\n              style={{\n                padding: '0.5rem 1rem',\n                border: '1px solid #e2e8f0',\n                borderRadius: '6px',\n                background: 'white',\n                color: '#64748b',\n                cursor: 'pointer',\n              }}\n            >\n              <option value={7}>7 days</option>\n              <option value={14}>14 days</option>\n              <option value={30}>30 days</option>\n              <option value={60}>60 days</option>\n            </select>\n          </div>\n        </div>\n\n        {/* Filters */}\n        {showFilters && (\n          <div\n            style={{\n              background: 'white',\n              padding: '1rem',\n              borderRadius: '8px',\n              marginBottom: '1.5rem',\n              display: 'flex',\n              gap: '1rem',\n              flexWrap: 'wrap',\n            }}\n          >\n            <div>\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', color: '#64748b' }}>\n                Room Type\n              </label>\n              <select\n                value={filters.roomType}\n                onChange={(e) => setFilters({ ...filters, roomType: e.target.value })}\n                style={{\n                  padding: '0.5rem',\n                  border: '1px solid #e2e8f0',\n                  borderRadius: '6px',\n                  minWidth: '150px',\n                }}\n              >\n                <option value=\"\">All Types</option>\n                <option value=\"single\">Single</option>\n                <option value=\"double\">Double</option>\n                <option value=\"suite\">Suite</option>\n                <option value=\"deluxe\">Deluxe</option>\n              </select>\n            </div>\n            <div>\n              <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', color: '#64748b' }}>\n                Room Status\n              </label>\n              <select\n                value={filters.status}\n                onChange={(e) => setFilters({ ...filters, status: e.target.value })}\n                style={{\n                  padding: '0.5rem',\n                  border: '1px solid #e2e8f0',\n                  borderRadius: '6px',\n                  minWidth: '150px',\n                }}\n              >\n                <option value=\"\">All Statuses</option>\n                <option value=\"available\">Available</option>\n                <option value=\"occupied\">Occupied</option>\n                <option value=\"dirty\">Dirty</option>\n                <option value=\"maintenance\">Maintenance</option>\n              </select>\n            </div>\n            <button\n              onClick={() => setFilters({ roomType: '', status: '' })}\n              style={{\n                padding: '0.5rem 1rem',\n                border: '1px solid #e2e8f0',\n                borderRadius: '6px',\n                background: 'white',\n                color: '#64748b',\n                cursor: 'pointer',\n                alignSelf: 'flex-end',\n              }}\n            >\n              Clear Filters\n            </button>\n          </div>\n        )}\n\n        {/* Date Navigation */}\n        <div\n          style={{\n            background: 'white',\n            padding: '1rem',\n            borderRadius: '8px',\n            marginBottom: '1rem',\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n          }}\n        >\n          <button\n            onClick={handlePrevious}\n            style={{\n              padding: '0.5rem',\n              border: '1px solid #e2e8f0',\n              borderRadius: '6px',\n              background: 'white',\n              cursor: 'pointer',\n              display: 'flex',\n              alignItems: 'center',\n            }}\n          >\n            <ChevronLeft size={20} />\n          </button>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>\n            <span style={{ fontWeight: '600', color: '#1e293b' }}>\n              {format(parseISO(calendarData.startDate), 'MMM d')} - {format(parseISO(calendarData.endDate), 'MMM d, yyyy')}\n            </span>\n            <button\n              onClick={handleToday}\n              style={{\n                padding: '0.5rem 1rem',\n                border: '1px solid #e2e8f0',\n                borderRadius: '6px',\n                background: '#f8fafc',\n                color: '#64748b',\n                cursor: 'pointer',\n                fontSize: '0.875rem',\n              }}\n            >\n              Today\n            </button>\n          </div>\n          <button\n            onClick={handleNext}\n            style={{\n              padding: '0.5rem',\n              border: '1px solid #e2e8f0',\n              borderRadius: '6px',\n              background: 'white',\n              cursor: 'pointer',\n              display: 'flex',\n              alignItems: 'center',\n            }}\n          >\n            <ChevronRight size={20} />\n          </button>\n        </div>\n\n        {/* Calendar Grid */}\n        <div\n          style={{\n            background: 'white',\n            borderRadius: '8px',\n            overflow: 'auto',\n            boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\n          }}\n        >\n          <div style={{ display: 'grid', gridTemplateColumns: `200px repeat(${dates.length}, minmax(120px, 1fr))`, minWidth: 'max-content' }}>\n            {/* Header Row */}\n            <div\n              style={{\n                padding: '1rem',\n                background: '#f8fafc',\n                borderBottom: '2px solid #e2e8f0',\n                fontWeight: '600',\n                color: '#1e293b',\n                position: 'sticky',\n                left: 0,\n                zIndex: 10,\n              }}\n            >\n              Room\n            </div>\n            {dates.map((date) => (\n              <div\n                key={date.toISOString()}\n                style={{\n                  padding: '1rem 0.5rem',\n                  background: '#f8fafc',\n                  borderBottom: '2px solid #e2e8f0',\n                  borderLeft: '1px solid #e2e8f0',\n                  textAlign: 'center',\n                  fontWeight: '600',\n                  color: '#1e293b',\n                }}\n              >\n                <div style={{ fontSize: '0.875rem' }}>{format(date, 'EEE')}</div>\n                <div style={{ fontSize: '1.125rem' }}>{format(date, 'd')}</div>\n                <div style={{ fontSize: '0.75rem', color: '#64748b' }}>{format(date, 'MMM')}</div>\n              </div>\n            ))}\n\n            {/* Room Rows */}\n            {calendarData.rooms.map((roomData) => (\n              <div key={roomData.room.id} style={{ display: 'contents' }}>\n                {/* Room Name Column */}\n                <div\n                  style={{\n                    padding: '1rem',\n                    background: 'white',\n                    borderBottom: '1px solid #e2e8f0',\n                    borderRight: '1px solid #e2e8f0',\n                    position: 'sticky',\n                    left: 0,\n                    zIndex: 5,\n                  }}\n                >\n                  <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '0.25rem' }}>\n                    {roomData.room.roomNumber}\n                  </div>\n                  <div style={{ fontSize: '0.75rem', color: '#64748b' }}>{roomData.room.roomType}</div>\n                  <div\n                    style={{\n                      fontSize: '0.75rem',\n                      padding: '0.125rem 0.5rem',\n                      borderRadius: '12px',\n                      display: 'inline-block',\n                      marginTop: '0.25rem',\n                      background: getStatusColor(roomData.room.status),\n                      color: getStatusTextColor(roomData.room.status),\n                    }}\n                  >\n                    {roomData.room.status}\n                  </div>\n                </div>\n\n                {/* Date Cells */}\n                {roomData.availability.map((day) => {\n                  const isToday = isSameDay(parseISO(day.date), new Date());\n                  const date = parseISO(day.date);\n                  const canDrop = draggedReservation && \n                    day.status === 'available' && \n                    !day.reservation &&\n                    draggedReservation.roomId !== roomData.room.id;\n                  \n                  return (\n                    <div\n                      key={day.date}\n                      draggable={!!(day.reservation && (day.reservation.status === 'confirmed' || day.reservation.status === 'checked_in'))}\n                      onDragStart={(e) => day.reservation && handleDragStart(e, day.reservation, roomData.room.id)}\n                      onDragOver={handleDragOver}\n                      onDrop={(e) => handleDrop(e, roomData.room.id, date)}\n                      onClick={() => {\n                        if (day.reservation) {\n                          setSelectedReservation(day.reservation);\n                        } else {\n                          handleCellClick(roomData.room.id, date, day);\n                        }\n                      }}\n                      style={{\n                        padding: '0.5rem',\n                        borderBottom: '1px solid #e2e8f0',\n                        borderLeft: isToday ? '3px solid #3b82f6' : '1px solid #e2e8f0',\n                        minHeight: '80px',\n                        background: canDrop ? '#dbeafe' : getStatusColor(day.status),\n                        cursor: day.reservation || day.status === 'available' ? 'pointer' : 'default',\n                        position: 'relative',\n                        opacity: draggedReservation && draggedReservation.reservationId === day.reservation?.id ? '0.5' : '1',\n                      }}\n                      onMouseEnter={(e) => {\n                        if (day.reservation || day.status === 'available') {\n                          e.currentTarget.style.opacity = '0.8';\n                        }\n                      }}\n                      onMouseLeave={(e) => {\n                        e.currentTarget.style.opacity = draggedReservation && draggedReservation.reservationId === day.reservation?.id ? '0.5' : '1';\n                      }}\n                    >\n                      {day.reservation && (\n                        <div>\n                          <div\n                            style={{\n                              padding: '0.25rem 0.5rem',\n                              borderRadius: '4px',\n                              background: day.reservation.groupBookingId ? '#8b5cf6' : getStatusBorderColor(day.status),\n                              color: 'white',\n                              fontSize: '0.75rem',\n                              fontWeight: '500',\n                              marginBottom: '0.25rem',\n                              display: 'flex',\n                              alignItems: 'center',\n                              gap: '0.25rem',\n                            }}\n                          >\n                            {day.reservation.groupBookingId && (\n                              <Users size={12} style={{ flexShrink: 0 }} />\n                            )}\n                            <span style={{ flex: 1, overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>\n                              {day.reservation.guestName}\n                            </span>\n                          </div>\n                          {day.reservation.groupBooking && (\n                            <div\n                              style={{\n                                fontSize: '0.625rem',\n                                color: '#6b21a8',\n                                fontWeight: '500',\n                                marginTop: '0.125rem',\n                                padding: '0.125rem 0.375rem',\n                                background: '#f3e8ff',\n                                borderRadius: '3px',\n                                display: 'inline-block',\n                              }}\n                              title={`Group: ${day.reservation.groupBooking.groupName || day.reservation.groupBooking.groupBookingNumber} (${day.reservation.groupBooking.totalRooms} rooms)`}\n                            >\n                              Group ({day.reservation.groupBooking.totalRooms})\n                            </div>\n                          )}\n                        </div>\n                      )}\n                      {day.status === 'check_in' && (\n                        <div style={{ fontSize: '0.625rem', color: '#92400e', fontWeight: '500' }}>Check-in</div>\n                      )}\n                      {day.status === 'check_out' && (\n                        <div style={{ fontSize: '0.625rem', color: '#9f1239', fontWeight: '500' }}>Check-out</div>\n                      )}\n                      {day.status === 'blocked' && (\n                        <div style={{ fontSize: '0.625rem', color: '#991b1b', fontWeight: '500' }}>Blocked</div>\n                      )}\n                    </div>\n                  );\n                })}\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* Legend */}\n        <div\n          style={{\n            marginTop: '1rem',\n            padding: '1rem',\n            background: 'white',\n            borderRadius: '8px',\n            display: 'flex',\n            gap: '1.5rem',\n            flexWrap: 'wrap',\n          }}\n        >\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n            <div style={{ width: '20px', height: '20px', background: '#d1fae5', borderRadius: '4px' }} />\n            <span style={{ fontSize: '0.875rem', color: '#64748b' }}>Available</span>\n          </div>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n            <div style={{ width: '20px', height: '20px', background: '#dbeafe', borderRadius: '4px' }} />\n            <span style={{ fontSize: '0.875rem', color: '#64748b' }}>Occupied</span>\n          </div>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n            <div style={{ width: '20px', height: '20px', background: '#fef3c7', borderRadius: '4px' }} />\n            <span style={{ fontSize: '0.875rem', color: '#64748b' }}>Check-in</span>\n          </div>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n            <div style={{ width: '20px', height: '20px', background: '#fce7f3', borderRadius: '4px' }} />\n            <span style={{ fontSize: '0.875rem', color: '#64748b' }}>Check-out</span>\n          </div>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n            <div style={{ width: '20px', height: '20px', background: '#fee2e2', borderRadius: '4px' }} />\n            <span style={{ fontSize: '0.875rem', color: '#64748b' }}>Blocked</span>\n          </div>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n            <div style={{ width: '20px', height: '20px', background: '#8b5cf6', borderRadius: '4px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\n              <Users size={12} color=\"white\" />\n            </div>\n            <span style={{ fontSize: '0.875rem', color: '#64748b' }}>Group Booking</span>\n          </div>\n        </div>\n\n        {/* Reservation Details Modal */}\n        {selectedReservation && (\n          <div\n            style={{\n              position: 'fixed',\n              top: 0,\n              left: 0,\n              right: 0,\n              bottom: 0,\n              background: 'rgba(0,0,0,0.5)',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              zIndex: 1000,\n            }}\n            onClick={() => setSelectedReservation(null)}\n          >\n            <div\n              style={{\n                background: 'white',\n                borderRadius: '8px',\n                padding: '2rem',\n                maxWidth: '500px',\n                width: '90%',\n              }}\n              onClick={(e) => e.stopPropagation()}\n            >\n              <h2 style={{ margin: '0 0 1rem', color: '#1e293b' }}>Reservation Details</h2>\n              <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>\n                <div>\n                  <div style={{ fontSize: '0.875rem', color: '#64748b', marginBottom: '0.25rem' }}>Guest</div>\n                  <div style={{ fontWeight: '600', color: '#1e293b' }}>{selectedReservation.guestName}</div>\n                </div>\n                <div>\n                  <div style={{ fontSize: '0.875rem', color: '#64748b', marginBottom: '0.25rem' }}>Check-in</div>\n                  <div style={{ color: '#1e293b' }}>{format(selectedReservation.checkInDate, 'MMM d, yyyy')}</div>\n                </div>\n                <div>\n                  <div style={{ fontSize: '0.875rem', color: '#64748b', marginBottom: '0.25rem' }}>Check-out</div>\n                  <div style={{ color: '#1e293b' }}>{format(selectedReservation.checkOutDate, 'MMM d, yyyy')}</div>\n                </div>\n                <div>\n                  <div style={{ fontSize: '0.875rem', color: '#64748b', marginBottom: '0.25rem' }}>Rate</div>\n                  <div style={{ fontWeight: '600', color: '#1e293b' }}>{selectedReservation.rate.toLocaleString()}</div>\n                </div>\n                <div>\n                  <div style={{ fontSize: '0.875rem', color: '#64748b', marginBottom: '0.25rem' }}>Status</div>\n                  <span\n                    style={{\n                      padding: '0.25rem 0.75rem',\n                      borderRadius: '12px',\n                      fontSize: '0.75rem',\n                      fontWeight: '500',\n                      background: getStatusColor(selectedReservation.status),\n                      color: getStatusTextColor(selectedReservation.status),\n                    }}\n                  >\n                    {selectedReservation.status.replace('_', ' ').toUpperCase()}\n                  </span>\n                </div>\n                {selectedReservation.groupBooking && (\n                  <div\n                    style={{\n                      padding: '0.75rem',\n                      background: '#f3e8ff',\n                      borderRadius: '6px',\n                      border: '1px solid #c084fc',\n                    }}\n                  >\n                    <div style={{ fontSize: '0.875rem', color: '#6b21a8', marginBottom: '0.5rem', fontWeight: '600', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n                      <Users size={16} />\n                      Group Booking\n                    </div>\n                    <div style={{ fontSize: '0.875rem', color: '#7c3aed', marginBottom: '0.25rem' }}>\n                      {selectedReservation.groupBooking.groupName || selectedReservation.groupBooking.groupBookingNumber}\n                    </div>\n                    <div style={{ fontSize: '0.75rem', color: '#a855f7' }}>\n                      {selectedReservation.groupBooking.totalRooms} room{selectedReservation.groupBooking.totalRooms !== 1 ? 's' : ''} in this group\n                    </div>\n                    <button\n                      onClick={() => {\n                        setSelectedReservation(null);\n                        navigate(`/group-bookings?highlight=${selectedReservation.groupBooking.id}`);\n                      }}\n                      style={{\n                        marginTop: '0.75rem',\n                        padding: '0.5rem 1rem',\n                        border: '1px solid #c084fc',\n                        borderRadius: '4px',\n                        background: 'white',\n                        color: '#7c3aed',\n                        cursor: 'pointer',\n                        fontSize: '0.875rem',\n                        fontWeight: '500',\n                        width: '100%',\n                      }}\n                    >\n                      View Group Booking\n                    </button>\n                  </div>\n                )}\n              </div>\n              <div style={{ display: 'flex', gap: '0.75rem', marginTop: '1.5rem' }}>\n                <button\n                  onClick={() => setSelectedReservation(null)}\n                  style={{\n                    flex: 1,\n                    padding: '0.75rem 1.5rem',\n                    border: 'none',\n                    borderRadius: '6px',\n                    background: '#3b82f6',\n                    color: 'white',\n                    cursor: 'pointer',\n                  }}\n                >\n                  Close\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Quick Create Reservation Modal */}\n        {showCreateModal && createModalData && (\n          <QuickCreateReservationModal\n            roomId={createModalData.roomId}\n            checkInDate={createModalData.checkInDate}\n            checkOutDate={createModalData.checkOutDate}\n            rooms={rooms}\n            onClose={() => {\n              setShowCreateModal(false);\n              setCreateModalData(null);\n            }}\n            onSuccess={() => {\n              setShowCreateModal(false);\n              setCreateModalData(null);\n              fetchCalendar();\n            }}\n          />\n        )}\n      </div>\n    </Layout>\n  );\n}\n\nfunction QuickCreateReservationModal({\n  roomId,\n  checkInDate,\n  checkOutDate,\n  rooms,\n  onClose,\n  onSuccess,\n}: {\n  roomId: string;\n  checkInDate: string;\n  checkOutDate: string;\n  rooms: any[];\n  onClose: () => void;\n  onSuccess: () => void;\n}) {\n  const { user } = useAuthStore();\n  const [formData, setFormData] = useState({\n    roomId,\n    guestName: '',\n    guestEmail: '',\n    guestPhone: '',\n    checkInDate,\n    checkOutDate,\n    adults: 1,\n    children: 0,\n    rate: '',\n  });\n  const [loading, setLoading] = useState(false);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!formData.guestName || !formData.rate) {\n      toast.error('Please fill in guest name and rate');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      await api.post(`/tenants/${user?.tenantId}/reservations`, {\n        ...formData,\n        rate: parseFloat(formData.rate),\n        checkInDate: new Date(formData.checkInDate).toISOString(),\n        checkOutDate: new Date(formData.checkOutDate).toISOString(),\n      });\n      toast.success('Reservation created successfully');\n      onSuccess();\n    } catch (error: any) {\n      console.error('Failed to create reservation:', error);\n      toast.error(error.response?.data?.message || 'Failed to create reservation');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        background: 'rgba(0,0,0,0.5)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 1000,\n      }}\n      onClick={onClose}\n    >\n      <div\n        style={{\n          background: 'white',\n          borderRadius: '8px',\n          padding: '2rem',\n          width: '90%',\n          maxWidth: '500px',\n          maxHeight: '90vh',\n          overflow: 'auto',\n        }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        <h2 style={{ margin: '0 0 1.5rem', color: '#1e293b' }}>Quick Create Reservation</h2>\n        <form onSubmit={handleSubmit}>\n          <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\n            <div>\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\n                Room *\n              </label>\n              <select\n                value={formData.roomId}\n                onChange={(e) => setFormData({ ...formData, roomId: e.target.value })}\n                required\n                style={{\n                  width: '100%',\n                  padding: '0.75rem',\n                  border: '1px solid #cbd5e1',\n                  borderRadius: '6px',\n                }}\n              >\n                {rooms.map((room) => (\n                  <option key={room.id} value={room.id}>\n                    {room.roomNumber} - {room.roomType}\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            <div>\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\n                Guest Name *\n              </label>\n              <input\n                type=\"text\"\n                value={formData.guestName}\n                onChange={(e) => setFormData({ ...formData, guestName: e.target.value })}\n                required\n                style={{\n                  width: '100%',\n                  padding: '0.75rem',\n                  border: '1px solid #cbd5e1',\n                  borderRadius: '6px',\n                }}\n              />\n            </div>\n\n            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>\n              <div>\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\n                  Check-in Date *\n                </label>\n                <input\n                  type=\"datetime-local\"\n                  value={formData.checkInDate}\n                  onChange={(e) => setFormData({ ...formData, checkInDate: e.target.value })}\n                  required\n                  style={{\n                    width: '100%',\n                    padding: '0.75rem',\n                    border: '1px solid #cbd5e1',\n                    borderRadius: '6px',\n                  }}\n                />\n              </div>\n              <div>\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\n                  Check-out Date *\n                </label>\n                <input\n                  type=\"datetime-local\"\n                  value={formData.checkOutDate}\n                  onChange={(e) => setFormData({ ...formData, checkOutDate: e.target.value })}\n                  required\n                  style={{\n                    width: '100%',\n                    padding: '0.75rem',\n                    border: '1px solid #cbd5e1',\n                    borderRadius: '6px',\n                  }}\n                />\n              </div>\n            </div>\n\n            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>\n              <div>\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\n                  Adults\n                </label>\n                <input\n                  type=\"number\"\n                  min=\"1\"\n                  value={formData.adults}\n                  onChange={(e) => setFormData({ ...formData, adults: parseInt(e.target.value) || 1 })}\n                  style={{\n                    width: '100%',\n                    padding: '0.75rem',\n                    border: '1px solid #cbd5e1',\n                    borderRadius: '6px',\n                  }}\n                />\n              </div>\n              <div>\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\n                  Children\n                </label>\n                <input\n                  type=\"number\"\n                  min=\"0\"\n                  value={formData.children}\n                  onChange={(e) => setFormData({ ...formData, children: parseInt(e.target.value) || 0 })}\n                  style={{\n                    width: '100%',\n                    padding: '0.75rem',\n                    border: '1px solid #cbd5e1',\n                    borderRadius: '6px',\n                  }}\n                />\n              </div>\n            </div>\n\n            <div>\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\n                Rate () *\n              </label>\n              <input\n                type=\"number\"\n                step=\"0.01\"\n                value={formData.rate}\n                onChange={(e) => setFormData({ ...formData, rate: e.target.value })}\n                required\n                style={{\n                  width: '100%',\n                  padding: '0.75rem',\n                  border: '1px solid #cbd5e1',\n                  borderRadius: '6px',\n                }}\n              />\n            </div>\n\n            <div>\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\n                Guest Email\n              </label>\n              <input\n                type=\"email\"\n                value={formData.guestEmail}\n                onChange={(e) => setFormData({ ...formData, guestEmail: e.target.value })}\n                style={{\n                  width: '100%',\n                  padding: '0.75rem',\n                  border: '1px solid #cbd5e1',\n                  borderRadius: '6px',\n                }}\n              />\n            </div>\n\n            <div>\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\n                Guest Phone\n              </label>\n              <input\n                type=\"tel\"\n                value={formData.guestPhone}\n                onChange={(e) => setFormData({ ...formData, guestPhone: e.target.value })}\n                style={{\n                  width: '100%',\n                  padding: '0.75rem',\n                  border: '1px solid #cbd5e1',\n                  borderRadius: '6px',\n                }}\n              />\n            </div>\n\n            <div style={{ display: 'flex', gap: '1rem', marginTop: '1rem' }}>\n              <button\n                type=\"button\"\n                onClick={onClose}\n                style={{\n                  flex: 1,\n                  padding: '0.75rem',\n                  border: '1px solid #e2e8f0',\n                  borderRadius: '6px',\n                  background: 'white',\n                  color: '#64748b',\n                  cursor: 'pointer',\n                  fontWeight: '500',\n                }}\n              >\n                Cancel\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                style={{\n                  flex: 1,\n                  padding: '0.75rem',\n                  border: 'none',\n                  borderRadius: '6px',\n                  background: '#3b82f6',\n                  color: 'white',\n                  cursor: loading ? 'not-allowed' : 'pointer',\n                  fontWeight: '500',\n                  opacity: loading ? 0.6 : 1,\n                }}\n              >\n                {loading ? 'Creating...' : 'Create Reservation'}\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\DashboardPage.tsx","messages":[{"ruleId":"react/display-name","severity":2,"message":"Component definition is missing display name","line":82,"column":20,"nodeType":"CallExpression","messageId":"noDisplayName","endLine":132,"endColumn":5}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useCallback, useMemo, memo } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Layout from '../components/Layout';\r\nimport { Calendar, DollarSign, Bed, AlertTriangle, RefreshCw, AlertCircle } from 'lucide-react';\r\nimport { DashboardSkeleton } from '../components/LoadingSkeleton';\r\nimport toast from 'react-hot-toast';\r\n\r\ninterface DashboardStats {\r\n  todayReservations: number;\r\n  checkedIn: number;\r\n  availableRooms: number;\r\n  todayRevenue: number;\r\n  occupancyRate: number;\r\n  adr: number;\r\n  revpar: number;\r\n}\r\n\r\nexport default function DashboardPage() {\r\n  const { user } = useAuthStore();\r\n  const [stats, setStats] = useState<DashboardStats | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [refreshing, setRefreshing] = useState(false);\r\n\r\n  const fetchStats = useCallback(async (showRefreshing = false) => {\r\n    if (!user?.tenantId) return;\r\n\r\n    try {\r\n      if (showRefreshing) {\r\n        setRefreshing(true);\r\n      } else {\r\n        setLoading(true);\r\n      }\r\n      setError(null);\r\n\r\n      const today = new Date().toISOString().split('T')[0];\r\n      const [reservationsRes, roomsRes, revenueRes, occupancyRes] = await Promise.all([\r\n        api.get(`/tenants/${user.tenantId}/reservations`, {\r\n          params: { startDate: today, endDate: today },\r\n        }),\r\n        api.get(`/tenants/${user.tenantId}/rooms`),\r\n        api.get(`/tenants/${user.tenantId}/reports/revenue`, {\r\n          params: { startDate: today, endDate: today },\r\n        }),\r\n        api.get(`/tenants/${user.tenantId}/reports/occupancy`, {\r\n          params: { startDate: today, endDate: today },\r\n        }),\r\n      ]);\r\n\r\n      const reservations = reservationsRes.data.data || [];\r\n      const rooms = roomsRes.data.data || [];\r\n      const revenue = revenueRes.data.data || {};\r\n      const occupancy = occupancyRes.data.data || {};\r\n\r\n      setStats({\r\n        todayReservations: reservations.length,\r\n        checkedIn: reservations.filter((r: any) => r.status === 'checked_in').length,\r\n        availableRooms: rooms.filter((r: any) => r.status === 'available').length,\r\n        todayRevenue: revenue.totalRevenue || 0,\r\n        occupancyRate: occupancy.occupancyRate || 0,\r\n        adr: occupancy.adr || 0,\r\n        revpar: occupancy.revpar || 0,\r\n      });\r\n      toast.success('Dashboard updated');\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch stats:', error);\r\n      const errorMessage = error.response?.data?.error?.message || 'Failed to load dashboard data';\r\n      setError(errorMessage);\r\n      toast.error(errorMessage);\r\n    } finally {\r\n      setLoading(false);\r\n      setRefreshing(false);\r\n    }\r\n  }, [user?.tenantId]);\r\n\r\n  useEffect(() => {\r\n    fetchStats();\r\n  }, [fetchStats]);\r\n\r\n  const StatCard = memo(({ icon: Icon, title, value, subtitle, color }: any) => (\r\n    <div\r\n      style={{\r\n        background: 'white',\r\n        padding: '1.5rem',\r\n        borderRadius: '8px',\r\n        boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n        border: `1px solid ${color}20`,\r\n        borderLeft: `4px solid ${color}`,\r\n        transition: 'transform 0.2s, box-shadow 0.2s',\r\n      }}\r\n      onMouseEnter={(e) => {\r\n        e.currentTarget.style.transform = 'translateY(-2px)';\r\n        e.currentTarget.style.boxShadow = '0 4px 6px rgba(0,0,0,0.1)';\r\n      }}\r\n      onMouseLeave={(e) => {\r\n        e.currentTarget.style.transform = 'translateY(0)';\r\n        e.currentTarget.style.boxShadow = '0 1px 3px rgba(0,0,0,0.1)';\r\n      }}\r\n    >\r\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\r\n        <div>\r\n          <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.5rem' }}>\r\n            {title}\r\n          </div>\r\n          <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#1e293b' }}>\r\n            {value}\r\n          </div>\r\n          {subtitle && (\r\n            <div style={{ color: '#94a3b8', fontSize: '0.75rem', marginTop: '0.25rem' }}>\r\n              {subtitle}\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div\r\n          style={{\r\n            width: '48px',\r\n            height: '48px',\r\n            borderRadius: '8px',\r\n            background: `${color}20`,\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            color,\r\n          }}\r\n        >\r\n          <Icon size={24} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  ));\r\n\r\n  const statCards = useMemo(() => {\r\n    if (!stats) return null;\r\n    return [\r\n      {\r\n        icon: Calendar,\r\n        title: \"Today's Reservations\",\r\n        value: stats.todayReservations,\r\n        subtitle: `${stats.checkedIn} checked in`,\r\n        color: '#3b82f6',\r\n      },\r\n      {\r\n        icon: Bed,\r\n        title: 'Available Rooms',\r\n        value: stats.availableRooms,\r\n        color: '#10b981',\r\n      },\r\n      {\r\n        icon: DollarSign,\r\n        title: \"Today's Revenue\",\r\n        value: `${stats.todayRevenue.toLocaleString()}`,\r\n        color: '#f59e0b',\r\n      },\r\n      {\r\n        icon: AlertTriangle,\r\n        title: 'Occupancy Rate',\r\n        value: `${stats.occupancyRate.toFixed(1)}%`,\r\n        subtitle: `ADR: ${stats.adr.toLocaleString()}`,\r\n        color: '#8b5cf6',\r\n      },\r\n    ];\r\n  }, [stats]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <Layout>\r\n        <div>\r\n          <h1 style={{ marginBottom: '1.5rem', color: '#1e293b' }}>Dashboard</h1>\r\n          <DashboardSkeleton />\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  if (error && !stats) {\r\n    return (\r\n      <Layout>\r\n        <div>\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n            <h1 style={{ color: '#1e293b' }}>Dashboard</h1>\r\n            <button\r\n              onClick={() => fetchStats()}\r\n              style={{\r\n                padding: '0.5rem 1rem',\r\n                background: '#3b82f6',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '6px',\r\n                cursor: 'pointer',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: '0.5rem',\r\n              }}\r\n            >\r\n              <RefreshCw size={16} />\r\n              Retry\r\n            </button>\r\n          </div>\r\n          <div style={{\r\n            background: 'white',\r\n            padding: '2rem',\r\n            borderRadius: '8px',\r\n            textAlign: 'center',\r\n            color: '#64748b',\r\n          }}>\r\n            <AlertCircle size={48} style={{ margin: '0 auto 1rem', color: '#ef4444' }} />\r\n            <p style={{ marginBottom: '1rem' }}>{error}</p>\r\n            <button\r\n              onClick={() => fetchStats()}\r\n              style={{\r\n                padding: '0.75rem 1.5rem',\r\n                background: '#3b82f6',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '6px',\r\n                cursor: 'pointer',\r\n              }}\r\n            >\r\n              Try Again\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Layout>\r\n      <div>\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <h1 style={{ color: '#1e293b' }}>Dashboard</h1>\r\n          <button\r\n            onClick={() => fetchStats(true)}\r\n            disabled={refreshing}\r\n            style={{\r\n              padding: '0.5rem 1rem',\r\n              background: refreshing ? '#94a3b8' : '#3b82f6',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '6px',\r\n              cursor: refreshing ? 'not-allowed' : 'pointer',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.5rem',\r\n              transition: 'all 0.2s',\r\n            }}\r\n            onMouseEnter={(e) => {\r\n              if (!refreshing) {\r\n                e.currentTarget.style.background = '#2563eb';\r\n              }\r\n            }}\r\n            onMouseLeave={(e) => {\r\n              if (!refreshing) {\r\n                e.currentTarget.style.background = '#3b82f6';\r\n              }\r\n            }}\r\n          >\r\n            <RefreshCw size={16} style={{ animation: refreshing ? 'spin 1s linear infinite' : 'none' }} />\r\n            Refresh\r\n          </button>\r\n        </div>\r\n\r\n        {statCards && (\r\n          <div\r\n            style={{\r\n              display: 'grid',\r\n              gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',\r\n              gap: '1.5rem',\r\n              marginBottom: '2rem',\r\n            }}\r\n          >\r\n            {statCards.map((card, idx) => (\r\n              <StatCard key={idx} {...card} />\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '1.5rem' }}>\r\n          <div\r\n            style={{\r\n              background: 'white',\r\n              padding: '1.5rem',\r\n              borderRadius: '8px',\r\n              boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n            }}\r\n          >\r\n            <h3 style={{ marginBottom: '1rem', color: '#1e293b' }}>Key Metrics</h3>\r\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>\r\n              <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n                <span style={{ color: '#64748b' }}>Average Daily Rate (ADR)</span>\r\n                <span style={{ fontWeight: 'bold' }}>{(stats?.adr || 0).toLocaleString()}</span>\r\n              </div>\r\n              <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n                <span style={{ color: '#64748b' }}>RevPAR</span>\r\n                <span style={{ fontWeight: 'bold' }}>{(stats?.revpar || 0).toLocaleString()}</span>\r\n              </div>\r\n              <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n                <span style={{ color: '#64748b' }}>Occupancy Rate</span>\r\n                <span style={{ fontWeight: 'bold' }}>{(stats?.occupancyRate || 0).toFixed(1)}%</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div\r\n            style={{\r\n              background: 'white',\r\n              padding: '1.5rem',\r\n              borderRadius: '8px',\r\n              boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n            }}\r\n          >\r\n            <h3 style={{ marginBottom: '1rem', color: '#1e293b' }}>Quick Actions</h3>\r\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>\r\n              <Link\r\n                to=\"/reservations\"\r\n                style={{\r\n                  padding: '0.75rem',\r\n                  background: '#f1f5f9',\r\n                  borderRadius: '4px',\r\n                  textDecoration: 'none',\r\n                  color: '#1e293b',\r\n                  textAlign: 'center',\r\n                  transition: 'all 0.2s',\r\n                }}\r\n                onMouseEnter={(e) => {\r\n                  e.currentTarget.style.background = '#e2e8f0';\r\n                  e.currentTarget.style.transform = 'translateY(-1px)';\r\n                }}\r\n                onMouseLeave={(e) => {\r\n                  e.currentTarget.style.background = '#f1f5f9';\r\n                  e.currentTarget.style.transform = 'translateY(0)';\r\n                }}\r\n              >\r\n                Create New Reservation\r\n              </Link>\r\n              <Link\r\n                to=\"/rooms\"\r\n                style={{\r\n                  padding: '0.75rem',\r\n                  background: '#f1f5f9',\r\n                  borderRadius: '4px',\r\n                  textDecoration: 'none',\r\n                  color: '#1e293b',\r\n                  textAlign: 'center',\r\n                  transition: 'all 0.2s',\r\n                }}\r\n                onMouseEnter={(e) => {\r\n                  e.currentTarget.style.background = '#e2e8f0';\r\n                  e.currentTarget.style.transform = 'translateY(-1px)';\r\n                }}\r\n                onMouseLeave={(e) => {\r\n                  e.currentTarget.style.background = '#f1f5f9';\r\n                  e.currentTarget.style.transform = 'translateY(0)';\r\n                }}\r\n              >\r\n                Manage Rooms\r\n              </Link>\r\n              <Link\r\n                to=\"/reports\"\r\n                style={{\r\n                  padding: '0.75rem',\r\n                  background: '#f1f5f9',\r\n                  borderRadius: '4px',\r\n                  textDecoration: 'none',\r\n                  color: '#1e293b',\r\n                  textAlign: 'center',\r\n                  transition: 'all 0.2s',\r\n                }}\r\n                onMouseEnter={(e) => {\r\n                  e.currentTarget.style.background = '#e2e8f0';\r\n                  e.currentTarget.style.transform = 'translateY(-1px)';\r\n                }}\r\n                onMouseLeave={(e) => {\r\n                  e.currentTarget.style.background = '#f1f5f9';\r\n                  e.currentTarget.style.transform = 'translateY(0)';\r\n                }}\r\n              >\r\n                View Reports\r\n              </Link>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Layout>\r\n  );\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\DepositManagementPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadPolicies'. Either include it or remove the dependency array.","line":69,"column":6,"nodeType":"ArrayExpression","endLine":69,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [loadPolicies, user.tenantId]","fix":{"range":[2022,2038],"text":"[loadPolicies, user.tenantId]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Button from '../components/Button';\r\nimport DepositPolicyModal from '../components/DepositPolicyModal';\r\nimport { Plus, Edit, Trash2, DollarSign, Calculator, Settings } from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\n\r\ninterface DepositPolicy {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  depositType: 'percentage' | 'fixed_amount' | 'nights' | 'custom';\r\n  depositValue: number;\r\n  maxDepositAmount?: number;\r\n  minDepositAmount?: number;\r\n  appliesToAllRooms: boolean;\r\n  roomCategoryIds: string[];\r\n  ratePlanIds: string[];\r\n  isActive: boolean;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\ninterface DepositCalculation {\r\n  depositAmount: number;\r\n  depositRequired: boolean;\r\n  policy: {\r\n    id: string;\r\n    name: string;\r\n    depositType: string;\r\n    depositValue: number;\r\n  };\r\n  calculation: {\r\n    type: string;\r\n    nights: number;\r\n    rate: number;\r\n    rawAmount: number;\r\n    adjustments: {\r\n      minLimit?: number;\r\n      maxLimit?: number;\r\n    };\r\n  };\r\n}\r\n\r\nexport default function DepositManagementPage() {\r\n  const { user } = useAuthStore();\r\n  const [activeTab, setActiveTab] = useState<'policies' | 'calculator' | 'payments'>('policies');\r\n  const [policies, setPolicies] = useState<DepositPolicy[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showPolicyModal, setShowPolicyModal] = useState(false);\r\n  const [editingPolicy, setEditingPolicy] = useState<DepositPolicy | null>(null);\r\n\r\n  // Calculator state\r\n  const [calculatorData, setCalculatorData] = useState({\r\n    roomId: '',\r\n    checkInDate: '',\r\n    checkOutDate: '',\r\n    rate: '',\r\n    roomType: '',\r\n    categoryId: '',\r\n    ratePlanId: ''\r\n  });\r\n  const [calculation, setCalculation] = useState<DepositCalculation | null>(null);\r\n  const [calculating, setCalculating] = useState(false);\r\n\r\n  useEffect(() => {\r\n    loadPolicies();\r\n  }, [user?.tenantId]);\r\n\r\n  const loadPolicies = async () => {\r\n    if (!user?.tenantId) return;\r\n\r\n    try {\r\n      const response = await api.get(`/tenants/${user.tenantId}/deposit-policies`);\r\n      setPolicies(response.data.data);\r\n    } catch (error) {\r\n      console.error('Error loading deposit policies:', error);\r\n      toast.error('Failed to load deposit policies');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleCalculateDeposit = async () => {\r\n    if (!user?.tenantId) return;\r\n\r\n    const { roomId, checkInDate, checkOutDate, rate, roomType, categoryId, ratePlanId } = calculatorData;\r\n\r\n    if (!roomId || !checkInDate || !checkOutDate || !rate) {\r\n      toast.error('Please fill in all required fields');\r\n      return;\r\n    }\r\n\r\n    setCalculating(true);\r\n    try {\r\n      const response = await api.post(`/tenants/${user.tenantId}/deposits/calculate`, {\r\n        roomId,\r\n        checkInDate,\r\n        checkOutDate,\r\n        rate: parseFloat(rate),\r\n        roomType,\r\n        categoryId,\r\n        ratePlanId\r\n      });\r\n\r\n      setCalculation(response.data.data);\r\n    } catch (error) {\r\n      console.error('Error calculating deposit:', error);\r\n      toast.error('Failed to calculate deposit');\r\n    } finally {\r\n      setCalculating(false);\r\n    }\r\n  };\r\n\r\n  const handleDeletePolicy = async (policyId: string) => {\r\n    if (!user?.tenantId) return;\r\n\r\n    if (!confirm('Are you sure you want to delete this deposit policy?')) return;\r\n\r\n    try {\r\n      await api.delete(`/tenants/${user.tenantId}/deposit-policies/${policyId}`);\r\n      toast.success('Deposit policy deleted successfully');\r\n      loadPolicies();\r\n    } catch (error) {\r\n      console.error('Error deleting policy:', error);\r\n      toast.error('Failed to delete deposit policy');\r\n    }\r\n  };\r\n\r\n  const tabs = [\r\n    { id: 'policies', label: 'Policies', icon: Settings },\r\n    { id: 'calculator', label: 'Calculator', icon: Calculator },\r\n    { id: 'payments', label: 'Payments', icon: DollarSign }\r\n  ];\r\n\r\n  return (\r\n    <div style={{ padding: '2rem', maxWidth: '1200px', margin: '0 auto' }}>\r\n      <div style={{ marginBottom: '2rem' }}>\r\n        <h1 style={{ fontSize: '2rem', fontWeight: 'bold', marginBottom: '0.5rem' }}>\r\n          Deposit Management\r\n        </h1>\r\n        <p style={{ color: '#64748b' }}>\r\n          Manage deposit policies, calculate deposits, and track payments\r\n        </p>\r\n      </div>\r\n\r\n      {/* Tab Navigation */}\r\n      <div style={{\r\n        display: 'flex',\r\n        borderBottom: '1px solid #e2e8f0',\r\n        marginBottom: '2rem'\r\n      }}>\r\n        {tabs.map((tab) => (\r\n          <button\r\n            key={tab.id}\r\n            onClick={() => setActiveTab(tab.id as any)}\r\n            style={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.5rem',\r\n              padding: '1rem 1.5rem',\r\n              border: 'none',\r\n              background: 'none',\r\n              borderBottom: activeTab === tab.id ? '2px solid #3b82f6' : '2px solid transparent',\r\n              color: activeTab === tab.id ? '#3b82f6' : '#64748b',\r\n              fontWeight: activeTab === tab.id ? '600' : '500',\r\n              cursor: 'pointer',\r\n              transition: 'all 0.2s'\r\n            }}\r\n          >\r\n            <tab.icon size={18} />\r\n            {tab.label}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Policies Tab */}\r\n      {activeTab === 'policies' && (\r\n        <div>\r\n          <div style={{\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            marginBottom: '1.5rem'\r\n          }}>\r\n            <h2 style={{ fontSize: '1.5rem', fontWeight: '600' }}>Deposit Policies</h2>\r\n            <Button\r\n              onClick={() => {\r\n                setEditingPolicy(null);\r\n                setShowPolicyModal(true);\r\n              }}\r\n              style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}\r\n            >\r\n              <Plus size={18} />\r\n              New Policy\r\n            </Button>\r\n          </div>\r\n\r\n          {loading ? (\r\n            <div style={{ textAlign: 'center', padding: '2rem' }}>\r\n              Loading policies...\r\n            </div>\r\n          ) : policies.length === 0 ? (\r\n            <div style={{\r\n              textAlign: 'center',\r\n              padding: '3rem',\r\n              border: '2px dashed #e2e8f0',\r\n              borderRadius: '8px'\r\n            }}>\r\n              <Settings size={48} style={{ color: '#cbd5e1', marginBottom: '1rem' }} />\r\n              <h3 style={{ fontSize: '1.25rem', fontWeight: '600', marginBottom: '0.5rem' }}>\r\n                No Deposit Policies\r\n              </h3>\r\n              <p style={{ color: '#64748b', marginBottom: '1.5rem' }}>\r\n                Create your first deposit policy to start managing deposits\r\n              </p>\r\n              <Button onClick={() => setShowPolicyModal(true)}>\r\n                <Plus size={18} style={{ marginRight: '0.5rem' }} />\r\n                Create Policy\r\n              </Button>\r\n            </div>\r\n          ) : (\r\n            <div style={{\r\n              display: 'grid',\r\n              gap: '1rem',\r\n              gridTemplateColumns: 'repeat(auto-fill, minmax(350px, 1fr))'\r\n            }}>\r\n              {policies.map((policy) => (\r\n                <div\r\n                  key={policy.id}\r\n                  style={{\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '8px',\r\n                    padding: '1.5rem',\r\n                    background: 'white'\r\n                  }}\r\n                >\r\n                  <div style={{\r\n                    display: 'flex',\r\n                    justifyContent: 'space-between',\r\n                    alignItems: 'flex-start',\r\n                    marginBottom: '1rem'\r\n                  }}>\r\n                    <div>\r\n                      <h3 style={{ fontWeight: '600', marginBottom: '0.25rem' }}>\r\n                        {policy.name}\r\n                      </h3>\r\n                      <p style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                        {policy.description}\r\n                      </p>\r\n                    </div>\r\n                    <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => {\r\n                          setEditingPolicy(policy);\r\n                          setShowPolicyModal(true);\r\n                        }}\r\n                        title=\"Edit policy\"\r\n                      >\r\n                        <Edit size={16} />\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => handleDeletePolicy(policy.id)}\r\n                        style={{ color: '#ef4444' }}\r\n                      >\r\n                        <Trash2 size={16} />\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div style={{\r\n                    display: 'grid',\r\n                    gridTemplateColumns: '1fr 1fr',\r\n                    gap: '1rem',\r\n                    fontSize: '0.875rem'\r\n                  }}>\r\n                    <div>\r\n                      <span style={{ color: '#64748b' }}>Type:</span>\r\n                      <span style={{ marginLeft: '0.5rem', fontWeight: '500' }}>\r\n                        {policy.depositType.replace('_', ' ').toUpperCase()}\r\n                      </span>\r\n                    </div>\r\n                    <div>\r\n                      <span style={{ color: '#64748b' }}>Value:</span>\r\n                      <span style={{ marginLeft: '0.5rem', fontWeight: '500' }}>\r\n                        {policy.depositType === 'percentage' ? `${policy.depositValue}%` : `${policy.depositValue}`}\r\n                      </span>\r\n                    </div>\r\n                    <div>\r\n                      <span style={{ color: '#64748b' }}>Status:</span>\r\n                      <span style={{\r\n                        marginLeft: '0.5rem',\r\n                        padding: '0.125rem 0.5rem',\r\n                        borderRadius: '9999px',\r\n                        fontSize: '0.75rem',\r\n                        fontWeight: '500',\r\n                        background: policy.isActive ? '#dcfce7' : '#fee2e2',\r\n                        color: policy.isActive ? '#166534' : '#991b1b'\r\n                      }}>\r\n                        {policy.isActive ? 'Active' : 'Inactive'}\r\n                      </span>\r\n                    </div>\r\n                    <div>\r\n                      <span style={{ color: '#64748b' }}>Rooms:</span>\r\n                      <span style={{ marginLeft: '0.5rem', fontWeight: '500' }}>\r\n                        {policy.appliesToAllRooms ? 'All' : `${policy.roomCategoryIds.length} categories`}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Calculator Tab */}\r\n      {activeTab === 'calculator' && (\r\n        <div>\r\n          <h2 style={{ fontSize: '1.5rem', fontWeight: '600', marginBottom: '1.5rem' }}>\r\n            Deposit Calculator\r\n          </h2>\r\n\r\n          <div style={{\r\n            display: 'grid',\r\n            gridTemplateColumns: '1fr 1fr',\r\n            gap: '2rem'\r\n          }}>\r\n            {/* Calculator Form */}\r\n            <div style={{\r\n              border: '1px solid #e2e8f0',\r\n              borderRadius: '8px',\r\n              padding: '2rem',\r\n              background: 'white'\r\n            }}>\r\n              <h3 style={{ fontSize: '1.25rem', fontWeight: '600', marginBottom: '1.5rem' }}>\r\n                Calculate Deposit\r\n              </h3>\r\n\r\n              <div style={{ display: 'grid', gap: '1rem' }}>\r\n                <div>\r\n                  <label style={{\r\n                    display: 'block',\r\n                    fontSize: '0.875rem',\r\n                    fontWeight: '500',\r\n                    marginBottom: '0.5rem',\r\n                    color: '#374151'\r\n                  }}>\r\n                    Room ID *\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={calculatorData.roomId}\r\n                    onChange={(e) => setCalculatorData(prev => ({ ...prev, roomId: e.target.value }))}\r\n                    placeholder=\"Enter room ID\"\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #d1d5db',\r\n                      borderRadius: '6px',\r\n                      fontSize: '1rem'\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>\r\n                  <div>\r\n                    <label style={{\r\n                      display: 'block',\r\n                      fontSize: '0.875rem',\r\n                      fontWeight: '500',\r\n                      marginBottom: '0.5rem',\r\n                      color: '#374151'\r\n                    }}>\r\n                      Check-in Date *\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={calculatorData.checkInDate}\r\n                      onChange={(e) => setCalculatorData(prev => ({ ...prev, checkInDate: e.target.value }))}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #d1d5db',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem'\r\n                      }}\r\n                    />\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label style={{\r\n                      display: 'block',\r\n                      fontSize: '0.875rem',\r\n                      fontWeight: '500',\r\n                      marginBottom: '0.5rem',\r\n                      color: '#374151'\r\n                    }}>\r\n                      Check-out Date *\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={calculatorData.checkOutDate}\r\n                      onChange={(e) => setCalculatorData(prev => ({ ...prev, checkOutDate: e.target.value }))}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #d1d5db',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem'\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>\r\n                  <div>\r\n                    <label style={{\r\n                      display: 'block',\r\n                      fontSize: '0.875rem',\r\n                      fontWeight: '500',\r\n                      marginBottom: '0.5rem',\r\n                      color: '#374151'\r\n                    }}>\r\n                      Room Rate () *\r\n                    </label>\r\n                    <input\r\n                      type=\"number\"\r\n                      value={calculatorData.rate}\r\n                      onChange={(e) => setCalculatorData(prev => ({ ...prev, rate: e.target.value }))}\r\n                      placeholder=\"25000\"\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #d1d5db',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem'\r\n                      }}\r\n                    />\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label style={{\r\n                      display: 'block',\r\n                      fontSize: '0.875rem',\r\n                      fontWeight: '500',\r\n                      marginBottom: '0.5rem',\r\n                      color: '#374151'\r\n                    }}>\r\n                      Room Type\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={calculatorData.roomType}\r\n                      onChange={(e) => setCalculatorData(prev => ({ ...prev, roomType: e.target.value }))}\r\n                      placeholder=\"deluxe\"\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #d1d5db',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem'\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <Button\r\n                  onClick={handleCalculateDeposit}\r\n                  loading={calculating}\r\n                  style={{ width: '100%', marginTop: '1rem' }}\r\n                >\r\n                  <Calculator size={18} style={{ marginRight: '0.5rem' }} />\r\n                  Calculate Deposit\r\n                </Button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Calculation Result */}\r\n            <div style={{\r\n              border: '1px solid #e2e8f0',\r\n              borderRadius: '8px',\r\n              padding: '2rem',\r\n              background: 'white'\r\n            }}>\r\n              <h3 style={{ fontSize: '1.25rem', fontWeight: '600', marginBottom: '1.5rem' }}>\r\n                Calculation Result\r\n              </h3>\r\n\r\n              {calculation ? (\r\n                <div style={{ display: 'grid', gap: '1.5rem' }}>\r\n                  <div style={{\r\n                    padding: '1.5rem',\r\n                    background: '#f0f9ff',\r\n                    borderRadius: '8px',\r\n                    border: '1px solid #bae6fd'\r\n                  }}>\r\n                    <div style={{\r\n                      fontSize: '2rem',\r\n                      fontWeight: 'bold',\r\n                      color: '#0369a1',\r\n                      marginBottom: '0.5rem'\r\n                    }}>\r\n                      {calculation.depositAmount.toLocaleString()}\r\n                    </div>\r\n                    <div style={{ color: '#0369a1', fontSize: '0.875rem' }}>\r\n                      Required Deposit Amount\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div style={{ display: 'grid', gap: '1rem' }}>\r\n                    <div style={{\r\n                      display: 'flex',\r\n                      justifyContent: 'space-between',\r\n                      padding: '0.75rem',\r\n                      background: '#f8fafc',\r\n                      borderRadius: '6px'\r\n                    }}>\r\n                      <span style={{ color: '#64748b' }}>Policy Applied:</span>\r\n                      <span style={{ fontWeight: '500' }}>{calculation.policy.name}</span>\r\n                    </div>\r\n\r\n                    <div style={{\r\n                      display: 'flex',\r\n                      justifyContent: 'space-between',\r\n                      padding: '0.75rem',\r\n                      background: '#f8fafc',\r\n                      borderRadius: '6px'\r\n                    }}>\r\n                      <span style={{ color: '#64748b' }}>Calculation Type:</span>\r\n                      <span style={{ fontWeight: '500' }}>{calculation.calculation.type.replace('_', ' ').toUpperCase()}</span>\r\n                    </div>\r\n\r\n                    <div style={{\r\n                      display: 'flex',\r\n                      justifyContent: 'space-between',\r\n                      padding: '0.75rem',\r\n                      background: '#f8fafc',\r\n                      borderRadius: '6px'\r\n                    }}>\r\n                      <span style={{ color: '#64748b' }}>Nights:</span>\r\n                      <span style={{ fontWeight: '500' }}>{calculation.calculation.nights}</span>\r\n                    </div>\r\n\r\n                    <div style={{\r\n                      display: 'flex',\r\n                      justifyContent: 'space-between',\r\n                      padding: '0.75rem',\r\n                      background: '#f8fafc',\r\n                      borderRadius: '6px'\r\n                    }}>\r\n                      <span style={{ color: '#64748b' }}>Deposit Required:</span>\r\n                      <span style={{\r\n                        fontWeight: '500',\r\n                        color: calculation.depositRequired ? '#166534' : '#991b1b'\r\n                      }}>\r\n                        {calculation.depositRequired ? 'Yes' : 'No'}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ) : (\r\n                <div style={{\r\n                  textAlign: 'center',\r\n                  padding: '3rem',\r\n                  color: '#64748b'\r\n                }}>\r\n                  <Calculator size={48} style={{ marginBottom: '1rem', opacity: 0.5 }} />\r\n                  <p>Enter reservation details and click calculate to see the deposit amount</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Payments Tab */}\r\n      {activeTab === 'payments' && (\r\n        <div>\r\n          <h2 style={{ fontSize: '1.5rem', fontWeight: '600', marginBottom: '1.5rem' }}>\r\n            Deposit Payments\r\n          </h2>\r\n\r\n          <div style={{\r\n            textAlign: 'center',\r\n            padding: '3rem',\r\n            border: '2px dashed #e2e8f0',\r\n            borderRadius: '8px'\r\n          }}>\r\n            <DollarSign size={48} style={{ color: '#cbd5e1', marginBottom: '1rem' }} />\r\n            <h3 style={{ fontSize: '1.25rem', fontWeight: '600', marginBottom: '0.5rem' }}>\r\n              Payment Tracking\r\n            </h3>\r\n            <p style={{ color: '#64748b' }}>\r\n              Deposit payment tracking will be implemented here\r\n            </p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Policy Modal */}\r\n      <DepositPolicyModal\r\n        isOpen={showPolicyModal}\r\n        onClose={() => {\r\n          setShowPolicyModal(false);\r\n          setEditingPolicy(null);\r\n        }}\r\n        policy={editingPolicy}\r\n        onSuccess={() => {\r\n          loadPolicies();\r\n          setShowPolicyModal(false);\r\n          setEditingPolicy(null);\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\FoliosPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'pagination.page'. Either include it or remove the dependency array.","line":73,"column":6,"nodeType":"ArrayExpression","endLine":73,"endColumn":49,"suggestions":[{"desc":"Update the dependencies array to be: [pagination.page, pagination.limit, user.tenantId, filters.status, filters.startDate, filters.endDate]","fix":{"range":[2448,2491],"text":"[pagination.page, pagination.limit, user.tenantId, filters.status, filters.startDate, filters.endDate]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useCallback, useMemo } from 'react';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Layout from '../components/Layout';\r\nimport { X, Filter, Printer, Receipt } from 'lucide-react';\r\nimport { format, subDays } from 'date-fns';\r\nimport toast from 'react-hot-toast';\r\nimport { TableSkeleton } from '../components/LoadingSkeleton';\r\nimport SearchInput from '../components/SearchInput';\r\nimport Pagination from '../components/Pagination';\r\nimport { printFolio } from '../utils/print';\r\nimport { useDebounce } from '../hooks/useDebounce';\r\nimport EmptyState from '../components/EmptyState';\r\n\r\ninterface Folio {\r\n  id: string;\r\n  guestName: string;\r\n  status: string;\r\n  totalCharges: number;\r\n  totalPayments: number;\r\n  balance: number;\r\n  room: {\r\n    roomNumber: string;\r\n  };\r\n  charges: any[];\r\n  payments: any[];\r\n}\r\n\r\nexport default function FoliosPage() {\r\n  const { user } = useAuthStore();\r\n  const [folios, setFolios] = useState<Folio[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [selectedFolio, setSelectedFolio] = useState<Folio | null>(null);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const debouncedSearchTerm = useDebounce(searchTerm, 500);\r\n  const [showFilters, setShowFilters] = useState(false);\r\n  const [filters, setFilters] = useState({\r\n    status: '',\r\n    startDate: '',\r\n    endDate: '',\r\n  });\r\n  const [pagination, setPagination] = useState({\r\n    page: 1,\r\n    limit: 20,\r\n    total: 0,\r\n    totalPages: 0,\r\n  });\r\n\r\n  const fetchFolios = useCallback(async (page = pagination.page) => {\r\n    if (!user?.tenantId) return;\r\n    setLoading(true);\r\n    try {\r\n      const params: any = {\r\n        page,\r\n        limit: pagination.limit,\r\n      };\r\n      if (filters.status) params.status = filters.status;\r\n      if (filters.startDate) params.startDate = filters.startDate;\r\n      if (filters.endDate) params.endDate = filters.endDate;\r\n\r\n      const response = await api.get(`/tenants/${user.tenantId}/folios`, { params });\r\n      setFolios(response.data.data || []);\r\n      if (response.data.pagination) {\r\n        setPagination(response.data.pagination);\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch folios:', error);\r\n      toast.error(error.response?.data?.error?.message || 'Failed to fetch folios');\r\n      setFolios([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [user?.tenantId, filters, pagination.limit]);\r\n\r\n  useEffect(() => {\r\n    fetchFolios(pagination.page);\r\n  }, [fetchFolios, pagination.page]);\r\n\r\n  const handleViewDetails = async (folioId: string) => {\r\n    try {\r\n      const response = await api.get(`/tenants/${user?.tenantId}/folios/${folioId}`);\r\n      setSelectedFolio(response.data.data);\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch folio details:', error);\r\n      toast.error(error.response?.data?.error?.message || 'Failed to fetch folio details');\r\n    }\r\n  };\r\n\r\n  const handleRefreshFolio = async () => {\r\n    if (selectedFolio) {\r\n      await handleViewDetails(selectedFolio.id);\r\n    }\r\n  };\r\n\r\n  const filteredFolios = useMemo(() => folios.filter((folio) => {\r\n    if (!debouncedSearchTerm) return true;\r\n    const searchLower = debouncedSearchTerm.toLowerCase();\r\n    return (\r\n      folio.guestName.toLowerCase().includes(searchLower) ||\r\n      folio.room?.roomNumber.toLowerCase().includes(searchLower) ||\r\n      folio.status.toLowerCase().includes(searchLower)\r\n    );\r\n  }), [folios, debouncedSearchTerm]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <Layout>\r\n        <div>\r\n          <h1 style={{ marginBottom: '1.5rem', color: '#1e293b' }}>Folios</h1>\r\n          <TableSkeleton rows={8} columns={7} />\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Layout>\r\n      <div>\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <div>\r\n            <h1 style={{ margin: 0, color: '#1e293b' }}>Folios</h1>\r\n            {pagination.total > 0 && (\r\n              <p style={{ margin: '0.25rem 0 0 0', color: '#64748b', fontSize: '0.875rem' }}>\r\n                {pagination.total} total folio{pagination.total !== 1 ? 's' : ''}\r\n              </p>\r\n            )}\r\n          </div>\r\n          <button\r\n            onClick={() => setShowFilters(!showFilters)}\r\n            style={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.5rem',\r\n              padding: '0.75rem 1.5rem',\r\n              background: showFilters ? '#3b82f6' : '#f1f5f9',\r\n              color: showFilters ? 'white' : '#475569',\r\n              border: 'none',\r\n              borderRadius: '6px',\r\n              cursor: 'pointer',\r\n              fontWeight: '500',\r\n            }}\r\n          >\r\n            <Filter size={20} />\r\n            Filters\r\n          </button>\r\n        </div>\r\n\r\n        {showFilters && (\r\n          <div\r\n            style={{\r\n              background: 'white',\r\n              padding: '1.5rem',\r\n              borderRadius: '8px',\r\n              marginBottom: '1.5rem',\r\n              boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n            }}\r\n          >\r\n            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>\r\n              <h3 style={{ color: '#1e293b', fontSize: '1rem', fontWeight: '600' }}>Filter Folios</h3>\r\n              <button\r\n                onClick={() => {\r\n                  setFilters({ status: '', startDate: '', endDate: '' });\r\n                  setPagination({ ...pagination, page: 1 });\r\n                }}\r\n                style={{\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  gap: '0.5rem',\r\n                  padding: '0.5rem 1rem',\r\n                  background: '#f1f5f9',\r\n                  color: '#475569',\r\n                  border: 'none',\r\n                  borderRadius: '4px',\r\n                  cursor: 'pointer',\r\n                  fontSize: '0.875rem',\r\n                }}\r\n              >\r\n                <X size={16} />\r\n                Clear All\r\n              </button>\r\n            </div>\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem' }}>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n                  Status\r\n                </label>\r\n                <select\r\n                  value={filters.status}\r\n                  onChange={(e) => {\r\n                    setFilters({ ...filters, status: e.target.value });\r\n                    setPagination({ ...pagination, page: 1 });\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.5rem',\r\n                    border: '1px solid #cbd5e1',\r\n                    borderRadius: '4px',\r\n                    fontSize: '0.875rem',\r\n                  }}\r\n                >\r\n                  <option value=\"\">All Statuses</option>\r\n                  <option value=\"open\">Open</option>\r\n                  <option value=\"closed\">Closed</option>\r\n                  <option value=\"voided\">Voided</option>\r\n                </select>\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n                  Date From\r\n                </label>\r\n                <input\r\n                  type=\"date\"\r\n                  value={filters.startDate}\r\n                  onChange={(e) => {\r\n                    setFilters({ ...filters, startDate: e.target.value });\r\n                    setPagination({ ...pagination, page: 1 });\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.5rem',\r\n                    border: '1px solid #cbd5e1',\r\n                    borderRadius: '4px',\r\n                    fontSize: '0.875rem',\r\n                  }}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n                  Date To\r\n                </label>\r\n                <input\r\n                  type=\"date\"\r\n                  value={filters.endDate}\r\n                  onChange={(e) => {\r\n                    setFilters({ ...filters, endDate: e.target.value });\r\n                    setPagination({ ...pagination, page: 1 });\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.5rem',\r\n                    border: '1px solid #cbd5e1',\r\n                    borderRadius: '4px',\r\n                    fontSize: '0.875rem',\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div style={{ marginTop: '1rem', display: 'flex', gap: '0.5rem' }}>\r\n              <button\r\n                onClick={() => {\r\n                  setFilters({\r\n                    status: '',\r\n                    startDate: format(subDays(new Date(), 7), 'yyyy-MM-dd'),\r\n                    endDate: format(new Date(), 'yyyy-MM-dd'),\r\n                  });\r\n                  setPagination({ ...pagination, page: 1 });\r\n                }}\r\n                style={{\r\n                  padding: '0.5rem 1rem',\r\n                  background: '#f1f5f9',\r\n                  color: '#475569',\r\n                  border: 'none',\r\n                  borderRadius: '4px',\r\n                  cursor: 'pointer',\r\n                  fontSize: '0.875rem',\r\n                }}\r\n              >\r\n                Last 7 Days\r\n              </button>\r\n              <button\r\n                onClick={() => {\r\n                  setFilters({\r\n                    status: '',\r\n                    startDate: format(subDays(new Date(), 30), 'yyyy-MM-dd'),\r\n                    endDate: format(new Date(), 'yyyy-MM-dd'),\r\n                  });\r\n                  setPagination({ ...pagination, page: 1 });\r\n                }}\r\n                style={{\r\n                  padding: '0.5rem 1rem',\r\n                  background: '#f1f5f9',\r\n                  color: '#475569',\r\n                  border: 'none',\r\n                  borderRadius: '4px',\r\n                  cursor: 'pointer',\r\n                  fontSize: '0.875rem',\r\n                }}\r\n              >\r\n                Last 30 Days\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div style={{ marginBottom: '1.5rem', display: 'flex', gap: '1rem', alignItems: 'center' }}>\r\n          <div style={{ flex: 1 }}>\r\n            <SearchInput\r\n              value={searchTerm}\r\n              onChange={setSearchTerm}\r\n              placeholder=\"Search by guest name, room number, or status...\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div\r\n          style={{\r\n            background: 'white',\r\n            borderRadius: '8px',\r\n            boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n            overflow: 'hidden',\r\n          }}\r\n        >\r\n          <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n            <thead>\r\n              <tr style={{ background: '#f8fafc', borderBottom: '1px solid #e2e8f0' }}>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Guest</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Room</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Charges</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Payments</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Balance</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Status</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {filteredFolios.length === 0 && !loading ? (\r\n                <tr>\r\n                  <td colSpan={7} style={{ padding: '3rem', textAlign: 'center' }}>\r\n                    <EmptyState\r\n                      icon={Receipt}\r\n                      title={searchTerm || filters.status || filters.startDate || filters.endDate \r\n                        ? 'No folios match your filters' \r\n                        : 'No folios yet'}\r\n                      description={searchTerm || filters.status || filters.startDate || filters.endDate\r\n                        ? 'Try adjusting your search or filter criteria'\r\n                        : 'Folios will appear here when guests make reservations'}\r\n                    />\r\n                  </td>\r\n                </tr>\r\n              ) : filteredFolios.length > 0 ? (\r\n                filteredFolios.map((folio) => (\r\n                  <tr key={folio.id} style={{ borderBottom: '1px solid #e2e8f0' }}>\r\n                    <td style={{ padding: '1rem', color: '#1e293b' }}>{folio.guestName}</td>\r\n                    <td style={{ padding: '1rem', color: '#1e293b' }}>{folio.room?.roomNumber}</td>\r\n                    <td style={{ padding: '1rem', color: '#1e293b', fontWeight: '500' }}>\r\n                      {Number(folio.totalCharges).toLocaleString()}\r\n                    </td>\r\n                    <td style={{ padding: '1rem', color: '#10b981', fontWeight: '500' }}>\r\n                      {Number(folio.totalPayments).toLocaleString()}\r\n                    </td>\r\n                    <td\r\n                      style={{\r\n                        padding: '1rem',\r\n                        color: Number(folio.balance) > 0 ? '#ef4444' : '#10b981',\r\n                        fontWeight: '500',\r\n                      }}\r\n                    >\r\n                      {Number(folio.balance).toLocaleString()}\r\n                    </td>\r\n                    <td style={{ padding: '1rem' }}>\r\n                      <span\r\n                        style={{\r\n                          padding: '0.25rem 0.75rem',\r\n                          borderRadius: '12px',\r\n                          fontSize: '0.75rem',\r\n                          fontWeight: '500',\r\n                          background:\r\n                            folio.status === 'open'\r\n                              ? '#dbeafe'\r\n                              : folio.status === 'closed'\r\n                              ? '#d1fae5'\r\n                              : '#fee2e2',\r\n                          color:\r\n                            folio.status === 'open'\r\n                              ? '#1e40af'\r\n                              : folio.status === 'closed'\r\n                              ? '#065f46'\r\n                              : '#991b1b',\r\n                        }}\r\n                      >\r\n                        {folio.status.toUpperCase()}\r\n                      </span>\r\n                    </td>\r\n                    <td style={{ padding: '1rem' }}>\r\n                      <button\r\n                        onClick={() => handleViewDetails(folio.id)}\r\n                        style={{\r\n                          padding: '0.5rem 1rem',\r\n                          background: '#3b82f6',\r\n                          color: 'white',\r\n                          border: 'none',\r\n                          borderRadius: '4px',\r\n                          cursor: 'pointer',\r\n                          fontSize: '0.875rem',\r\n                        }}\r\n                      >\r\n                        View Details\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n              ) : null}\r\n            </tbody>\r\n          </table>\r\n          {pagination.totalPages > 1 && (\r\n            <Pagination\r\n              page={pagination.page}\r\n              totalPages={pagination.totalPages}\r\n              total={pagination.total}\r\n              limit={pagination.limit}\r\n              onPageChange={(newPage) => {\r\n                setPagination({ ...pagination, page: newPage });\r\n                fetchFolios(newPage);\r\n              }}\r\n            />\r\n          )}\r\n        </div>\r\n\r\n        {selectedFolio && (\r\n          <FolioDetailsModal \r\n            folio={selectedFolio} \r\n            onClose={() => setSelectedFolio(null)}\r\n            onRefresh={handleRefreshFolio}\r\n          />\r\n        )}\r\n      </div>\r\n    </Layout>\r\n  );\r\n}\r\n\r\nfunction FolioDetailsModal({ \r\n  folio, \r\n  onClose, \r\n  onRefresh \r\n}: { \r\n  folio: Folio; \r\n  onClose: () => void;\r\n  onRefresh: () => void;\r\n}) {\r\n  const [showAddCharge, setShowAddCharge] = useState(false);\r\n  const [showAddPayment, setShowAddPayment] = useState(false);\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0,0,0,0.5)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 1000,\r\n        padding: '1rem',\r\n      }}\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        style={{\r\n          background: 'white',\r\n          borderRadius: '8px',\r\n          padding: '2rem',\r\n          width: '100%',\r\n          maxWidth: '800px',\r\n          maxHeight: '90vh',\r\n          overflow: 'auto',\r\n        }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <h2 style={{ color: '#1e293b' }}>Folio Details</h2>\r\n          <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>\r\n            <button\r\n              onClick={() => printFolio(folio)}\r\n              style={{\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: '0.5rem',\r\n                padding: '0.5rem 1rem',\r\n                background: '#64748b',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '6px',\r\n                cursor: 'pointer',\r\n                fontSize: '0.875rem',\r\n              }}\r\n            >\r\n              <Printer size={18} />\r\n              Print\r\n            </button>\r\n            <button\r\n              onClick={onClose}\r\n              style={{\r\n                background: 'none',\r\n                border: 'none',\r\n                fontSize: '1.5rem',\r\n              cursor: 'pointer',\r\n              color: '#94a3b8',\r\n            }}\r\n          >\r\n            \r\n          </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ marginBottom: '2rem' }}>\r\n          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem', marginBottom: '1rem' }}>\r\n            <div>\r\n              <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Guest</div>\r\n              <div style={{ fontWeight: '500', color: '#1e293b' }}>{folio.guestName}</div>\r\n            </div>\r\n            <div>\r\n              <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Room</div>\r\n              <div style={{ fontWeight: '500', color: '#1e293b' }}>{folio.room?.roomNumber}</div>\r\n            </div>\r\n          </div>\r\n\r\n          <div\r\n            style={{\r\n              display: 'grid',\r\n              gridTemplateColumns: 'repeat(3, 1fr)',\r\n              gap: '1rem',\r\n              padding: '1rem',\r\n              background: '#f8fafc',\r\n              borderRadius: '6px',\r\n            }}\r\n          >\r\n            <div>\r\n              <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.25rem' }}>Total Charges</div>\r\n              <div style={{ fontSize: '1.25rem', fontWeight: 'bold', color: '#1e293b' }}>\r\n                {Number(folio.totalCharges).toLocaleString()}\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.25rem' }}>Total Payments</div>\r\n              <div style={{ fontSize: '1.25rem', fontWeight: 'bold', color: '#10b981' }}>\r\n                {Number(folio.totalPayments).toLocaleString()}\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.25rem' }}>Balance</div>\r\n              <div\r\n                style={{\r\n                  fontSize: '1.25rem',\r\n                  fontWeight: 'bold',\r\n                  color: Number(folio.balance) > 0 ? '#ef4444' : '#10b981',\r\n                }}\r\n              >\r\n                {Number(folio.balance).toLocaleString()}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1.5rem' }}>\r\n          <button\r\n            onClick={() => setShowAddCharge(true)}\r\n            style={{\r\n              padding: '0.75rem 1.5rem',\r\n              background: '#3b82f6',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '6px',\r\n              cursor: 'pointer',\r\n            }}\r\n          >\r\n            Add Charge\r\n          </button>\r\n          <button\r\n            onClick={() => setShowAddPayment(true)}\r\n            style={{\r\n              padding: '0.75rem 1.5rem',\r\n              background: '#10b981',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '6px',\r\n              cursor: 'pointer',\r\n            }}\r\n          >\r\n            Add Payment\r\n          </button>\r\n        </div>\r\n\r\n        <div style={{ marginBottom: '2rem' }}>\r\n          <h3 style={{ marginBottom: '1rem', color: '#1e293b' }}>Charges</h3>\r\n          <div style={{ background: '#f8fafc', borderRadius: '6px', padding: '1rem' }}>\r\n            {folio.charges?.length === 0 ? (\r\n              <div style={{ color: '#94a3b8', textAlign: 'center', padding: '1rem' }}>No charges</div>\r\n            ) : (\r\n              <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n                <thead>\r\n                  <tr>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', color: '#64748b', fontSize: '0.875rem' }}>\r\n                      Description\r\n                    </th>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', color: '#64748b', fontSize: '0.875rem' }}>\r\n                      Category\r\n                    </th>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'right', color: '#64748b', fontSize: '0.875rem' }}>\r\n                      Amount\r\n                    </th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {folio.charges?.map((charge: any) => (\r\n                    <tr key={charge.id}>\r\n                      <td style={{ padding: '0.5rem', color: '#1e293b' }}>{charge.description}</td>\r\n                      <td style={{ padding: '0.5rem', color: '#64748b' }}>{charge.category}</td>\r\n                      <td style={{ padding: '0.5rem', textAlign: 'right', fontWeight: '500', color: '#1e293b' }}>\r\n                        {Number(charge.total).toLocaleString()}\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <h3 style={{ marginBottom: '1rem', color: '#1e293b' }}>Payments</h3>\r\n          <div style={{ background: '#f8fafc', borderRadius: '6px', padding: '1rem' }}>\r\n            {folio.payments?.length === 0 ? (\r\n              <div style={{ color: '#94a3b8', textAlign: 'center', padding: '1rem' }}>No payments</div>\r\n            ) : (\r\n              <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n                <thead>\r\n                  <tr>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', color: '#64748b', fontSize: '0.875rem' }}>\r\n                      Date\r\n                    </th>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', color: '#64748b', fontSize: '0.875rem' }}>\r\n                      Method\r\n                    </th>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'right', color: '#64748b', fontSize: '0.875rem' }}>\r\n                      Amount\r\n                    </th>\r\n                    <th style={{ padding: '0.5rem', textAlign: 'left', color: '#64748b', fontSize: '0.875rem' }}>\r\n                      Status\r\n                    </th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {folio.payments?.map((payment: any) => (\r\n                    <tr key={payment.id}>\r\n                      <td style={{ padding: '0.5rem', color: '#1e293b' }}>\r\n                        {format(new Date(payment.createdAt), 'MMM dd, yyyy HH:mm')}\r\n                      </td>\r\n                      <td style={{ padding: '0.5rem', color: '#64748b' }}>{payment.method}</td>\r\n                      <td style={{ padding: '0.5rem', textAlign: 'right', fontWeight: '500', color: '#10b981' }}>\r\n                        {Number(payment.amount).toLocaleString()}\r\n                      </td>\r\n                      <td style={{ padding: '0.5rem' }}>\r\n                        <span\r\n                          style={{\r\n                            padding: '0.25rem 0.5rem',\r\n                            borderRadius: '4px',\r\n                            fontSize: '0.75rem',\r\n                            background: payment.status === 'completed' ? '#d1fae5' : '#fee2e2',\r\n                            color: payment.status === 'completed' ? '#065f46' : '#991b1b',\r\n                          }}\r\n                        >\r\n                          {payment.status}\r\n                        </span>\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {showAddCharge && (\r\n          <AddChargeModal\r\n            folioId={folio.id}\r\n            onClose={() => setShowAddCharge(false)}\r\n            onSuccess={() => {\r\n              setShowAddCharge(false);\r\n              onRefresh();\r\n            }}\r\n          />\r\n        )}\r\n\r\n        {showAddPayment && (\r\n          <AddPaymentModal\r\n            folioId={folio.id}\r\n            onClose={() => setShowAddPayment(false)}\r\n            onSuccess={() => {\r\n              setShowAddPayment(false);\r\n              onRefresh();\r\n            }}\r\n          />\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction AddChargeModal({\r\n  folioId,\r\n  onClose,\r\n  onSuccess,\r\n}: {\r\n  folioId: string;\r\n  onClose: () => void;\r\n  onSuccess: () => void;\r\n}) {\r\n  const { user } = useAuthStore();\r\n  const [formData, setFormData] = useState({\r\n    description: '',\r\n    category: 'other' as 'room_rate' | 'extra' | 'tax' | 'discount' | 'other',\r\n    amount: '',\r\n    quantity: '1',\r\n    taxRate: '',\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    try {\r\n      await api.post(`/tenants/${user?.tenantId}/folios/${folioId}/charges`, {\r\n        description: formData.description,\r\n        category: formData.category,\r\n        amount: parseFloat(formData.amount),\r\n        quantity: parseInt(formData.quantity),\r\n        taxRate: formData.taxRate ? parseFloat(formData.taxRate) : undefined,\r\n      });\r\n      toast.success('Charge added successfully');\r\n      onSuccess();\r\n    } catch (error: any) {\r\n      // Error is handled by API interceptor\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0,0,0,0.5)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 2000,\r\n        padding: '1rem',\r\n      }}\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        style={{\r\n          background: 'white',\r\n          borderRadius: '8px',\r\n          padding: '2rem',\r\n          width: '100%',\r\n          maxWidth: '500px',\r\n        }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <h2 style={{ color: '#1e293b' }}>Add Charge</h2>\r\n          <button\r\n            onClick={onClose}\r\n            style={{\r\n              background: 'none',\r\n              border: 'none',\r\n              fontSize: '1.5rem',\r\n              cursor: 'pointer',\r\n              color: '#94a3b8',\r\n            }}\r\n          >\r\n            <X size={24} />\r\n          </button>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit}>\r\n          <div style={{ display: 'grid', gap: '1rem' }}>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Description *\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={formData.description}\r\n                onChange={(e) => setFormData({ ...formData, description: e.target.value })}\r\n                required\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                }}\r\n                placeholder=\"e.g., Room service, Mini bar, etc.\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Category *\r\n              </label>\r\n              <select\r\n                value={formData.category}\r\n                onChange={(e) => setFormData({ ...formData, category: e.target.value as any })}\r\n                required\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                }}\r\n              >\r\n                <option value=\"room_rate\">Room Rate</option>\r\n                <option value=\"extra\">Extra</option>\r\n                <option value=\"tax\">Tax</option>\r\n                <option value=\"discount\">Discount</option>\r\n                <option value=\"other\">Other</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr', gap: '1rem' }}>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                  Amount () *\r\n                </label>\r\n                <input\r\n                  type=\"number\"\r\n                  step=\"0.01\"\r\n                  min=\"0\"\r\n                  value={formData.amount}\r\n                  onChange={(e) => setFormData({ ...formData, amount: e.target.value })}\r\n                  required\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #cbd5e1',\r\n                    borderRadius: '6px',\r\n                  }}\r\n                  placeholder=\"0.00\"\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                  Quantity *\r\n                </label>\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"1\"\r\n                  value={formData.quantity}\r\n                  onChange={(e) => setFormData({ ...formData, quantity: e.target.value })}\r\n                  required\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #cbd5e1',\r\n                    borderRadius: '6px',\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Tax Rate (%)\r\n              </label>\r\n              <input\r\n                type=\"number\"\r\n                step=\"0.01\"\r\n                min=\"0\"\r\n                max=\"100\"\r\n                value={formData.taxRate}\r\n                onChange={(e) => setFormData({ ...formData, taxRate: e.target.value })}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                }}\r\n                placeholder=\"Optional\"\r\n              />\r\n            </div>\r\n\r\n            <div style={{ display: 'flex', gap: '1rem', marginTop: '1rem' }}>\r\n              <button\r\n                type=\"button\"\r\n                onClick={onClose}\r\n                style={{\r\n                  flex: 1,\r\n                  padding: '0.75rem',\r\n                  background: '#f1f5f9',\r\n                  color: '#475569',\r\n                  border: 'none',\r\n                  borderRadius: '6px',\r\n                  cursor: 'pointer',\r\n                  fontWeight: '500',\r\n                }}\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                type=\"submit\"\r\n                disabled={loading}\r\n                style={{\r\n                  flex: 1,\r\n                  padding: '0.75rem',\r\n                  background: loading ? '#94a3b8' : '#3b82f6',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  borderRadius: '6px',\r\n                  cursor: loading ? 'not-allowed' : 'pointer',\r\n                  fontWeight: '500',\r\n                }}\r\n              >\r\n                {loading ? 'Adding...' : 'Add Charge'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction AddPaymentModal({\r\n  folioId,\r\n  onClose,\r\n  onSuccess,\r\n}: {\r\n  folioId: string;\r\n  onClose: () => void;\r\n  onSuccess: () => void;\r\n}) {\r\n  const { user } = useAuthStore();\r\n  const [formData, setFormData] = useState({\r\n    amount: '',\r\n    method: 'cash' as 'card' | 'bank_transfer' | 'cash' | 'other',\r\n    reference: '',\r\n    paymentGateway: 'manual' as 'paystack' | 'flutterwave' | 'stripe' | 'manual',\r\n    gatewayTransactionId: '',\r\n    notes: '',\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    try {\r\n      await api.post(`/tenants/${user?.tenantId}/payments`, {\r\n        folioId,\r\n        amount: parseFloat(formData.amount),\r\n        method: formData.method,\r\n        reference: formData.reference || undefined,\r\n        paymentGateway: formData.paymentGateway !== 'manual' ? formData.paymentGateway : undefined,\r\n        gatewayTransactionId: formData.gatewayTransactionId || undefined,\r\n        notes: formData.notes || undefined,\r\n      });\r\n      toast.success('Payment added successfully');\r\n      onSuccess();\r\n    } catch (error: any) {\r\n      // Error is handled by API interceptor\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0,0,0,0.5)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 2000,\r\n        padding: '1rem',\r\n      }}\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        style={{\r\n          background: 'white',\r\n          borderRadius: '8px',\r\n          padding: '2rem',\r\n          width: '100%',\r\n          maxWidth: '500px',\r\n        }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <h2 style={{ color: '#1e293b' }}>Add Payment</h2>\r\n          <button\r\n            onClick={onClose}\r\n            style={{\r\n              background: 'none',\r\n              border: 'none',\r\n              fontSize: '1.5rem',\r\n              cursor: 'pointer',\r\n              color: '#94a3b8',\r\n            }}\r\n          >\r\n            <X size={24} />\r\n          </button>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit}>\r\n          <div style={{ display: 'grid', gap: '1rem' }}>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Amount () *\r\n              </label>\r\n              <input\r\n                type=\"number\"\r\n                step=\"0.01\"\r\n                min=\"0.01\"\r\n                value={formData.amount}\r\n                onChange={(e) => setFormData({ ...formData, amount: e.target.value })}\r\n                required\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                }}\r\n                placeholder=\"0.00\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Payment Method *\r\n              </label>\r\n              <select\r\n                value={formData.method}\r\n                onChange={(e) => setFormData({ ...formData, method: e.target.value as any })}\r\n                required\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                }}\r\n              >\r\n                <option value=\"cash\">Cash</option>\r\n                <option value=\"card\">Card</option>\r\n                <option value=\"bank_transfer\">Bank Transfer</option>\r\n                <option value=\"other\">Other</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Payment Gateway\r\n              </label>\r\n              <select\r\n                value={formData.paymentGateway}\r\n                onChange={(e) => setFormData({ ...formData, paymentGateway: e.target.value as any })}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                }}\r\n              >\r\n                <option value=\"manual\">Manual Entry</option>\r\n                <option value=\"paystack\">Paystack</option>\r\n                <option value=\"flutterwave\">Flutterwave</option>\r\n                <option value=\"stripe\">Stripe</option>\r\n              </select>\r\n            </div>\r\n\r\n            {formData.paymentGateway !== 'manual' && (\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                  Gateway Transaction ID\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={formData.gatewayTransactionId}\r\n                  onChange={(e) => setFormData({ ...formData, gatewayTransactionId: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #cbd5e1',\r\n                    borderRadius: '6px',\r\n                  }}\r\n                  placeholder=\"Transaction ID from gateway\"\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Reference Number\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={formData.reference}\r\n                onChange={(e) => setFormData({ ...formData, reference: e.target.value })}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                }}\r\n                placeholder=\"Optional reference number\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Notes\r\n              </label>\r\n              <textarea\r\n                value={formData.notes}\r\n                onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\r\n                rows={3}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                  resize: 'vertical',\r\n                }}\r\n                placeholder=\"Optional notes\"\r\n              />\r\n            </div>\r\n\r\n            <div style={{ display: 'flex', gap: '1rem', marginTop: '1rem' }}>\r\n              <button\r\n                type=\"button\"\r\n                onClick={onClose}\r\n                style={{\r\n                  flex: 1,\r\n                  padding: '0.75rem',\r\n                  background: '#f1f5f9',\r\n                  color: '#475569',\r\n                  border: 'none',\r\n                  borderRadius: '6px',\r\n                  cursor: 'pointer',\r\n                  fontWeight: '500',\r\n                }}\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                type=\"submit\"\r\n                disabled={loading}\r\n                style={{\r\n                  flex: 1,\r\n                  padding: '0.75rem',\r\n                  background: loading ? '#94a3b8' : '#10b981',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  borderRadius: '6px',\r\n                  cursor: loading ? 'not-allowed' : 'pointer',\r\n                  fontWeight: '500',\r\n                }}\r\n              >\r\n                {loading ? 'Adding...' : 'Add Payment'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\GroupBookingsEnhancedPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadBookings' and 'loadStats'. Either include them or remove the dependency array.","line":192,"column":6,"nodeType":"ArrayExpression","endLine":192,"endColumn":36,"suggestions":[{"desc":"Update the dependencies array to be: [user.tenantId, statusFilter, loadBookings, loadStats]","fix":{"range":[5454,5484],"text":"[user.tenantId, statusFilter, loadBookings, loadStats]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadMeetingHalls' and 'loadRoomMeta'. Either include them or remove the dependency array.","line":199,"column":6,"nodeType":"ArrayExpression","endLine":199,"endColumn":39,"suggestions":[{"desc":"Update the dependencies array to be: [loadMeetingHalls, loadRoomMeta, showCreateModal, user.tenantId]","fix":{"range":[5601,5634],"text":"[loadMeetingHalls, loadRoomMeta, showCreateModal, user.tenantId]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useMemo } from 'react';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Button from '../components/Button';\r\nimport {\r\n  Plus,\r\n  Search,\r\n  Users,\r\n  Calendar,\r\n  DollarSign,\r\n  Building,\r\n  User,\r\n  Bed,\r\n  Mail,\r\n  Phone\r\n} from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\n\r\ninterface GroupBooking {\r\n  id: string;\r\n  groupBookingNumber: string;\r\n  groupName: string;\r\n  groupType: string;\r\n  contactPerson: string;\r\n  contactEmail: string;\r\n  contactPhone: string;\r\n  expectedGuests: number;\r\n  confirmedGuests: number;\r\n  checkInDate: string;\r\n  checkOutDate: string;\r\n  totalRooms: number;\r\n  totalRevenue: number;\r\n  depositAmount?: number;\r\n  depositPaid: boolean;\r\n  status: string;\r\n  bookingProgress: string;\r\n  specialRequests?: string;\r\n  dietaryRequirements?: string;\r\n  setupRequirements?: string;\r\n  assignedTo?: string;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n  roomBlocks?: RoomBlock[];\r\n  hallReservations?: HallReservation[];\r\n  reservations?: any[];\r\n}\r\n\r\ninterface RoomBlockValidationErrors {\r\n  roomCategoryId?: string;\r\n  roomType?: string;\r\n  totalRooms?: string;\r\n}\r\n\r\ninterface HallReservationValidationErrors {\r\n  hallId?: string;\r\n  startDateTime?: string;\r\n  endDateTime?: string;\r\n}\r\n\r\nconst generateTempId = () =>\r\n  (typeof crypto !== 'undefined' && typeof crypto.randomUUID === 'function')\r\n    ? crypto.randomUUID()\r\n    : Math.random().toString(36).slice(2, 10);\r\n\r\ninterface RoomBlock {\r\n  id: string;\r\n  roomCategoryId: string;\r\n  roomType: string;\r\n  totalRooms: number;\r\n  allocatedRooms: number;\r\n  availableRooms: number;\r\n  negotiatedRate?: number;\r\n  discountPercent?: number;\r\n  checkInDate: string;\r\n  checkOutDate: string;\r\n}\r\n\r\ninterface HallReservation {\r\n  id?: string;\r\n  hallId: string;\r\n  eventName?: string;\r\n  purpose?: string;\r\n  setupType?: string;\r\n  attendeeCount?: number;\r\n  startDateTime: string;\r\n  endDateTime: string;\r\n  cateringNotes?: string;\r\n  avRequirements?: string;\r\n  hall?: {\r\n    id: string;\r\n    name: string;\r\n    capacity: number;\r\n    location?: string;\r\n  } | null;\r\n}\r\n\r\ninterface MeetingHall {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  capacity: number;\r\n  location?: string;\r\n  amenities?: Record<string, unknown>;\r\n}\r\n\r\ninterface BookingStats {\r\n  totalBookings: number;\r\n  confirmedBookings: number;\r\n  pendingBookings: number;\r\n  totalRevenue: number;\r\n  totalRooms: number;\r\n  upcomingBookings: number;\r\n}\r\n\r\nexport default function GroupBookingsEnhancedPage() {\r\n  const { user } = useAuthStore();\r\n  const [bookings, setBookings] = useState<GroupBooking[]>([]);\r\n  const [stats, setStats] = useState<BookingStats | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [statusFilter, setStatusFilter] = useState<string>('all');\r\n  const [selectedBooking, setSelectedBooking] = useState<GroupBooking | null>(null);\r\n  const [showDetailsModal, setShowDetailsModal] = useState(false);\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [meetingHalls, setMeetingHalls] = useState<MeetingHall[]>([]);\r\n  const [roomCategories, setRoomCategories] = useState<Array<{ id: string; name: string }>>([]);\r\n  const [roomInventory, setRoomInventory] = useState<Array<{ id: string; roomNumber?: string; roomType?: string; categoryId?: string }>>([]);\r\n  const [roomTypes, setRoomTypes] = useState<string[]>([]);\r\n  const [loadingHalls, setLoadingHalls] = useState(false);\r\n  const [loadingRoomMeta, setLoadingRoomMeta] = useState(false);\r\n  const [saving, setSaving] = useState(false);\r\n  const [showValidationErrors, setShowValidationErrors] = useState(false);\r\n  const [formData, setFormData] = useState<{\r\n    groupName: string;\r\n    groupType: string;\r\n    contactPerson: string;\r\n    contactEmail: string;\r\n    contactPhone: string;\r\n    expectedGuests: string;\r\n    checkInDate: string;\r\n    checkOutDate: string;\r\n    depositAmount: string;\r\n    specialRequests: string;\r\n    dietaryRequirements: string;\r\n    setupRequirements: string;\r\n    roomBlocks: RoomBlock[];\r\n    hallReservations: HallReservation[];\r\n  }>({\r\n    groupName: '',\r\n    groupType: 'corporate',\r\n    contactPerson: '',\r\n    contactEmail: '',\r\n    contactPhone: '',\r\n    expectedGuests: '',\r\n    checkInDate: '',\r\n    checkOutDate: '',\r\n    depositAmount: '',\r\n    specialRequests: '',\r\n    dietaryRequirements: '',\r\n    setupRequirements: '',\r\n    roomBlocks: [{\r\n      id: generateTempId(),\r\n      roomCategoryId: '',\r\n      roomType: '',\r\n      totalRooms: 5,\r\n      allocatedRooms: 0,\r\n      availableRooms: 5,\r\n      negotiatedRate: undefined,\r\n      discountPercent: undefined,\r\n      checkInDate: '',\r\n      checkOutDate: '',\r\n    }],\r\n    hallReservations: [],\r\n  });\r\n\r\n  const getCategoryName = (categoryId: string) => {\r\n    if (!categoryId) return 'Unassigned';\r\n    return roomCategories.find((category) => category.id === categoryId)?.name ?? 'Unassigned';\r\n  };\r\n\r\n  const getInventoryCount = (categoryId: string, roomType: string) => {\r\n    return roomInventory.filter((room) => {\r\n      const matchesCategory = categoryId ? room.categoryId === categoryId : true;\r\n      const matchesRoomType = roomType ? room.roomType === roomType : true;\r\n      return matchesCategory && matchesRoomType;\r\n    }).length;\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadBookings();\r\n    loadStats();\r\n  }, [user?.tenantId, statusFilter]);\r\n\r\n  useEffect(() => {\r\n    if (showCreateModal) {\r\n      loadMeetingHalls();\r\n      loadRoomMeta();\r\n    }\r\n  }, [showCreateModal, user?.tenantId]);\r\n\r\n  const loadBookings = async () => {\r\n    if (!user?.tenantId) return;\r\n\r\n    try {\r\n      const params = new URLSearchParams();\r\n      if (statusFilter !== 'all') params.append('status', statusFilter);\r\n\r\n      const response = await api.get(`/tenants/${user.tenantId}/group-bookings?${params}`);\r\n      setBookings(response.data.data);\r\n    } catch (error) {\r\n      console.error('Error loading group bookings:', error);\r\n      toast.error('Failed to load group bookings');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadRoomMeta = async () => {\r\n    if (!user?.tenantId) return;\r\n    setLoadingRoomMeta(true);\r\n    try {\r\n      const [categoriesResponse, roomsResponse] = await Promise.all([\r\n        api.get(`/tenants/${user.tenantId}/room-categories`),\r\n        api.get(`/tenants/${user.tenantId}/rooms`),\r\n      ]);\r\n\r\n      const categories = categoriesResponse.data?.data ?? [];\r\n      const rooms = roomsResponse.data?.data ?? [];\r\n      setRoomCategories(\r\n        categories.map((category: any) => ({\r\n          id: category.id,\r\n          name: category.name,\r\n        })),\r\n      );\r\n      setRoomInventory(\r\n        rooms.map((room: any) => ({\r\n          id: room.id,\r\n          roomNumber: room.roomNumber,\r\n          roomType: room.roomType,\r\n          categoryId: room.category?.id ?? room.categoryId ?? null,\r\n        })),\r\n      );\r\n      const types = Array.from(\r\n        new Set(\r\n          rooms\r\n            .map((room: any) => room.roomType)\r\n            .filter((value: string | undefined) => Boolean(value)),\r\n        ),\r\n      ) as string[];\r\n      setRoomTypes(types);\r\n    } catch (error) {\r\n      console.error('Error loading room metadata:', error);\r\n      toast.error('Failed to load room categories/rooms');\r\n    } finally {\r\n      setLoadingRoomMeta(false);\r\n    }\r\n  };\r\n\r\n  const loadStats = async () => {\r\n    if (!user?.tenantId) return;\r\n\r\n    try {\r\n      const response = await api.get(`/tenants/${user.tenantId}/group-bookings/stats/overview`);\r\n      setStats(response.data.data);\r\n    } catch (error) {\r\n      console.error('Error loading booking stats:', error);\r\n    }\r\n  };\r\n\r\n  const loadMeetingHalls = async () => {\r\n    if (!user?.tenantId) return;\r\n    setLoadingHalls(true);\r\n    try {\r\n      const response = await api.get(`/tenants/${user.tenantId}/group-bookings/meeting-halls`);\r\n      setMeetingHalls(response.data.data);\r\n    } catch (error) {\r\n      console.error('Error loading meeting halls:', error);\r\n      toast.error('Failed to load meeting halls');\r\n    } finally {\r\n      setLoadingHalls(false);\r\n    }\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFormData({\r\n      groupName: '',\r\n      groupType: 'corporate',\r\n      contactPerson: '',\r\n      contactEmail: '',\r\n      contactPhone: '',\r\n      expectedGuests: '',\r\n      checkInDate: '',\r\n      checkOutDate: '',\r\n      depositAmount: '',\r\n      specialRequests: '',\r\n      dietaryRequirements: '',\r\n      setupRequirements: '',\r\n      roomBlocks: [{\r\n        id: generateTempId(),\r\n        roomCategoryId: '',\r\n        roomType: '',\r\n        totalRooms: 5,\r\n        allocatedRooms: 0,\r\n        availableRooms: 5,\r\n        negotiatedRate: undefined,\r\n        discountPercent: undefined,\r\n        checkInDate: '',\r\n        checkOutDate: '',\r\n      }],\r\n      hallReservations: [],\r\n    });\r\n    setShowValidationErrors(false);\r\n  };\r\n\r\n  const validationErrors = useMemo(() => {\r\n    const trim = (value: string) => value.trim();\r\n    const fields: Record<string, string | undefined> = {\r\n      groupName: trim(formData.groupName) ? undefined : 'Group name is required',\r\n      contactPerson: trim(formData.contactPerson) ? undefined : 'Contact person is required',\r\n      contactEmail: trim(formData.contactEmail) ? undefined : 'Contact email is required',\r\n      contactPhone: trim(formData.contactPhone) ? undefined : 'Contact phone is required',\r\n      checkInDate: formData.checkInDate ? undefined : 'Check-in date is required',\r\n      checkOutDate: formData.checkOutDate ? undefined : 'Check-out date is required',\r\n      roomBlocks: formData.roomBlocks.length === 0 ? 'At least one room block is required' : undefined,\r\n    };\r\n\r\n    if (formData.checkInDate && formData.checkOutDate) {\r\n      const checkIn = new Date(formData.checkInDate);\r\n      const checkOut = new Date(formData.checkOutDate);\r\n      if (checkOut <= checkIn) {\r\n        fields.checkOutDate = 'Check-out must be after check-in';\r\n      }\r\n    }\r\n\r\n    const roomBlocks = formData.roomBlocks.map<RoomBlockValidationErrors>((block) => {\r\n      const errors: RoomBlockValidationErrors = {};\r\n      if (!block.roomCategoryId.trim()) errors.roomCategoryId = 'Room category is required';\r\n      if (!block.roomType.trim()) errors.roomType = 'Room type is required';\r\n      if (!block.totalRooms || block.totalRooms <= 0) errors.totalRooms = 'Total rooms must be greater than 0';\r\n      return errors;\r\n    });\r\n\r\n    const hallReservations = formData.hallReservations.map<HallReservationValidationErrors>((reservation) => {\r\n      const errors: HallReservationValidationErrors = {};\r\n      if (!reservation.hallId) errors.hallId = 'Select a hall';\r\n      if (!reservation.startDateTime) errors.startDateTime = 'Start date & time is required';\r\n      if (!reservation.endDateTime) errors.endDateTime = 'End date & time is required';\r\n      if (\r\n        reservation.startDateTime &&\r\n        reservation.endDateTime &&\r\n        new Date(reservation.endDateTime) <= new Date(reservation.startDateTime)\r\n      ) {\r\n        errors.endDateTime = 'End must be after start';\r\n      }\r\n      return errors;\r\n    });\r\n\r\n    const hasErrors =\r\n      Object.values(fields).some(Boolean) ||\r\n      roomBlocks.some((block) => Object.keys(block).length > 0) ||\r\n      hallReservations.some((reservation) => Object.keys(reservation).length > 0);\r\n\r\n    return { fields, roomBlocks, hallReservations, hasErrors };\r\n  }, [formData]);\r\n\r\n  const shouldShowErrors = showValidationErrors;\r\n  const getFieldError = (field: string) =>\r\n    shouldShowErrors ? validationErrors.fields[field] : undefined;\r\n  const errorTextStyle = {\r\n    color: '#dc2626',\r\n    fontSize: '0.75rem',\r\n    marginTop: '0.25rem'\r\n  };\r\n  const inputBorderStyle = (field?: string) => ({\r\n    marginTop: '0.35rem',\r\n    padding: '0.6rem',\r\n    borderRadius: '8px',\r\n    border: field && getFieldError(field) ? '1px solid #f87171' : '1px solid #cbd5f5',\r\n    background: field && getFieldError(field) ? '#fef2f2' : '#fff'\r\n  });\r\n  const createDisabled = saving || validationErrors.hasErrors;\r\n  const roomBlockInputStyle = (index: number, field: keyof RoomBlockValidationErrors) => {\r\n    const error = shouldShowErrors ? validationErrors.roomBlocks[index]?.[field] : undefined;\r\n    return {\r\n      padding: '0.6rem',\r\n      borderRadius: '8px',\r\n      border: error ? '1px solid #f87171' : '1px solid #cbd5f5',\r\n      background: error ? '#fef2f2' : '#fff'\r\n    };\r\n  };\r\n  const hallReservationInputStyle = (index: number, field: keyof HallReservationValidationErrors) => {\r\n    const error = shouldShowErrors ? validationErrors.hallReservations[index]?.[field] : undefined;\r\n    return {\r\n      padding: '0.6rem 0.75rem',\r\n      borderRadius: '10px',\r\n      border: error ? '1px solid #fb7185' : '1px solid #cbd5f5',\r\n      fontSize: '1rem',\r\n      color: '#0f172a',\r\n      background: error ? '#fff1f2' : '#fff',\r\n      outline: 'none',\r\n      caretColor: '#0f172a',\r\n      '::placeholder': {\r\n        color: '#94a3b8',\r\n      },\r\n    };\r\n  };\r\n\r\n  const handleAddRoomBlock = () => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      roomBlocks: [\r\n        ...prev.roomBlocks,\r\n        {\r\n          id: generateTempId(),\r\n          roomCategoryId: '',\r\n          roomType: '',\r\n          totalRooms: 5,\r\n          allocatedRooms: 0,\r\n          availableRooms: 5,\r\n          negotiatedRate: undefined,\r\n          discountPercent: undefined,\r\n          checkInDate: '',\r\n          checkOutDate: '',\r\n        },\r\n      ],\r\n    }));\r\n  };\r\n\r\n  const handleUpdateRoomBlock = (index: number, field: keyof RoomBlock, value: string) => {\r\n    setFormData(prev => {\r\n      const updated = [...prev.roomBlocks];\r\n      const target = { ...updated[index] };\r\n      if (field === 'totalRooms') {\r\n        const num = Number(value) || 0;\r\n        target.totalRooms = num;\r\n        target.availableRooms = num - (target.allocatedRooms || 0);\r\n      } else if (field === 'negotiatedRate' || field === 'discountPercent') {\r\n        (target as any)[field] = value === '' ? undefined : Number(value);\r\n      } else {\r\n        (target as any)[field] = value;\r\n      }\r\n      updated[index] = target;\r\n      return { ...prev, roomBlocks: updated };\r\n    });\r\n  };\r\n\r\n  const handleRemoveRoomBlock = (index: number) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      roomBlocks: prev.roomBlocks.filter((_, i) => i !== index),\r\n    }));\r\n  };\r\n\r\n  const handleAddHallReservation = () => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      hallReservations: [\r\n        ...prev.hallReservations,\r\n        {\r\n          id: generateTempId(),\r\n          hallId: meetingHalls[0]?.id || '',\r\n          eventName: '',\r\n          purpose: '',\r\n          setupType: '',\r\n          attendeeCount: undefined,\r\n          startDateTime: '',\r\n          endDateTime: '',\r\n          cateringNotes: '',\r\n          avRequirements: '',\r\n        },\r\n      ],\r\n    }));\r\n  };\r\n\r\n  const handleUpdateHallReservation = (index: number, field: keyof HallReservation, value: string) => {\r\n    setFormData(prev => {\r\n      const updated = [...prev.hallReservations];\r\n      const target = { ...updated[index] };\r\n      if (field === 'attendeeCount') {\r\n        target.attendeeCount = value === '' ? undefined : Number(value);\r\n      } else {\r\n        (target as any)[field] = value;\r\n      }\r\n      updated[index] = target;\r\n      return { ...prev, hallReservations: updated };\r\n    });\r\n  };\r\n\r\n  const handleRemoveHallReservation = (index: number) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      hallReservations: prev.hallReservations.filter((_, i) => i !== index),\r\n    }));\r\n  };\r\n\r\n  const handleCreateBooking = async () => {\r\n    if (!user?.tenantId) return;\r\n\r\n    if (validationErrors.hasErrors) {\r\n      setShowValidationErrors(true);\r\n      toast.error('Please resolve the highlighted fields');\r\n      return;\r\n    }\r\n\r\n    setSaving(true);\r\n    try {\r\n      await api.post(`/tenants/${user.tenantId}/group-bookings`, {\r\n        groupName: formData.groupName.trim(),\r\n        groupType: formData.groupType,\r\n        contactPerson: formData.contactPerson.trim(),\r\n        contactEmail: formData.contactEmail.trim(),\r\n        contactPhone: formData.contactPhone.trim(),\r\n        expectedGuests: formData.expectedGuests ? Number(formData.expectedGuests) : undefined,\r\n        checkInDate: formData.checkInDate,\r\n        checkOutDate: formData.checkOutDate,\r\n        depositAmount: formData.depositAmount ? Number(formData.depositAmount) : undefined,\r\n        specialRequests: formData.specialRequests.trim() || undefined,\r\n        dietaryRequirements: formData.dietaryRequirements.trim() || undefined,\r\n        setupRequirements: formData.setupRequirements.trim() || undefined,\r\n        roomBlocks: formData.roomBlocks.map(block => ({\r\n          roomCategoryId: block.roomCategoryId.trim(),\r\n          roomType: block.roomType.trim(),\r\n          totalRooms: block.totalRooms,\r\n          negotiatedRate: block.negotiatedRate,\r\n          discountPercent: block.discountPercent,\r\n        })),\r\n        hallReservations: formData.hallReservations.map(reservation => ({\r\n          hallId: reservation.hallId,\r\n          eventName: reservation.eventName?.trim() || undefined,\r\n          purpose: reservation.purpose?.trim() || undefined,\r\n          setupType: reservation.setupType?.trim() || undefined,\r\n          attendeeCount: reservation.attendeeCount,\r\n          startDateTime: reservation.startDateTime,\r\n          endDateTime: reservation.endDateTime,\r\n          cateringNotes: reservation.cateringNotes?.trim() || undefined,\r\n          avRequirements: reservation.avRequirements?.trim() || undefined,\r\n        })),\r\n      });\r\n\r\n      toast.success('Group booking created');\r\n      setShowCreateModal(false);\r\n      resetForm();\r\n      loadBookings();\r\n      loadStats();\r\n    } catch (error: any) {\r\n      console.error('Error creating group booking:', error);\r\n      const message = error?.response?.data?.message || 'Failed to create group booking';\r\n      toast.error(message);\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const openCreateModal = () => {\r\n    resetForm();\r\n    setShowCreateModal(true);\r\n  };\r\n\r\n  const closeCreateModal = () => {\r\n    setShowCreateModal(false);\r\n    setShowValidationErrors(false);\r\n  };\r\n\r\n  const filteredBookings = bookings.filter(booking =>\r\n    booking.groupName.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    booking.groupBookingNumber.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    booking.contactPerson.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    booking.contactEmail.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'confirmed': return '#10b981';\r\n      case 'pending': return '#f59e0b';\r\n      case 'in_progress': return '#3b82f6';\r\n      case 'completed': return '#8b5cf6';\r\n      case 'cancelled': return '#ef4444';\r\n      default: return '#6b7280';\r\n    }\r\n  };\r\n\r\n  const getProgressColor = (progress: string) => {\r\n    switch (progress) {\r\n      case 'initial_contact': return '#ef4444';\r\n      case 'contract_signed': return '#f59e0b';\r\n      case 'deposit_received': return '#3b82f6';\r\n      case 'rooms_allocated': return '#8b5cf6';\r\n      case 'confirmed': return '#10b981';\r\n      default: return '#6b7280';\r\n    }\r\n  };\r\n\r\n  const formatCurrency = (amount: number) => {\r\n    return new Intl.NumberFormat('en-NG', {\r\n      style: 'currency',\r\n      currency: 'NGN'\r\n    }).format(amount);\r\n  };\r\n\r\n  const formatDate = (dateString: string) => {\r\n    return new Date(dateString).toLocaleDateString('en-US', {\r\n      month: 'short',\r\n      day: 'numeric',\r\n      year: 'numeric'\r\n    });\r\n  };\r\n\r\n  const getProgressLabel = (progress: string) => {\r\n    return progress.split('_').map(word =>\r\n      word.charAt(0).toUpperCase() + word.slice(1)\r\n    ).join(' ');\r\n  };\r\n\r\n  const formatDateTime = (dateString: string) => {\r\n    return new Date(dateString).toLocaleString('en-US', {\r\n      month: 'short',\r\n      day: 'numeric',\r\n      year: 'numeric',\r\n      hour: '2-digit',\r\n      minute: '2-digit'\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: '2rem', maxWidth: '1400px', margin: '0 auto' }}>\r\n      <div style={{ marginBottom: '2rem' }}>\r\n        <h1 style={{ fontSize: '2rem', fontWeight: 'bold', marginBottom: '0.5rem' }}>\r\n          Group Bookings Management\r\n        </h1>\r\n        <p style={{ color: '#64748b' }}>\r\n          Manage large group bookings, room blocks, and event coordination\r\n        </p>\r\n      </div>\r\n\r\n      {/* Stats Cards */}\r\n      {stats && (\r\n        <div style={{\r\n          display: 'grid',\r\n          gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',\r\n          gap: '1rem',\r\n          marginBottom: '2rem'\r\n        }}>\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#1f2937' }}>\r\n              {stats.totalBookings}\r\n            </div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Total Bookings</div>\r\n          </div>\r\n\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#10b981' }}>\r\n              {stats.confirmedBookings}\r\n            </div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Confirmed</div>\r\n          </div>\r\n\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#f59e0b' }}>\r\n              {stats.pendingBookings}\r\n            </div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Pending</div>\r\n          </div>\r\n\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#3b82f6' }}>\r\n              {formatCurrency(stats.totalRevenue)}\r\n            </div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Total Revenue</div>\r\n          </div>\r\n\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#8b5cf6' }}>\r\n              {stats.totalRooms}\r\n            </div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Total Rooms</div>\r\n          </div>\r\n\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#f97316' }}>\r\n              {stats.upcomingBookings}\r\n            </div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Upcoming</div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Filters and Search */}\r\n      <div style={{\r\n        background: 'white',\r\n        border: '1px solid #e2e8f0',\r\n        borderRadius: '8px',\r\n        padding: '1.5rem',\r\n        marginBottom: '2rem'\r\n      }}>\r\n        <div style={{\r\n          display: 'flex',\r\n          flexWrap: 'wrap',\r\n          gap: '1rem',\r\n          alignItems: 'center',\r\n          marginBottom: '1rem'\r\n        }}>\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', flex: 1, minWidth: '250px' }}>\r\n            <Search size={18} style={{ color: '#64748b' }} />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search bookings...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              style={{\r\n                flex: 1,\r\n                padding: '0.5rem 0.75rem',\r\n                border: '1px solid #d1d5db',\r\n                borderRadius: '6px',\r\n                fontSize: '0.875rem'\r\n              }}\r\n            />\r\n          </div>\r\n\r\n          <select\r\n            value={statusFilter}\r\n            onChange={(e) => setStatusFilter(e.target.value)}\r\n            style={{\r\n              padding: '0.5rem 0.75rem',\r\n              border: '1px solid #d1d5db',\r\n              borderRadius: '6px',\r\n              fontSize: '0.875rem',\r\n              minWidth: '140px'\r\n            }}\r\n          >\r\n            <option value=\"all\">All Status</option>\r\n            <option value=\"pending\">Pending</option>\r\n            <option value=\"confirmed\">Confirmed</option>\r\n            <option value=\"in_progress\">In Progress</option>\r\n            <option value=\"completed\">Completed</option>\r\n            <option value=\"cancelled\">Cancelled</option>\r\n          </select>\r\n\r\n          <Button onClick={openCreateModal}>\r\n            <Plus size={18} style={{ marginRight: '0.5rem' }} />\r\n            New Group Booking\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Bookings List */}\r\n      {loading ? (\r\n        <div style={{ textAlign: 'center', padding: '3rem' }}>\r\n          Loading group bookings...\r\n        </div>\r\n      ) : filteredBookings.length === 0 ? (\r\n        <div style={{\r\n          textAlign: 'center',\r\n          padding: '3rem',\r\n          border: '2px dashed #e2e8f0',\r\n          borderRadius: '8px'\r\n        }}>\r\n          <Users size={48} style={{ color: '#cbd5e1', marginBottom: '1rem' }} />\r\n          <h3 style={{ fontSize: '1.25rem', fontWeight: '600', marginBottom: '0.5rem' }}>\r\n            No Group Bookings Found\r\n          </h3>\r\n          <p style={{ color: '#64748b', marginBottom: '1.5rem' }}>\r\n            {searchTerm || statusFilter !== 'all'\r\n              ? 'No bookings match your current filters.'\r\n              : 'Start by creating your first group booking for events or large parties.'}\r\n          </p>\r\n          <Button onClick={openCreateModal}>\r\n            <Plus size={18} style={{ marginRight: '0.5rem' }} />\r\n            Create Group Booking\r\n          </Button>\r\n        </div>\r\n      ) : (\r\n        <div style={{ display: 'grid', gap: '1rem' }}>\r\n          {filteredBookings.map((booking) => (\r\n            <div\r\n              key={booking.id}\r\n              style={{\r\n                background: 'white',\r\n                border: '1px solid #e2e8f0',\r\n                borderRadius: '12px',\r\n                padding: '1.5rem',\r\n                cursor: 'pointer',\r\n                transition: 'all 0.2s'\r\n              }}\r\n              onClick={() => {\r\n                setSelectedBooking(booking);\r\n                setShowDetailsModal(true);\r\n              }}\r\n            >\r\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1rem' }}>\r\n                <div>\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', marginBottom: '0.5rem' }}>\r\n                    <h3 style={{ fontSize: '1.25rem', fontWeight: '600', margin: 0 }}>\r\n                      {booking.groupName}\r\n                    </h3>\r\n                    <span style={{\r\n                      padding: '0.25rem 0.75rem',\r\n                      borderRadius: '9999px',\r\n                      fontSize: '0.75rem',\r\n                      fontWeight: '600',\r\n                      background: `${getStatusColor(booking.status)}20`,\r\n                      color: getStatusColor(booking.status)\r\n                    }}>\r\n                      {booking.status.toUpperCase()}\r\n                    </span>\r\n                  </div>\r\n\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', fontSize: '0.875rem', color: '#64748b' }}>\r\n                    <span>#{booking.groupBookingNumber}</span>\r\n                    <span style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\r\n                      <Users size={14} />\r\n                      {booking.expectedGuests} expected\r\n                    </span>\r\n                    <span style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\r\n                      <Bed size={14} />\r\n                      {booking.totalRooms} rooms\r\n                    </span>\r\n                    <span style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\r\n                      <Calendar size={14} />\r\n                      {formatDate(booking.checkInDate)} - {formatDate(booking.checkOutDate)}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n\r\n                <div style={{ textAlign: 'right' }}>\r\n                  <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '0.25rem' }}>\r\n                    {formatCurrency(booking.totalRevenue)}\r\n                  </div>\r\n                  <div style={{\r\n                    padding: '0.25rem 0.5rem',\r\n                    borderRadius: '4px',\r\n                    fontSize: '0.75rem',\r\n                    fontWeight: '500',\r\n                    background: `${getProgressColor(booking.bookingProgress)}20`,\r\n                    color: getProgressColor(booking.bookingProgress)\r\n                  }}>\r\n                    {getProgressLabel(booking.bookingProgress)}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Contact Info */}\r\n              <div style={{\r\n                display: 'grid',\r\n                gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',\r\n                gap: '1rem',\r\n                marginBottom: '1rem'\r\n              }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', fontSize: '0.875rem', color: '#64748b' }}>\r\n                  <User size={16} />\r\n                  <span>{booking.contactPerson}</span>\r\n                </div>\r\n\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', fontSize: '0.875rem', color: '#64748b' }}>\r\n                  <Mail size={16} />\r\n                  <span>{booking.contactEmail}</span>\r\n                </div>\r\n\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', fontSize: '0.875rem', color: '#64748b' }}>\r\n                  <Phone size={16} />\r\n                  <span>{booking.contactPhone}</span>\r\n                </div>\r\n\r\n                {booking.depositAmount && (\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', fontSize: '0.875rem', color: '#64748b' }}>\r\n                    <DollarSign size={16} />\r\n                    <span>\r\n                      Deposit: {formatCurrency(booking.depositAmount)}\r\n                      {booking.depositPaid && (\r\n                        <span style={{ color: '#10b981', marginLeft: '0.5rem' }}> Paid</span>\r\n                      )}\r\n                    </span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* Room Blocks Summary */}\r\n              {booking.roomBlocks && booking.roomBlocks.length > 0 && (\r\n                <div style={{\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  gap: '1rem',\r\n                  padding: '0.75rem',\r\n                  background: '#f8fafc',\r\n                  borderRadius: '6px',\r\n                  fontSize: '0.875rem'\r\n                }}>\r\n                  <Building size={16} style={{ color: '#64748b' }} />\r\n                  <span style={{ color: '#64748b' }}>\r\n                    {booking.roomBlocks.length} room block{booking.roomBlocks.length !== 1 ? 's' : ''}:\r\n                    {booking.roomBlocks.map(block => ` ${block.totalRooms} ${block.roomType}`).join(', ')}\r\n                  </span>\r\n                </div>\r\n              )}\r\n\r\n              {/* Hall Reservations Summary */}\r\n              {booking.hallReservations && booking.hallReservations.length > 0 && (\r\n                <div style={{\r\n                  marginTop: '0.75rem',\r\n                  padding: '0.75rem',\r\n                  background: '#f0f9ff',\r\n                  borderRadius: '6px',\r\n                  border: '1px solid #bae6fd',\r\n                  fontSize: '0.875rem',\r\n                  color: '#0c4a6e'\r\n                }}>\r\n                  <div style={{ fontWeight: 600, marginBottom: '0.25rem' }}>Meeting Hall Reservations</div>\r\n                  <ul style={{ margin: 0, paddingLeft: '1rem' }}>\r\n                    {booking.hallReservations.map((reservation) => (\r\n                      <li key={reservation.id} style={{ marginBottom: '0.25rem' }}>\r\n                        <strong>{reservation.hall?.name || 'Hall'}</strong> &mdash; {reservation.eventName || 'Event'}\r\n                        {' '}({formatDate(reservation.startDateTime)} @ {new Date(reservation.startDateTime).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                        {' '} - {new Date(reservation.endDateTime).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })})\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              )}\r\n\r\n              {/* Special Requirements */}\r\n              {(booking.specialRequests || booking.dietaryRequirements || booking.setupRequirements) && (\r\n                <div style={{\r\n                  marginTop: '1rem',\r\n                  padding: '0.75rem',\r\n                  background: '#fef3c7',\r\n                  borderRadius: '6px',\r\n                  border: '1px solid #f59e0b'\r\n                }}>\r\n                  <div style={{ fontSize: '0.875rem', fontWeight: '600', color: '#92400e', marginBottom: '0.25rem' }}>\r\n                    Special Requirements\r\n                  </div>\r\n                  <div style={{ fontSize: '0.875rem', color: '#92400e' }}>\r\n                    {booking.specialRequests && <div>Requests: {booking.specialRequests}</div>}\r\n                    {booking.dietaryRequirements && <div>Dietary: {booking.dietaryRequirements}</div>}\r\n                    {booking.setupRequirements && <div>Setup: {booking.setupRequirements}</div>}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {/* Details Modal */}\r\n      {showDetailsModal && selectedBooking && (\r\n        <div\r\n          style={{\r\n            position: 'fixed',\r\n            inset: 0,\r\n            background: 'rgba(15, 23, 42, 0.65)',\r\n            display: 'flex',\r\n            alignItems: 'flex-start',\r\n            justifyContent: 'center',\r\n            padding: '2rem',\r\n            zIndex: 1000,\r\n            overflowY: 'auto'\r\n          }}\r\n        >\r\n          <div\r\n            style={{\r\n              background: '#fff',\r\n              borderRadius: '16px',\r\n              width: '100%',\r\n              maxWidth: '960px',\r\n              paddingBottom: '1rem',\r\n              boxShadow: '0 20px 45px -15px rgba(15,23,42,0.4)'\r\n            }}\r\n          >\r\n            <div\r\n              style={{\r\n                display: 'flex',\r\n                justifyContent: 'space-between',\r\n                alignItems: 'center',\r\n                padding: '1.5rem 2rem',\r\n                borderBottom: '1px solid #e2e8f0'\r\n              }}\r\n            >\r\n              <div>\r\n                <h2 style={{ margin: 0, fontSize: '1.75rem' }}>{selectedBooking.groupName}</h2>\r\n                <p style={{ margin: '0.35rem 0 0', color: '#475569', fontSize: '0.95rem' }}>\r\n                  #{selectedBooking.groupBookingNumber}  {selectedBooking.groupType}\r\n                </p>\r\n              </div>\r\n              <div style={{ display: 'flex', gap: '0.75rem', alignItems: 'center' }}>\r\n                <span\r\n                  style={{\r\n                    padding: '0.35rem 0.85rem',\r\n                    borderRadius: '999px',\r\n                    fontWeight: 600,\r\n                    fontSize: '0.85rem',\r\n                    background: `${getStatusColor(selectedBooking.status)}20`,\r\n                    color: getStatusColor(selectedBooking.status)\r\n                  }}\r\n                >\r\n                  {selectedBooking.status.toUpperCase()}\r\n                </span>\r\n                <button\r\n                  onClick={() => setShowDetailsModal(false)}\r\n                  style={{\r\n                    border: 'none',\r\n                    background: '#f1f5f9',\r\n                    width: '38px',\r\n                    height: '38px',\r\n                    borderRadius: '999px',\r\n                    fontSize: '1.25rem',\r\n                    cursor: 'pointer'\r\n                  }}\r\n                  aria-label=\"Close details\"\r\n                >\r\n                  \r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <div style={{ padding: '1.5rem 2rem', display: 'grid', gap: '1.25rem' }}>\r\n              {/* Timeline and Revenue */}\r\n              <section\r\n                style={{\r\n                  display: 'grid',\r\n                  gridTemplateColumns: 'repeat(auto-fit, minmax(180px, 1fr))',\r\n                  gap: '1rem'\r\n                }}\r\n              >\r\n                <div\r\n                  style={{\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '12px',\r\n                    padding: '1rem'\r\n                  }}\r\n                >\r\n                  <div style={{ color: '#94a3b8', fontSize: '0.75rem', letterSpacing: '0.05em' }}>CHECK-IN</div>\r\n                  <div style={{ fontSize: '1.1rem', fontWeight: 600 }}>{formatDate(selectedBooking.checkInDate)}</div>\r\n                </div>\r\n                <div\r\n                  style={{\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '12px',\r\n                    padding: '1rem'\r\n                  }}\r\n                >\r\n                  <div style={{ color: '#94a3b8', fontSize: '0.75rem', letterSpacing: '0.05em' }}>CHECK-OUT</div>\r\n                  <div style={{ fontSize: '1.1rem', fontWeight: 600 }}>{formatDate(selectedBooking.checkOutDate)}</div>\r\n                </div>\r\n                <div\r\n                  style={{\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '12px',\r\n                    padding: '1rem'\r\n                  }}\r\n                >\r\n                  <div style={{ color: '#94a3b8', fontSize: '0.75rem', letterSpacing: '0.05em' }}>ROOMS</div>\r\n                  <div style={{ fontSize: '1.1rem', fontWeight: 600 }}>{selectedBooking.totalRooms}</div>\r\n                </div>\r\n                <div\r\n                  style={{\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '12px',\r\n                    padding: '1rem'\r\n                  }}\r\n                >\r\n                  <div style={{ color: '#94a3b8', fontSize: '0.75rem', letterSpacing: '0.05em' }}>REVENUE</div>\r\n                  <div style={{ fontSize: '1.1rem', fontWeight: 600 }}>\r\n                    {formatCurrency(selectedBooking.totalRevenue)}\r\n                  </div>\r\n                </div>\r\n              </section>\r\n\r\n              {/* Contact + Requests */}\r\n              <section\r\n                style={{\r\n                  border: '1px solid #e2e8f0',\r\n                  borderRadius: '12px',\r\n                  padding: '1.25rem',\r\n                  display: 'grid',\r\n                  gap: '1rem'\r\n                }}\r\n              >\r\n                <div\r\n                  style={{\r\n                    display: 'grid',\r\n                    gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',\r\n                    gap: '1rem',\r\n                    color: '#475569',\r\n                    fontSize: '0.9rem'\r\n                  }}\r\n                >\r\n                  <div>\r\n                    <div style={{ fontWeight: 600, marginBottom: '0.25rem' }}>Contact</div>\r\n                    <div>{selectedBooking.contactPerson}</div>\r\n                  </div>\r\n                  <div>\r\n                    <div style={{ fontWeight: 600, marginBottom: '0.25rem' }}>Email</div>\r\n                    <div>{selectedBooking.contactEmail}</div>\r\n                  </div>\r\n                  <div>\r\n                    <div style={{ fontWeight: 600, marginBottom: '0.25rem' }}>Phone</div>\r\n                    <div>{selectedBooking.contactPhone}</div>\r\n                  </div>\r\n                  <div>\r\n                    <div style={{ fontWeight: 600, marginBottom: '0.25rem' }}>Guests</div>\r\n                    <div>\r\n                      Expected {selectedBooking.expectedGuests} / Confirmed {selectedBooking.confirmedGuests}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {(selectedBooking.specialRequests ||\r\n                  selectedBooking.dietaryRequirements ||\r\n                  selectedBooking.setupRequirements) && (\r\n                  <div\r\n                    style={{\r\n                      background: '#fff7ed',\r\n                      borderRadius: '10px',\r\n                      padding: '0.85rem',\r\n                      border: '1px solid #fdba74',\r\n                      color: '#92400e',\r\n                      fontSize: '0.9rem'\r\n                    }}\r\n                  >\r\n                    {selectedBooking.specialRequests && (\r\n                      <div style={{ marginBottom: '0.35rem' }}>\r\n                        <strong>Special:</strong> {selectedBooking.specialRequests}\r\n                      </div>\r\n                    )}\r\n                    {selectedBooking.dietaryRequirements && (\r\n                      <div style={{ marginBottom: '0.35rem' }}>\r\n                        <strong>Dietary:</strong> {selectedBooking.dietaryRequirements}\r\n                      </div>\r\n                    )}\r\n                    {selectedBooking.setupRequirements && (\r\n                      <div>\r\n                        <strong>Setup:</strong> {selectedBooking.setupRequirements}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </section>\r\n\r\n              {/* Room Blocks */}\r\n              {selectedBooking.roomBlocks && selectedBooking.roomBlocks.length > 0 && (\r\n                <section\r\n                  style={{\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '12px',\r\n                    padding: '1.25rem'\r\n                  }}\r\n                >\r\n                  <div\r\n                    style={{\r\n                      display: 'flex',\r\n                      justifyContent: 'space-between',\r\n                      alignItems: 'center',\r\n                      marginBottom: '1rem'\r\n                    }}\r\n                  >\r\n                    <h3 style={{ margin: 0 }}>Room Blocks</h3>\r\n                    <span style={{ color: '#64748b', fontSize: '0.85rem' }}>\r\n                      {selectedBooking.roomBlocks.length} block\r\n                      {selectedBooking.roomBlocks.length > 1 ? 's' : ''}\r\n                    </span>\r\n                  </div>\r\n                  <div style={{ display: 'grid', gap: '0.75rem' }}>\r\n                    {selectedBooking.roomBlocks.map((block) => (\r\n                      <div\r\n                        key={block.id}\r\n                        style={{\r\n                          border: '1px solid #cbd5f5',\r\n                          borderRadius: '10px',\r\n                          padding: '0.85rem'\r\n                        }}\r\n                      >\r\n                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem' }}>\r\n                          <div style={{ fontWeight: 600 }}>{block.roomType || 'Room Type'}</div>\r\n                          <div style={{ color: '#0f172a', fontWeight: 600 }}>{block.totalRooms} rooms</div>\r\n                        </div>\r\n                        <div\r\n                          style={{\r\n                            display: 'grid',\r\n                            gridTemplateColumns: 'repeat(auto-fit, minmax(140px, 1fr))',\r\n                            gap: '0.5rem',\r\n                            fontSize: '0.85rem',\r\n                            color: '#475569'\r\n                          }}\r\n                        >\r\n                          <span>Category: {block.roomCategoryId || ''}</span>\r\n                          <span>Rate: {block.negotiatedRate ? formatCurrency(block.negotiatedRate) : 'N/A'}</span>\r\n                          <span>Discount: {block.discountPercent ? `${block.discountPercent}%` : ''}</span>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </section>\r\n              )}\r\n\r\n              {/* Hall Reservations */}\r\n              {selectedBooking.hallReservations && selectedBooking.hallReservations.length > 0 && (\r\n                <section\r\n                  style={{\r\n                    border: '1px solid #e0f2fe',\r\n                    borderRadius: '12px',\r\n                    padding: '1.25rem',\r\n                    background: '#f0f9ff'\r\n                  }}\r\n                >\r\n                  <div\r\n                    style={{\r\n                      display: 'flex',\r\n                      justifyContent: 'space-between',\r\n                      alignItems: 'center',\r\n                      marginBottom: '1rem',\r\n                      color: '#0c4a6e'\r\n                    }}\r\n                  >\r\n                    <h3 style={{ margin: 0 }}>Meeting Hall Reservations</h3>\r\n                    <span style={{ fontSize: '0.85rem' }}>\r\n                      {selectedBooking.hallReservations.length}{' '}\r\n                      {selectedBooking.hallReservations.length === 1 ? 'reservation' : 'reservations'}\r\n                    </span>\r\n                  </div>\r\n                  <div style={{ display: 'grid', gap: '0.75rem' }}>\r\n                    {selectedBooking.hallReservations.map((reservation) => (\r\n                      <div\r\n                        key={reservation.id}\r\n                        style={{\r\n                          border: '1px solid #bae6fd',\r\n                          borderRadius: '10px',\r\n                          padding: '0.85rem',\r\n                          background: '#fff'\r\n                        }}\r\n                      >\r\n                        <div\r\n                          style={{\r\n                            display: 'flex',\r\n                            justifyContent: 'space-between',\r\n                            gap: '0.5rem',\r\n                            flexWrap: 'wrap',\r\n                            marginBottom: '0.4rem'\r\n                          }}\r\n                        >\r\n                          <div style={{ fontWeight: 600 }}>\r\n                            {reservation.hall?.name || 'Hall'}  {reservation.eventName || 'Event'}\r\n                          </div>\r\n                          <div style={{ fontSize: '0.85rem', color: '#0369a1' }}>\r\n                            {reservation.attendeeCount ? `${reservation.attendeeCount} attendees` : 'Capacity TBD'}\r\n                          </div>\r\n                        </div>\r\n                        <div style={{ fontSize: '0.85rem', color: '#0f172a', marginBottom: '0.4rem' }}>\r\n                          {formatDateTime(reservation.startDateTime)} &rarr; {formatDateTime(reservation.endDateTime)}\r\n                        </div>\r\n                        <div\r\n                          style={{\r\n                            display: 'grid',\r\n                            gridTemplateColumns: 'repeat(auto-fit, minmax(160px, 1fr))',\r\n                            gap: '0.5rem',\r\n                            fontSize: '0.8rem',\r\n                            color: '#475569'\r\n                          }}\r\n                        >\r\n                          <span>Purpose: {reservation.purpose || ''}</span>\r\n                          <span>Setup: {reservation.setupType || ''}</span>\r\n                        </div>\r\n                        {(reservation.cateringNotes || reservation.avRequirements) && (\r\n                          <div\r\n                            style={{\r\n                              marginTop: '0.6rem',\r\n                              background: '#f8fafc',\r\n                              borderRadius: '8px',\r\n                              padding: '0.6rem',\r\n                              fontSize: '0.8rem',\r\n                              color: '#0f172a'\r\n                            }}\r\n                          >\r\n                            {reservation.cateringNotes && (\r\n                              <div style={{ marginBottom: '0.35rem' }}>\r\n                                <strong>Catering:</strong> {reservation.cateringNotes}\r\n                              </div>\r\n                            )}\r\n                            {reservation.avRequirements && (\r\n                              <div>\r\n                                <strong>AV:</strong> {reservation.avRequirements}\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </section>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Create Booking Modal */}\r\n      {showCreateModal && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          inset: 0,\r\n          background: 'rgba(15, 23, 42, 0.55)',\r\n          display: 'flex',\r\n          alignItems: 'flex-start',\r\n          justifyContent: 'center',\r\n          overflowY: 'auto',\r\n          padding: '2rem',\r\n          zIndex: 1000,\r\n        }}>\r\n          <div style={{\r\n            background: '#fff',\r\n            borderRadius: '16px',\r\n            width: '100%',\r\n            maxWidth: '1000px',\r\n            padding: '2rem',\r\n            boxShadow: '0 25px 50px -12px rgba(15,23,42,0.35)',\r\n          }}>\r\n            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n              <div>\r\n                <h2 style={{ margin: 0, fontSize: '1.75rem', fontWeight: 700 }}>New Group Booking</h2>\r\n                <p style={{ margin: 0, color: '#64748b' }}>Capture room blocks and optional hall reservations</p>\r\n              </div>\r\n              <button\r\n                onClick={closeCreateModal}\r\n                style={{\r\n                  border: 'none',\r\n                  background: '#f1f5f9',\r\n                  width: '36px',\r\n                  height: '36px',\r\n                  borderRadius: '50%',\r\n                  fontSize: '1.25rem',\r\n                  cursor: 'pointer',\r\n                }}\r\n                aria-label=\"Close\"\r\n              >\r\n                \r\n              </button>\r\n            </div>\r\n\r\n            <div style={{ display: 'grid', gap: '1.5rem' }}>\r\n              {/* Contact & Dates */}\r\n              <section style={{ border: '1px solid #e2e8f0', borderRadius: '12px', padding: '1.25rem' }}>\r\n                <h3 style={{ margin: '0 0 1rem', fontSize: '1.1rem' }}>Event Details</h3>\r\n                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(220px, 1fr))', gap: '1rem' }}>\r\n                  <label style={{ display: 'flex', flexDirection: 'column', fontSize: '0.85rem', color: '#475569' }}>\r\n                    Group Name *\r\n                    <input\r\n                      type=\"text\"\r\n                      value={formData.groupName}\r\n                      onChange={(e) => setFormData(prev => ({ ...prev, groupName: e.target.value }))}\r\n                      style={inputBorderStyle('groupName')}\r\n                    />\r\n                    {getFieldError('groupName') && (\r\n                      <span style={errorTextStyle}>{getFieldError('groupName')}</span>\r\n                    )}\r\n                  </label>\r\n                  <label style={{ display: 'flex', flexDirection: 'column', fontSize: '0.85rem', color: '#475569' }}>\r\n                    Contact Person *\r\n                    <input\r\n                      type=\"text\"\r\n                      value={formData.contactPerson}\r\n                      onChange={(e) => setFormData(prev => ({ ...prev, contactPerson: e.target.value }))}\r\n                      style={inputBorderStyle('contactPerson')}\r\n                    />\r\n                    {getFieldError('contactPerson') && (\r\n                      <span style={errorTextStyle}>{getFieldError('contactPerson')}</span>\r\n                    )}\r\n                  </label>\r\n                  <label style={{ display: 'flex', flexDirection: 'column', fontSize: '0.85rem', color: '#475569' }}>\r\n                    Contact Email *\r\n                    <input\r\n                      type=\"email\"\r\n                      value={formData.contactEmail}\r\n                      onChange={(e) => setFormData(prev => ({ ...prev, contactEmail: e.target.value }))}\r\n                      style={inputBorderStyle('contactEmail')}\r\n                    />\r\n                    {getFieldError('contactEmail') && (\r\n                      <span style={errorTextStyle}>{getFieldError('contactEmail')}</span>\r\n                    )}\r\n                  </label>\r\n                  <label style={{ display: 'flex', flexDirection: 'column', fontSize: '0.85rem', color: '#475569' }}>\r\n                    Contact Phone *\r\n                    <input\r\n                      type=\"tel\"\r\n                      value={formData.contactPhone}\r\n                      onChange={(e) => setFormData(prev => ({ ...prev, contactPhone: e.target.value }))}\r\n                      style={inputBorderStyle('contactPhone')}\r\n                    />\r\n                    {getFieldError('contactPhone') && (\r\n                      <span style={errorTextStyle}>{getFieldError('contactPhone')}</span>\r\n                    )}\r\n                  </label>\r\n                  <label style={{ display: 'flex', flexDirection: 'column', fontSize: '0.85rem', color: '#475569' }}>\r\n                    Expected Guests\r\n                    <input\r\n                      type=\"number\"\r\n                      min={0}\r\n                      value={formData.expectedGuests}\r\n                      onChange={(e) => setFormData(prev => ({ ...prev, expectedGuests: e.target.value }))}\r\n                      style={{ marginTop: '0.35rem', padding: '0.6rem', borderRadius: '8px', border: '1px solid #cbd5f5' }}\r\n                    />\r\n                  </label>\r\n                  <label style={{ display: 'flex', flexDirection: 'column', fontSize: '0.85rem', color: '#475569' }}>\r\n                    Check-In Date *\r\n                    <input\r\n                      type=\"date\"\r\n                      value={formData.checkInDate}\r\n                      onChange={(e) => setFormData(prev => ({ ...prev, checkInDate: e.target.value }))}\r\n                      style={inputBorderStyle('checkInDate')}\r\n                    />\r\n                    {getFieldError('checkInDate') && (\r\n                      <span style={errorTextStyle}>{getFieldError('checkInDate')}</span>\r\n                    )}\r\n                  </label>\r\n                  <label style={{ display: 'flex', flexDirection: 'column', fontSize: '0.85rem', color: '#475569' }}>\r\n                    Check-Out Date *\r\n                    <input\r\n                      type=\"date\"\r\n                      value={formData.checkOutDate}\r\n                      onChange={(e) => setFormData(prev => ({ ...prev, checkOutDate: e.target.value }))}\r\n                      style={inputBorderStyle('checkOutDate')}\r\n                    />\r\n                    {getFieldError('checkOutDate') && (\r\n                      <span style={errorTextStyle}>{getFieldError('checkOutDate')}</span>\r\n                    )}\r\n                  </label>\r\n                  <label style={{ display: 'flex', flexDirection: 'column', fontSize: '0.85rem', color: '#475569' }}>\r\n                    Deposit Amount\r\n                    <input\r\n                      type=\"number\"\r\n                      min={0}\r\n                      value={formData.depositAmount}\r\n                      onChange={(e) => setFormData(prev => ({ ...prev, depositAmount: e.target.value }))}\r\n                      style={{ marginTop: '0.35rem', padding: '0.6rem', borderRadius: '8px', border: '1px solid #cbd5f5' }}\r\n                    />\r\n                  </label>\r\n                </div>\r\n                <div style={{ marginTop: '1rem', display: 'grid', gap: '0.75rem' }}>\r\n                  <textarea\r\n                    placeholder=\"Special requests\"\r\n                    value={formData.specialRequests}\r\n                    onChange={(e) => setFormData(prev => ({ ...prev, specialRequests: e.target.value }))}\r\n                    style={{ minHeight: '70px', padding: '0.75rem', borderRadius: '8px', border: '1px solid #cbd5f5' }}\r\n                  />\r\n                  <textarea\r\n                    placeholder=\"Dietary requirements\"\r\n                    value={formData.dietaryRequirements}\r\n                    onChange={(e) => setFormData(prev => ({ ...prev, dietaryRequirements: e.target.value }))}\r\n                    style={{ minHeight: '70px', padding: '0.75rem', borderRadius: '8px', border: '1px solid #cbd5f5' }}\r\n                  />\r\n                  <textarea\r\n                    placeholder=\"Setup requirements\"\r\n                    value={formData.setupRequirements}\r\n                    onChange={(e) => setFormData(prev => ({ ...prev, setupRequirements: e.target.value }))}\r\n                    style={{ minHeight: '70px', padding: '0.75rem', borderRadius: '8px', border: '1px solid #cbd5f5' }}\r\n                  />\r\n                </div>\r\n              </section>\r\n\r\n              {/* Room Blocks */}\r\n              <section style={{ border: '1px solid #e2e8f0', borderRadius: '12px', padding: '1.25rem' }}>\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>\r\n                  <h3 style={{ margin: 0, fontSize: '1.1rem' }}>Room Blocks</h3>\r\n                  <Button\r\n                    onClick={handleAddRoomBlock}\r\n                    disabled={loadingRoomMeta}\r\n                    style={{ padding: '0.4rem 0.9rem', fontSize: '0.85rem', opacity: loadingRoomMeta ? 0.6 : 1 }}\r\n                  >\r\n                    + Add Block\r\n                  </Button>\r\n                </div>\r\n                {loadingRoomMeta && (\r\n                  <div style={{ color: '#64748b', marginBottom: '0.75rem' }}>Loading room categories and inventory...</div>\r\n                )}\r\n                <div style={{ display: 'grid', gap: '1rem' }}>\r\n                  {shouldShowErrors && validationErrors.fields.roomBlocks && (\r\n                    <div style={{ color: '#dc2626', fontSize: '0.85rem' }}>\r\n                      {validationErrors.fields.roomBlocks}\r\n                    </div>\r\n                  )}\r\n                  {formData.roomBlocks.map((block, index) => (\r\n                    <div key={block.id} style={{ border: '1px solid #cbd5f5', borderRadius: '10px', padding: '1rem' }}>\r\n                      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(180px, 1fr))', gap: '0.75rem' }}>\r\n                        <div style={{ display: 'flex', flexDirection: 'column' }}>\r\n                          <select\r\n                            value={block.roomCategoryId}\r\n                            onChange={(e) => handleUpdateRoomBlock(index, 'roomCategoryId', e.target.value)}\r\n                            style={roomBlockInputStyle(index, 'roomCategoryId')}\r\n                          >\r\n                            <option value=\"\">Select category</option>\r\n                            {roomCategories.map((category) => (\r\n                              <option key={category.id} value={category.id}>\r\n                                {category.name}\r\n                              </option>\r\n                            ))}\r\n                          </select>\r\n                          {shouldShowErrors && validationErrors.roomBlocks[index]?.roomCategoryId && (\r\n                            <span style={errorTextStyle}>{validationErrors.roomBlocks[index]?.roomCategoryId}</span>\r\n                          )}\r\n                        </div>\r\n                        <div style={{ display: 'flex', flexDirection: 'column' }}>\r\n                          <select\r\n                            value={block.roomType}\r\n                            onChange={(e) => handleUpdateRoomBlock(index, 'roomType', e.target.value)}\r\n                            style={roomBlockInputStyle(index, 'roomType')}\r\n                          >\r\n                            <option value=\"\">Select room type</option>\r\n                            {roomTypes.map((type) => (\r\n                              <option key={type} value={type}>\r\n                                {type}\r\n                              </option>\r\n                            ))}\r\n                          </select>\r\n                          {shouldShowErrors && validationErrors.roomBlocks[index]?.roomType && (\r\n                            <span style={errorTextStyle}>{validationErrors.roomBlocks[index]?.roomType}</span>\r\n                          )}\r\n                        </div>\r\n                        <input\r\n                          type=\"number\"\r\n                          min={1}\r\n                          placeholder=\"Total Rooms\"\r\n                          value={block.totalRooms}\r\n                          onChange={(e) => handleUpdateRoomBlock(index, 'totalRooms', e.target.value)}\r\n                          style={roomBlockInputStyle(index, 'totalRooms')}\r\n                        />\r\n                        {shouldShowErrors && validationErrors.roomBlocks[index]?.totalRooms && (\r\n                          <span style={errorTextStyle}>{validationErrors.roomBlocks[index]?.totalRooms}</span>\r\n                        )}\r\n                        <input\r\n                          type=\"number\"\r\n                          placeholder=\"Negotiated Rate\"\r\n                          value={block.negotiatedRate ?? ''}\r\n                          onChange={(e) => handleUpdateRoomBlock(index, 'negotiatedRate', e.target.value)}\r\n                          style={{ padding: '0.6rem', borderRadius: '8px', border: '1px solid #cbd5f5' }}\r\n                        />\r\n                        <input\r\n                          type=\"number\"\r\n                          placeholder=\"Discount %\"\r\n                          value={block.discountPercent ?? ''}\r\n                          onChange={(e) => handleUpdateRoomBlock(index, 'discountPercent', e.target.value)}\r\n                          style={{ padding: '0.6rem', borderRadius: '8px', border: '1px solid #cbd5f5' }}\r\n                        />\r\n                      </div>\r\n                      <div style={{ marginTop: '0.5rem', fontSize: '0.85rem', color: '#475569' }}>\r\n                        <span style={{ color: '#0f172a', fontWeight: 600 }}>\r\n                          Inventory:&nbsp;\r\n                          {getInventoryCount(block.roomCategoryId, block.roomType)}\r\n                        </span>\r\n                        &nbsp;rooms\r\n                        {block.roomCategoryId && (\r\n                          <>\r\n                            &nbsp;in {getCategoryName(block.roomCategoryId)}\r\n                            {block.roomType ? ` (${block.roomType})` : ''}\r\n                          </>\r\n                        )}\r\n                      </div>\r\n                      {formData.roomBlocks.length > 1 && (\r\n                        <button\r\n                          onClick={() => handleRemoveRoomBlock(index)}\r\n                          style={{\r\n                            marginTop: '0.75rem',\r\n                            border: 'none',\r\n                            background: 'transparent',\r\n                            color: '#dc2626',\r\n                            cursor: 'pointer',\r\n                            fontWeight: 600,\r\n                          }}\r\n                        >\r\n                          Remove block\r\n                        </button>\r\n                      )}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </section>\r\n\r\n              {/* Hall Reservations */}\r\n              <section style={{ border: '1px solid #e2e8f0', borderRadius: '12px', padding: '1.25rem' }}>\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>\r\n                  <h3 style={{ margin: 0, fontSize: '1.1rem' }}>Meeting Hall Reservations</h3>\r\n                  <Button\r\n                    onClick={handleAddHallReservation}\r\n                    disabled={!meetingHalls.length || loadingHalls}\r\n                    style={{ padding: '0.4rem 0.9rem', fontSize: '0.85rem', opacity: meetingHalls.length ? 1 : 0.6 }}\r\n                  >\r\n                    + Add Hall\r\n                  </Button>\r\n                </div>\r\n                {loadingHalls ? (\r\n                  <div style={{ color: '#64748b' }}>Loading halls...</div>\r\n                ) : meetingHalls.length === 0 ? (\r\n                  <div style={{ color: '#94a3b8' }}>No halls available for this tenant.</div>\r\n                ) : (\r\n                  <div style={{ display: 'grid', gap: '1rem' }}>\r\n                    {formData.hallReservations.map((reservation, index) => (\r\n                      <div key={reservation.id} style={{ border: '1px solid #cbd5f5', borderRadius: '10px', padding: '1rem' }}>\r\n                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(160px, 1fr))', gap: '0.75rem' }}>\r\n                          <select\r\n                            value={reservation.hallId}\r\n                            onChange={(e) => handleUpdateHallReservation(index, 'hallId', e.target.value)}\r\n                            style={hallReservationInputStyle(index, 'hallId')}\r\n                          >\r\n                            {meetingHalls.map(hall => (\r\n                              <option key={hall.id} value={hall.id}>\r\n                                {hall.name} (cap {hall.capacity})\r\n                              </option>\r\n                            ))}\r\n                          </select>\r\n                          {shouldShowErrors && validationErrors.hallReservations[index]?.hallId && (\r\n                            <span style={errorTextStyle}>{validationErrors.hallReservations[index]?.hallId}</span>\r\n                          )}\r\n                          <input\r\n                            type=\"text\"\r\n                            placeholder=\"Event Name\"\r\n                            value={reservation.eventName || ''}\r\n                            onChange={(e) => handleUpdateHallReservation(index, 'eventName', e.target.value)}\r\n                            style={{ padding: '0.6rem', borderRadius: '8px', border: '1px solid #cbd5f5' }}\r\n                          />\r\n                          <input\r\n                            type=\"text\"\r\n                            placeholder=\"Purpose\"\r\n                            value={reservation.purpose || ''}\r\n                            onChange={(e) => handleUpdateHallReservation(index, 'purpose', e.target.value)}\r\n                            style={{ padding: '0.6rem', borderRadius: '8px', border: '1px solid #cbd5f5' }}\r\n                          />\r\n                          <input\r\n                            type=\"text\"\r\n                            placeholder=\"Setup Type\"\r\n                            value={reservation.setupType || ''}\r\n                            onChange={(e) => handleUpdateHallReservation(index, 'setupType', e.target.value)}\r\n                            style={{ padding: '0.6rem', borderRadius: '8px', border: '1px solid #cbd5f5' }}\r\n                          />\r\n                          <input\r\n                            type=\"number\"\r\n                            min={0}\r\n                            placeholder=\"Attendees\"\r\n                            value={reservation.attendeeCount ?? ''}\r\n                            onChange={(e) => handleUpdateHallReservation(index, 'attendeeCount', e.target.value)}\r\n                            style={{ padding: '0.6rem', borderRadius: '8px', border: '1px solid #cbd5f5' }}\r\n                          />\r\n                          <input\r\n                            type=\"datetime-local\"\r\n                            value={reservation.startDateTime}\r\n                            onChange={(e) => handleUpdateHallReservation(index, 'startDateTime', e.target.value)}\r\n                            style={hallReservationInputStyle(index, 'startDateTime')}\r\n                          />\r\n                          {shouldShowErrors && validationErrors.hallReservations[index]?.startDateTime && (\r\n                            <span style={errorTextStyle}>{validationErrors.hallReservations[index]?.startDateTime}</span>\r\n                          )}\r\n                          <input\r\n                            type=\"datetime-local\"\r\n                            value={reservation.endDateTime}\r\n                            onChange={(e) => handleUpdateHallReservation(index, 'endDateTime', e.target.value)}\r\n                            style={hallReservationInputStyle(index, 'endDateTime')}\r\n                          />\r\n                          {shouldShowErrors && validationErrors.hallReservations[index]?.endDateTime && (\r\n                            <span style={errorTextStyle}>{validationErrors.hallReservations[index]?.endDateTime}</span>\r\n                          )}\r\n                        </div>\r\n                        <textarea\r\n                          placeholder=\"Catering notes\"\r\n                          value={reservation.cateringNotes || ''}\r\n                          onChange={(e) => handleUpdateHallReservation(index, 'cateringNotes', e.target.value)}\r\n                          style={{ marginTop: '0.75rem', width: '100%', minHeight: '60px', borderRadius: '8px', border: '1px solid #cbd5f5', padding: '0.6rem' }}\r\n                        />\r\n                        <textarea\r\n                          placeholder=\"AV requirements\"\r\n                          value={reservation.avRequirements || ''}\r\n                          onChange={(e) => handleUpdateHallReservation(index, 'avRequirements', e.target.value)}\r\n                          style={{ marginTop: '0.5rem', width: '100%', minHeight: '60px', borderRadius: '8px', border: '1px solid #cbd5f5', padding: '0.6rem' }}\r\n                        />\r\n                        <button\r\n                          onClick={() => handleRemoveHallReservation(index)}\r\n                          style={{\r\n                            marginTop: '0.75rem',\r\n                            border: 'none',\r\n                            background: 'transparent',\r\n                            color: '#dc2626',\r\n                            cursor: 'pointer',\r\n                            fontWeight: 600,\r\n                          }}\r\n                        >\r\n                          Remove hall reservation\r\n                        </button>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </section>\r\n\r\n              <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '0.75rem' }}>\r\n                <button\r\n                  onClick={closeCreateModal}\r\n                  style={{\r\n                    border: '1px solid #cbd5f5',\r\n                    background: '#fff',\r\n                    padding: '0.75rem 1.25rem',\r\n                    borderRadius: '999px',\r\n                    cursor: 'pointer',\r\n                  }}\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  onClick={handleCreateBooking}\r\n                  disabled={createDisabled}\r\n                  style={{\r\n                    border: 'none',\r\n                    background: createDisabled ? '#475569' : '#0f172a',\r\n                    color: '#fff',\r\n                    padding: '0.75rem 1.5rem',\r\n                    borderRadius: '999px',\r\n                    cursor: 'pointer',\r\n                    opacity: createDisabled ? 0.7 : 1,\r\n                  }}\r\n                >\r\n                  {saving ? 'Saving...' : 'Create Booking'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\GroupBookingsPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchDetails'. Either include it or remove the dependency array.","line":516,"column":6,"nodeType":"ArrayExpression","endLine":516,"endColumn":28,"suggestions":[{"desc":"Update the dependencies array to be: [booking.id, fetchDetails, tenantId]","fix":{"range":[20125,20147],"text":"[booking.id, fetchDetails, tenantId]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchCategories' and 'fetchMeetingHalls'. Either include them or remove the dependency array.","line":790,"column":6,"nodeType":"ArrayExpression","endLine":790,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [fetchCategories, fetchMeetingHalls, tenantId]","fix":{"range":[31129,31139],"text":"[fetchCategories, fetchMeetingHalls, tenantId]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchAvailability'. Either include it or remove the dependency array.","line":812,"column":6,"nodeType":"ArrayExpression","endLine":812,"endColumn":97,"suggestions":[{"desc":"Update the dependencies array to be: [formData.checkInDate, formData.checkOutDate, formData.adults, formData.children, tenantId, fetchAvailability]","fix":{"range":[31832,31923],"text":"[formData.checkInDate, formData.checkOutDate, formData.adults, formData.children, tenantId, fetchAvailability]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'hallReservations.length'. Either include it or remove the dependency array.","line":835,"column":6,"nodeType":"ArrayExpression","endLine":835,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [hallReservations.length, includeHall, meetingHalls]","fix":{"range":[32475,32502],"text":"[hallReservations.length, includeHall, meetingHalls]"}}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":1458,"column":29,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[53614,53675],"text":"\n          Bulk select (e.g. &quot;101-105\" or \"201,203\")\n        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[53614,53675],"text":"\n          Bulk select (e.g. &ldquo;101-105\" or \"201,203\")\n        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[53614,53675],"text":"\n          Bulk select (e.g. &#34;101-105\" or \"201,203\")\n        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[53614,53675],"text":"\n          Bulk select (e.g. &rdquo;101-105\" or \"201,203\")\n        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":1458,"column":37,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[53614,53675],"text":"\n          Bulk select (e.g. \"101-105&quot; or \"201,203\")\n        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[53614,53675],"text":"\n          Bulk select (e.g. \"101-105&ldquo; or \"201,203\")\n        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[53614,53675],"text":"\n          Bulk select (e.g. \"101-105&#34; or \"201,203\")\n        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[53614,53675],"text":"\n          Bulk select (e.g. \"101-105&rdquo; or \"201,203\")\n        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":1458,"column":42,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[53614,53675],"text":"\n          Bulk select (e.g. \"101-105\" or &quot;201,203\")\n        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[53614,53675],"text":"\n          Bulk select (e.g. \"101-105\" or &ldquo;201,203\")\n        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[53614,53675],"text":"\n          Bulk select (e.g. \"101-105\" or &#34;201,203\")\n        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[53614,53675],"text":"\n          Bulk select (e.g. \"101-105\" or &rdquo;201,203\")\n        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":1458,"column":50,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[53614,53675],"text":"\n          Bulk select (e.g. \"101-105\" or \"201,203&quot;)\n        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[53614,53675],"text":"\n          Bulk select (e.g. \"101-105\" or \"201,203&ldquo;)\n        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[53614,53675],"text":"\n          Bulk select (e.g. \"101-105\" or \"201,203&#34;)\n        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[53614,53675],"text":"\n          Bulk select (e.g. \"101-105\" or \"201,203&rdquo;)\n        "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useCallback, useMemo } from 'react';\nimport { useAuthStore } from '../store/authStore';\nimport { api } from '../lib/api';\nimport Layout from '../components/Layout';\nimport { Plus, Users, CheckCircle, XCircle, Clock } from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport { DashboardSkeleton } from '../components/LoadingSkeleton';\nimport SearchInput from '../components/SearchInput';\nimport { format } from 'date-fns';\nimport { useDebounce } from '../hooks/useDebounce';\nimport EmptyState from '../components/EmptyState';\n\ninterface GroupBooking {\n  id: string;\n  groupBookingNumber: string;\n  groupName?: string;\n  guestName: string;\n  guestEmail?: string;\n  guestPhone?: string;\n  checkInDate: Date;\n  checkOutDate: Date;\n  adults: number;\n  children: number;\n  totalRooms: number;\n  totalRate: number;\n  status: 'confirmed' | 'partially_checked_in' | 'checked_in' | 'partially_checked_out' | 'checked_out' | 'cancelled';\n  reservations: Array<{\n    id: string;\n    reservationNumber: string;\n    roomNumber?: string;\n    status: string;\n  }>;\n  createdAt?: Date;\n  updatedAt?: Date;\n}\n\n// Helper functions\nconst getStatusLabel = (status: string) => {\n  return status.split('_').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');\n};\n\nconst getStatusColor = (status: string) => {\n  switch (status) {\n    case 'confirmed':\n      return { bg: '#dbeafe', text: '#1e40af', icon: Clock };\n    case 'partially_checked_in':\n      return { bg: '#fef3c7', text: '#92400e', icon: Clock };\n    case 'checked_in':\n      return { bg: '#d1fae5', text: '#065f46', icon: CheckCircle };\n    case 'partially_checked_out':\n      return { bg: '#fef3c7', text: '#92400e', icon: Clock };\n    case 'checked_out':\n      return { bg: '#e0e7ff', text: '#3730a3', icon: CheckCircle };\n    case 'cancelled':\n      return { bg: '#fee2e2', text: '#991b1b', icon: XCircle };\n    default:\n      return { bg: '#f3f4f6', text: '#6b7280', icon: Clock };\n  }\n};\n\nconst getRoomEffectiveRate = (room: any): number | null => {\n  if (!room) return null;\n  if (room.effectiveRate !== undefined && room.effectiveRate !== null) {\n    return Number(room.effectiveRate);\n  }\n  if (room.customRate !== undefined && room.customRate !== null) {\n    return Number(room.customRate);\n  }\n  if (room.ratePlan?.baseRate !== undefined && room.ratePlan?.baseRate !== null) {\n    return Number(room.ratePlan.baseRate);\n  }\n  return null;\n};\n\ntype HallReservationForm = {\n  id: string;\n  hallId: string;\n  eventName: string;\n  purpose: string;\n  setupType: string;\n  attendeeCount: string;\n  startDateTime: string;\n  endDateTime: string;\n  cateringNotes: string;\n  avRequirements: string;\n  rate: string;\n};\n\nexport default function GroupBookingsPage() {\n  const { user } = useAuthStore();\n  const [groupBookings, setGroupBookings] = useState<GroupBooking[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState('');\n  const debouncedSearchTerm = useDebounce(searchTerm, 500);\n  const [statusFilter, setStatusFilter] = useState<string | null>(null);\n  const [selectedBooking, setSelectedBooking] = useState<GroupBooking | null>(null);\n  const [showDetailsModal, setShowDetailsModal] = useState(false);\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [processingActions, setProcessingActions] = useState<Set<string>>(new Set());\n\n  const fetchGroupBookings = useCallback(async () => {\n    if (!user?.tenantId) return;\n    setLoading(true);\n    try {\n      const params: any = {};\n      if (statusFilter) {\n        params.status = statusFilter;\n      }\n      const response = await api.get(`/tenants/${user.tenantId}/group-bookings`, { params });\n      setGroupBookings(response.data.data || []);\n    } catch (error: any) {\n      console.error('Failed to fetch group bookings:', error);\n      toast.error(error.response?.data?.error?.message || error.response?.data?.message || 'Failed to fetch group bookings');\n      setGroupBookings([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [user?.tenantId, statusFilter]);\n\n  useEffect(() => {\n    fetchGroupBookings();\n  }, [fetchGroupBookings]);\n\n  // Handle highlight from URL (e.g., from calendar navigation)\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    const highlightId = params.get('highlight');\n    if (highlightId && groupBookings.length > 0) {\n      const booking = groupBookings.find(b => b.id === highlightId);\n      if (booking) {\n        // Fetch and show details\n        (async () => {\n          try {\n            const response = await api.get(`/tenants/${user?.tenantId}/group-bookings/${booking.id}`);\n            setSelectedBooking(response.data.data);\n            setShowDetailsModal(true);\n            // Clean up URL\n            window.history.replaceState({}, '', window.location.pathname);\n          } catch (error: any) {\n            console.error('Failed to fetch group booking details:', error);\n          }\n        })();\n      }\n    }\n  }, [groupBookings, user?.tenantId]);\n\n  const handleCheckIn = async (bookingId: string) => {\n    setProcessingActions(prev => new Set(prev).add(bookingId));\n    try {\n      const response = await api.post(`/tenants/${user?.tenantId}/group-bookings/${bookingId}/checkin`);\n      toast.success(response.data.message);\n      fetchGroupBookings();\n      if (selectedBooking?.id === bookingId) {\n        setSelectedBooking(null);\n        setShowDetailsModal(false);\n      }\n    } catch (error: any) {\n      console.error('Failed to check in group booking:', error);\n      toast.error(error.response?.data?.error?.message || error.response?.data?.message || 'Failed to check in group booking');\n    } finally {\n      setProcessingActions(prev => {\n        const next = new Set(prev);\n        next.delete(bookingId);\n        return next;\n      });\n    }\n  };\n\n  const handleCheckOut = async (bookingId: string) => {\n    setProcessingActions(prev => new Set(prev).add(bookingId));\n    try {\n      const response = await api.post(`/tenants/${user?.tenantId}/group-bookings/${bookingId}/checkout`);\n      toast.success(response.data.message);\n      fetchGroupBookings();\n      if (selectedBooking?.id === bookingId) {\n        setSelectedBooking(null);\n        setShowDetailsModal(false);\n      }\n    } catch (error: any) {\n      console.error('Failed to check out group booking:', error);\n      toast.error(error.response?.data?.error?.message || error.response?.data?.message || 'Failed to check out group booking');\n    } finally {\n      setProcessingActions(prev => {\n        const next = new Set(prev);\n        next.delete(bookingId);\n        return next;\n      });\n    }\n  };\n\n  const handleCancel = async (bookingId: string) => {\n    if (!window.confirm('Are you sure you want to cancel this group booking? This will cancel all reservations in the group.')) {\n      return;\n    }\n\n    setProcessingActions(prev => new Set(prev).add(bookingId));\n    try {\n      await api.post(`/tenants/${user?.tenantId}/group-bookings/${bookingId}/cancel`);\n      toast.success('Group booking cancelled successfully');\n      fetchGroupBookings();\n      if (selectedBooking?.id === bookingId) {\n        setSelectedBooking(null);\n        setShowDetailsModal(false);\n      }\n    } catch (error: any) {\n      console.error('Failed to cancel group booking:', error);\n      toast.error(error.response?.data?.error?.message || error.response?.data?.message || 'Failed to cancel group booking');\n    } finally {\n      setProcessingActions(prev => {\n        const next = new Set(prev);\n        next.delete(bookingId);\n        return next;\n      });\n    }\n  };\n\n  const handleViewDetails = async (bookingId: string) => {\n    try {\n      const response = await api.get(`/tenants/${user?.tenantId}/group-bookings/${bookingId}`);\n      setSelectedBooking(response.data.data);\n      setShowDetailsModal(true);\n    } catch (error: any) {\n      console.error('Failed to fetch group booking details:', error);\n      toast.error(error.response?.data?.message || 'Failed to fetch group booking details');\n    }\n  };\n\n\n  const filteredBookings = useMemo(() => groupBookings.filter((booking) => {\n    if (!debouncedSearchTerm) return true;\n    const searchLower = debouncedSearchTerm.toLowerCase();\n    return (\n      booking.groupBookingNumber.toLowerCase().includes(searchLower) ||\n      booking.guestName.toLowerCase().includes(searchLower) ||\n      booking.guestEmail?.toLowerCase().includes(searchLower) ||\n      booking.guestPhone?.toLowerCase().includes(searchLower) ||\n      booking.groupName?.toLowerCase().includes(searchLower)\n    );\n  }), [groupBookings, debouncedSearchTerm]);\n\n  if (loading) {\n    return (\n      <Layout>\n        <div style={{ padding: '2rem' }}>\n          <DashboardSkeleton />\n        </div>\n      </Layout>\n    );\n  }\n\n  return (\n    <Layout>\n      <div style={{ maxWidth: '1400px', margin: '0 auto', padding: '2rem' }}>\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\n          <h1 style={{ fontSize: '2rem', fontWeight: 'bold', color: '#1e293b', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n            <Users size={28} />\n            Group Bookings\n          </h1>\n          <button\n            onClick={() => setShowCreateModal(true)}\n            style={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: '0.5rem',\n              padding: '0.75rem 1.5rem',\n              background: '#3b82f6',\n              color: 'white',\n              border: 'none',\n              borderRadius: '6px',\n              cursor: 'pointer',\n              fontWeight: '500',\n            }}\n          >\n            <Plus size={20} />\n            Create Group Booking\n          </button>\n        </div>\n\n        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1.5rem', flexWrap: 'wrap' }}>\n          <div style={{ flex: 1, minWidth: '300px' }}>\n            <SearchInput\n              placeholder=\"Search by booking number, guest name, email, or phone...\"\n              value={searchTerm}\n              onChange={(value) => setSearchTerm(value)}\n            />\n          </div>\n          <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>\n            <button\n              onClick={() => setStatusFilter(null)}\n              style={{\n                padding: '0.5rem 1rem',\n                border: '1px solid #e2e8f0',\n                borderRadius: '6px',\n                background: statusFilter === null ? '#3b82f6' : 'white',\n                color: statusFilter === null ? 'white' : '#64748b',\n                cursor: 'pointer',\n              }}\n            >\n              All\n            </button>\n            {['confirmed', 'checked_in', 'checked_out', 'cancelled'].map((status) => (\n              <button\n                key={status}\n                onClick={() => setStatusFilter(statusFilter === status ? null : status)}\n                style={{\n                  padding: '0.5rem 1rem',\n                  border: '1px solid #e2e8f0',\n                  borderRadius: '6px',\n                  background: statusFilter === status ? '#3b82f6' : 'white',\n                  color: statusFilter === status ? 'white' : '#64748b',\n                  cursor: 'pointer',\n                }}\n              >\n                {getStatusLabel(status)}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {!loading && filteredBookings.length === 0 ? (\n          <EmptyState\n            icon={Users}\n            title={searchTerm || statusFilter ? 'No group bookings match your filters' : 'No group bookings yet'}\n            description={searchTerm || statusFilter\n              ? 'Try adjusting your search or filter criteria'\n              : 'Create your first group booking to get started'}\n            action={searchTerm || statusFilter ? undefined : {\n              label: 'Create Group Booking',\n              onClick: () => setShowCreateModal(true),\n            }}\n          />\n        ) : filteredBookings.length > 0 ? (\n          <div style={{ display: 'grid', gap: '1rem' }}>\n            {filteredBookings.map((booking: GroupBooking) => {\n              const statusStyle = getStatusColor(booking.status);\n              const StatusIcon = statusStyle.icon;\n\n              return (\n                <div\n                  key={booking.id}\n                  style={{\n                    background: 'white',\n                    border: '1px solid #e2e8f0',\n                    borderRadius: '8px',\n                    padding: '1.5rem',\n                    boxShadow: '0 2px 4px rgba(0,0,0,0.05)',\n                    cursor: 'pointer',\n                    transition: 'all 0.2s',\n                  }}\n                  onClick={() => handleViewDetails(booking.id)}\n                  onMouseEnter={(e) => {\n                    e.currentTarget.style.boxShadow = '0 4px 8px rgba(0,0,0,0.1)';\n                    e.currentTarget.style.transform = 'translateY(-2px)';\n                  }}\n                  onMouseLeave={(e) => {\n                    e.currentTarget.style.boxShadow = '0 2px 4px rgba(0,0,0,0.05)';\n                    e.currentTarget.style.transform = 'translateY(0)';\n                  }}\n                >\n                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1rem' }}>\n                    <div style={{ flex: 1 }}>\n                      <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '0.5rem' }}>\n                        <h3 style={{ margin: 0, fontSize: '1.25rem', fontWeight: '600', color: '#1e293b' }}>\n                          {booking.groupName || booking.guestName}\n                        </h3>\n                        <span\n                          style={{\n                            padding: '0.25rem 0.75rem',\n                            borderRadius: '12px',\n                            fontSize: '0.75rem',\n                            fontWeight: '500',\n                            background: statusStyle.bg,\n                            color: statusStyle.text,\n                            display: 'flex',\n                            alignItems: 'center',\n                            gap: '0.25rem',\n                          }}\n                        >\n                          <StatusIcon size={12} />\n                          {getStatusLabel(booking.status)}\n                        </span>\n                      </div>\n                      <p style={{ margin: 0, color: '#64748b', fontSize: '0.875rem' }}>\n                        {booking.groupBookingNumber}\n                      </p>\n                    </div>\n                    <div style={{ textAlign: 'right' }}>\n                      <p style={{ margin: 0, fontSize: '1.5rem', fontWeight: '700', color: '#1e293b' }}>\n                        {booking.totalRate.toLocaleString()}\n                      </p>\n                      <p style={{ margin: '0.25rem 0 0', color: '#64748b', fontSize: '0.875rem' }}>\n                        {booking.totalRooms} room{booking.totalRooms !== 1 ? 's' : ''}\n                      </p>\n                    </div>\n                  </div>\n\n                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem', marginBottom: '1rem', paddingTop: '1rem', borderTop: '1px solid #e2e8f0' }}>\n                    <div>\n                      <p style={{ margin: 0, fontSize: '0.75rem', color: '#64748b', textTransform: 'uppercase' }}>Guest</p>\n                      <p style={{ margin: '0.25rem 0 0', fontWeight: '500', color: '#1e293b' }}>{booking.guestName}</p>\n                      {booking.guestEmail && (\n                        <p style={{ margin: '0.25rem 0 0', fontSize: '0.875rem', color: '#64748b' }}>{booking.guestEmail}</p>\n                      )}\n                    </div>\n                    <div>\n                      <p style={{ margin: 0, fontSize: '0.75rem', color: '#64748b', textTransform: 'uppercase' }}>Check-In</p>\n                      <p style={{ margin: '0.25rem 0 0', fontWeight: '500', color: '#1e293b' }}>\n                        {format(new Date(booking.checkInDate), 'MMM dd, yyyy')}\n                      </p>\n                    </div>\n                    <div>\n                      <p style={{ margin: 0, fontSize: '0.75rem', color: '#64748b', textTransform: 'uppercase' }}>Check-Out</p>\n                      <p style={{ margin: '0.25rem 0 0', fontWeight: '500', color: '#1e293b' }}>\n                        {format(new Date(booking.checkOutDate), 'MMM dd, yyyy')}\n                      </p>\n                    </div>\n                    <div>\n                      <p style={{ margin: 0, fontSize: '0.75rem', color: '#64748b', textTransform: 'uppercase' }}>Guests</p>\n                      <p style={{ margin: '0.25rem 0 0', fontWeight: '500', color: '#1e293b' }}>\n                        {booking.adults} Adult{booking.adults !== 1 ? 's' : ''}\n                        {booking.children > 0 && `, ${booking.children} Child${booking.children !== 1 ? 'ren' : ''}`}\n                      </p>\n                    </div>\n                  </div>\n\n                  <div style={{ display: 'flex', gap: '0.5rem', paddingTop: '1rem', borderTop: '1px solid #e2e8f0' }}>\n                    {booking.reservations.slice(0, 5).map((res: { id: string; reservationNumber: string; roomNumber?: string; status: string }) => (\n                      <span\n                        key={res.id}\n                        style={{\n                          padding: '0.25rem 0.75rem',\n                          background: '#f1f5f9',\n                          borderRadius: '4px',\n                          fontSize: '0.875rem',\n                          color: '#475569',\n                        }}\n                      >\n                        {res.roomNumber || res.reservationNumber}\n                      </span>\n                    ))}\n                    {booking.reservations.length > 5 && (\n                      <span\n                        style={{\n                          padding: '0.25rem 0.75rem',\n                          background: '#f1f5f9',\n                          borderRadius: '4px',\n                          fontSize: '0.875rem',\n                          color: '#475569',\n                        }}\n                      >\n                        +{booking.reservations.length - 5} more\n                      </span>\n                    )}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        ) : null}\n\n        {/* Details Modal */}\n        {showDetailsModal && selectedBooking && (\n          <GroupBookingDetailsModal\n            booking={selectedBooking}\n            onClose={() => {\n              setShowDetailsModal(false);\n              setSelectedBooking(null);\n            }}\n            onCheckIn={handleCheckIn}\n            onCheckOut={handleCheckOut}\n            onCancel={handleCancel}\n            tenantId={user?.tenantId || ''}\n            isProcessing={processingActions.has(selectedBooking.id)}\n          />\n        )}\n\n        {/* Create Modal - Will be implemented next */}\n        {showCreateModal && (\n          <CreateGroupBookingModal\n            onClose={() => setShowCreateModal(false)}\n            onSuccess={() => {\n              setShowCreateModal(false);\n              fetchGroupBookings();\n            }}\n            tenantId={user?.tenantId || ''}\n          />\n        )}\n      </div>\n    </Layout>\n  );\n}\n\n// Details Modal Component\nfunction GroupBookingDetailsModal({\n  booking,\n  onClose,\n  onCheckIn,\n  onCheckOut,\n  onCancel,\n  tenantId,\n  isProcessing = false,\n}: {\n  booking: GroupBooking;\n  onClose: () => void;\n  onCheckIn: (id: string) => void;\n  onCheckOut: (id: string) => void;\n  onCancel: (id: string) => void;\n  tenantId: string;\n  isProcessing?: boolean;\n}) {\n  const [details, setDetails] = useState<any>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    fetchDetails();\n  }, [booking.id, tenantId]);\n\n  const fetchDetails = async () => {\n    try {\n      setLoading(true);\n      const response = await api.get(`/tenants/${tenantId}/group-bookings/${booking.id}`);\n      setDetails(response.data.data);\n    } catch (error: any) {\n      console.error('Failed to fetch details:', error);\n      toast.error(error.response?.data?.message || 'Failed to fetch details');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const statusStyle = getStatusColor(booking.status);\n  const StatusIcon = statusStyle.icon;\n\n  return (\n    <div\n      className=\"group-booking-modal-overlay\"\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        background: 'rgba(0,0,0,0.5)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 1000,\n        padding: '1rem',\n      }}\n      onClick={onClose}\n    >\n      <div\n        style={{\n          background: 'white',\n          borderRadius: '8px',\n          padding: '2rem',\n          width: '90%',\n          maxWidth: '900px',\n          maxHeight: '90vh',\n          overflow: 'auto',\n        }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\n          <h2 style={{ margin: 0, fontSize: '1.5rem', fontWeight: '600', color: '#1e293b' }}>\n            Group Booking Details\n          </h2>\n          <button\n            onClick={onClose}\n            style={{\n              background: 'none',\n              border: 'none',\n              cursor: 'pointer',\n              padding: '0.5rem',\n              display: 'flex',\n              alignItems: 'center',\n            }}\n          >\n            <XCircle size={24} color=\"#64748b\" />\n          </button>\n        </div>\n\n        {loading ? (\n          <div style={{ textAlign: 'center', padding: '2rem' }}>Loading...</div>\n        ) : details ? (\n          <>\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', gap: '1rem', marginBottom: '2rem' }}>\n              <div>\n                <p style={{ margin: 0, fontSize: '0.75rem', color: '#64748b', textTransform: 'uppercase' }}>Booking Number</p>\n                <p style={{ margin: '0.25rem 0 0', fontWeight: '600', color: '#1e293b' }}>{details.groupBookingNumber}</p>\n              </div>\n              <div>\n                <p style={{ margin: 0, fontSize: '0.75rem', color: '#64748b', textTransform: 'uppercase' }}>Status</p>\n                <span\n                  style={{\n                    display: 'inline-flex',\n                    alignItems: 'center',\n                    gap: '0.25rem',\n                    marginTop: '0.25rem',\n                    padding: '0.25rem 0.75rem',\n                    borderRadius: '12px',\n                    fontSize: '0.875rem',\n                    fontWeight: '500',\n                    background: statusStyle.bg,\n                    color: statusStyle.text,\n                  }}\n                >\n                  <StatusIcon size={14} />\n                  {getStatusLabel(details.status)}\n                </span>\n              </div>\n              <div>\n                <p style={{ margin: 0, fontSize: '0.75rem', color: '#64748b', textTransform: 'uppercase' }}>Total Rate</p>\n                <p style={{ margin: '0.25rem 0 0', fontWeight: '600', color: '#1e293b', fontSize: '1.25rem' }}>\n                  {details.totalRate?.toLocaleString() || 0}\n                </p>\n              </div>\n              <div>\n                <p style={{ margin: 0, fontSize: '0.75rem', color: '#64748b', textTransform: 'uppercase' }}>Total Rooms</p>\n                <p style={{ margin: '0.25rem 0 0', fontWeight: '600', color: '#1e293b' }}>{details.totalRooms}</p>\n              </div>\n            </div>\n\n            <div style={{ marginBottom: '2rem' }}>\n              <h3 style={{ margin: '0 0 1rem', fontSize: '1.1rem', fontWeight: '600', color: '#1e293b' }}>Guest Information</h3>\n              <div style={{ background: '#f8f9fa', padding: '1rem', borderRadius: '6px' }}>\n                <p style={{ margin: '0 0 0.5rem', fontWeight: '500', color: '#1e293b' }}>{details.guestName}</p>\n                {details.guestEmail && <p style={{ margin: '0 0 0.25rem', color: '#64748b' }}>Email: {details.guestEmail}</p>}\n                {details.guestPhone && <p style={{ margin: 0, color: '#64748b' }}>Phone: {details.guestPhone}</p>}\n              </div>\n            </div>\n\n            <div style={{ marginBottom: '2rem' }}>\n              <h3 style={{ margin: '0 0 1rem', fontSize: '1.1rem', fontWeight: '600', color: '#1e293b' }}>Reservations</h3>\n              <div style={{ display: 'grid', gap: '0.75rem' }}>\n                {details.reservations?.map((res: any) => (\n                  <div\n                    key={res.id}\n                    style={{\n                      display: 'flex',\n                      justifyContent: 'space-between',\n                      alignItems: 'center',\n                      padding: '1rem',\n                      background: '#f8f9fa',\n                      borderRadius: '6px',\n                    }}\n                  >\n                    <div>\n                      <p style={{ margin: 0, fontWeight: '500', color: '#1e293b' }}>\n                        {res.room?.roomNumber || 'Room N/A'}\n                      </p>\n                      <p style={{ margin: '0.25rem 0 0', fontSize: '0.875rem', color: '#64748b' }}>\n                        {res.reservationNumber}\n                      </p>\n                    </div>\n                    <div style={{ textAlign: 'right' }}>\n                      <p style={{ margin: 0, fontWeight: '600', color: '#1e293b' }}>{res.rate?.toLocaleString() || 0}</p>\n                      <span\n                        style={{\n                          display: 'inline-block',\n                          marginTop: '0.25rem',\n                          padding: '0.125rem 0.5rem',\n                          borderRadius: '4px',\n                          fontSize: '0.75rem',\n                          background: res.status === 'checked_in' ? '#d1fae5' : res.status === 'checked_out' ? '#e0e7ff' : '#dbeafe',\n                          color: res.status === 'checked_in' ? '#065f46' : res.status === 'checked_out' ? '#3730a3' : '#1e40af',\n                        }}\n                      >\n                        {res.status}\n                      </span>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n\n            <div style={{ display: 'flex', gap: '0.75rem', paddingTop: '1.5rem', borderTop: '1px solid #e2e8f0' }}>\n              {details.status === 'confirmed' || details.status === 'partially_checked_in' ? (\n                <button\n                  onClick={() => onCheckIn(details.id)}\n                  disabled={isProcessing}\n                  style={{\n                    flex: 1,\n                    padding: '0.75rem',\n                    background: '#10b981',\n                    color: 'white',\n                    border: 'none',\n                    borderRadius: '6px',\n                    cursor: isProcessing ? 'not-allowed' : 'pointer',\n                    fontWeight: '500',\n                    opacity: isProcessing ? 0.6 : 1,\n                  }}\n                >\n                  {isProcessing ? 'Processing...' : 'Check In All Rooms'}\n                </button>\n              ) : null}\n              {details.status === 'checked_in' || details.status === 'partially_checked_out' ? (\n                <button\n                  onClick={() => onCheckOut(details.id)}\n                  disabled={isProcessing}\n                  style={{\n                    flex: 1,\n                    padding: '0.75rem',\n                    background: '#3b82f6',\n                    color: 'white',\n                    border: 'none',\n                    borderRadius: '6px',\n                    cursor: isProcessing ? 'not-allowed' : 'pointer',\n                    fontWeight: '500',\n                    opacity: isProcessing ? 0.6 : 1,\n                  }}\n                >\n                  {isProcessing ? 'Processing...' : 'Check Out All Rooms'}\n                </button>\n              ) : null}\n              {details.status !== 'cancelled' && details.status !== 'checked_out' ? (\n                <button\n                  onClick={() => onCancel(details.id)}\n                  disabled={isProcessing}\n                  style={{\n                    padding: '0.75rem 1.5rem',\n                    background: 'white',\n                    color: '#ef4444',\n                    border: '1px solid #fee2e2',\n                    borderRadius: '6px',\n                    cursor: isProcessing ? 'not-allowed' : 'pointer',\n                    fontWeight: '500',\n                    opacity: isProcessing ? 0.6 : 1,\n                  }}\n                >\n                  {isProcessing ? 'Processing...' : 'Cancel'}\n                </button>\n              ) : null}\n            </div>\n          </>\n        ) : null}\n      </div>\n    </div>\n  );\n}\n\n\n// Create Group Booking Modal\nfunction CreateGroupBookingModal({\n  onClose,\n  onSuccess,\n  tenantId,\n}: {\n  onClose: () => void;\n  onSuccess: () => void;\n  tenantId: string;\n}) {\n  const [availableRooms, setAvailableRooms] = useState<any[]>([]);\n  const [categories, setCategories] = useState<any[]>([]);\n  const [meetingHalls, setMeetingHalls] = useState<any[]>([]);\n  const [selectedRooms, setSelectedRooms] = useState<Set<string>>(new Set());\n  const [roomRates, setRoomRates] = useState<Record<string, number>>({});\n  const [checkingAvailability, setCheckingAvailability] = useState(false);\n  const [availabilityError, setAvailabilityError] = useState<string | null>(null);\n  const [roomSearch, setRoomSearch] = useState('');\n  const [categoryFilter, setCategoryFilter] = useState('all');\n  const [bulkSelectionInput, setBulkSelectionInput] = useState('');\n  const [bulkSelectionError, setBulkSelectionError] = useState<string | null>(null);\n  const [unavailableRooms, setUnavailableRooms] = useState<Set<string>>(new Set());\n  const [hallReservations, setHallReservations] = useState<HallReservationForm[]>([]);\n  const [includeHall, setIncludeHall] = useState(false);\n  const [currentStep, setCurrentStep] = useState(0);\n  const [submitting, setSubmitting] = useState(false);\n  const steps = ['Guest Details', 'Stay Details', 'Rooms', 'Hall Booking', 'Invoice'];\n  const [formData, setFormData] = useState({\n    groupName: '',\n    guestName: '',\n    guestEmail: '',\n    guestPhone: '',\n    guestAddress: '',\n    guestIdNumber: '',\n    checkInDate: '',\n    checkOutDate: '',\n    adults: 1,\n    children: 0,\n    specialRequests: '',\n  });\n\n  const generateTempId = () => Math.random().toString(36).substring(2, 9);\n\n  useEffect(() => {\n    if (!tenantId) return;\n    fetchCategories();\n    fetchMeetingHalls();\n  }, [tenantId]);\n\n  useEffect(() => {\n    if (!tenantId) return;\n    if (!formData.checkInDate || !formData.checkOutDate) {\n      setAvailableRooms([]);\n      setSelectedRooms(new Set());\n      setRoomRates({});\n      setAvailabilityError(null);\n      return;\n    }\n    const checkIn = new Date(formData.checkInDate);\n    const checkOut = new Date(formData.checkOutDate);\n    if (Number.isNaN(checkIn.getTime()) || Number.isNaN(checkOut.getTime())) {\n      setAvailabilityError('Select a valid check-in and check-out date');\n      return;\n    }\n    if (checkOut <= checkIn) {\n      setAvailabilityError('Check-out must be after check-in');\n      return;\n    }\n    fetchAvailability(checkIn, checkOut);\n  }, [formData.checkInDate, formData.checkOutDate, formData.adults, formData.children, tenantId]);\n\n  useEffect(() => {\n    if (includeHall && hallReservations.length === 0 && meetingHalls.length > 0) {\n      setHallReservations([\n        {\n          id: generateTempId(),\n          hallId: meetingHalls[0]?.id || '',\n          eventName: '',\n          purpose: '',\n          setupType: '',\n          attendeeCount: '',\n          startDateTime: '',\n          endDateTime: '',\n          cateringNotes: '',\n          avRequirements: '',\n          rate: '',\n        },\n      ]);\n    }\n    if (!includeHall) {\n      setHallReservations([]);\n    }\n  }, [includeHall, meetingHalls]);\n\n  const fetchCategories = async () => {\n    try {\n      const response = await api.get(`/tenants/${tenantId}/room-categories`);\n      setCategories(response.data.data || []);\n    } catch (error) {\n      console.error('Failed to fetch categories:', error);\n      toast.error('Unable to load room categories');\n    }\n  };\n\n  const fetchMeetingHalls = async () => {\n    try {\n      const response = await api.get(`/tenants/${tenantId}/group-bookings/meeting-halls`);\n      setMeetingHalls(response.data.data || []);\n    } catch (error) {\n      console.error('Failed to load meeting halls:', error);\n      toast.error('Unable to load meeting halls');\n    }\n  };\n\n  const fetchAvailability = async (checkIn: Date, checkOut: Date) => {\n    setCheckingAvailability(true);\n    setAvailabilityError(null);\n    setBulkSelectionError(null);\n    setUnavailableRooms(new Set());\n\n    try {\n      const response = await api.get(`/tenants/${tenantId}/reservations/availability`, {\n        params: {\n          startDate: checkIn.toISOString(),\n          endDate: checkOut.toISOString(),\n          minOccupancy: Math.max(1, (formData.adults || 0) + (formData.children || 0)),\n        },\n      });\n      const rooms = response.data.data?.availableRooms || [];\n      setAvailableRooms(rooms);\n      setSelectedRooms((prev) => {\n        const next = new Set(prev);\n        const validIds = new Set(rooms.map((room: any) => room.id));\n        Array.from(next).forEach((roomId) => {\n          if (!validIds.has(roomId)) {\n            next.delete(roomId);\n          }\n        });\n        return next;\n      });\n      setRoomRates((prev) => {\n        const updated: Record<string, number> = {};\n        rooms.forEach((room: any) => {\n          const effectiveRate = getRoomEffectiveRate(room);\n          if (effectiveRate !== null) {\n            updated[room.id] = prev[room.id] ?? effectiveRate;\n          }\n        });\n        return updated;\n      });\n    } catch (error) {\n      console.error('Failed to load availability:', error);\n      setAvailabilityError('Unable to load availability for the selected dates');\n      setAvailableRooms([]);\n      setSelectedRooms(new Set());\n    } finally {\n      setCheckingAvailability(false);\n    }\n  };\n\n  const parseBulkSelection = (input: string): string[] => {\n    const roomNumbers: string[] = [];\n    const parts = input.split(',').map((part) => part.trim()).filter(Boolean);\n    parts.forEach((part) => {\n      if (part.includes('-')) {\n        const [startRaw, endRaw] = part.split('-');\n        const start = parseInt(startRaw.trim(), 10);\n        const end = parseInt(endRaw.trim(), 10);\n        if (Number.isNaN(start) || Number.isNaN(end)) {\n          throw new Error(`Invalid range \"${part}\"`);\n        }\n        if (start > end) {\n          throw new Error(`Range start (${start}) must be <= end (${end})`);\n        }\n        for (let i = start; i <= end; i += 1) {\n          roomNumbers.push(String(i));\n        }\n      } else {\n        const num = parseInt(part, 10);\n        if (Number.isNaN(num)) {\n          throw new Error(`Invalid room number \"${part}\"`);\n        }\n        roomNumbers.push(String(num));\n      }\n    });\n    return roomNumbers;\n  };\n\n  const handleBulkSelection = () => {\n    if (!bulkSelectionInput.trim()) {\n      setBulkSelectionError('Enter room numbers to add');\n      return;\n    }\n    try {\n      const numbers = parseBulkSelection(bulkSelectionInput);\n      const nextSelected = new Set(selectedRooms);\n      const notFound = new Set<string>();\n      numbers.forEach((roomNumber) => {\n        const match = availableRooms.find(\n          (room: any) => (room.roomNumber || '').toString() === roomNumber.toString()\n        );\n        if (match) {\n          nextSelected.add(match.id);\n        } else {\n          notFound.add(roomNumber);\n        }\n      });\n      setSelectedRooms(nextSelected);\n      setUnavailableRooms(notFound);\n      if (notFound.size > 0) {\n        setBulkSelectionError(`Rooms unavailable: ${Array.from(notFound).join(', ')}`);\n      } else {\n        setBulkSelectionError(null);\n        setBulkSelectionInput('');\n        toast.success(`Added ${numbers.length} room${numbers.length === 1 ? '' : 's'}`);\n      }\n    } catch (error: any) {\n      setBulkSelectionError(error.message || 'Invalid format');\n    }\n  };\n\n  const toggleRoomSelection = (roomId: string) => {\n    setSelectedRooms((prev) => {\n      const next = new Set(prev);\n      if (next.has(roomId)) {\n        next.delete(roomId);\n      } else {\n        next.add(roomId);\n      }\n      return next;\n    });\n  };\n\n  const handleCategorySelectAll = (rooms: any[]) => {\n    setSelectedRooms((prev) => {\n      const next = new Set(prev);\n      rooms.forEach((room) => next.add(room.id));\n      return next;\n    });\n  };\n\n  const handleCategoryClear = (rooms: any[]) => {\n    setSelectedRooms((prev) => {\n      const next = new Set(prev);\n      rooms.forEach((room) => next.delete(room.id));\n      return next;\n    });\n  };\n\n  const filteredRooms = availableRooms.filter((room) => {\n    const matchesCategory =\n      categoryFilter === 'all'\n        ? true\n        : categoryFilter === 'none'\n          ? !room.categoryId\n          : room.categoryId === categoryFilter;\n    if (!matchesCategory) return false;\n    if (!roomSearch.trim()) return true;\n    const query = roomSearch.toLowerCase();\n    return (\n      (room.roomNumber || '').toLowerCase().includes(query) ||\n      (room.roomType || '').toLowerCase().includes(query) ||\n      (room.category?.name || '').toLowerCase().includes(query)\n    );\n  });\n\n  const roomsByCategory = Object.values(\n    filteredRooms.reduce<Record<string, { id: string; name: string; rooms: any[] }>>((acc, room) => {\n      const key = room.category?.id || 'uncategorized';\n      if (!acc[key]) {\n        acc[key] = {\n          id: key,\n          name: room.category?.name || 'Uncategorized',\n          rooms: [],\n        };\n      }\n      acc[key].rooms.push(room);\n      return acc;\n    }, {})\n  ).sort((a, b) => a.name.localeCompare(b.name));\n\n  const hallTotal = hallReservations.reduce((sum, hall) => sum + (Number(hall.rate) || 0), 0);\n  const nights = (() => {\n    if (!formData.checkInDate || !formData.checkOutDate) return 0;\n    const start = new Date(formData.checkInDate);\n    const end = new Date(formData.checkOutDate);\n    if (Number.isNaN(start.getTime()) || Number.isNaN(end.getTime())) return 0;\n    const diff = end.getTime() - start.getTime();\n    if (diff <= 0) return 0;\n    return Math.ceil(diff / (1000 * 60 * 60 * 24));\n  })();\n\n  const nightMultiplier = Math.max(nights, 1);\n  const roomSubtotal = Array.from(selectedRooms).reduce(\n    (sum, roomId) => sum + (roomRates[roomId] || 0) * nightMultiplier,\n    0\n  );\n  const invoiceTotal = roomSubtotal + hallTotal;\n\n  const validateHallReservations = () => {\n    if (!includeHall) return true;\n    if (hallReservations.length === 0) return false;\n    return hallReservations.every((reservation) => {\n      if (!reservation.hallId || !reservation.startDateTime || !reservation.endDateTime) return false;\n      const start = new Date(reservation.startDateTime);\n      const end = new Date(reservation.endDateTime);\n      if (Number.isNaN(start.getTime()) || Number.isNaN(end.getTime()) || end <= start) return false;\n      return Number(reservation.rate) > 0;\n    });\n  };\n\n  const validateStep = (stepIndex: number) => {\n    switch (stepIndex) {\n      case 0:\n        return (\n          formData.guestName.trim().length > 1 &&\n          formData.guestEmail.trim().length > 3 &&\n          formData.guestPhone.trim().length > 3 &&\n          formData.guestAddress.trim().length > 3\n        );\n      case 1: {\n        if (!formData.checkInDate || !formData.checkOutDate) return false;\n        const start = new Date(formData.checkInDate);\n        const end = new Date(formData.checkOutDate);\n        return end > start && !availabilityError && availableRooms.length >= 0;\n      }\n      case 2:\n        return selectedRooms.size > 0;\n      case 3:\n        return validateHallReservations();\n      case 4:\n        return selectedRooms.size > 0 && (!includeHall || validateHallReservations());\n      default:\n        return true;\n    }\n  };\n\n  const canProceed = validateStep(currentStep);\n\n  const goToNextStep = () => {\n    if (!canProceed) {\n      toast.error('Please complete the required fields before continuing');\n      return;\n    }\n    setCurrentStep((prev) => Math.min(prev + 1, steps.length - 1));\n  };\n\n  const goToPreviousStep = () => {\n    setCurrentStep((prev) => Math.max(prev - 1, 0));\n  };\n\n  const handleHallChange = (index: number, field: keyof HallReservationForm, value: string) => {\n    setHallReservations((prev) => {\n      const next = [...prev];\n      next[index] = { ...next[index], [field]: value };\n      return next;\n    });\n  };\n\n  const addHallReservation = () => {\n    setHallReservations((prev) => [\n      ...prev,\n      {\n        id: generateTempId(),\n        hallId: meetingHalls[0]?.id || '',\n        eventName: '',\n        purpose: '',\n        setupType: '',\n        attendeeCount: '',\n        startDateTime: '',\n        endDateTime: '',\n        cateringNotes: '',\n        avRequirements: '',\n        rate: '',\n      },\n    ]);\n  };\n\n  const removeHallReservation = (id: string) => {\n    setHallReservations((prev) => prev.filter((reservation) => reservation.id !== id));\n  };\n\n  const selectedRoomDetails = Array.from(selectedRooms)\n    .map((roomId) => availableRooms.find((room) => room.id === roomId))\n    .filter(Boolean);\n\n  const formatCurrency = (value: number) => `${Number(value).toLocaleString()}`;\n\n  const handleSubmit = async () => {\n    if (!validateStep(steps.length - 1)) {\n      toast.error('Please complete required details before submitting');\n      return;\n    }\n    if (!tenantId) {\n      toast.error('Tenant not found');\n      return;\n    }\n    const checkIn = new Date(formData.checkInDate);\n    const checkOut = new Date(formData.checkOutDate);\n    if (Number.isNaN(checkIn.getTime()) || Number.isNaN(checkOut.getTime())) {\n      toast.error('Select valid dates');\n      return;\n    }\n    const roomIdArray = Array.from(selectedRooms);\n    if (roomIdArray.length === 0) {\n      toast.error('Select at least one room');\n      return;\n    }\n    setSubmitting(true);\n    try {\n      const rates: Record<string, number> = {};\n      roomIdArray.forEach((roomId) => {\n        rates[roomId] = roomRates[roomId] || 0;\n      });\n      const hallNotes =\n        includeHall && hallReservations.length > 0\n          ? hallReservations\n              .map((reservation, index) => {\n                const hallName = meetingHalls.find((hall) => hall.id === reservation.hallId)?.name || 'Hall';\n                return `Hall ${index + 1}: ${hallName} (${reservation.startDateTime} - ${\n                  reservation.endDateTime\n                })  ${formatCurrency(Number(reservation.rate) || 0)}`;\n              })\n              .join('\\n')\n          : '';\n      const addressNote = formData.guestAddress ? `Guest address: ${formData.guestAddress.trim()}` : '';\n      const combinedRequests = [addressNote, hallNotes, formData.specialRequests.trim()]\n        .filter(Boolean)\n        .join('\\n\\n');\n\n      await api.post(`/tenants/${tenantId}/group-bookings`, {\n        roomIds: roomIdArray,\n        groupName: formData.groupName || undefined,\n        guestName: formData.guestName.trim(),\n        guestEmail: formData.guestEmail.trim() || undefined,\n        guestPhone: formData.guestPhone.trim() || undefined,\n        guestIdNumber: formData.guestIdNumber.trim() || undefined,\n        checkInDate: checkIn.toISOString(),\n        checkOutDate: checkOut.toISOString(),\n        adults: formData.adults,\n        children: formData.children,\n        rates,\n        specialRequests: combinedRequests || undefined,\n        hallReservations: includeHall ? hallReservations : undefined,\n      });\n      toast.success('Group booking created successfully');\n      onSuccess();\n    } catch (error: any) {\n      console.error('Failed to create group booking:', error);\n      toast.error(error.response?.data?.message || 'Unable to create group booking');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const renderGuestStep = () => (\n    <div style={{ display: 'grid', gap: '1rem' }}>\n      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(220px, 1fr))', gap: '1rem' }}>\n        <div>\n          <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>Group Name</label>\n          <input\n            type=\"text\"\n            value={formData.groupName}\n            onChange={(e) => setFormData({ ...formData, groupName: e.target.value })}\n            placeholder=\"Corporate Retreat, Family Reunion...\"\n            style={{\n              width: '100%',\n              padding: '0.75rem',\n              borderRadius: '8px',\n              border: '1px solid #cbd5e1',\n            }}\n          />\n        </div>\n        <div>\n          <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>\n            Guest Name *\n          </label>\n          <input\n            type=\"text\"\n            value={formData.guestName}\n            onChange={(e) => setFormData({ ...formData, guestName: e.target.value })}\n            required\n            style={{\n              width: '100%',\n              padding: '0.75rem',\n              borderRadius: '8px',\n              border: '1px solid #cbd5e1',\n            }}\n          />\n        </div>\n        <div>\n          <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>\n            Email *\n          </label>\n          <input\n            type=\"email\"\n            value={formData.guestEmail}\n            onChange={(e) => setFormData({ ...formData, guestEmail: e.target.value })}\n            required\n            style={{\n              width: '100%',\n              padding: '0.75rem',\n              borderRadius: '8px',\n              border: '1px solid #cbd5e1',\n            }}\n          />\n        </div>\n        <div>\n          <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>\n            Phone *\n          </label>\n          <input\n            type=\"tel\"\n            value={formData.guestPhone}\n            onChange={(e) => setFormData({ ...formData, guestPhone: e.target.value })}\n            required\n            style={{\n              width: '100%',\n              padding: '0.75rem',\n              borderRadius: '8px',\n              border: '1px solid #cbd5e1',\n            }}\n          />\n        </div>\n      </div>\n      <div>\n        <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>\n          Address *\n        </label>\n        <textarea\n          value={formData.guestAddress}\n          onChange={(e) => setFormData({ ...formData, guestAddress: e.target.value })}\n          rows={3}\n          placeholder=\"Street, City, State\"\n          style={{\n            width: '100%',\n            padding: '0.75rem',\n            borderRadius: '8px',\n            border: '1px solid #cbd5e1',\n            resize: 'vertical',\n          }}\n          required\n        />\n      </div>\n    </div>\n  );\n\n  const renderStayStep = () => (\n    <div style={{ display: 'grid', gap: '1rem' }}>\n      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(220px, 1fr))', gap: '1rem' }}>\n        <div>\n          <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>\n            Check-in *\n          </label>\n          <input\n            type=\"date\"\n            value={formData.checkInDate}\n            onChange={(e) => setFormData({ ...formData, checkInDate: e.target.value })}\n            style={{\n              width: '100%',\n              padding: '0.75rem',\n              border: '1px solid #cbd5e1',\n              borderRadius: '8px',\n            }}\n          />\n        </div>\n        <div>\n          <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>\n            Check-out *\n          </label>\n          <input\n            type=\"date\"\n            value={formData.checkOutDate}\n            onChange={(e) => setFormData({ ...formData, checkOutDate: e.target.value })}\n            style={{\n              width: '100%',\n              padding: '0.75rem',\n              border: '1px solid #cbd5e1',\n              borderRadius: '8px',\n            }}\n          />\n        </div>\n        <div>\n          <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>\n            Adults *\n          </label>\n          <input\n            type=\"number\"\n            min={1}\n            value={formData.adults}\n            onChange={(e) => setFormData({ ...formData, adults: Math.max(1, parseInt(e.target.value || '0', 10)) })}\n            style={{\n              width: '100%',\n              padding: '0.75rem',\n              border: '1px solid #cbd5e1',\n              borderRadius: '8px',\n            }}\n          />\n        </div>\n        <div>\n          <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>\n            Children\n          </label>\n          <input\n            type=\"number\"\n            min={0}\n            value={formData.children}\n            onChange={(e) => setFormData({ ...formData, children: Math.max(0, parseInt(e.target.value || '0', 10)) })}\n            style={{\n              width: '100%',\n              padding: '0.75rem',\n              border: '1px solid #cbd5e1',\n              borderRadius: '8px',\n            }}\n          />\n        </div>\n      </div>\n      <div>\n        <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>Special Notes</label>\n        <textarea\n          value={formData.specialRequests}\n          onChange={(e) => setFormData({ ...formData, specialRequests: e.target.value })}\n          rows={3}\n          placeholder=\"Dietary needs, arrival info...\"\n          style={{\n            width: '100%',\n            padding: '0.75rem',\n            borderRadius: '8px',\n            border: '1px solid #cbd5e1',\n            resize: 'vertical',\n          }}\n        />\n      </div>\n      <div\n        style={{\n          border: '1px solid #e2e8f0',\n          borderRadius: '10px',\n          padding: '1rem',\n          background: '#f8fafc',\n        }}\n      >\n        {checkingAvailability ? (\n          <p style={{ margin: 0, color: '#64748b' }}>Checking room availability...</p>\n        ) : availabilityError ? (\n          <p style={{ margin: 0, color: '#ef4444' }}>{availabilityError}</p>\n        ) : formData.checkInDate && formData.checkOutDate ? (\n          <p style={{ margin: 0, color: '#0f172a' }}>\n            {availableRooms.length} room{availableRooms.length === 1 ? '' : 's'} available for {nights || 1} night\n            {nights === 1 ? '' : 's'}.\n          </p>\n        ) : (\n          <p style={{ margin: 0, color: '#64748b' }}>Pick your dates to load availability.</p>\n        )}\n      </div>\n    </div>\n  );\n\n  const renderRoomsStep = () => (\n    <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\n      <div\n        style={{\n          display: 'flex',\n          flexWrap: 'wrap',\n          gap: '1rem',\n          alignItems: 'center',\n          justifyContent: 'space-between',\n        }}\n      >\n        <div style={{ flex: 1 }}>\n          <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>Search rooms</label>\n          <input\n            type=\"text\"\n            value={roomSearch}\n            onChange={(e) => setRoomSearch(e.target.value)}\n            placeholder=\"Search by room #, type, category\"\n            style={{\n              width: '100%',\n              padding: '0.7rem',\n              borderRadius: '8px',\n              border: '1px solid #cbd5e1',\n            }}\n          />\n        </div>\n        <div style={{ minWidth: '220px' }}>\n          <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>Category</label>\n          <select\n            value={categoryFilter}\n            onChange={(e) => setCategoryFilter(e.target.value)}\n            style={{\n              width: '100%',\n              padding: '0.7rem',\n              borderRadius: '8px',\n              border: '1px solid #cbd5e1',\n            }}\n          >\n            <option value=\"all\">All categories</option>\n            <option value=\"none\">Uncategorized</option>\n            {categories.map((category) => (\n              <option key={category.id} value={category.id}>\n                {category.name}\n              </option>\n            ))}\n          </select>\n        </div>\n      </div>\n\n      <div\n        style={{\n          padding: '1rem',\n          borderRadius: '10px',\n          border: '1px solid #e2e8f0',\n          background: '#f8fafc',\n        }}\n      >\n        <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: 600 }}>\n          Bulk select (e.g. \"101-105\" or \"201,203\")\n        </label>\n        <div style={{ display: 'flex', gap: '0.75rem', flexWrap: 'wrap' }}>\n          <input\n            type=\"text\"\n            value={bulkSelectionInput}\n            onChange={(e) => {\n              setBulkSelectionInput(e.target.value);\n              setBulkSelectionError(null);\n            }}\n            placeholder=\"101-105, 210\"\n            style={{\n              flex: 1,\n              minWidth: '220px',\n              padding: '0.75rem',\n              borderRadius: '8px',\n              border: `1px solid ${bulkSelectionError ? '#ef4444' : '#cbd5e1'}`,\n            }}\n          />\n          <button\n            type=\"button\"\n            onClick={handleBulkSelection}\n            style={{\n              padding: '0.8rem 1.5rem',\n              borderRadius: '8px',\n              border: 'none',\n              background: '#2563eb',\n              color: 'white',\n              cursor: 'pointer',\n              fontWeight: 600,\n            }}\n          >\n            Add Rooms\n          </button>\n        </div>\n        {bulkSelectionError && (\n          <p style={{ marginTop: '0.4rem', color: '#ef4444', fontSize: '0.85rem' }}>{bulkSelectionError}</p>\n        )}\n        {unavailableRooms.size > 0 && (\n          <p style={{ marginTop: '0.4rem', color: '#f97316', fontSize: '0.85rem' }}>\n            Unavailable: {Array.from(unavailableRooms).join(', ')}\n          </p>\n        )}\n      </div>\n\n      {roomsByCategory.length === 0 ? (\n        <p style={{ color: '#94a3b8', textAlign: 'center' }}>\n          {formData.checkInDate && formData.checkOutDate\n            ? 'No rooms available for the selected filters'\n            : 'Select stay details first to load rooms'}\n        </p>\n      ) : (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem', maxHeight: '320px', overflowY: 'auto' }}>\n          {roomsByCategory.map((group) => {\n            const selectedCount = group.rooms.filter((room) => selectedRooms.has(room.id)).length;\n            return (\n              <div\n                key={group.id}\n                style={{\n                  border: '1px solid #e2e8f0',\n                  borderRadius: '10px',\n                  padding: '1rem',\n                  background: '#fff',\n                }}\n              >\n                <div\n                  style={{\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    flexWrap: 'wrap',\n                    gap: '0.75rem',\n                    marginBottom: '0.75rem',\n                  }}\n                >\n                  <div>\n                    <p style={{ margin: 0, fontWeight: 600, color: '#0f172a' }}>{group.name}</p>\n                    <p style={{ margin: '0.2rem 0 0', color: '#64748b', fontSize: '0.85rem' }}>\n                      {selectedCount}/{group.rooms.length} selected\n                    </p>\n                  </div>\n                  <div style={{ display: 'flex', gap: '0.5rem' }}>\n                    <button\n                      type=\"button\"\n                      onClick={() => handleCategorySelectAll(group.rooms)}\n                      style={{\n                        padding: '0.35rem 0.9rem',\n                        borderRadius: '6px',\n                        border: '1px solid #cbd5e1',\n                        background: '#fff',\n                        cursor: 'pointer',\n                        fontSize: '0.8rem',\n                      }}\n                    >\n                      Select all\n                    </button>\n                    {selectedCount > 0 && (\n                      <button\n                        type=\"button\"\n                        onClick={() => handleCategoryClear(group.rooms)}\n                        style={{\n                          padding: '0.35rem 0.9rem',\n                          borderRadius: '6px',\n                          border: '1px solid #fecaca',\n                          background: '#fee2e2',\n                          color: '#b91c1c',\n                          cursor: 'pointer',\n                          fontSize: '0.8rem',\n                        }}\n                      >\n                        Clear\n                      </button>\n                    )}\n                  </div>\n                </div>\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '0.6rem' }}>\n                  {group.rooms.map((room) => {\n                    const isSelected = selectedRooms.has(room.id);\n                    const rate = roomRates[room.id] ?? getRoomEffectiveRate(room) ?? 0;\n                    const hasCustomRate = room.customRate !== undefined && room.customRate !== null;\n                    return (\n                      <div\n                        key={room.id}\n                        onClick={() => toggleRoomSelection(room.id)}\n                        style={{\n                          display: 'flex',\n                          justifyContent: 'space-between',\n                          alignItems: 'center',\n                          padding: '0.85rem',\n                          border: `2px solid ${isSelected ? '#2563eb' : '#e2e8f0'}`,\n                          borderRadius: '8px',\n                          cursor: 'pointer',\n                          background: isSelected ? '#eff6ff' : '#fff',\n                        }}\n                      >\n                        <div>\n                          <p style={{ margin: 0, fontWeight: 600, color: '#0f172a' }}>\n                            Room {room.roomNumber}  {room.roomType}\n                          </p>\n                          <p style={{ margin: '0.2rem 0 0', color: '#475569', fontSize: '0.85rem' }}>\n                            {hasCustomRate ? 'Custom rate' : room.ratePlan?.name || 'Category rate'}\n                          </p>\n                        </div>\n                        <div style={{ textAlign: 'right' }}>\n                          <input\n                            type=\"number\"\n                            value={rate}\n                            onClick={(e) => e.stopPropagation()}\n                            onChange={(e) =>\n                              setRoomRates({ ...roomRates, [room.id]: Number(e.target.value) || 0 })\n                            }\n                            style={{\n                              width: '110px',\n                              padding: '0.45rem',\n                              borderRadius: '6px',\n                              border: '1px solid #cbd5e1',\n                              textAlign: 'right',\n                            }}\n                          />\n                          <p style={{ margin: '0.2rem 0 0', color: '#64748b', fontSize: '0.75rem' }}>per night</p>\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      )}\n\n      {selectedRooms.size > 0 && (\n        <div\n          style={{\n            border: '1px solid #e2e8f0',\n            borderRadius: '10px',\n            padding: '1rem',\n            background: '#f8fafc',\n          }}\n        >\n          <p style={{ margin: 0, color: '#64748b', fontSize: '0.85rem' }}>Selected</p>\n          <p style={{ margin: '0.25rem 0', fontWeight: 700, color: '#0f172a', fontSize: '1.25rem' }}>\n            {selectedRooms.size} room{selectedRooms.size === 1 ? '' : 's'}  {formatCurrency(roomSubtotal)}\n          </p>\n          <p style={{ margin: 0, color: '#475569', fontSize: '0.85rem' }}>\n            {selectedRoomDetails\n              .map((room: any) => `${room.roomNumber} (${formatCurrency(roomRates[room.id] || 0)}/night)`)\n              .join(', ')}\n          </p>\n        </div>\n      )}\n    </div>\n  );\n\n  const renderHallStep = () => (\n    <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\n      <div\n        style={{\n          border: '1px solid #e2e8f0',\n          borderRadius: '10px',\n          padding: '1rem',\n          background: '#f8fafc',\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          flexWrap: 'wrap',\n          gap: '0.5rem',\n        }}\n      >\n        <div>\n          <p style={{ margin: 0, fontWeight: 600, color: '#0f172a' }}>Add hall or event space</p>\n          <p style={{ margin: '0.2rem 0 0', color: '#64748b', fontSize: '0.85rem' }}>\n            Attach meeting halls to this group booking\n          </p>\n        </div>\n        <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>\n          <input type=\"checkbox\" checked={includeHall} onChange={(e) => setIncludeHall(e.target.checked)} />\n          Include hall booking\n        </label>\n      </div>\n\n      {includeHall && meetingHalls.length === 0 && (\n        <p style={{ color: '#ef4444' }}>No meeting halls configured for this property yet.</p>\n      )}\n\n      {includeHall && meetingHalls.length > 0 && (\n        <>\n          {hallReservations.map((reservation, index) => (\n            <div\n              key={reservation.id}\n              style={{\n                border: '1px solid #e2e8f0',\n                borderRadius: '10px',\n                padding: '1rem',\n                background: '#fff',\n                display: 'flex',\n                flexDirection: 'column',\n                gap: '0.8rem',\n              }}\n            >\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                <p style={{ margin: 0, fontWeight: 600, color: '#0f172a' }}>Hall Reservation #{index + 1}</p>\n                {hallReservations.length > 1 && (\n                  <button\n                    type=\"button\"\n                    onClick={() => removeHallReservation(reservation.id)}\n                    style={{\n                      border: 'none',\n                      background: 'transparent',\n                      color: '#ef4444',\n                      cursor: 'pointer',\n                      fontWeight: 600,\n                    }}\n                  >\n                    Remove\n                  </button>\n                )}\n              </div>\n              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '0.85rem' }}>\n                <div>\n                  <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>\n                    Hall *\n                  </label>\n                  <select\n                    value={reservation.hallId}\n                    onChange={(e) => handleHallChange(index, 'hallId', e.target.value)}\n                    style={{\n                      width: '100%',\n                      padding: '0.7rem',\n                      borderRadius: '8px',\n                      border: '1px solid #cbd5e1',\n                    }}\n                  >\n                    <option value=\"\">Select hall</option>\n                    {meetingHalls.map((hall) => (\n                      <option key={hall.id} value={hall.id}>\n                        {hall.name} (cap. {hall.capacity})\n                      </option>\n                    ))}\n                  </select>\n                </div>\n                <div>\n                  <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>\n                    Event Name\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={reservation.eventName}\n                    onChange={(e) => handleHallChange(index, 'eventName', e.target.value)}\n                    style={{\n                      width: '100%',\n                      padding: '0.7rem',\n                      borderRadius: '8px',\n                      border: '1px solid #cbd5e1',\n                    }}\n                  />\n                </div>\n                <div>\n                  <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>\n                    Rate (flat) *\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={reservation.rate}\n                    onChange={(e) => handleHallChange(index, 'rate', e.target.value)}\n                    style={{\n                      width: '100%',\n                      padding: '0.7rem',\n                      borderRadius: '8px',\n                      border: '1px solid #cbd5e1',\n                    }}\n                  />\n                </div>\n              </div>\n              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '0.85rem' }}>\n                <div>\n                  <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>\n                    Start *\n                  </label>\n                  <input\n                    type=\"datetime-local\"\n                    value={reservation.startDateTime}\n                    onChange={(e) => handleHallChange(index, 'startDateTime', e.target.value)}\n                    style={{\n                      width: '100%',\n                      padding: '0.7rem',\n                      borderRadius: '8px',\n                      border: '1px solid #cbd5e1',\n                    }}\n                  />\n                </div>\n                <div>\n                  <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>\n                    End *\n                  </label>\n                  <input\n                    type=\"datetime-local\"\n                    value={reservation.endDateTime}\n                    onChange={(e) => handleHallChange(index, 'endDateTime', e.target.value)}\n                    style={{\n                      width: '100%',\n                      padding: '0.7rem',\n                      borderRadius: '8px',\n                      border: '1px solid #cbd5e1',\n                    }}\n                  />\n                </div>\n                <div>\n                  <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>\n                    Attendees\n                  </label>\n                  <input\n                    type=\"number\"\n                    min={0}\n                    value={reservation.attendeeCount}\n                    onChange={(e) => handleHallChange(index, 'attendeeCount', e.target.value)}\n                    style={{\n                      width: '100%',\n                      padding: '0.7rem',\n                      borderRadius: '8px',\n                      border: '1px solid #cbd5e1',\n                    }}\n                  />\n                </div>\n              </div>\n              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '0.85rem' }}>\n                <div>\n                  <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>\n                    Purpose\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={reservation.purpose}\n                    onChange={(e) => handleHallChange(index, 'purpose', e.target.value)}\n                    style={{\n                      width: '100%',\n                      padding: '0.7rem',\n                      borderRadius: '8px',\n                      border: '1px solid #cbd5e1',\n                    }}\n                  />\n                </div>\n                <div>\n                  <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>\n                    Setup Type\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={reservation.setupType}\n                    onChange={(e) => handleHallChange(index, 'setupType', e.target.value)}\n                    style={{\n                      width: '100%',\n                      padding: '0.7rem',\n                      borderRadius: '8px',\n                      border: '1px solid #cbd5e1',\n                    }}\n                  />\n                </div>\n              </div>\n              <textarea\n                value={reservation.cateringNotes}\n                onChange={(e) => handleHallChange(index, 'cateringNotes', e.target.value)}\n                placeholder=\"Catering notes\"\n                rows={2}\n                style={{\n                  width: '100%',\n                  padding: '0.7rem',\n                  borderRadius: '8px',\n                  border: '1px solid #cbd5e1',\n                  resize: 'vertical',\n                }}\n              />\n              <textarea\n                value={reservation.avRequirements}\n                onChange={(e) => handleHallChange(index, 'avRequirements', e.target.value)}\n                placeholder=\"A/V requirements\"\n                rows={2}\n                style={{\n                  width: '100%',\n                  padding: '0.7rem',\n                  borderRadius: '8px',\n                  border: '1px solid #cbd5e1',\n                  resize: 'vertical',\n                }}\n              />\n            </div>\n          ))}\n          <button\n            type=\"button\"\n            onClick={addHallReservation}\n            style={{\n              padding: '0.75rem 1rem',\n              borderRadius: '8px',\n              border: '1px dashed #94a3b8',\n              background: '#fff',\n              cursor: 'pointer',\n              fontWeight: 600,\n              color: '#2563eb',\n            }}\n          >\n            + Add another hall\n          </button>\n        </>\n      )}\n    </div>\n  );\n\n  const renderInvoiceStep = () => (\n    <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\n      <div\n        style={{\n          border: '1px solid #e2e8f0',\n          borderRadius: '10px',\n          padding: '1rem',\n          background: '#fff',\n        }}\n      >\n        <p style={{ margin: 0, fontWeight: 600, color: '#0f172a' }}>Guest</p>\n        <p style={{ margin: '0.2rem 0 0', color: '#475569' }}>{formData.guestName}</p>\n        <p style={{ margin: '0.2rem 0 0', color: '#94a3b8', fontSize: '0.85rem' }}>\n          {formData.guestEmail}  {formData.guestPhone}\n        </p>\n        <p style={{ margin: '0.2rem 0 0', color: '#94a3b8', fontSize: '0.85rem' }}>{formData.guestAddress}</p>\n      </div>\n      <div\n        style={{\n          border: '1px solid #e2e8f0',\n          borderRadius: '10px',\n          padding: '1rem',\n          background: '#fff',\n        }}\n      >\n        <p style={{ margin: 0, fontWeight: 600, color: '#0f172a' }}>Stay</p>\n        <p style={{ margin: '0.2rem 0 0', color: '#475569' }}>\n          {formData.checkInDate}  {formData.checkOutDate}  {nightMultiplier} night\n          {nightMultiplier === 1 ? '' : 's'}\n        </p>\n        <p style={{ margin: '0.2rem 0 0', color: '#94a3b8', fontSize: '0.85rem' }}>\n          {formData.adults} adult{formData.adults === 1 ? '' : 's'}\n          {formData.children ? `  ${formData.children} child${formData.children === 1 ? '' : 'ren'}` : ''}\n        </p>\n      </div>\n      <div\n        style={{\n          border: '1px solid #e2e8f0',\n          borderRadius: '10px',\n          padding: '1rem',\n          background: '#fff',\n        }}\n      >\n        <p style={{ margin: 0, fontWeight: 600, color: '#0f172a' }}>Rooms ({selectedRooms.size})</p>\n        <div style={{ marginTop: '0.75rem', display: 'flex', flexDirection: 'column', gap: '0.65rem' }}>\n          {selectedRoomDetails.map((room: any) => {\n            const nightly = roomRates[room.id] || 0;\n            return (\n              <div\n                key={room.id}\n                style={{\n                  display: 'flex',\n                  justifyContent: 'space-between',\n                  color: '#475569',\n                }}\n              >\n                <span>\n                  Room {room.roomNumber}  {room.roomType}\n                </span>\n                <span>\n                  {formatCurrency(nightly)}  {nightMultiplier} = {formatCurrency(nightly * nightMultiplier)}\n                </span>\n              </div>\n            );\n          })}\n        </div>\n        <p style={{ marginTop: '0.8rem', fontWeight: 600, color: '#0f172a' }}>\n          Subtotal: {formatCurrency(roomSubtotal)}\n        </p>\n      </div>\n      {includeHall && hallReservations.length > 0 && (\n        <div\n          style={{\n            border: '1px solid #e2e8f0',\n            borderRadius: '10px',\n            padding: '1rem',\n            background: '#fff',\n          }}\n        >\n          <p style={{ margin: 0, fontWeight: 600, color: '#0f172a' }}>Hall bookings</p>\n          <div style={{ marginTop: '0.75rem', display: 'flex', flexDirection: 'column', gap: '0.65rem' }}>\n            {hallReservations.map((reservation, index) => {\n              const hallName = meetingHalls.find((hall) => hall.id === reservation.hallId)?.name || `Hall ${index + 1}`;\n              return (\n                <div\n                  key={reservation.id}\n                  style={{\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    color: '#475569',\n                  }}\n                >\n                  <span>\n                    {hallName}  {reservation.startDateTime || 'TBD'}\n                  </span>\n                  <span>{formatCurrency(Number(reservation.rate) || 0)}</span>\n                </div>\n              );\n            })}\n          </div>\n          <p style={{ marginTop: '0.8rem', fontWeight: 600, color: '#0f172a' }}>\n            Hall total: {formatCurrency(hallTotal)}\n          </p>\n        </div>\n      )}\n      <div\n        style={{\n          border: '1px solid #cbd5e1',\n          borderRadius: '12px',\n          padding: '1.25rem',\n          background: '#0f172a',\n          color: '#fff',\n        }}\n      >\n        <p style={{ margin: 0, fontSize: '0.9rem', letterSpacing: '0.08em', textTransform: 'uppercase' }}>Invoice total</p>\n        <p style={{ margin: '0.25rem 0 0', fontSize: '2rem', fontWeight: 700 }}>{formatCurrency(invoiceTotal)}</p>\n        <p style={{ margin: '0.25rem 0 0', color: '#cbd5f5' }}>\n          Rooms: {formatCurrency(roomSubtotal)}  Halls: {formatCurrency(hallTotal)}\n        </p>\n      </div>\n    </div>\n  );\n\n  const renderStep = () => {\n    switch (currentStep) {\n      case 0:\n        return renderGuestStep();\n      case 1:\n        return renderStayStep();\n      case 2:\n        return renderRoomsStep();\n      case 3:\n        return renderHallStep();\n      case 4:\n        return renderInvoiceStep();\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        background: 'rgba(15, 23, 42, 0.45)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 1000,\n        padding: '1rem',\n      }}\n      onClick={onClose}\n    >\n      <style>\n        {`\n          .group-booking-modal input,\n          .group-booking-modal select,\n          .group-booking-modal textarea {\n            color: #0f172a !important;\n            background-color: #ffffff !important;\n            caret-color: #0f172a;\n          }\n\n          .group-booking-modal input::placeholder,\n          .group-booking-modal select::placeholder,\n          .group-booking-modal textarea::placeholder {\n            color: #475569 !important;\n            opacity: 1;\n          }\n\n          .group-booking-modal input:-webkit-autofill,\n          .group-booking-modal input:-webkit-autofill:hover,\n          .group-booking-modal input:-webkit-autofill:focus,\n          .group-booking-modal textarea:-webkit-autofill,\n          .group-booking-modal textarea:-webkit-autofill:hover,\n          .group-booking-modal textarea:-webkit-autofill:focus,\n          .group-booking-modal select:-webkit-autofill,\n          .group-booking-modal select:-webkit-autofill:hover,\n          .group-booking-modal select:-webkit-autofill:focus {\n            -webkit-text-fill-color: #0f172a;\n            box-shadow: 0 0 0px 1000px #ffffff inset;\n            transition: background-color 5000s ease-in-out 0s;\n          }\n        `}\n      </style>\n      <div\n        className=\"group-booking-modal\"\n        style={{\n          width: '95%',\n          maxWidth: '960px',\n          background: '#fff',\n          borderRadius: '18px',\n          padding: '2rem',\n          maxHeight: '90vh',\n          overflowY: 'auto',\n          boxShadow: '0 25px 70px rgba(15, 23, 42, 0.18)',\n        }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\n          <div>\n            <h2 style={{ margin: 0, fontSize: '1.75rem', color: '#0f172a' }}>New Group Booking</h2>\n            <p style={{ margin: '0.3rem 0 0', color: '#64748b' }}>Capture guest info, rooms, halls, and invoice in one flow</p>\n          </div>\n          <button\n            type=\"button\"\n            onClick={onClose}\n            style={{ border: 'none', background: 'transparent', cursor: 'pointer', color: '#94a3b8' }}\n          >\n            <XCircle size={28} />\n          </button>\n        </div>\n\n        <div style={{ display: 'grid', gridTemplateColumns: `repeat(${steps.length}, minmax(0, 1fr))`, gap: '0.35rem', marginBottom: '1.5rem' }}>\n          {steps.map((label, index) => {\n            const isActive = index === currentStep;\n            const isComplete = index < currentStep;\n            return (\n              <div\n                key={label}\n                style={{\n                  padding: '0.55rem 0.4rem',\n                  borderRadius: '999px',\n                  textAlign: 'center',\n                  fontSize: '0.78rem',\n                  fontWeight: 600,\n                  background: isComplete ? '#dbeafe' : isActive ? '#2563eb' : '#f1f5f9',\n                  color: isActive ? '#fff' : isComplete ? '#1d4ed8' : '#94a3b8',\n                  textTransform: 'uppercase',\n                  letterSpacing: '0.08em',\n                }}\n              >\n                {label}\n              </div>\n            );\n          })}\n        </div>\n\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '1.25rem' }}>{renderStep()}</div>\n\n        <div\n          style={{\n            marginTop: '2rem',\n            display: 'flex',\n            justifyContent: 'space-between',\n            gap: '1rem',\n            flexWrap: 'wrap',\n          }}\n        >\n          <button\n            type=\"button\"\n            onClick={onClose}\n            style={{\n              padding: '0.9rem 1.5rem',\n              borderRadius: '999px',\n              border: '1px solid #e2e8f0',\n              background: '#fff',\n              color: '#475569',\n              fontWeight: 600,\n              flex: 1,\n              maxWidth: '160px',\n            }}\n          >\n            Cancel\n          </button>\n          {currentStep > 0 && (\n            <button\n              type=\"button\"\n              onClick={goToPreviousStep}\n              style={{\n                padding: '0.9rem 1.5rem',\n                borderRadius: '999px',\n                border: '1px solid #cbd5e1',\n                background: '#fff',\n                color: '#0f172a',\n                fontWeight: 600,\n                flex: 1,\n                maxWidth: '160px',\n              }}\n            >\n              Back\n            </button>\n          )}\n          {currentStep < steps.length - 1 && (\n            <button\n              type=\"button\"\n              onClick={goToNextStep}\n              disabled={!canProceed}\n              style={{\n                padding: '0.9rem 1.5rem',\n                borderRadius: '999px',\n                border: 'none',\n                background: canProceed ? '#2563eb' : '#cbd5e1',\n                color: '#fff',\n                fontWeight: 600,\n                flex: 1,\n                maxWidth: '200px',\n                cursor: canProceed ? 'pointer' : 'not-allowed',\n              }}\n            >\n              Next\n            </button>\n          )}\n          {currentStep === steps.length - 1 && (\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={submitting}\n              style={{\n                padding: '0.9rem 1.5rem',\n                borderRadius: '999px',\n                border: 'none',\n                background: submitting ? '#cbd5e1' : '#16a34a',\n                color: '#fff',\n                fontWeight: 600,\n                flex: 1,\n                maxWidth: '220px',\n                cursor: submitting ? 'not-allowed' : 'pointer',\n              }}\n            >\n              {submitting ? 'Saving...' : 'Create Booking'}\n            </button>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\GuestProfilePage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchGuestProfile'. Either include it or remove the dependency array.","line":62,"column":6,"nodeType":"ArrayExpression","endLine":62,"endColumn":24,"suggestions":[{"desc":"Update the dependencies array to be: [user, identifier, fetchGuestProfile]","fix":{"range":[1724,1742],"text":"[user, identifier, fetchGuestProfile]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Layout from '../components/Layout';\r\nimport { ArrowLeft, Mail, Phone, User, Calendar } from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\nimport { CardSkeleton } from '../components/LoadingSkeleton';\r\nimport { format } from 'date-fns';\r\n\r\ninterface GuestProfile {\r\n  name: string;\r\n  email?: string;\r\n  phone?: string;\r\n  idNumber?: string;\r\n  statistics: {\r\n    totalStays: number;\r\n    totalNights: number;\r\n    totalSpent: number;\r\n    averageStayLength: number;\r\n    averageSpent: number;\r\n    firstStay?: Date;\r\n    lastStay?: Date;\r\n  };\r\n  preferences: {\r\n    preferredRoomType?: string;\r\n    roomTypeFrequency: Record<string, number>;\r\n    commonSpecialRequests: string[];\r\n    preferredSource?: string;\r\n  };\r\n  reservations: Array<{\r\n    id: string;\r\n    reservationNumber: string;\r\n    checkInDate?: Date;\r\n    checkOutDate?: Date;\r\n    status: string;\r\n    rate: number;\r\n    room?: {\r\n      roomNumber?: string;\r\n      roomType?: string;\r\n    };\r\n  }>;\r\n  folios: Array<{\r\n    id: string;\r\n    totalCharges: number;\r\n    totalPayments: number;\r\n    balance: number;\r\n    status: string;\r\n  }>;\r\n}\r\n\r\nexport default function GuestProfilePage() {\r\n  const { identifier } = useParams<{ identifier: string }>();\r\n  const navigate = useNavigate();\r\n  const { user } = useAuthStore();\r\n  const [profile, setProfile] = useState<GuestProfile | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    if (!user?.tenantId || !identifier) return;\r\n    fetchGuestProfile();\r\n  }, [user, identifier]);\r\n\r\n  const fetchGuestProfile = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await api.get(`/tenants/${user?.tenantId}/guests/${identifier}`);\r\n      setProfile(response.data.data);\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch guest profile:', error);\r\n      toast.error(error.response?.data?.message || 'Failed to fetch guest profile');\r\n      if (error.response?.status === 404) {\r\n        navigate('/guests');\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    const colors: Record<string, string> = {\r\n      confirmed: '#3b82f6',\r\n      checked_in: '#10b981',\r\n      checked_out: '#64748b',\r\n      cancelled: '#ef4444',\r\n      no_show: '#f59e0b',\r\n    };\r\n    return colors[status] || '#94a3b8';\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Layout>\r\n        <div>\r\n          <CardSkeleton count={3} />\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  if (!profile) {\r\n    return (\r\n      <Layout>\r\n        <div style={{ textAlign: 'center', padding: '3rem' }}>\r\n          <User size={48} style={{ margin: '0 auto 1rem', opacity: 0.5, color: '#64748b' }} />\r\n          <p style={{ color: '#64748b', fontSize: '1.125rem' }}>Guest not found</p>\r\n          <button\r\n            onClick={() => navigate('/guests')}\r\n            style={{\r\n              marginTop: '1rem',\r\n              padding: '0.75rem 1.5rem',\r\n              background: '#3b82f6',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '6px',\r\n              cursor: 'pointer',\r\n            }}\r\n          >\r\n            Back to Guests\r\n          </button>\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Layout>\r\n      <div>\r\n        <button\r\n          onClick={() => navigate('/guests')}\r\n          style={{\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            gap: '0.5rem',\r\n            marginBottom: '1.5rem',\r\n            background: 'none',\r\n            border: 'none',\r\n            color: '#64748b',\r\n            cursor: 'pointer',\r\n            fontSize: '0.875rem',\r\n          }}\r\n        >\r\n          <ArrowLeft size={16} />\r\n          Back to Guests\r\n        </button>\r\n\r\n        {/* Guest Header */}\r\n        <div\r\n          style={{\r\n            background: 'white',\r\n            borderRadius: '8px',\r\n            padding: '2rem',\r\n            marginBottom: '1.5rem',\r\n            boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n          }}\r\n        >\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1.5rem' }}>\r\n            <div>\r\n              <h1 style={{ margin: 0, color: '#1e293b', fontSize: '2rem', fontWeight: '700' }}>\r\n                {profile.name}\r\n              </h1>\r\n              <div style={{ display: 'flex', flexWrap: 'wrap', gap: '1rem', marginTop: '1rem' }}>\r\n                {profile.email && (\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', color: '#64748b' }}>\r\n                    <Mail size={16} />\r\n                    <span>{profile.email}</span>\r\n                  </div>\r\n                )}\r\n                {profile.phone && (\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', color: '#64748b' }}>\r\n                    <Phone size={16} />\r\n                    <span>{profile.phone}</span>\r\n                  </div>\r\n                )}\r\n                {profile.idNumber && (\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', color: '#64748b' }}>\r\n                    <User size={16} />\r\n                    <span>ID: {profile.idNumber}</span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Statistics Cards */}\r\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem' }}>\r\n            <div style={{ padding: '1rem', background: '#f8fafc', borderRadius: '6px' }}>\r\n              <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.5rem' }}>Total Stays</div>\r\n              <div style={{ fontSize: '1.5rem', fontWeight: '700', color: '#1e293b' }}>\r\n                {profile.statistics.totalStays}\r\n              </div>\r\n            </div>\r\n            <div style={{ padding: '1rem', background: '#f8fafc', borderRadius: '6px' }}>\r\n              <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.5rem' }}>Total Nights</div>\r\n              <div style={{ fontSize: '1.5rem', fontWeight: '700', color: '#1e293b' }}>\r\n                {profile.statistics.totalNights}\r\n              </div>\r\n            </div>\r\n            <div style={{ padding: '1rem', background: '#f8fafc', borderRadius: '6px' }}>\r\n              <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.5rem' }}>Total Spent</div>\r\n              <div style={{ fontSize: '1.5rem', fontWeight: '700', color: '#1e293b' }}>\r\n                {profile.statistics.totalSpent.toLocaleString()}\r\n              </div>\r\n            </div>\r\n            <div style={{ padding: '1rem', background: '#f8fafc', borderRadius: '6px' }}>\r\n              <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.5rem' }}>Avg. Stay Length</div>\r\n              <div style={{ fontSize: '1.5rem', fontWeight: '700', color: '#1e293b' }}>\r\n                {profile.statistics.averageStayLength} nights\r\n              </div>\r\n            </div>\r\n            {profile.statistics.firstStay && (\r\n              <div style={{ padding: '1rem', background: '#f8fafc', borderRadius: '6px' }}>\r\n                <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.5rem' }}>First Stay</div>\r\n                <div style={{ fontSize: '1rem', fontWeight: '600', color: '#1e293b' }}>\r\n                  {format(profile.statistics.firstStay, 'MMM d, yyyy')}\r\n                </div>\r\n              </div>\r\n            )}\r\n            {profile.statistics.lastStay && (\r\n              <div style={{ padding: '1rem', background: '#f8fafc', borderRadius: '6px' }}>\r\n                <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.5rem' }}>Last Stay</div>\r\n                <div style={{ fontSize: '1rem', fontWeight: '600', color: '#1e293b' }}>\r\n                  {format(profile.statistics.lastStay, 'MMM d, yyyy')}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Preferences */}\r\n        {Object.keys(profile.preferences.roomTypeFrequency).length > 0 && (\r\n          <div\r\n            style={{\r\n              background: 'white',\r\n              borderRadius: '8px',\r\n              padding: '1.5rem',\r\n              marginBottom: '1.5rem',\r\n              boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n            }}\r\n          >\r\n            <h2 style={{ margin: '0 0 1rem', color: '#1e293b', fontSize: '1.25rem', fontWeight: '600' }}>\r\n              Preferences\r\n            </h2>\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', gap: '1rem' }}>\r\n              {profile.preferences.preferredRoomType && (\r\n                <div>\r\n                  <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.5rem' }}>Preferred Room Type</div>\r\n                  <div style={{ fontSize: '1rem', fontWeight: '600', color: '#1e293b' }}>\r\n                    {profile.preferences.preferredRoomType}\r\n                  </div>\r\n                </div>\r\n              )}\r\n              {profile.preferences.preferredSource && (\r\n                <div>\r\n                  <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.5rem' }}>Preferred Source</div>\r\n                  <div style={{ fontSize: '1rem', fontWeight: '600', color: '#1e293b' }}>\r\n                    {profile.preferences.preferredSource}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n            {profile.preferences.commonSpecialRequests.length > 0 && (\r\n              <div style={{ marginTop: '1rem' }}>\r\n                <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.5rem' }}>Common Requests</div>\r\n                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>\r\n                  {profile.preferences.commonSpecialRequests.map((request, idx) => (\r\n                    <span\r\n                      key={idx}\r\n                      style={{\r\n                        padding: '0.25rem 0.75rem',\r\n                        background: '#f1f5f9',\r\n                        borderRadius: '12px',\r\n                        fontSize: '0.875rem',\r\n                        color: '#475569',\r\n                      }}\r\n                    >\r\n                      {request}\r\n                    </span>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Reservation History */}\r\n        <div\r\n          style={{\r\n            background: 'white',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            marginBottom: '1.5rem',\r\n            boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n          }}\r\n        >\r\n          <h2 style={{ margin: '0 0 1rem', color: '#1e293b', fontSize: '1.25rem', fontWeight: '600' }}>\r\n            Reservation History ({profile.reservations.length})\r\n          </h2>\r\n          {profile.reservations.length === 0 ? (\r\n            <p style={{ color: '#64748b', textAlign: 'center', padding: '2rem' }}>No reservations found</p>\r\n          ) : (\r\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\r\n              {profile.reservations.map((reservation) => (\r\n                <div\r\n                  key={reservation.id}\r\n                  style={{\r\n                    padding: '1rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    display: 'flex',\r\n                    justifyContent: 'space-between',\r\n                    alignItems: 'center',\r\n                    flexWrap: 'wrap',\r\n                    gap: '1rem',\r\n                  }}\r\n                >\r\n                  <div style={{ flex: 1 }}>\r\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', flexWrap: 'wrap' }}>\r\n                      <div>\r\n                        <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '0.25rem' }}>\r\n                          {reservation.reservationNumber}\r\n                        </div>\r\n                        {reservation.room && (\r\n                          <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                            Room {reservation.room.roomNumber}  {reservation.room.roomType}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      {reservation.checkInDate && reservation.checkOutDate && (\r\n                        <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                          <Calendar size={14} style={{ display: 'inline', marginRight: '0.25rem' }} />\r\n                          {format(reservation.checkInDate, 'MMM d')} - {format(reservation.checkOutDate, 'MMM d, yyyy')}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>\r\n                    <div style={{ textAlign: 'right' }}>\r\n                      <div style={{ fontWeight: '600', color: '#1e293b' }}>{reservation.rate.toLocaleString()}</div>\r\n                      <span\r\n                        style={{\r\n                          padding: '0.25rem 0.75rem',\r\n                          borderRadius: '12px',\r\n                          fontSize: '0.75rem',\r\n                          fontWeight: '500',\r\n                          background: getStatusColor(reservation.status) + '20',\r\n                          color: getStatusColor(reservation.status),\r\n                        }}\r\n                      >\r\n                        {reservation.status.replace('_', ' ').toUpperCase()}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </Layout>\r\n  );\r\n}\r\n\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\GuestProfilePageEnhanced.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchGuestProfile'. Either include it or remove the dependency array.","line":77,"column":6,"nodeType":"ArrayExpression","endLine":77,"endColumn":24,"suggestions":[{"desc":"Update the dependencies array to be: [user, identifier, fetchGuestProfile]","fix":{"range":[2311,2329],"text":"[user, identifier, fetchGuestProfile]"}}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":475,"column":23,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19688,19713],"text":"\r\n                      &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19688,19713],"text":"\r\n                      &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19688,19713],"text":"\r\n                      &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19688,19713],"text":"\r\n                      &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":475,"column":49,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19738,19761],"text":"&quot;\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19738,19761],"text":"&ldquo;\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19738,19761],"text":"&#34;\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19738,19761],"text":"&rdquo;\r\n                    "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Layout from '../components/Layout';\r\nimport { \r\n  ArrowLeft, Mail, Phone, User, Calendar, MapPin, Star,\r\n  Edit, Activity, FileText, Gift \r\n} from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\nimport { CardSkeleton } from '../components/LoadingSkeleton';\r\nimport { format } from 'date-fns';\r\nimport LoyaltyBadge from '../components/LoyaltyBadge';\r\nimport ActivityTimeline from '../components/ActivityTimeline';\r\nimport GuestNotes from '../components/GuestNotes';\r\nimport LoyaltySection from '../components/LoyaltySection';\r\nimport Button from '../components/Button';\r\nimport GuestFormModal from '../components/GuestFormModal';\r\n\r\ninterface GuestProfile {\r\n  id: string;\r\n  name: string;\r\n  email?: string;\r\n  phone?: string;\r\n  idNumber?: string;\r\n  dateOfBirth?: Date;\r\n  nationality?: string;\r\n  address?: string;\r\n  city?: string;\r\n  state?: string;\r\n  country?: string;\r\n  postalCode?: string;\r\n  \r\n  loyaltyTier: string;\r\n  loyaltyPoints: number;\r\n  totalStays: number;\r\n  totalNights: number;\r\n  totalSpent: number;\r\n  \r\n  preferredRoomType?: string;\r\n  preferredFloor?: number;\r\n  smokingPreference?: boolean;\r\n  bedPreference?: string;\r\n  pillowPreference?: string;\r\n  \r\n  dietaryRestrictions?: string[];\r\n  allergies?: string[];\r\n  specialRequests?: string;\r\n  \r\n  isVIP: boolean;\r\n  isBanned: boolean;\r\n  bannedReason?: string;\r\n  \r\n  firstStayDate?: Date;\r\n  lastStayDate?: Date;\r\n  \r\n  reservations: any[];\r\n  activityLogs: any[];\r\n  notes: any[];\r\n  loyaltyTransactions: any[];\r\n}\r\n\r\ntype TabType = 'overview' | 'activity' | 'notes' | 'loyalty';\r\n\r\nexport default function GuestProfilePageEnhanced() {\r\n  const { identifier } = useParams<{ identifier: string }>();\r\n  const navigate = useNavigate();\r\n  const { user } = useAuthStore();\r\n  const [profile, setProfile] = useState<GuestProfile | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [activeTab, setActiveTab] = useState<TabType>('overview');\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!user?.tenantId || !identifier) return;\r\n    fetchGuestProfile();\r\n  }, [user, identifier]);\r\n\r\n  const fetchGuestProfile = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await api.get(`/tenants/${user?.tenantId}/guests/${identifier}`);\r\n      setProfile(response.data.data);\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch guest profile:', error);\r\n      toast.error(error.response?.data?.message || 'Failed to fetch guest profile');\r\n      if (error.response?.status === 404) {\r\n        navigate('/guests');\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleUpdateGuest = async (data: any) => {\r\n    try {\r\n      await api.post(`/tenants/${user?.tenantId}/guests`, data);\r\n      toast.success('Guest updated successfully');\r\n      setShowEditModal(false);\r\n      fetchGuestProfile();\r\n    } catch (error: any) {\r\n      toast.error(error.response?.data?.message || 'Failed to update guest');\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const handleToggleVIP = async () => {\r\n    if (!profile) return;\r\n    \r\n    try {\r\n      await api.post(`/tenants/${user?.tenantId}/guests`, {\r\n        ...profile,\r\n        isVIP: !profile.isVIP,\r\n      });\r\n      toast.success(profile.isVIP ? 'VIP status removed' : 'Marked as VIP');\r\n      fetchGuestProfile();\r\n    } catch (error: any) {\r\n      toast.error('Failed to update VIP status');\r\n    }\r\n  };\r\n\r\n  const handleAddNote = async (noteData: any) => {\r\n    try {\r\n      await api.post(`/tenants/${user?.tenantId}/guests/${identifier}/notes`, noteData);\r\n      fetchGuestProfile();\r\n    } catch (error: any) {\r\n      toast.error('Failed to add note');\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const handleUpdateNote = async (noteId: string, noteData: any) => {\r\n    try {\r\n      await api.put(`/tenants/${user?.tenantId}/guests/${identifier}/notes/${noteId}`, noteData);\r\n      fetchGuestProfile();\r\n    } catch (error: any) {\r\n      toast.error('Failed to update note');\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const handleDeleteNote = async (noteId: string) => {\r\n    try {\r\n      await api.delete(`/tenants/${user?.tenantId}/guests/${identifier}/notes/${noteId}`);\r\n      fetchGuestProfile();\r\n    } catch (error: any) {\r\n      toast.error('Failed to delete note');\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const handleAwardPoints = async (points: number, description: string) => {\r\n    try {\r\n      await api.post(`/tenants/${user?.tenantId}/guests/${identifier}/loyalty`, {\r\n        points,\r\n        description,\r\n      });\r\n      fetchGuestProfile();\r\n    } catch (error: any) {\r\n      toast.error('Failed to process points');\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Layout>\r\n        <div>\r\n          <CardSkeleton count={3} />\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  if (!profile) {\r\n    return (\r\n      <Layout>\r\n        <div style={{ textAlign: 'center', padding: '3rem' }}>\r\n          <p>Guest not found</p>\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  const getStatusColor = (status: string) => {\r\n    const colors: Record<string, string> = {\r\n      confirmed: '#3b82f6',\r\n      checked_in: '#10b981',\r\n      checked_out: '#64748b',\r\n      cancelled: '#ef4444',\r\n      no_show: '#f59e0b',\r\n    };\r\n    return colors[status] || '#94a3b8';\r\n  };\r\n\r\n  const tabs: { id: TabType; label: string; icon: any }[] = [\r\n    { id: 'overview', label: 'Overview', icon: User },\r\n    { id: 'activity', label: 'Activity', icon: Activity },\r\n    { id: 'notes', label: 'Notes', icon: FileText },\r\n    { id: 'loyalty', label: 'Loyalty', icon: Gift },\r\n  ];\r\n\r\n  return (\r\n    <Layout>\r\n      <div>\r\n        {/* Header */}\r\n        <div style={{ marginBottom: '2rem' }}>\r\n          <button\r\n            onClick={() => navigate('/guests')}\r\n            style={{\r\n              background: 'none',\r\n              border: 'none',\r\n              cursor: 'pointer',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.5rem',\r\n              color: '#64748b',\r\n              fontSize: '0.875rem',\r\n              marginBottom: '1rem',\r\n              padding: '0.5rem 0',\r\n            }}\r\n          >\r\n            <ArrowLeft size={16} />\r\n            Back to Guests\r\n          </button>\r\n\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', flexWrap: 'wrap', gap: '1rem' }}>\r\n            <div>\r\n              <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', marginBottom: '0.5rem' }}>\r\n                <h1 style={{ margin: 0, color: '#1e293b' }}>{profile.name}</h1>\r\n                {profile.isVIP && (\r\n                  <div style={{\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    gap: '0.375rem',\r\n                    padding: '0.375rem 0.75rem',\r\n                    backgroundColor: '#faf5ff',\r\n                    color: '#9333ea',\r\n                    borderRadius: '6px',\r\n                    fontSize: '0.875rem',\r\n                    fontWeight: '600',\r\n                    border: '1px solid #e9d5ff',\r\n                  }}>\r\n                    <Star size={14} fill=\"#9333ea\" />\r\n                    VIP Guest\r\n                  </div>\r\n                )}\r\n                <LoyaltyBadge tier={profile.loyaltyTier as any} />\r\n              </div>\r\n              <div style={{ display: 'flex', gap: '1.5rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n                {profile.email && (\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n                    <Mail size={16} />\r\n                    {profile.email}\r\n                  </div>\r\n                )}\r\n                {profile.phone && (\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n                    <Phone size={16} />\r\n                    {profile.phone}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            <div style={{ display: 'flex', gap: '0.75rem' }}>\r\n              <Button variant=\"secondary\" onClick={() => setShowEditModal(true)}>\r\n                <Edit size={16} />\r\n                Edit\r\n              </Button>\r\n              <Button \r\n                variant={profile.isVIP ? \"ghost\" : \"primary\"} \r\n                onClick={handleToggleVIP}\r\n              >\r\n                <Star size={16} fill={profile.isVIP ? \"currentColor\" : \"none\"} />\r\n                {profile.isVIP ? 'Remove VIP' : 'Mark as VIP'}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Tabs */}\r\n        <div style={{\r\n          borderBottom: '2px solid #e2e8f0',\r\n          marginBottom: '2rem',\r\n          display: 'flex',\r\n          gap: '2rem',\r\n        }}>\r\n          {tabs.map(tab => {\r\n            const Icon = tab.icon;\r\n            const isActive = activeTab === tab.id;\r\n            \r\n            return (\r\n              <button\r\n                key={tab.id}\r\n                onClick={() => setActiveTab(tab.id)}\r\n                style={{\r\n                  background: 'none',\r\n                  border: 'none',\r\n                  cursor: 'pointer',\r\n                  padding: '1rem 0',\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  gap: '0.5rem',\r\n                  fontSize: '0.9375rem',\r\n                  fontWeight: isActive ? '600' : '500',\r\n                  color: isActive ? '#3b82f6' : '#64748b',\r\n                  borderBottom: isActive ? '2px solid #3b82f6' : '2px solid transparent',\r\n                  marginBottom: '-2px',\r\n                  transition: 'all 0.2s',\r\n                }}\r\n              >\r\n                <Icon size={18} />\r\n                {tab.label}\r\n              </button>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {/* Tab Content */}\r\n        {activeTab === 'overview' && (\r\n          <div style={{ display: 'grid', gap: '1.5rem' }}>\r\n            {/* Statistics Cards */}\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem' }}>\r\n              <div style={{ backgroundColor: 'white', padding: '1.5rem', borderRadius: '8px', border: '1px solid #e2e8f0' }}>\r\n                <div style={{ fontSize: '0.875rem', color: '#64748b', marginBottom: '0.5rem' }}>Total Stays</div>\r\n                <div style={{ fontSize: '2rem', fontWeight: '700', color: '#1e293b' }}>{profile.totalStays}</div>\r\n              </div>\r\n              <div style={{ backgroundColor: 'white', padding: '1.5rem', borderRadius: '8px', border: '1px solid #e2e8f0' }}>\r\n                <div style={{ fontSize: '0.875rem', color: '#64748b', marginBottom: '0.5rem' }}>Total Nights</div>\r\n                <div style={{ fontSize: '2rem', fontWeight: '700', color: '#1e293b' }}>{profile.totalNights}</div>\r\n              </div>\r\n              <div style={{ backgroundColor: 'white', padding: '1.5rem', borderRadius: '8px', border: '1px solid #e2e8f0' }}>\r\n                <div style={{ fontSize: '0.875rem', color: '#64748b', marginBottom: '0.5rem' }}>Total Spent</div>\r\n                <div style={{ fontSize: '2rem', fontWeight: '700', color: '#1e293b' }}>{profile.totalSpent?.toLocaleString()}</div>\r\n              </div>\r\n              <div style={{ backgroundColor: 'white', padding: '1.5rem', borderRadius: '8px', border: '1px solid #e2e8f0' }}>\r\n                <div style={{ fontSize: '0.875rem', color: '#64748b', marginBottom: '0.5rem' }}>Loyalty Points</div>\r\n                <div style={{ fontSize: '2rem', fontWeight: '700', color: '#9333ea' }}>{profile.loyaltyPoints?.toLocaleString()}</div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Guest Information */}\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(350px, 1fr))', gap: '1.5rem' }}>\r\n              {/* Personal Info */}\r\n              <div style={{ backgroundColor: 'white', padding: '1.5rem', borderRadius: '8px', border: '1px solid #e2e8f0' }}>\r\n                <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1rem', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n                  <User size={20} />\r\n                  Personal Information\r\n                </h3>\r\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem', fontSize: '0.875rem' }}>\r\n                  {profile.idNumber && (\r\n                    <div>\r\n                      <span style={{ color: '#64748b' }}>ID Number:</span> <span style={{ fontWeight: '500' }}>{profile.idNumber}</span>\r\n                    </div>\r\n                  )}\r\n                  {profile.dateOfBirth && (\r\n                    <div>\r\n                      <span style={{ color: '#64748b' }}>Date of Birth:</span> <span style={{ fontWeight: '500' }}>{format(new Date(profile.dateOfBirth), 'MMM d, yyyy')}</span>\r\n                    </div>\r\n                  )}\r\n                  {profile.nationality && (\r\n                    <div>\r\n                      <span style={{ color: '#64748b' }}>Nationality:</span> <span style={{ fontWeight: '500' }}>{profile.nationality}</span>\r\n                    </div>\r\n                  )}\r\n                  {(profile.firstStayDate || profile.lastStayDate) && (\r\n                    <>\r\n                      {profile.firstStayDate && (\r\n                        <div>\r\n                          <span style={{ color: '#64748b' }}>First Stay:</span> <span style={{ fontWeight: '500' }}>{format(new Date(profile.firstStayDate), 'MMM d, yyyy')}</span>\r\n                        </div>\r\n                      )}\r\n                      {profile.lastStayDate && (\r\n                        <div>\r\n                          <span style={{ color: '#64748b' }}>Last Stay:</span> <span style={{ fontWeight: '500' }}>{format(new Date(profile.lastStayDate), 'MMM d, yyyy')}</span>\r\n                        </div>\r\n                      )}\r\n                    </>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Address */}\r\n              {(profile.address || profile.city || profile.country) && (\r\n                <div style={{ backgroundColor: 'white', padding: '1.5rem', borderRadius: '8px', border: '1px solid #e2e8f0' }}>\r\n                  <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1rem', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n                    <MapPin size={20} />\r\n                    Address\r\n                  </h3>\r\n                  <div style={{ fontSize: '0.875rem', color: '#64748b', lineHeight: '1.6' }}>\r\n                    {profile.address && <div>{profile.address}</div>}\r\n                    <div>\r\n                      {[profile.city, profile.state, profile.postalCode].filter(Boolean).join(', ')}\r\n                    </div>\r\n                    {profile.country && <div>{profile.country}</div>}\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Preferences */}\r\n              <div style={{ backgroundColor: 'white', padding: '1.5rem', borderRadius: '8px', border: '1px solid #e2e8f0' }}>\r\n                <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1rem', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n                  <Calendar size={20} />\r\n                  Preferences\r\n                </h3>\r\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem', fontSize: '0.875rem' }}>\r\n                  {profile.preferredRoomType && (\r\n                    <div>\r\n                      <span style={{ color: '#64748b' }}>Room Type:</span> <span style={{ fontWeight: '500', textTransform: 'capitalize' }}>{profile.preferredRoomType}</span>\r\n                    </div>\r\n                  )}\r\n                  {profile.preferredFloor && (\r\n                    <div>\r\n                      <span style={{ color: '#64748b' }}>Floor:</span> <span style={{ fontWeight: '500' }}>{profile.preferredFloor}</span>\r\n                    </div>\r\n                  )}\r\n                  {profile.bedPreference && (\r\n                    <div>\r\n                      <span style={{ color: '#64748b' }}>Bed:</span> <span style={{ fontWeight: '500', textTransform: 'capitalize' }}>{profile.bedPreference}</span>\r\n                    </div>\r\n                  )}\r\n                  {profile.pillowPreference && (\r\n                    <div>\r\n                      <span style={{ color: '#64748b' }}>Pillow:</span> <span style={{ fontWeight: '500', textTransform: 'capitalize' }}>{profile.pillowPreference}</span>\r\n                    </div>\r\n                  )}\r\n                  {profile.smokingPreference && (\r\n                    <div style={{ color: '#f59e0b', fontWeight: '500' }}>Smoking Preference</div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Dietary & Allergies */}\r\n              {((profile.dietaryRestrictions && profile.dietaryRestrictions.length > 0) || \r\n                (profile.allergies && profile.allergies.length > 0) ||\r\n                profile.specialRequests) && (\r\n                <div style={{ backgroundColor: 'white', padding: '1.5rem', borderRadius: '8px', border: '1px solid #e2e8f0' }}>\r\n                  <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1rem' }}>Dietary & Special Requests</h3>\r\n                  {profile.dietaryRestrictions && profile.dietaryRestrictions.length > 0 && (\r\n                    <div style={{ marginBottom: '0.75rem' }}>\r\n                      <div style={{ fontSize: '0.75rem', color: '#64748b', marginBottom: '0.25rem' }}>Dietary Restrictions:</div>\r\n                      <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>\r\n                        {profile.dietaryRestrictions.map((item, idx) => (\r\n                          <span key={idx} style={{\r\n                            fontSize: '0.75rem',\r\n                            padding: '0.25rem 0.5rem',\r\n                            backgroundColor: '#fef3c7',\r\n                            color: '#92400e',\r\n                            borderRadius: '4px',\r\n                          }}>{item}</span>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  {profile.allergies && profile.allergies.length > 0 && (\r\n                    <div style={{ marginBottom: '0.75rem' }}>\r\n                      <div style={{ fontSize: '0.75rem', color: '#ef4444', marginBottom: '0.25rem', fontWeight: '600' }}> Allergies:</div>\r\n                      <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>\r\n                        {profile.allergies.map((item, idx) => (\r\n                          <span key={idx} style={{\r\n                            fontSize: '0.75rem',\r\n                            padding: '0.25rem 0.5rem',\r\n                            backgroundColor: '#fee2e2',\r\n                            color: '#991b1b',\r\n                            borderRadius: '4px',\r\n                            fontWeight: '600',\r\n                          }}>{item}</span>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  {profile.specialRequests && (\r\n                    <div style={{ fontSize: '0.875rem', color: '#64748b', fontStyle: 'italic' }}>\r\n                      \"{profile.specialRequests}\"\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Recent Reservations */}\r\n            {profile.reservations && profile.reservations.length > 0 && (\r\n              <div style={{ backgroundColor: 'white', padding: '1.5rem', borderRadius: '8px', border: '1px solid #e2e8f0' }}>\r\n                <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1rem' }}>Recent Reservations</h3>\r\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>\r\n                  {profile.reservations.slice(0, 5).map((reservation) => (\r\n                    <div\r\n                      key={reservation.id}\r\n                      style={{\r\n                        padding: '1rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        display: 'flex',\r\n                        justifyContent: 'space-between',\r\n                        alignItems: 'center',\r\n                      }}\r\n                    >\r\n                      <div>\r\n                        <div style={{ fontWeight: '600', marginBottom: '0.25rem' }}>\r\n                          {reservation.reservationNumber}\r\n                        </div>\r\n                        <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                          {reservation.checkInDate && format(new Date(reservation.checkInDate), 'MMM d')} - {reservation.checkOutDate && format(new Date(reservation.checkOutDate), 'MMM d, yyyy')}\r\n                        </div>\r\n                      </div>\r\n                      <div style={{ textAlign: 'right' }}>\r\n                        <div\r\n                          style={{\r\n                            fontSize: '0.75rem',\r\n                            fontWeight: '600',\r\n                            padding: '0.25rem 0.5rem',\r\n                            borderRadius: '4px',\r\n                            backgroundColor: `${getStatusColor(reservation.status)}15`,\r\n                            color: getStatusColor(reservation.status),\r\n                            textTransform: 'capitalize',\r\n                            marginBottom: '0.25rem',\r\n                          }}\r\n                        >\r\n                          {reservation.status.replace('_', ' ')}\r\n                        </div>\r\n                        <div style={{ fontSize: '0.875rem', fontWeight: '600' }}>\r\n                          {reservation.rate?.toLocaleString()}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {activeTab === 'activity' && (\r\n          <div style={{ backgroundColor: 'white', borderRadius: '8px', border: '1px solid #e2e8f0' }}>\r\n            <ActivityTimeline activities={profile.activityLogs || []} />\r\n          </div>\r\n        )}\r\n\r\n        {activeTab === 'notes' && (\r\n          <div style={{ backgroundColor: 'white', borderRadius: '8px', border: '1px solid #e2e8f0' }}>\r\n            <GuestNotes\r\n              notes={profile.notes || []}\r\n              onAddNote={handleAddNote}\r\n              onUpdateNote={handleUpdateNote}\r\n              onDeleteNote={handleDeleteNote}\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        {activeTab === 'loyalty' && (\r\n          <div style={{ backgroundColor: 'white', borderRadius: '8px', border: '1px solid #e2e8f0' }}>\r\n            <LoyaltySection\r\n              currentPoints={profile.loyaltyPoints || 0}\r\n              loyaltyTier={profile.loyaltyTier}\r\n              transactions={profile.loyaltyTransactions || []}\r\n              onAwardPoints={handleAwardPoints}\r\n            />\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Edit Modal */}\r\n      <GuestFormModal\r\n        isOpen={showEditModal}\r\n        onClose={() => setShowEditModal(false)}\r\n        onSubmit={handleUpdateGuest}\r\n        initialData={profile}\r\n        isLoading={loading}\r\n      />\r\n    </Layout>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\GuestRequestsPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadRequests' and 'loadStats'. Either include them or remove the dependency array.","line":59,"column":6,"nodeType":"ArrayExpression","endLine":59,"endColumn":64,"suggestions":[{"desc":"Update the dependencies array to be: [user.tenantId, statusFilter, priorityFilter, typeFilter, loadRequests, loadStats]","fix":{"range":[1683,1741],"text":"[user.tenantId, statusFilter, priorityFilter, typeFilter, loadRequests, loadStats]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Button from '../components/Button';\r\nimport {\r\n  Search,\r\n  MessageSquare,\r\n  Clock,\r\n  AlertTriangle,\r\n  MoreVertical,\r\n  User,\r\n  Calendar,\r\n  Hash\r\n} from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\n\r\ninterface GuestRequest {\r\n  id: string;\r\n  requestType: 'amenities' | 'maintenance' | 'housekeeping' | 'concierge' | 'other';\r\n  priority: 'low' | 'normal' | 'high' | 'urgent';\r\n  title: string;\r\n  description: string;\r\n  status: 'pending' | 'assigned' | 'in_progress' | 'completed' | 'cancelled';\r\n  guestName?: string;\r\n  guestPhone?: string;\r\n  guestEmail?: string;\r\n  roomNumber?: string;\r\n  assignedTo?: string;\r\n  department?: string;\r\n  estimatedCompletion?: string;\r\n  actualCompletion?: string;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\ninterface RequestStats {\r\n  total: number;\r\n  pending: number;\r\n  inProgress: number;\r\n  completed: number;\r\n  urgent: number;\r\n  overdue: number;\r\n  averageResolutionTime: number;\r\n}\r\n\r\nexport default function GuestRequestsPage() {\r\n  const { user } = useAuthStore();\r\n  const [requests, setRequests] = useState<GuestRequest[]>([]);\r\n  const [stats, setStats] = useState<RequestStats | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [statusFilter, setStatusFilter] = useState<string>('all');\r\n  const [priorityFilter, setPriorityFilter] = useState<string>('all');\r\n  const [typeFilter, setTypeFilter] = useState<string>('all');\r\n\r\n  useEffect(() => {\r\n    loadRequests();\r\n    loadStats();\r\n  }, [user?.tenantId, statusFilter, priorityFilter, typeFilter]);\r\n\r\n  const loadRequests = async () => {\r\n    if (!user?.tenantId) return;\r\n\r\n    try {\r\n      const params = new URLSearchParams();\r\n      if (statusFilter !== 'all') params.append('status', statusFilter);\r\n      if (priorityFilter !== 'all') params.append('priority', priorityFilter);\r\n      if (typeFilter !== 'all') params.append('requestType', typeFilter);\r\n\r\n      const response = await api.get(`/tenants/${user.tenantId}/guest-requests?${params}`);\r\n      setRequests(response.data.data);\r\n    } catch (error) {\r\n      console.error('Error loading guest requests:', error);\r\n      toast.error('Failed to load guest requests');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadStats = async () => {\r\n    if (!user?.tenantId) return;\r\n\r\n    try {\r\n      const response = await api.get(`/tenants/${user.tenantId}/guest-requests/stats/summary`);\r\n      setStats(response.data.data);\r\n    } catch (error) {\r\n      console.error('Error loading request stats:', error);\r\n    }\r\n  };\r\n\r\n  const filteredRequests = requests.filter(request =>\r\n    request.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    request.description.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    request.guestName?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    request.roomNumber?.includes(searchTerm)\r\n  );\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'pending': return '#fbbf24';\r\n      case 'assigned': return '#3b82f6';\r\n      case 'in_progress': return '#8b5cf6';\r\n      case 'completed': return '#10b981';\r\n      case 'cancelled': return '#ef4444';\r\n      default: return '#6b7280';\r\n    }\r\n  };\r\n\r\n  const getPriorityColor = (priority: string) => {\r\n    switch (priority) {\r\n      case 'urgent': return '#ef4444';\r\n      case 'high': return '#f97316';\r\n      case 'normal': return '#eab308';\r\n      case 'low': return '#6b7280';\r\n      default: return '#6b7280';\r\n    }\r\n  };\r\n\r\n  const getTypeIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'amenities': return '';\r\n      case 'maintenance': return '';\r\n      case 'housekeeping': return '';\r\n      case 'concierge': return '';\r\n      default: return '';\r\n    }\r\n  };\r\n\r\n  const formatDate = (dateString: string) => {\r\n    return new Date(dateString).toLocaleDateString('en-US', {\r\n      month: 'short',\r\n      day: 'numeric',\r\n      hour: '2-digit',\r\n      minute: '2-digit'\r\n    });\r\n  };\r\n\r\n  const isOverdue = (request: GuestRequest) => {\r\n    if (!request.estimatedCompletion || request.status === 'completed') return false;\r\n    return new Date(request.estimatedCompletion) < new Date();\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: '2rem', maxWidth: '1400px', margin: '0 auto' }}>\r\n      <div style={{ marginBottom: '2rem' }}>\r\n        <h1 style={{ fontSize: '2rem', fontWeight: 'bold', marginBottom: '0.5rem' }}>\r\n          Guest Requests\r\n        </h1>\r\n        <p style={{ color: '#64748b' }}>\r\n          Manage and respond to guest service requests\r\n        </p>\r\n      </div>\r\n\r\n      {/* Stats Cards */}\r\n      {stats && (\r\n        <div style={{\r\n          display: 'grid',\r\n          gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',\r\n          gap: '1rem',\r\n          marginBottom: '2rem'\r\n        }}>\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#1f2937' }}>\r\n              {stats.total}\r\n            </div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Total Requests</div>\r\n          </div>\r\n\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#f59e0b' }}>\r\n              {stats.pending}\r\n            </div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Pending</div>\r\n          </div>\r\n\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#8b5cf6' }}>\r\n              {stats.inProgress}\r\n            </div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem' }}>In Progress</div>\r\n          </div>\r\n\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#10b981' }}>\r\n              {stats.completed}\r\n            </div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Completed</div>\r\n          </div>\r\n\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#ef4444' }}>\r\n              {stats.urgent}\r\n            </div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Urgent</div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Filters and Search */}\r\n      <div style={{\r\n        background: 'white',\r\n        border: '1px solid #e2e8f0',\r\n        borderRadius: '8px',\r\n        padding: '1.5rem',\r\n        marginBottom: '2rem'\r\n      }}>\r\n        <div style={{\r\n          display: 'flex',\r\n          flexWrap: 'wrap',\r\n          gap: '1rem',\r\n          alignItems: 'center',\r\n          marginBottom: '1rem'\r\n        }}>\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', flex: 1, minWidth: '200px' }}>\r\n            <Search size={18} style={{ color: '#64748b' }} />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search requests...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              style={{\r\n                flex: 1,\r\n                padding: '0.5rem 0.75rem',\r\n                border: '1px solid #d1d5db',\r\n                borderRadius: '6px',\r\n                fontSize: '0.875rem'\r\n              }}\r\n            />\r\n          </div>\r\n\r\n          <select\r\n            value={statusFilter}\r\n            onChange={(e) => setStatusFilter(e.target.value)}\r\n            style={{\r\n              padding: '0.5rem 0.75rem',\r\n              border: '1px solid #d1d5db',\r\n              borderRadius: '6px',\r\n              fontSize: '0.875rem',\r\n              minWidth: '120px'\r\n            }}\r\n          >\r\n            <option value=\"all\">All Status</option>\r\n            <option value=\"pending\">Pending</option>\r\n            <option value=\"assigned\">Assigned</option>\r\n            <option value=\"in_progress\">In Progress</option>\r\n            <option value=\"completed\">Completed</option>\r\n            <option value=\"cancelled\">Cancelled</option>\r\n          </select>\r\n\r\n          <select\r\n            value={priorityFilter}\r\n            onChange={(e) => setPriorityFilter(e.target.value)}\r\n            style={{\r\n              padding: '0.5rem 0.75rem',\r\n              border: '1px solid #d1d5db',\r\n              borderRadius: '6px',\r\n              fontSize: '0.875rem',\r\n              minWidth: '120px'\r\n            }}\r\n          >\r\n            <option value=\"all\">All Priority</option>\r\n            <option value=\"urgent\">Urgent</option>\r\n            <option value=\"high\">High</option>\r\n            <option value=\"normal\">Normal</option>\r\n            <option value=\"low\">Low</option>\r\n          </select>\r\n\r\n          <select\r\n            value={typeFilter}\r\n            onChange={(e) => setTypeFilter(e.target.value)}\r\n            style={{\r\n              padding: '0.5rem 0.75rem',\r\n              border: '1px solid #d1d5db',\r\n              borderRadius: '6px',\r\n              fontSize: '0.875rem',\r\n              minWidth: '140px'\r\n            }}\r\n          >\r\n            <option value=\"all\">All Types</option>\r\n            <option value=\"amenities\">Amenities</option>\r\n            <option value=\"maintenance\">Maintenance</option>\r\n            <option value=\"housekeeping\">Housekeeping</option>\r\n            <option value=\"concierge\">Concierge</option>\r\n            <option value=\"other\">Other</option>\r\n          </select>\r\n\r\n          <Button onClick={() => {\r\n            setSearchTerm('');\r\n            setStatusFilter('all');\r\n            setPriorityFilter('all');\r\n            setTypeFilter('all');\r\n          }}>\r\n            Clear Filters\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Requests List */}\r\n      {loading ? (\r\n        <div style={{ textAlign: 'center', padding: '3rem' }}>\r\n          Loading guest requests...\r\n        </div>\r\n      ) : filteredRequests.length === 0 ? (\r\n        <div style={{\r\n          textAlign: 'center',\r\n          padding: '3rem',\r\n          border: '2px dashed #e2e8f0',\r\n          borderRadius: '8px'\r\n        }}>\r\n          <MessageSquare size={48} style={{ color: '#cbd5e1', marginBottom: '1rem' }} />\r\n          <h3 style={{ fontSize: '1.25rem', fontWeight: '600', marginBottom: '0.5rem' }}>\r\n            No Guest Requests Found\r\n          </h3>\r\n          <p style={{ color: '#64748b' }}>\r\n            {searchTerm || statusFilter !== 'all' || priorityFilter !== 'all' || typeFilter !== 'all'\r\n              ? 'No requests match your current filters.'\r\n              : 'No guest requests have been submitted yet.'}\r\n          </p>\r\n        </div>\r\n      ) : (\r\n        <div style={{ display: 'grid', gap: '1rem' }}>\r\n          {filteredRequests.map((request) => (\r\n            <div\r\n              key={request.id}\r\n              style={{\r\n                background: 'white',\r\n                border: '1px solid #e2e8f0',\r\n                borderRadius: '8px',\r\n                padding: '1.5rem',\r\n                position: 'relative'\r\n              }}\r\n            >\r\n              {/* Priority Indicator */}\r\n              {request.priority === 'urgent' && (\r\n                <div style={{\r\n                  position: 'absolute',\r\n                  top: '1rem',\r\n                  right: '1rem',\r\n                  background: '#ef4444',\r\n                  color: 'white',\r\n                  padding: '0.25rem 0.5rem',\r\n                  borderRadius: '4px',\r\n                  fontSize: '0.75rem',\r\n                  fontWeight: '600',\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  gap: '0.25rem'\r\n                }}>\r\n                  <AlertTriangle size={12} />\r\n                  URGENT\r\n                </div>\r\n              )}\r\n\r\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1rem' }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>\r\n                  <div style={{\r\n                    fontSize: '1.5rem',\r\n                    width: '40px',\r\n                    height: '40px',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'center',\r\n                    background: '#f3f4f6',\r\n                    borderRadius: '8px'\r\n                  }}>\r\n                    {getTypeIcon(request.requestType)}\r\n                  </div>\r\n                  <div>\r\n                    <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '0.25rem' }}>\r\n                      {request.title}\r\n                    </h3>\r\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', fontSize: '0.875rem', color: '#64748b' }}>\r\n                      <span style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\r\n                        <Hash size={14} />\r\n                        {request.id.slice(-8)}\r\n                      </span>\r\n                      <span style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\r\n                        <Calendar size={14} />\r\n                        {formatDate(request.createdAt)}\r\n                      </span>\r\n                      {request.roomNumber && (\r\n                        <span style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\r\n                          <User size={14} />\r\n                          Room {request.roomNumber}\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n                  <span style={{\r\n                    padding: '0.25rem 0.75rem',\r\n                    borderRadius: '9999px',\r\n                    fontSize: '0.75rem',\r\n                    fontWeight: '600',\r\n                    background: `${getPriorityColor(request.priority)}20`,\r\n                    color: getPriorityColor(request.priority)\r\n                  }}>\r\n                    {request.priority.toUpperCase()}\r\n                  </span>\r\n                  <span style={{\r\n                    padding: '0.25rem 0.75rem',\r\n                    borderRadius: '9999px',\r\n                    fontSize: '0.75rem',\r\n                    fontWeight: '600',\r\n                    background: `${getStatusColor(request.status)}20`,\r\n                    color: getStatusColor(request.status)\r\n                  }}>\r\n                    {request.status.replace('_', ' ').toUpperCase()}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n\r\n              <p style={{\r\n                color: '#64748b',\r\n                marginBottom: '1rem',\r\n                lineHeight: '1.5',\r\n                display: '-webkit-box',\r\n                WebkitLineClamp: 2,\r\n                WebkitBoxOrient: 'vertical',\r\n                overflow: 'hidden'\r\n              }}>\r\n                {request.description}\r\n              </p>\r\n\r\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', fontSize: '0.875rem', color: '#64748b' }}>\r\n                  {request.guestName && (\r\n                    <span>Guest: {request.guestName}</span>\r\n                  )}\r\n                  {request.assignedTo && (\r\n                    <span>Assigned: {request.assignedTo}</span>\r\n                  )}\r\n                  {request.estimatedCompletion && (\r\n                    <span style={{\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: '0.25rem',\r\n                      color: isOverdue(request) ? '#ef4444' : '#64748b'\r\n                    }}>\r\n                      <Clock size={14} />\r\n                      Due: {formatDate(request.estimatedCompletion)}\r\n                      {isOverdue(request) && ' (Overdue)'}\r\n                    </span>\r\n                  )}\r\n                </div>\r\n\r\n                <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n                  <Button variant=\"ghost\" size=\"sm\">\r\n                    <MessageSquare size={16} />\r\n                  </Button>\r\n                  <Button variant=\"ghost\" size=\"sm\">\r\n                    <MoreVertical size={16} />\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\GuestsPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'pagination.page'. Either include it or remove the dependency array.","line":76,"column":6,"nodeType":"ArrayExpression","endLine":76,"endColumn":49,"suggestions":[{"desc":"Update the dependencies array to be: [pagination.page, pagination.limit, user.tenantId, filters.loyaltyTier, filters.isVIP]","fix":{"range":[2566,2609],"text":"[pagination.page, pagination.limit, user.tenantId, filters.loyaltyTier, filters.isVIP]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'debouncedSearchQuery'. Either include it or remove the dependency array.","line":83,"column":6,"nodeType":"ArrayExpression","endLine":83,"endColumn":52,"suggestions":[{"desc":"Update the dependencies array to be: [user?.tenantId, pagination.page, fetchGuests, debouncedSearchQuery]","fix":{"range":[2764,2810],"text":"[user?.tenantId, pagination.page, fetchGuests, debouncedSearchQuery]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Layout from '../components/Layout';\r\nimport { User, Mail, Phone, Search, Plus, Star, Filter } from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\nimport { CardSkeleton } from '../components/LoadingSkeleton';\r\nimport { useDebounce } from '../hooks/useDebounce';\r\nimport EmptyState from '../components/EmptyState';\r\nimport Pagination from '../components/Pagination';\r\nimport Button from '../components/Button';\r\nimport LoyaltyBadge from '../components/LoyaltyBadge';\r\nimport GuestFormModal from '../components/GuestFormModal';\r\n\r\nexport default function GuestsPage() {\r\n  const navigate = useNavigate();\r\n  const { user } = useAuthStore();\r\n  const [guests, setGuests] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [isSearching, setIsSearching] = useState(false);\r\n  const debouncedSearchQuery = useDebounce(searchQuery, 500);\r\n  const [pagination, setPagination] = useState({\r\n    page: 1,\r\n    limit: 20,\r\n    total: 0,\r\n    totalPages: 0,\r\n  });\r\n  const [showGuestForm, setShowGuestForm] = useState(false);\r\n  const [showFilters, setShowFilters] = useState(false);\r\n  const [filters, setFilters] = useState({\r\n    loyaltyTier: '',\r\n    isVIP: '',\r\n  });\r\n\r\n  const fetchGuests = useCallback(async (page = pagination.page, search = '') => {\r\n    if (!user?.tenantId) return;\r\n    \r\n    try {\r\n      setLoading(true);\r\n      \r\n      const params: any = {\r\n        page,\r\n        limit: pagination.limit,\r\n      };\r\n\r\n      if (search.trim()) {\r\n        params.search = search.trim();\r\n        setIsSearching(true);\r\n      } else {\r\n        setIsSearching(false);\r\n      }\r\n\r\n      if (filters.loyaltyTier) {\r\n        params.loyaltyTier = filters.loyaltyTier;\r\n      }\r\n\r\n      if (filters.isVIP) {\r\n        params.isVIP = filters.isVIP;\r\n      }\r\n\r\n      const response = await api.get(`/tenants/${user.tenantId}/guests`, { params });\r\n      setGuests(response.data.data || []);\r\n      \r\n      if (response.data.pagination) {\r\n        setPagination(response.data.pagination);\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch guests:', error);\r\n      toast.error(error.response?.data?.error?.message || error.response?.data?.message || 'Failed to fetch guests');\r\n      setGuests([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [user?.tenantId, pagination.limit, filters]);\r\n\r\n  useEffect(() => {\r\n    if (!user?.tenantId) return;\r\n    if (!debouncedSearchQuery.trim()) {\r\n      fetchGuests(pagination.page, '');\r\n    }\r\n  }, [user?.tenantId, pagination.page, fetchGuests]);\r\n\r\n  useEffect(() => {\r\n    if (!user?.tenantId) return;\r\n    if (debouncedSearchQuery.trim()) {\r\n      fetchGuests(1, debouncedSearchQuery);\r\n    } else if (searchQuery === '' && debouncedSearchQuery === '') {\r\n      fetchGuests(1, '');\r\n    }\r\n  }, [debouncedSearchQuery, user?.tenantId, fetchGuests, searchQuery]);\r\n\r\n  const handleClearSearch = useCallback(() => {\r\n    setSearchQuery('');\r\n    fetchGuests(1, '');\r\n  }, [fetchGuests]);\r\n\r\n  const handlePageChange = useCallback((page: number) => {\r\n    setPagination(prev => ({ ...prev, page }));\r\n  }, []);\r\n\r\n  const handleCreateGuest = async (data: any) => {\r\n    try {\r\n      await api.post(`/tenants/${user?.tenantId}/guests`, data);\r\n      toast.success('Guest created successfully');\r\n      setShowGuestForm(false);\r\n      fetchGuests();\r\n    } catch (error: any) {\r\n      toast.error(error.response?.data?.message || 'Failed to create guest');\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Layout>\r\n        <div>\r\n          <h1 style={{ marginBottom: '1.5rem', color: '#1e293b' }}>Guests</h1>\r\n          <CardSkeleton count={6} />\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Layout>\r\n      <div>\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem', flexWrap: 'wrap', gap: '1rem' }}>\r\n          <h1 style={{ color: '#1e293b', margin: 0 }}>Guests</h1>\r\n          <Button onClick={() => setShowGuestForm(true)}>\r\n            <Plus size={16} />\r\n            Add Guest\r\n          </Button>\r\n        </div>\r\n\r\n        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1.5rem', alignItems: 'center', flexWrap: 'wrap' }}>\r\n          <div style={{ flex: 1, minWidth: '300px' }}>\r\n            <div style={{ position: 'relative' }}>\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Search by name, email, or phone...\"\r\n                value={searchQuery}\r\n                onChange={(e) => setSearchQuery(e.target.value)}\r\n                onKeyDown={(e) => {\r\n                  if (e.key === 'Enter' && searchQuery.trim()) {\r\n                    fetchGuests(1, searchQuery);\r\n                  }\r\n                }}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem 1rem 0.75rem 2.5rem',\r\n                  border: '1px solid #e2e8f0',\r\n                  borderRadius: '6px',\r\n                  fontSize: '1rem',\r\n                }}\r\n              />\r\n              <Search\r\n                size={18}\r\n                style={{\r\n                  position: 'absolute',\r\n                  left: '0.75rem',\r\n                  top: '50%',\r\n                  transform: 'translateY(-50%)',\r\n                  color: '#94a3b8',\r\n                  pointerEvents: 'none',\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n          \r\n          <Button\r\n            variant={showFilters ? \"primary\" : \"secondary\"}\r\n            size=\"md\"\r\n            onClick={() => setShowFilters(!showFilters)}\r\n          >\r\n            <Filter size={16} />\r\n            Filters\r\n          </Button>\r\n\r\n          {searchQuery && (\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"md\"\r\n              onClick={handleClearSearch}\r\n              disabled={loading}\r\n            >\r\n              Clear\r\n            </Button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Filters Panel */}\r\n        {showFilters && (\r\n          <div style={{\r\n            backgroundColor: '#f8fafc',\r\n            padding: '1rem',\r\n            borderRadius: '8px',\r\n            marginBottom: '1.5rem',\r\n            border: '1px solid #e2e8f0',\r\n          }}>\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem' }}>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  Loyalty Tier\r\n                </label>\r\n                <select\r\n                  value={filters.loyaltyTier}\r\n                  onChange={(e) => setFilters({ ...filters, loyaltyTier: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.5rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '0.875rem',\r\n                  }}\r\n                >\r\n                  <option value=\"\">All Tiers</option>\r\n                  <option value=\"bronze\">Bronze</option>\r\n                  <option value=\"silver\">Silver</option>\r\n                  <option value=\"gold\">Gold</option>\r\n                  <option value=\"platinum\">Platinum</option>\r\n                  <option value=\"vip\">VIP</option>\r\n                </select>\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '500', color: '#374151' }}>\r\n                  Guest Type\r\n                </label>\r\n                <select\r\n                  value={filters.isVIP}\r\n                  onChange={(e) => setFilters({ ...filters, isVIP: e.target.value })}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.5rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '0.875rem',\r\n                  }}\r\n                >\r\n                  <option value=\"\">All Guests</option>\r\n                  <option value=\"true\">VIP Only</option>\r\n                  <option value=\"false\">Regular Only</option>\r\n                </select>\r\n              </div>\r\n            </div>\r\n            <div style={{ display: 'flex', gap: '0.5rem', marginTop: '1rem', justifyContent: 'flex-end' }}>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                onClick={() => {\r\n                  setFilters({ loyaltyTier: '', isVIP: '' });\r\n                  setShowFilters(false);\r\n                }}\r\n              >\r\n                Clear Filters\r\n              </Button>\r\n              <Button\r\n                size=\"sm\"\r\n                onClick={() => {\r\n                  fetchGuests(1, searchQuery);\r\n                  setShowFilters(false);\r\n                }}\r\n              >\r\n                Apply Filters\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {!loading && guests.length === 0 ? (\r\n          <EmptyState\r\n            icon={User}\r\n            title={isSearching ? 'No guests found' : 'No guests yet'}\r\n            description={isSearching ? 'Try adjusting your search terms' : 'Guests will appear here once they make a reservation'}\r\n          />\r\n        ) : (\r\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(350px, 1fr))', gap: '1.5rem' }}>\r\n            {guests.map((guest, idx) => {\r\n              const identifier = guest.id || guest.email || guest.phone || guest.name;\r\n              return (\r\n                <div\r\n                  key={idx}\r\n                  onClick={() => navigate(`/guests/${encodeURIComponent(identifier)}`)}\r\n                  style={{\r\n                    background: 'white',\r\n                    border: guest.isVIP ? '2px solid #9333ea' : '1px solid #e2e8f0',\r\n                    borderRadius: '8px',\r\n                    padding: '1.5rem',\r\n                    boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n                    cursor: 'pointer',\r\n                    transition: 'all 0.2s',\r\n                    position: 'relative',\r\n                  }}\r\n                  onMouseEnter={(e) => {\r\n                    e.currentTarget.style.boxShadow = '0 4px 6px rgba(0,0,0,0.1)';\r\n                    e.currentTarget.style.transform = 'translateY(-2px)';\r\n                  }}\r\n                  onMouseLeave={(e) => {\r\n                    e.currentTarget.style.boxShadow = '0 1px 3px rgba(0,0,0,0.1)';\r\n                    e.currentTarget.style.transform = 'translateY(0)';\r\n                  }}\r\n                >\r\n                  {/* VIP Badge */}\r\n                  {guest.isVIP && (\r\n                    <div style={{\r\n                      position: 'absolute',\r\n                      top: '1rem',\r\n                      right: '1rem',\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: '0.25rem',\r\n                      padding: '0.25rem 0.5rem',\r\n                      backgroundColor: '#faf5ff',\r\n                      color: '#9333ea',\r\n                      borderRadius: '4px',\r\n                      fontSize: '0.75rem',\r\n                      fontWeight: '600',\r\n                    }}>\r\n                      <Star size={12} fill=\"#9333ea\" />\r\n                      VIP\r\n                    </div>\r\n                  )}\r\n\r\n                  <div style={{ display: 'flex', alignItems: 'flex-start', justifyContent: 'space-between', marginBottom: '0.75rem' }}>\r\n                    <h3 style={{ margin: 0, color: '#1e293b', fontSize: '1.125rem', fontWeight: '600' }}>\r\n                      {guest.name}\r\n                    </h3>\r\n                  </div>\r\n\r\n                  <div style={{ marginBottom: '1rem' }}>\r\n                    {guest.loyaltyTier && (\r\n                      <LoyaltyBadge tier={guest.loyaltyTier} size=\"sm\" />\r\n                    )}\r\n                  </div>\r\n\r\n                  <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem', marginBottom: '1rem' }}>\r\n                    {guest.email && (\r\n                      <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n                        <Mail size={14} />\r\n                        {guest.email}\r\n                      </div>\r\n                    )}\r\n                    {guest.phone && (\r\n                      <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n                        <Phone size={14} />\r\n                        {guest.phone}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n\r\n                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '1rem', paddingTop: '1rem', borderTop: '1px solid #e2e8f0' }}>\r\n                    <div>\r\n                      <div style={{ color: '#64748b', fontSize: '0.75rem', marginBottom: '0.25rem' }}>Stays</div>\r\n                      <div style={{ fontWeight: '600', color: '#1e293b' }}>{guest.totalStays || 0}</div>\r\n                    </div>\r\n                    <div>\r\n                      <div style={{ color: '#64748b', fontSize: '0.75rem', marginBottom: '0.25rem' }}>Points</div>\r\n                      <div style={{ fontWeight: '600', color: '#9333ea' }}>{guest.loyaltyPoints?.toLocaleString() || 0}</div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n\r\n        {!isSearching && pagination.totalPages > 1 && (\r\n          <div style={{ marginTop: '2rem' }}>\r\n            <Pagination\r\n              page={pagination.page}\r\n              totalPages={pagination.totalPages}\r\n              total={pagination.total}\r\n              limit={pagination.limit}\r\n              onPageChange={handlePageChange}\r\n            />\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Guest Form Modal */}\r\n      <GuestFormModal\r\n        isOpen={showGuestForm}\r\n        onClose={() => setShowGuestForm(false)}\r\n        onSubmit={handleCreateGuest}\r\n        isLoading={loading}\r\n      />\r\n    </Layout>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\HomePage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\HousekeepingPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchRooms'. Either include it or remove the dependency array.","line":261,"column":6,"nodeType":"ArrayExpression","endLine":261,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [fetchRooms]","fix":{"range":[8776,8778],"text":"[fetchRooms]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useCallback, useMemo } from 'react';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Layout from '../components/Layout';\r\nimport { Sparkles, CheckCircle, Plus, X } from 'lucide-react';\r\nimport { CardSkeleton } from '../components/LoadingSkeleton';\r\nimport FileUpload from '../components/FileUpload';\r\nimport toast from 'react-hot-toast';\r\nimport SearchInput from '../components/SearchInput';\r\nimport { useDebounce } from '../hooks/useDebounce';\r\nimport EmptyState from '../components/EmptyState';\r\n\r\ninterface Task {\r\n  id: string;\r\n  taskType: string;\r\n  status: string;\r\n  room: {\r\n    roomNumber: string;\r\n  };\r\n  assignedStaff: {\r\n    firstName: string;\r\n    lastName: string;\r\n  } | null;\r\n}\r\n\r\ninterface TaskDetails extends Task {\r\n  photos?: string[];\r\n  checklist?: any[];\r\n  notes?: string;\r\n}\r\n\r\nexport default function HousekeepingPage() {\r\n  const { user } = useAuthStore();\r\n  const [tasks, setTasks] = useState<TaskDetails[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [selectedTask, setSelectedTask] = useState<TaskDetails | null>(null);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const debouncedSearchTerm = useDebounce(searchTerm, 500);\r\n\r\n  const fetchTasks = useCallback(async () => {\r\n    if (!user?.tenantId) return;\r\n    setLoading(true);\r\n    try {\r\n      const response = await api.get(`/tenants/${user.tenantId}/housekeeping`);\r\n      setTasks(response.data.data || []);\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch tasks:', error);\r\n      toast.error(error.response?.data?.error?.message || 'Failed to fetch tasks');\r\n      setTasks([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [user?.tenantId]);\r\n\r\n  useEffect(() => {\r\n    fetchTasks();\r\n  }, [fetchTasks]);\r\n\r\n  const handleCompleteTask = async (taskId: string) => {\r\n    setSelectedTask(tasks.find(t => t.id === taskId) || null);\r\n  };\r\n\r\n  const filteredTasks = useMemo(() => tasks.filter((task) => {\r\n    if (!debouncedSearchTerm) return true;\r\n    const searchLower = debouncedSearchTerm.toLowerCase();\r\n    return (\r\n      task.room?.roomNumber.toLowerCase().includes(searchLower) ||\r\n      task.taskType.toLowerCase().includes(searchLower) ||\r\n      task.status.toLowerCase().includes(searchLower) ||\r\n      task.assignedStaff?.firstName.toLowerCase().includes(searchLower) ||\r\n      task.assignedStaff?.lastName.toLowerCase().includes(searchLower)\r\n    );\r\n  }), [tasks, debouncedSearchTerm]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <Layout>\r\n        <div>\r\n          <h1 style={{ marginBottom: '1.5rem', color: '#1e293b' }}>Housekeeping</h1>\r\n          <CardSkeleton count={6} />\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Layout>\r\n      <div>\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <h1 style={{ margin: 0, color: '#1e293b' }}>Housekeeping</h1>\r\n          <button\r\n            onClick={() => setShowCreateModal(true)}\r\n            style={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.5rem',\r\n              padding: '0.75rem 1.5rem',\r\n              background: '#3b82f6',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '6px',\r\n              cursor: 'pointer',\r\n              fontWeight: '500',\r\n            }}\r\n          >\r\n            <Plus size={20} />\r\n            Create Task\r\n          </button>\r\n        </div>\r\n\r\n        <div style={{ marginBottom: '1.5rem' }}>\r\n          <SearchInput\r\n            value={searchTerm}\r\n            onChange={setSearchTerm}\r\n            placeholder=\"Search by room number, task type, status, or staff...\"\r\n          />\r\n        </div>\r\n\r\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(300px, 1fr))', gap: '1.5rem' }}>\r\n          {filteredTasks.map((task) => (\r\n            <div\r\n              key={task.id}\r\n              style={{\r\n                background: 'white',\r\n                borderRadius: '8px',\r\n                padding: '1.5rem',\r\n                boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n              }}\r\n            >\r\n              <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '1rem' }}>\r\n                <Sparkles size={24} style={{ color: '#8b5cf6' }} />\r\n                <div>\r\n                  <h3 style={{ margin: 0, color: '#1e293b' }}>Room {task.room?.roomNumber}</h3>\r\n                  <p style={{ margin: 0, color: '#64748b', fontSize: '0.875rem' }}>{task.taskType}</p>\r\n                </div>\r\n              </div>\r\n\r\n              <div style={{ marginBottom: '1rem' }}>\r\n                <span\r\n                  style={{\r\n                    padding: '0.25rem 0.75rem',\r\n                    borderRadius: '12px',\r\n                    fontSize: '0.75rem',\r\n                    fontWeight: '500',\r\n                    background:\r\n                      task.status === 'completed'\r\n                        ? '#d1fae5'\r\n                        : task.status === 'in_progress'\r\n                        ? '#dbeafe'\r\n                        : '#fee2e2',\r\n                    color:\r\n                      task.status === 'completed'\r\n                        ? '#065f46'\r\n                        : task.status === 'in_progress'\r\n                        ? '#1e40af'\r\n                        : '#991b1b',\r\n                  }}\r\n                >\r\n                  {task.status.replace('_', ' ').toUpperCase()}\r\n                </span>\r\n              </div>\r\n\r\n              {task.assignedStaff && (\r\n                <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '1rem' }}>\r\n                  Assigned to: {task.assignedStaff.firstName} {task.assignedStaff.lastName}\r\n                </div>\r\n              )}\r\n\r\n              {task.status !== 'completed' && (\r\n                <button\r\n                  onClick={() => handleCompleteTask(task.id)}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    background: '#10b981',\r\n                    color: 'white',\r\n                    border: 'none',\r\n                    borderRadius: '6px',\r\n                    cursor: 'pointer',\r\n                    fontWeight: '500',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'center',\r\n                    gap: '0.5rem',\r\n                    transition: 'all 0.2s',\r\n                  }}\r\n                  onMouseEnter={(e) => {\r\n                    e.currentTarget.style.background = '#059669';\r\n                  }}\r\n                  onMouseLeave={(e) => {\r\n                    e.currentTarget.style.background = '#10b981';\r\n                  }}\r\n                >\r\n                  <CheckCircle size={18} />\r\n                  Complete Task\r\n                </button>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        {!loading && filteredTasks.length === 0 && (\r\n          <EmptyState\r\n            icon={Sparkles}\r\n            title={searchTerm ? 'No tasks match your search' : 'No housekeeping tasks yet'}\r\n            description={searchTerm \r\n              ? 'Try adjusting your search terms to find tasks' \r\n              : 'Create your first housekeeping task to get started'}\r\n            action={searchTerm ? undefined : {\r\n              label: 'Create Task',\r\n              onClick: () => setShowCreateModal(true),\r\n            }}\r\n          />\r\n        )}\r\n\r\n        {showCreateModal && (\r\n          <CreateTaskModal\r\n            onClose={() => setShowCreateModal(false)}\r\n            onSuccess={() => {\r\n              setShowCreateModal(false);\r\n              fetchTasks();\r\n            }}\r\n          />\r\n        )}\r\n\r\n        {selectedTask && (\r\n          <CompleteTaskModal\r\n            task={selectedTask}\r\n            onClose={() => setSelectedTask(null)}\r\n            onSuccess={() => {\r\n              setSelectedTask(null);\r\n              fetchTasks();\r\n            }}\r\n          />\r\n        )}\r\n      </div>\r\n    </Layout>\r\n  );\r\n}\r\n\r\nfunction CreateTaskModal({\r\n  onClose,\r\n  onSuccess,\r\n}: {\r\n  onClose: () => void;\r\n  onSuccess: () => void;\r\n}) {\r\n  const { user } = useAuthStore();\r\n  const [rooms, setRooms] = useState<any[]>([]);\r\n  const [formData, setFormData] = useState({\r\n    roomId: '',\r\n    taskType: 'cleaning' as 'cleaning' | 'inspection' | 'maintenance_prep',\r\n    assignedTo: '',\r\n    notes: '',\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    fetchRooms();\r\n  }, []);\r\n\r\n  const fetchRooms = async () => {\r\n    try {\r\n      const response = await api.get(`/tenants/${user?.tenantId}/rooms`);\r\n      setRooms(response.data.data || []);\r\n    } catch (error) {\r\n      console.error('Failed to fetch rooms:', error);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    try {\r\n      await api.post(`/tenants/${user?.tenantId}/housekeeping`, {\r\n        roomId: formData.roomId,\r\n        taskType: formData.taskType,\r\n        assignedTo: formData.assignedTo || undefined,\r\n        notes: formData.notes || undefined,\r\n      });\r\n      toast.success('Task created successfully');\r\n      onSuccess();\r\n    } catch (error: any) {\r\n      // Error handled by API interceptor\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0,0,0,0.5)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 1000,\r\n        padding: '1rem',\r\n      }}\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        style={{\r\n          background: 'white',\r\n          borderRadius: '8px',\r\n          padding: '2rem',\r\n          width: '100%',\r\n          maxWidth: '500px',\r\n        }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <h2 style={{ color: '#1e293b' }}>Create Housekeeping Task</h2>\r\n          <button\r\n            onClick={onClose}\r\n            style={{\r\n              background: 'none',\r\n              border: 'none',\r\n              fontSize: '1.5rem',\r\n              cursor: 'pointer',\r\n              color: '#94a3b8',\r\n            }}\r\n          >\r\n            <X size={24} />\r\n          </button>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit}>\r\n          <div style={{ display: 'grid', gap: '1rem' }}>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Room *\r\n              </label>\r\n              <select\r\n                value={formData.roomId}\r\n                onChange={(e) => setFormData({ ...formData, roomId: e.target.value })}\r\n                required\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                }}\r\n              >\r\n                <option value=\"\">Select a room</option>\r\n                {rooms.map((room) => (\r\n                  <option key={room.id} value={room.id}>\r\n                    {room.roomNumber} - {room.roomType}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Task Type *\r\n              </label>\r\n              <select\r\n                value={formData.taskType}\r\n                onChange={(e) => setFormData({ ...formData, taskType: e.target.value as any })}\r\n                required\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                }}\r\n              >\r\n                <option value=\"cleaning\">Cleaning</option>\r\n                <option value=\"inspection\">Inspection</option>\r\n                <option value=\"maintenance_prep\">Maintenance Prep</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Notes\r\n              </label>\r\n              <textarea\r\n                value={formData.notes}\r\n                onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\r\n                rows={3}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                  resize: 'vertical',\r\n                }}\r\n                placeholder=\"Optional notes\"\r\n              />\r\n            </div>\r\n\r\n            <div style={{ display: 'flex', gap: '1rem', marginTop: '1rem' }}>\r\n              <button\r\n                type=\"button\"\r\n                onClick={onClose}\r\n                style={{\r\n                  flex: 1,\r\n                  padding: '0.75rem',\r\n                  background: '#f1f5f9',\r\n                  color: '#475569',\r\n                  border: 'none',\r\n                  borderRadius: '6px',\r\n                  cursor: 'pointer',\r\n                  fontWeight: '500',\r\n                }}\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                type=\"submit\"\r\n                disabled={loading}\r\n                style={{\r\n                  flex: 1,\r\n                  padding: '0.75rem',\r\n                  background: loading ? '#94a3b8' : '#3b82f6',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  borderRadius: '6px',\r\n                  cursor: loading ? 'not-allowed' : 'pointer',\r\n                  fontWeight: '500',\r\n                }}\r\n              >\r\n                {loading ? 'Creating...' : 'Create Task'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction CompleteTaskModal({\r\n  task,\r\n  onClose,\r\n  onSuccess,\r\n}: {\r\n  task: TaskDetails;\r\n  onClose: () => void;\r\n  onSuccess: () => void;\r\n}) {\r\n  const { user } = useAuthStore();\r\n  const [photos, setPhotos] = useState<string[]>([]);\r\n  const [notes, setNotes] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const handleUploadComplete = (urls: string[]) => {\r\n    setPhotos(urls);\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    try {\r\n      await api.post(`/tenants/${user?.tenantId}/housekeeping/${task.id}/complete`, {\r\n        photos: photos.length > 0 ? photos : undefined,\r\n        notes: notes || undefined,\r\n      });\r\n      toast.success('Task completed successfully');\r\n      onSuccess();\r\n    } catch (error: any) {\r\n      // Error handled by API interceptor\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0,0,0,0.5)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 1000,\r\n        padding: '1rem',\r\n      }}\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        style={{\r\n          background: 'white',\r\n          borderRadius: '8px',\r\n          padding: '2rem',\r\n          width: '100%',\r\n          maxWidth: '600px',\r\n          maxHeight: '90vh',\r\n          overflow: 'auto',\r\n        }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <h2 style={{ color: '#1e293b' }}>Complete Task - Room {task.room?.roomNumber}</h2>\r\n          <button\r\n            onClick={onClose}\r\n            style={{\r\n              background: 'none',\r\n              border: 'none',\r\n              fontSize: '1.5rem',\r\n              cursor: 'pointer',\r\n              color: '#94a3b8',\r\n            }}\r\n          >\r\n            <X size={24} />\r\n          </button>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit}>\r\n          <div style={{ display: 'grid', gap: '1.5rem' }}>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Upload Photos (Optional)\r\n              </label>\r\n              <FileUpload\r\n                onUploadComplete={handleUploadComplete}\r\n                maxFiles={5}\r\n                maxSizeMB={5}\r\n                accept=\"image/*\"\r\n                multiple={true}\r\n              />\r\n              {photos.length > 0 && (\r\n                <div style={{ marginTop: '1rem', display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(100px, 1fr))', gap: '0.5rem' }}>\r\n                  {photos.map((url, index) => (\r\n                    <img\r\n                      key={index}\r\n                      src={url}\r\n                      alt={`Photo ${index + 1}`}\r\n                      style={{\r\n                        width: '100%',\r\n                        height: '100px',\r\n                        objectFit: 'cover',\r\n                        borderRadius: '4px',\r\n                        border: '1px solid #e2e8f0',\r\n                      }}\r\n                    />\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Notes\r\n              </label>\r\n              <textarea\r\n                value={notes}\r\n                onChange={(e) => setNotes(e.target.value)}\r\n                rows={4}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                  resize: 'vertical',\r\n                }}\r\n                placeholder=\"Add any notes about the completed task...\"\r\n              />\r\n            </div>\r\n\r\n            <div style={{ display: 'flex', gap: '1rem', marginTop: '1rem' }}>\r\n              <button\r\n                type=\"button\"\r\n                onClick={onClose}\r\n                style={{\r\n                  flex: 1,\r\n                  padding: '0.75rem',\r\n                  background: '#f1f5f9',\r\n                  color: '#475569',\r\n                  border: 'none',\r\n                  borderRadius: '6px',\r\n                  cursor: 'pointer',\r\n                  fontWeight: '500',\r\n                }}\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                type=\"submit\"\r\n                disabled={loading}\r\n                style={{\r\n                  flex: 1,\r\n                  padding: '0.75rem',\r\n                  background: loading ? '#94a3b8' : '#10b981',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  borderRadius: '6px',\r\n                  cursor: loading ? 'not-allowed' : 'pointer',\r\n                  fontWeight: '500',\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  justifyContent: 'center',\r\n                  gap: '0.5rem',\r\n                }}\r\n              >\r\n                <CheckCircle size={18} />\r\n                {loading ? 'Completing...' : 'Complete Task'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\IntegrationPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\LoginPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\LostFoundPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadItems' and 'loadStats'. Either include them or remove the dependency array.","line":86,"column":6,"nodeType":"ArrayExpression","endLine":86,"endColumn":52,"suggestions":[{"desc":"Update the dependencies array to be: [user.tenantId, statusFilter, categoryFilter, loadItems, loadStats]","fix":{"range":[2212,2258],"text":"[user.tenantId, statusFilter, categoryFilter, loadItems, loadStats]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Button from '../components/Button';\r\nimport {\r\n  Plus,\r\n  Search,\r\n  Package,\r\n  User,\r\n  MapPin,\r\n  Calendar,\r\n  CheckCircle,\r\n  XCircle,\r\n  Clock,\r\n  AlertTriangle,\r\n  Edit,\r\n  Eye,\r\n  DollarSign,\r\n  Hash\r\n} from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\n\r\ninterface LostItem {\r\n  id: string;\r\n  itemNumber: string;\r\n  itemName: string;\r\n  description: string;\r\n  category: string;\r\n  color?: string;\r\n  brand?: string;\r\n  serialNumber?: string;\r\n  value?: number;\r\n  foundLocation: string;\r\n  foundBy?: string;\r\n  foundAt: string;\r\n  circumstances?: string;\r\n  reportedByGuestId?: string;\r\n  reportedByName?: string;\r\n  reportedByPhone?: string;\r\n  reportedByEmail?: string;\r\n  reportedByRoom?: string;\r\n  reportedAt?: string;\r\n  claimedBy?: string;\r\n  claimedAt?: string;\r\n  claimMethod?: string;\r\n  returnMethod?: string;\r\n  returnedTo?: string;\r\n  status: string;\r\n  storageLocation?: string;\r\n  storageNotes?: string;\r\n  disposedAt?: string;\r\n  disposedBy?: string;\r\n  disposalMethod?: string;\r\n  createdBy: string;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\ninterface ItemStats {\r\n  total: number;\r\n  unclaimed: number;\r\n  claimed: number;\r\n  returned: number;\r\n  disposed: number;\r\n  reported: number;\r\n  totalValue: number;\r\n  averageClaimTime: number;\r\n}\r\n\r\nexport default function LostFoundPage() {\r\n  const { user } = useAuthStore();\r\n  const [items, setItems] = useState<LostItem[]>([]);\r\n  const [stats, setStats] = useState<ItemStats | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [statusFilter, setStatusFilter] = useState<string>('all');\r\n  const [categoryFilter, setCategoryFilter] = useState<string>('all');\r\n  const [showRegisterModal, setShowRegisterModal] = useState(false);\r\n  const [showReportModal, setShowReportModal] = useState(false);\r\n  const [selectedItem, setSelectedItem] = useState<LostItem | null>(null);\r\n  const [showDetailsModal, setShowDetailsModal] = useState(false);\r\n\r\n  useEffect(() => {\r\n    loadItems();\r\n    loadStats();\r\n  }, [user?.tenantId, statusFilter, categoryFilter]);\r\n\r\n  const loadItems = async () => {\r\n    if (!user?.tenantId) return;\r\n\r\n    try {\r\n      const params = new URLSearchParams();\r\n      if (statusFilter !== 'all') params.append('status', statusFilter);\r\n      if (categoryFilter !== 'all') params.append('category', categoryFilter);\r\n\r\n      const response = await api.get(`/tenants/${user.tenantId}/lost-found?${params}`);\r\n      setItems(response.data.data);\r\n    } catch (error) {\r\n      console.error('Error loading lost items:', error);\r\n      toast.error('Failed to load lost items');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadStats = async () => {\r\n    if (!user?.tenantId) return;\r\n\r\n    try {\r\n      const response = await api.get(`/tenants/${user.tenantId}/lost-found/stats/summary`);\r\n      setStats(response.data.data);\r\n    } catch (error) {\r\n      console.error('Error loading item stats:', error);\r\n    }\r\n  };\r\n\r\n  const filteredItems = items.filter(item =>\r\n    item.itemName.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    item.description.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    item.itemNumber.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    item.reportedByName?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    item.brand?.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'unclaimed': return '#f59e0b';\r\n      case 'claimed': return '#10b981';\r\n      case 'returned': return '#3b82f6';\r\n      case 'disposed': return '#6b7280';\r\n      case 'reported': return '#8b5cf6';\r\n      default: return '#6b7280';\r\n    }\r\n  };\r\n\r\n  const getStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'unclaimed': return Clock;\r\n      case 'claimed': return CheckCircle;\r\n      case 'returned': return CheckCircle;\r\n      case 'disposed': return XCircle;\r\n      case 'reported': return AlertTriangle;\r\n      default: return Package;\r\n    }\r\n  };\r\n\r\n  const getCategoryColor = (category: string) => {\r\n    switch (category) {\r\n      case 'electronics': return '#3b82f6';\r\n      case 'clothing': return '#10b981';\r\n      case 'jewelry': return '#f59e0b';\r\n      case 'documents': return '#ef4444';\r\n      default: return '#6b7280';\r\n    }\r\n  };\r\n\r\n  const formatCurrency = (amount: number) => {\r\n    return new Intl.NumberFormat('en-NG', {\r\n      style: 'currency',\r\n      currency: 'NGN'\r\n    }).format(amount);\r\n  };\r\n\r\n\r\n  const getTimeAgo = (dateString: string) => {\r\n    const now = new Date();\r\n    const date = new Date(dateString);\r\n    const diffInHours = Math.floor((now.getTime() - date.getTime()) / (1000 * 60 * 60));\r\n\r\n    if (diffInHours < 1) return 'Just now';\r\n    if (diffInHours < 24) return `${diffInHours}h ago`;\r\n    const diffInDays = Math.floor(diffInHours / 24);\r\n    if (diffInDays < 7) return `${diffInDays}d ago`;\r\n    const diffInWeeks = Math.floor(diffInDays / 7);\r\n    return `${diffInWeeks}w ago`;\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: '2rem', maxWidth: '1400px', margin: '0 auto' }}>\r\n      <div style={{ marginBottom: '2rem' }}>\r\n        <h1 style={{ fontSize: '2rem', fontWeight: 'bold', marginBottom: '0.5rem' }}>\r\n          Lost & Found\r\n        </h1>\r\n        <p style={{ color: '#64748b' }}>\r\n          Manage found items, lost item reports, and item recovery\r\n        </p>\r\n      </div>\r\n\r\n      {/* Stats Cards */}\r\n      {stats && (\r\n        <div style={{\r\n          display: 'grid',\r\n          gridTemplateColumns: 'repeat(auto-fit, minmax(180px, 1fr))',\r\n          gap: '1rem',\r\n          marginBottom: '2rem'\r\n        }}>\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#1f2937' }}>\r\n              {stats.total}\r\n            </div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Total Items</div>\r\n          </div>\r\n\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#f59e0b' }}>\r\n              {stats.unclaimed}\r\n            </div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Unclaimed</div>\r\n          </div>\r\n\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#10b981' }}>\r\n              {stats.claimed}\r\n            </div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Claimed</div>\r\n          </div>\r\n\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#3b82f6' }}>\r\n              {stats.returned}\r\n            </div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Returned</div>\r\n          </div>\r\n\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#8b5cf6' }}>\r\n              {formatCurrency(stats.totalValue)}\r\n            </div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Total Value</div>\r\n          </div>\r\n\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            textAlign: 'center'\r\n          }}>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#f97316' }}>\r\n              {stats.averageClaimTime.toFixed(1)}d\r\n            </div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Avg Claim Time</div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Action Buttons */}\r\n      <div style={{\r\n        background: 'white',\r\n        border: '1px solid #e2e8f0',\r\n        borderRadius: '8px',\r\n        padding: '1.5rem',\r\n        marginBottom: '2rem'\r\n      }}>\r\n        <div style={{ display: 'flex', gap: '1rem', flexWrap: 'wrap' }}>\r\n          <Button onClick={() => setShowRegisterModal(true)}>\r\n            <Plus size={18} style={{ marginRight: '0.5rem' }} />\r\n            Register Found Item\r\n          </Button>\r\n          <Button variant=\"secondary\" onClick={() => setShowReportModal(true)}>\r\n            <AlertTriangle size={18} style={{ marginRight: '0.5rem' }} />\r\n            Report Lost Item\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filters and Search */}\r\n      <div style={{\r\n        background: 'white',\r\n        border: '1px solid #e2e8f0',\r\n        borderRadius: '8px',\r\n        padding: '1.5rem',\r\n        marginBottom: '2rem'\r\n      }}>\r\n        <div style={{\r\n          display: 'flex',\r\n          flexWrap: 'wrap',\r\n          gap: '1rem',\r\n          alignItems: 'center'\r\n        }}>\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', flex: 1, minWidth: '250px' }}>\r\n            <Search size={18} style={{ color: '#64748b' }} />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search items...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              style={{\r\n                flex: 1,\r\n                padding: '0.5rem 0.75rem',\r\n                border: '1px solid #d1d5db',\r\n                borderRadius: '6px',\r\n                fontSize: '0.875rem'\r\n              }}\r\n            />\r\n          </div>\r\n\r\n          <select\r\n            value={statusFilter}\r\n            onChange={(e) => setStatusFilter(e.target.value)}\r\n            style={{\r\n              padding: '0.5rem 0.75rem',\r\n              border: '1px solid #d1d5db',\r\n              borderRadius: '6px',\r\n              fontSize: '0.875rem',\r\n              minWidth: '140px'\r\n            }}\r\n          >\r\n            <option value=\"all\">All Status</option>\r\n            <option value=\"unclaimed\">Unclaimed</option>\r\n            <option value=\"claimed\">Claimed</option>\r\n            <option value=\"returned\">Returned</option>\r\n            <option value=\"reported\">Reported</option>\r\n            <option value=\"disposed\">Disposed</option>\r\n          </select>\r\n\r\n          <select\r\n            value={categoryFilter}\r\n            onChange={(e) => setCategoryFilter(e.target.value)}\r\n            style={{\r\n              padding: '0.5rem 0.75rem',\r\n              border: '1px solid #d1d5db',\r\n              borderRadius: '6px',\r\n              fontSize: '0.875rem',\r\n              minWidth: '140px'\r\n            }}\r\n          >\r\n            <option value=\"all\">All Categories</option>\r\n            <option value=\"electronics\">Electronics</option>\r\n            <option value=\"clothing\">Clothing</option>\r\n            <option value=\"jewelry\">Jewelry</option>\r\n            <option value=\"documents\">Documents</option>\r\n            <option value=\"other\">Other</option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Items Grid */}\r\n      {loading ? (\r\n        <div style={{ textAlign: 'center', padding: '3rem' }}>\r\n          Loading items...\r\n        </div>\r\n      ) : filteredItems.length === 0 ? (\r\n        <div style={{\r\n          textAlign: 'center',\r\n          padding: '3rem',\r\n          border: '2px dashed #e2e8f0',\r\n          borderRadius: '8px'\r\n        }}>\r\n          <Package size={48} style={{ color: '#cbd5e1', marginBottom: '1rem' }} />\r\n          <h3 style={{ fontSize: '1.25rem', fontWeight: '600', marginBottom: '0.5rem' }}>\r\n            No Items Found\r\n          </h3>\r\n          <p style={{ color: '#64748b', marginBottom: '1.5rem' }}>\r\n            {searchTerm || statusFilter !== 'all' || categoryFilter !== 'all'\r\n              ? 'No items match your current filters.'\r\n              : 'No lost or found items have been registered yet.'}\r\n          </p>\r\n          <div style={{ display: 'flex', gap: '1rem', justifyContent: 'center' }}>\r\n            <Button onClick={() => setShowRegisterModal(true)}>\r\n              <Plus size={18} style={{ marginRight: '0.5rem' }} />\r\n              Register Found Item\r\n            </Button>\r\n            <Button variant=\"secondary\" onClick={() => setShowReportModal(true)}>\r\n              <AlertTriangle size={18} style={{ marginRight: '0.5rem' }} />\r\n              Report Lost Item\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <div style={{\r\n          display: 'grid',\r\n          gridTemplateColumns: 'repeat(auto-fill, minmax(320px, 1fr))',\r\n          gap: '1.5rem'\r\n        }}>\r\n          {filteredItems.map((item) => {\r\n            const StatusIcon = getStatusIcon(item.status);\r\n            return (\r\n              <div\r\n                key={item.id}\r\n                style={{\r\n                  background: 'white',\r\n                  border: '1px solid #e2e8f0',\r\n                  borderRadius: '12px',\r\n                  overflow: 'hidden',\r\n                  cursor: 'pointer',\r\n                  transition: 'all 0.2s'\r\n                }}\r\n                onClick={() => {\r\n                  setSelectedItem(item);\r\n                  setShowDetailsModal(true);\r\n                }}\r\n              >\r\n                <div style={{\r\n                  padding: '1.5rem',\r\n                  borderBottom: item.status === 'unclaimed' ? '3px solid #f59e0b' :\r\n                                item.status === 'claimed' ? '3px solid #10b981' :\r\n                                item.status === 'returned' ? '3px solid #3b82f6' :\r\n                                item.status === 'reported' ? '3px solid #8b5cf6' : '3px solid #6b7280'\r\n                }}>\r\n                  <div style={{\r\n                    display: 'flex',\r\n                    justifyContent: 'space-between',\r\n                    alignItems: 'flex-start',\r\n                    marginBottom: '1rem'\r\n                  }}>\r\n                    <div style={{ flex: 1 }}>\r\n                      <div style={{\r\n                        display: 'flex',\r\n                        alignItems: 'center',\r\n                        gap: '0.5rem',\r\n                        marginBottom: '0.5rem'\r\n                      }}>\r\n                        <Package size={20} style={{ color: getCategoryColor(item.category) }} />\r\n                        <h3 style={{ fontSize: '1.125rem', fontWeight: '600', margin: 0 }}>\r\n                          {item.itemName}\r\n                        </h3>\r\n                      </div>\r\n\r\n                      <div style={{\r\n                        display: 'flex',\r\n                        alignItems: 'center',\r\n                        gap: '1rem',\r\n                        fontSize: '0.875rem',\r\n                        color: '#64748b',\r\n                        marginBottom: '0.5rem'\r\n                      }}>\r\n                        <span style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\r\n                          <Hash size={14} />\r\n                          {item.itemNumber}\r\n                        </span>\r\n                        <span style={{\r\n                          padding: '0.125rem 0.5rem',\r\n                          borderRadius: '4px',\r\n                          fontSize: '0.75rem',\r\n                          fontWeight: '500',\r\n                          background: `${getCategoryColor(item.category)}20`,\r\n                          color: getCategoryColor(item.category)\r\n                        }}>\r\n                          {item.category}\r\n                        </span>\r\n                      </div>\r\n\r\n                      <p style={{\r\n                        fontSize: '0.875rem',\r\n                        color: '#64748b',\r\n                        marginBottom: '1rem',\r\n                        lineHeight: '1.4',\r\n                        display: '-webkit-box',\r\n                        WebkitLineClamp: 2,\r\n                        WebkitBoxOrient: 'vertical',\r\n                        overflow: 'hidden'\r\n                      }}>\r\n                        {item.description}\r\n                      </p>\r\n                    </div>\r\n\r\n                    <div style={{\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: '0.5rem',\r\n                      marginLeft: '1rem'\r\n                    }}>\r\n                      <StatusIcon size={16} style={{ color: getStatusColor(item.status) }} />\r\n                      <span style={{\r\n                        padding: '0.25rem 0.5rem',\r\n                        borderRadius: '4px',\r\n                        fontSize: '0.75rem',\r\n                        fontWeight: '500',\r\n                        background: `${getStatusColor(item.status)}20`,\r\n                        color: getStatusColor(item.status)\r\n                      }}>\r\n                        {item.status}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Item Details */}\r\n                  <div style={{ display: 'grid', gap: '0.75rem', fontSize: '0.875rem' }}>\r\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', color: '#64748b' }}>\r\n                      <MapPin size={14} />\r\n                      <span>Found: {item.foundLocation}</span>\r\n                    </div>\r\n\r\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', color: '#64748b' }}>\r\n                      <Calendar size={14} />\r\n                      <span>{getTimeAgo(item.foundAt)}</span>\r\n                    </div>\r\n\r\n                    {item.value && (\r\n                      <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', color: '#64748b' }}>\r\n                        <DollarSign size={14} />\r\n                        <span>{formatCurrency(item.value)}</span>\r\n                      </div>\r\n                    )}\r\n\r\n                    {item.reportedByName && (\r\n                      <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', color: '#64748b' }}>\r\n                        <User size={14} />\r\n                        <span>Reported by: {item.reportedByName}</span>\r\n                      </div>\r\n                    )}\r\n\r\n                    {item.storageLocation && (\r\n                      <div style={{\r\n                        padding: '0.5rem',\r\n                        background: '#f8fafc',\r\n                        borderRadius: '4px',\r\n                        fontSize: '0.75rem',\r\n                        color: '#64748b'\r\n                      }}>\r\n                         {item.storageLocation}\r\n                        {item.storageNotes && (\r\n                          <div style={{ marginTop: '0.25rem', fontStyle: 'italic' }}>\r\n                            {item.storageNotes}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n\r\n                  {/* Action Buttons */}\r\n                  <div style={{\r\n                    display: 'flex',\r\n                    gap: '0.5rem',\r\n                    marginTop: '1rem',\r\n                    paddingTop: '1rem',\r\n                    borderTop: '1px solid #e2e8f0'\r\n                  }}>\r\n                    <Button variant=\"ghost\" size=\"sm\" style={{ flex: 1 }}>\r\n                      <Eye size={14} style={{ marginRight: '0.25rem' }} />\r\n                      View\r\n                    </Button>\r\n                    <Button variant=\"ghost\" size=\"sm\">\r\n                      <Edit size={14} />\r\n                    </Button>\r\n                    {item.status === 'unclaimed' && (\r\n                      <Button variant=\"ghost\" size=\"sm\" style={{ color: '#10b981' }}>\r\n                        <CheckCircle size={14} />\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      )}\r\n\r\n      {/* Register Found Item Modal Placeholder */}\r\n      {showRegisterModal && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: 'rgba(0, 0, 0, 0.5)',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          zIndex: 1000,\r\n          padding: '1rem'\r\n        }}>\r\n          <div style={{\r\n            background: 'white',\r\n            borderRadius: '12px',\r\n            width: '100%',\r\n            maxWidth: '500px'\r\n          }}>\r\n            <div style={{\r\n              display: 'flex',\r\n              justifyContent: 'space-between',\r\n              alignItems: 'center',\r\n              padding: '1.5rem',\r\n              borderBottom: '1px solid #e2e8f0'\r\n            }}>\r\n              <h2 style={{ fontSize: '1.5rem', fontWeight: '600' }}>\r\n                Register Found Item\r\n              </h2>\r\n              <button\r\n                onClick={() => setShowRegisterModal(false)}\r\n                style={{\r\n                  background: 'none',\r\n                  border: 'none',\r\n                  cursor: 'pointer',\r\n                  padding: '0.5rem',\r\n                  borderRadius: '6px',\r\n                  color: '#64748b'\r\n                }}\r\n              >\r\n                \r\n              </button>\r\n            </div>\r\n\r\n            <div style={{ padding: '1.5rem' }}>\r\n              <div style={{ textAlign: 'center', padding: '2rem', color: '#64748b' }}>\r\n                Item registration form will be implemented here\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Report Lost Item Modal Placeholder */}\r\n      {showReportModal && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: 'rgba(0, 0, 0, 0.5)',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          zIndex: 1000,\r\n          padding: '1rem'\r\n        }}>\r\n          <div style={{\r\n            background: 'white',\r\n            borderRadius: '12px',\r\n            width: '100%',\r\n            maxWidth: '500px'\r\n          }}>\r\n            <div style={{\r\n              display: 'flex',\r\n              justifyContent: 'space-between',\r\n              alignItems: 'center',\r\n              padding: '1.5rem',\r\n              borderBottom: '1px solid #e2e8f0'\r\n            }}>\r\n              <h2 style={{ fontSize: '1.5rem', fontWeight: '600' }}>\r\n                Report Lost Item\r\n              </h2>\r\n              <button\r\n                onClick={() => setShowReportModal(false)}\r\n                style={{\r\n                  background: 'none',\r\n                  border: 'none',\r\n                  cursor: 'pointer',\r\n                  padding: '0.5rem',\r\n                  borderRadius: '6px',\r\n                  color: '#64748b'\r\n                }}\r\n              >\r\n                \r\n              </button>\r\n            </div>\r\n\r\n            <div style={{ padding: '1.5rem' }}>\r\n              <div style={{ textAlign: 'center', padding: '2rem', color: '#64748b' }}>\r\n                Lost item reporting form will be implemented here\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Item Details Modal Placeholder */}\r\n      {showDetailsModal && selectedItem && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: 'rgba(0, 0, 0, 0.5)',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          zIndex: 1000,\r\n          padding: '1rem'\r\n        }}>\r\n          <div style={{\r\n            background: 'white',\r\n            borderRadius: '12px',\r\n            width: '100%',\r\n            maxWidth: '600px',\r\n            maxHeight: '90vh',\r\n            overflow: 'auto'\r\n          }}>\r\n            <div style={{\r\n              display: 'flex',\r\n              justifyContent: 'space-between',\r\n              alignItems: 'center',\r\n              padding: '1.5rem',\r\n              borderBottom: '1px solid #e2e8f0'\r\n            }}>\r\n              <h2 style={{ fontSize: '1.5rem', fontWeight: '600' }}>\r\n                {selectedItem.itemName} Details\r\n              </h2>\r\n              <button\r\n                onClick={() => setShowDetailsModal(false)}\r\n                style={{\r\n                  background: 'none',\r\n                  border: 'none',\r\n                  cursor: 'pointer',\r\n                  padding: '0.5rem',\r\n                  borderRadius: '6px',\r\n                  color: '#64748b'\r\n                }}\r\n              >\r\n                \r\n              </button>\r\n            </div>\r\n\r\n            <div style={{ padding: '1.5rem' }}>\r\n              <div style={{ textAlign: 'center', padding: '2rem', color: '#64748b' }}>\r\n                Detailed item management interface will be implemented here\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\MaintenancePage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchRooms'. Either include it or remove the dependency array.","line":385,"column":6,"nodeType":"ArrayExpression","endLine":385,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [fetchRooms]","fix":{"range":[14082,14084],"text":"[fetchRooms]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useCallback } from 'react';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Layout from '../components/Layout';\r\nimport { Wrench, Plus, X, CheckCircle } from 'lucide-react';\r\nimport { format } from 'date-fns';\r\nimport toast from 'react-hot-toast';\r\nimport { CardSkeleton } from '../components/LoadingSkeleton';\r\nimport FileUpload from '../components/FileUpload';\r\nimport EmptyState from '../components/EmptyState';\r\n\r\ninterface MaintenanceTicket {\r\n  id: string;\r\n  title: string;\r\n  description: string;\r\n  priority: string;\r\n  status: string;\r\n  createdAt: string;\r\n  resolvedAt?: string;\r\n  room?: {\r\n    roomNumber: string;\r\n  };\r\n  reporter: {\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n  assignedStaff?: {\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n  photos?: string[];\r\n}\r\n\r\nexport default function MaintenancePage() {\r\n  const { user } = useAuthStore();\r\n  const [tickets, setTickets] = useState<MaintenanceTicket[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [selectedTicket, setSelectedTicket] = useState<MaintenanceTicket | null>(null);\r\n  const [filters, setFilters] = useState({\r\n    status: '',\r\n    priority: '',\r\n  });\r\n  const [resolvingTickets, setResolvingTickets] = useState<Set<string>>(new Set());\r\n\r\n  const fetchTickets = useCallback(async () => {\r\n    if (!user?.tenantId) return;\r\n    setLoading(true);\r\n    try {\r\n      const params: any = {};\r\n      if (filters.status) params.status = filters.status;\r\n      if (filters.priority) params.priority = filters.priority;\r\n\r\n      const response = await api.get(`/tenants/${user.tenantId}/maintenance`, { params });\r\n      setTickets(response.data.data || []);\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch tickets:', error);\r\n      toast.error(error.response?.data?.error?.message || 'Failed to fetch tickets');\r\n      setTickets([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [user?.tenantId, filters]);\r\n\r\n  useEffect(() => {\r\n    fetchTickets();\r\n  }, [fetchTickets]);\r\n\r\n  const handleResolve = async (ticketId: string) => {\r\n    setResolvingTickets(prev => new Set(prev).add(ticketId));\r\n    try {\r\n      await api.patch(`/tenants/${user?.tenantId}/maintenance/${ticketId}`, {\r\n        status: 'resolved',\r\n        resolvedAt: new Date().toISOString(),\r\n      });\r\n      toast.success('Ticket resolved successfully');\r\n      fetchTickets();\r\n    } catch (error: any) {\r\n      // Error handled by API interceptor\r\n    } finally {\r\n      setResolvingTickets(prev => {\r\n        const next = new Set(prev);\r\n        next.delete(ticketId);\r\n        return next;\r\n      });\r\n    }\r\n  };\r\n\r\n  const getPriorityColor = (priority: string) => {\r\n    const colors: Record<string, { bg: string; text: string }> = {\r\n      urgent: { bg: '#fee2e2', text: '#991b1b' },\r\n      high: { bg: '#fef3c7', text: '#92400e' },\r\n      medium: { bg: '#dbeafe', text: '#1e40af' },\r\n      low: { bg: '#d1fae5', text: '#065f46' },\r\n    };\r\n    return colors[priority] || colors.medium;\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    const colors: Record<string, { bg: string; text: string }> = {\r\n      open: { bg: '#fee2e2', text: '#991b1b' },\r\n      assigned: { bg: '#fef3c7', text: '#92400e' },\r\n      in_progress: { bg: '#dbeafe', text: '#1e40af' },\r\n      resolved: { bg: '#d1fae5', text: '#065f46' },\r\n      closed: { bg: '#e5e7eb', text: '#374151' },\r\n    };\r\n    return colors[status] || colors.open;\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Layout>\r\n        <div>\r\n          <h1 style={{ marginBottom: '1.5rem', color: '#1e293b' }}>Maintenance</h1>\r\n          <CardSkeleton count={6} />\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  const openTickets = tickets.filter((t) => t.status !== 'resolved' && t.status !== 'closed').length;\r\n  const urgentTickets = tickets.filter((t) => t.priority === 'urgent' && t.status !== 'resolved').length;\r\n\r\n  return (\r\n    <Layout>\r\n      <div>\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <div>\r\n            <h1 style={{ margin: 0, color: '#1e293b' }}>Maintenance</h1>\r\n            <div style={{ display: 'flex', gap: '1rem', marginTop: '0.5rem', fontSize: '0.875rem', color: '#64748b' }}>\r\n              <span>{tickets.length} total tickets</span>\r\n              {openTickets > 0 && (\r\n                <span style={{ color: '#ef4444', fontWeight: '500' }}>{openTickets} open</span>\r\n              )}\r\n              {urgentTickets > 0 && (\r\n                <span style={{ color: '#991b1b', fontWeight: '500' }}>{urgentTickets} urgent</span>\r\n              )}\r\n            </div>\r\n          </div>\r\n          <button\r\n            onClick={() => setShowCreateModal(true)}\r\n            style={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.5rem',\r\n              padding: '0.75rem 1.5rem',\r\n              background: '#3b82f6',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '6px',\r\n              cursor: 'pointer',\r\n              fontWeight: '500',\r\n            }}\r\n          >\r\n            <Plus size={20} />\r\n            Create Ticket\r\n          </button>\r\n        </div>\r\n\r\n        {/* Filters */}\r\n        <div\r\n          style={{\r\n            background: 'white',\r\n            padding: '1rem',\r\n            borderRadius: '8px',\r\n            marginBottom: '1.5rem',\r\n            display: 'flex',\r\n            gap: '1rem',\r\n            flexWrap: 'wrap',\r\n          }}\r\n        >\r\n          <div>\r\n            <label style={{ display: 'block', marginBottom: '0.5rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n              Status\r\n            </label>\r\n            <select\r\n              value={filters.status}\r\n              onChange={(e) => setFilters({ ...filters, status: e.target.value })}\r\n              style={{\r\n                padding: '0.5rem',\r\n                border: '1px solid #cbd5e1',\r\n                borderRadius: '4px',\r\n                fontSize: '0.875rem',\r\n              }}\r\n            >\r\n              <option value=\"\">All</option>\r\n              <option value=\"open\">Open</option>\r\n              <option value=\"assigned\">Assigned</option>\r\n              <option value=\"in_progress\">In Progress</option>\r\n              <option value=\"resolved\">Resolved</option>\r\n              <option value=\"closed\">Closed</option>\r\n            </select>\r\n          </div>\r\n          <div>\r\n            <label style={{ display: 'block', marginBottom: '0.5rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n              Priority\r\n            </label>\r\n            <select\r\n              value={filters.priority}\r\n              onChange={(e) => setFilters({ ...filters, priority: e.target.value })}\r\n              style={{\r\n                padding: '0.5rem',\r\n                border: '1px solid #cbd5e1',\r\n                borderRadius: '4px',\r\n                fontSize: '0.875rem',\r\n              }}\r\n            >\r\n              <option value=\"\">All</option>\r\n              <option value=\"urgent\">Urgent</option>\r\n              <option value=\"high\">High</option>\r\n              <option value=\"medium\">Medium</option>\r\n              <option value=\"low\">Low</option>\r\n            </select>\r\n          </div>\r\n          <div style={{ display: 'flex', alignItems: 'flex-end' }}>\r\n            <button\r\n              onClick={() => setFilters({ status: '', priority: '' })}\r\n              style={{\r\n                padding: '0.5rem 1rem',\r\n                background: '#f1f5f9',\r\n                color: '#475569',\r\n                border: 'none',\r\n                borderRadius: '4px',\r\n                cursor: 'pointer',\r\n                fontSize: '0.875rem',\r\n              }}\r\n            >\r\n              Clear Filters\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Tickets Grid */}\r\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(350px, 1fr))', gap: '1.5rem' }}>\r\n          {tickets.map((ticket) => {\r\n            const priorityColor = getPriorityColor(ticket.priority);\r\n            const statusColor = getStatusColor(ticket.status);\r\n            return (\r\n              <div\r\n                key={ticket.id}\r\n                style={{\r\n                  background: 'white',\r\n                  borderRadius: '8px',\r\n                  padding: '1.5rem',\r\n                  boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n                  borderLeft: `4px solid ${priorityColor.text}`,\r\n                  cursor: 'pointer',\r\n                }}\r\n                onClick={() => setSelectedTicket(ticket)}\r\n              >\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start', marginBottom: '1rem' }}>\r\n                  <div>\r\n                    <h3 style={{ margin: 0, color: '#1e293b', marginBottom: '0.5rem' }}>{ticket.title}</h3>\r\n                    {ticket.room && (\r\n                      <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Room {ticket.room.roomNumber}</div>\r\n                    )}\r\n                  </div>\r\n                  <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem', alignItems: 'flex-end' }}>\r\n                    <span\r\n                      style={{\r\n                        padding: '0.25rem 0.75rem',\r\n                        borderRadius: '12px',\r\n                        fontSize: '0.75rem',\r\n                        fontWeight: '500',\r\n                        background: priorityColor.bg,\r\n                        color: priorityColor.text,\r\n                      }}\r\n                    >\r\n                      {ticket.priority.toUpperCase()}\r\n                    </span>\r\n                    <span\r\n                      style={{\r\n                        padding: '0.25rem 0.75rem',\r\n                        borderRadius: '12px',\r\n                        fontSize: '0.75rem',\r\n                        fontWeight: '500',\r\n                        background: statusColor.bg,\r\n                        color: statusColor.text,\r\n                      }}\r\n                    >\r\n                      {ticket.status.replace('_', ' ').toUpperCase()}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n\r\n                <p style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '1rem', lineHeight: '1.5' }}>\r\n                  {ticket.description.length > 100 ? `${ticket.description.substring(0, 100)}...` : ticket.description}\r\n                </p>\r\n\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', fontSize: '0.875rem', color: '#94a3b8' }}>\r\n                  <div>\r\n                    Reported by {ticket.reporter.firstName} {ticket.reporter.lastName}\r\n                  </div>\r\n                  <div>{format(new Date(ticket.createdAt), 'MMM dd, yyyy')}</div>\r\n                </div>\r\n\r\n                {ticket.status !== 'resolved' && ticket.status !== 'closed' && (\r\n                  <button\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleResolve(ticket.id);\r\n                    }}\r\n                    disabled={resolvingTickets.has(ticket.id)}\r\n                    style={{\r\n                      marginTop: '1rem',\r\n                      width: '100%',\r\n                      padding: '0.75rem',\r\n                      background: resolvingTickets.has(ticket.id) ? '#94a3b8' : '#10b981',\r\n                      color: 'white',\r\n                      border: 'none',\r\n                      borderRadius: '6px',\r\n                      cursor: resolvingTickets.has(ticket.id) ? 'not-allowed' : 'pointer',\r\n                      opacity: resolvingTickets.has(ticket.id) ? 0.6 : 1,\r\n                      fontWeight: '500',\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      justifyContent: 'center',\r\n                      gap: '0.5rem',\r\n                    }}\r\n                  >\r\n                    <CheckCircle size={18} />\r\n                    {resolvingTickets.has(ticket.id) ? 'Resolving...' : 'Resolve'}\r\n                  </button>\r\n                )}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {!loading && tickets.length === 0 && (\r\n          <EmptyState\r\n            icon={Wrench}\r\n            title={filters.status || filters.priority ? 'No tickets match your filters' : 'No maintenance tickets yet'}\r\n            description={filters.status || filters.priority\r\n              ? 'Try adjusting your filter criteria'\r\n              : 'Create your first maintenance ticket to get started'}\r\n            action={filters.status || filters.priority ? undefined : {\r\n              label: 'Create Ticket',\r\n              onClick: () => setShowCreateModal(true),\r\n            }}\r\n          />\r\n        )}\r\n\r\n        {showCreateModal && (\r\n          <CreateTicketModal\r\n            onClose={() => setShowCreateModal(false)}\r\n            onSuccess={() => {\r\n              setShowCreateModal(false);\r\n              fetchTickets();\r\n            }}\r\n          />\r\n        )}\r\n\r\n        {selectedTicket && (\r\n          <TicketDetailsModal\r\n            ticket={selectedTicket}\r\n            onClose={() => setSelectedTicket(null)}\r\n          />\r\n        )}\r\n      </div>\r\n    </Layout>\r\n  );\r\n}\r\n\r\nfunction CreateTicketModal({\r\n  onClose,\r\n  onSuccess,\r\n}: {\r\n  onClose: () => void;\r\n  onSuccess: () => void;\r\n}) {\r\n  const { user } = useAuthStore();\r\n  const [rooms, setRooms] = useState<any[]>([]);\r\n  const [photos, setPhotos] = useState<string[]>([]);\r\n  const [formData, setFormData] = useState({\r\n    roomId: '',\r\n    title: '',\r\n    description: '',\r\n    priority: 'medium' as 'low' | 'medium' | 'high' | 'urgent',\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    fetchRooms();\r\n  }, []);\r\n\r\n  const fetchRooms = async () => {\r\n    try {\r\n      const response = await api.get(`/tenants/${user?.tenantId}/rooms`);\r\n      setRooms(response.data.data || []);\r\n    } catch (error) {\r\n      console.error('Failed to fetch rooms:', error);\r\n    }\r\n  };\r\n\r\n  const handleUploadComplete = (urls: string[]) => {\r\n    setPhotos(urls);\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    try {\r\n      await api.post(`/tenants/${user?.tenantId}/maintenance`, {\r\n        roomId: formData.roomId || undefined,\r\n        title: formData.title,\r\n        description: formData.description,\r\n        priority: formData.priority,\r\n        photos: photos.length > 0 ? photos : undefined,\r\n      });\r\n      toast.success('Ticket created successfully');\r\n      onSuccess();\r\n    } catch (error: any) {\r\n      // Error handled by API interceptor\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0,0,0,0.5)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 1000,\r\n        padding: '1rem',\r\n      }}\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        style={{\r\n          background: 'white',\r\n          borderRadius: '8px',\r\n          padding: '2rem',\r\n          width: '100%',\r\n          maxWidth: '600px',\r\n          maxHeight: '90vh',\r\n          overflow: 'auto',\r\n        }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <h2 style={{ color: '#1e293b' }}>Create Maintenance Ticket</h2>\r\n          <button\r\n            onClick={onClose}\r\n            style={{\r\n              background: 'none',\r\n              border: 'none',\r\n              fontSize: '1.5rem',\r\n              cursor: 'pointer',\r\n              color: '#94a3b8',\r\n            }}\r\n          >\r\n            <X size={24} />\r\n          </button>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit}>\r\n          <div style={{ display: 'grid', gap: '1rem' }}>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Room (Optional)\r\n              </label>\r\n              <select\r\n                value={formData.roomId}\r\n                onChange={(e) => setFormData({ ...formData, roomId: e.target.value })}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                }}\r\n              >\r\n                <option value=\"\">Select a room (optional)</option>\r\n                {rooms.map((room) => (\r\n                  <option key={room.id} value={room.id}>\r\n                    {room.roomNumber} - {room.roomType}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Title *\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={formData.title}\r\n                onChange={(e) => setFormData({ ...formData, title: e.target.value })}\r\n                required\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                }}\r\n                placeholder=\"Brief description of the issue\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Description *\r\n              </label>\r\n              <textarea\r\n                value={formData.description}\r\n                onChange={(e) => setFormData({ ...formData, description: e.target.value })}\r\n                required\r\n                rows={4}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                  resize: 'vertical',\r\n                }}\r\n                placeholder=\"Detailed description of the maintenance issue\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Priority *\r\n              </label>\r\n              <select\r\n                value={formData.priority}\r\n                onChange={(e) => setFormData({ ...formData, priority: e.target.value as any })}\r\n                required\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                }}\r\n              >\r\n                <option value=\"low\">Low</option>\r\n                <option value=\"medium\">Medium</option>\r\n                <option value=\"high\">High</option>\r\n                <option value=\"urgent\">Urgent</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Photos (Optional)\r\n              </label>\r\n              <FileUpload\r\n                onUploadComplete={handleUploadComplete}\r\n                maxFiles={5}\r\n                maxSizeMB={5}\r\n                accept=\"image/*\"\r\n                multiple={true}\r\n              />\r\n            </div>\r\n\r\n            <div style={{ display: 'flex', gap: '1rem', marginTop: '1rem' }}>\r\n              <button\r\n                type=\"button\"\r\n                onClick={onClose}\r\n                style={{\r\n                  flex: 1,\r\n                  padding: '0.75rem',\r\n                  background: '#f1f5f9',\r\n                  color: '#475569',\r\n                  border: 'none',\r\n                  borderRadius: '6px',\r\n                  cursor: 'pointer',\r\n                  fontWeight: '500',\r\n                }}\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                type=\"submit\"\r\n                disabled={loading}\r\n                style={{\r\n                  flex: 1,\r\n                  padding: '0.75rem',\r\n                  background: loading ? '#94a3b8' : '#3b82f6',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  borderRadius: '6px',\r\n                  cursor: loading ? 'not-allowed' : 'pointer',\r\n                  fontWeight: '500',\r\n                }}\r\n              >\r\n                {loading ? 'Creating...' : 'Create Ticket'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction TicketDetailsModal({\r\n  ticket,\r\n  onClose,\r\n}: {\r\n  ticket: MaintenanceTicket;\r\n  onClose: () => void;\r\n}) {\r\n  const priorityColor = getPriorityColor(ticket.priority);\r\n  const statusColor = getStatusColor(ticket.status);\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0,0,0,0.5)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 1000,\r\n        padding: '1rem',\r\n      }}\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        style={{\r\n          background: 'white',\r\n          borderRadius: '8px',\r\n          padding: '2rem',\r\n          width: '100%',\r\n          maxWidth: '700px',\r\n          maxHeight: '90vh',\r\n          overflow: 'auto',\r\n        }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <h2 style={{ color: '#1e293b' }}>{ticket.title}</h2>\r\n          <button\r\n            onClick={onClose}\r\n            style={{\r\n              background: 'none',\r\n              border: 'none',\r\n              fontSize: '1.5rem',\r\n              cursor: 'pointer',\r\n              color: '#94a3b8',\r\n            }}\r\n          >\r\n            <X size={24} />\r\n          </button>\r\n        </div>\r\n\r\n        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1.5rem' }}>\r\n          <span\r\n            style={{\r\n              padding: '0.25rem 0.75rem',\r\n              borderRadius: '12px',\r\n              fontSize: '0.75rem',\r\n              fontWeight: '500',\r\n              background: priorityColor.bg,\r\n              color: priorityColor.text,\r\n            }}\r\n          >\r\n            {ticket.priority.toUpperCase()}\r\n          </span>\r\n          <span\r\n            style={{\r\n              padding: '0.25rem 0.75rem',\r\n              borderRadius: '12px',\r\n              fontSize: '0.75rem',\r\n              fontWeight: '500',\r\n              background: statusColor.bg,\r\n              color: statusColor.text,\r\n            }}\r\n          >\r\n            {ticket.status.replace('_', ' ').toUpperCase()}\r\n          </span>\r\n        </div>\r\n\r\n        <div style={{ marginBottom: '1.5rem' }}>\r\n          <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.5rem' }}>Description</div>\r\n          <div style={{ color: '#1e293b', lineHeight: '1.6' }}>{ticket.description}</div>\r\n        </div>\r\n\r\n        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem', marginBottom: '1.5rem' }}>\r\n          {ticket.room && (\r\n            <div>\r\n              <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.25rem' }}>Room</div>\r\n              <div style={{ fontWeight: '500', color: '#1e293b' }}>{ticket.room.roomNumber}</div>\r\n            </div>\r\n          )}\r\n          <div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.25rem' }}>Reported By</div>\r\n            <div style={{ fontWeight: '500', color: '#1e293b' }}>\r\n              {ticket.reporter.firstName} {ticket.reporter.lastName}\r\n            </div>\r\n          </div>\r\n          <div>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.25rem' }}>Created</div>\r\n            <div style={{ fontWeight: '500', color: '#1e293b' }}>\r\n              {format(new Date(ticket.createdAt), 'MMM dd, yyyy HH:mm')}\r\n            </div>\r\n          </div>\r\n          {ticket.resolvedAt && (\r\n            <div>\r\n              <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.25rem' }}>Resolved</div>\r\n              <div style={{ fontWeight: '500', color: '#1e293b' }}>\r\n                {format(new Date(ticket.resolvedAt), 'MMM dd, yyyy HH:mm')}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {ticket.photos && ticket.photos.length > 0 && (\r\n          <div style={{ marginBottom: '1.5rem' }}>\r\n            <div style={{ color: '#64748b', fontSize: '0.875rem', marginBottom: '0.5rem' }}>Photos</div>\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(150px, 1fr))', gap: '0.5rem' }}>\r\n              {ticket.photos.map((photo, index) => (\r\n                <img\r\n                  key={index}\r\n                  src={photo}\r\n                  alt={`Photo ${index + 1}`}\r\n                  style={{\r\n                    width: '100%',\r\n                    height: '150px',\r\n                    objectFit: 'cover',\r\n                    borderRadius: '4px',\r\n                    border: '1px solid #e2e8f0',\r\n                  }}\r\n                />\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <button\r\n          onClick={onClose}\r\n          style={{\r\n            width: '100%',\r\n            padding: '0.75rem',\r\n            background: '#f1f5f9',\r\n            color: '#475569',\r\n            border: 'none',\r\n            borderRadius: '6px',\r\n            cursor: 'pointer',\r\n            fontWeight: '500',\r\n          }}\r\n        >\r\n          Close\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction getPriorityColor(priority: string) {\r\n  const colors: Record<string, { bg: string; text: string }> = {\r\n    urgent: { bg: '#fee2e2', text: '#991b1b' },\r\n    high: { bg: '#fef3c7', text: '#92400e' },\r\n    medium: { bg: '#dbeafe', text: '#1e40af' },\r\n    low: { bg: '#d1fae5', text: '#065f46' },\r\n  };\r\n  return colors[priority] || colors.medium;\r\n}\r\n\r\nfunction getStatusColor(status: string) {\r\n  const colors: Record<string, { bg: string; text: string }> = {\r\n    open: { bg: '#fee2e2', text: '#991b1b' },\r\n    assigned: { bg: '#fef3c7', text: '#92400e' },\r\n    in_progress: { bg: '#dbeafe', text: '#1e40af' },\r\n    resolved: { bg: '#d1fae5', text: '#065f46' },\r\n    closed: { bg: '#e5e7eb', text: '#374151' },\r\n  };\r\n  return colors[status] || colors.open;\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\NightAuditPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchAudits'. Either include it or remove the dependency array.","line":54,"column":6,"nodeType":"ArrayExpression","endLine":54,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [fetchAudits, user]","fix":{"range":[1752,1758],"text":"[fetchAudits, user]"}}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":354,"column":72,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[13745,13862],"text":"\r\n                  Select the date to audit (typically yesterday). Today&apos;s date cannot be audited.\r\n                "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[13745,13862],"text":"\r\n                  Select the date to audit (typically yesterday). Today&lsquo;s date cannot be audited.\r\n                "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[13745,13862],"text":"\r\n                  Select the date to audit (typically yesterday). Today&#39;s date cannot be audited.\r\n                "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[13745,13862],"text":"\r\n                  Select the date to audit (typically yesterday). Today&rsquo;s date cannot be audited.\r\n                "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from 'react';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Layout from '../components/Layout';\r\nimport { Moon, Calendar, CheckCircle, AlertTriangle, Eye, Play } from 'lucide-react';\r\nimport { format, subDays } from 'date-fns';\r\nimport toast from 'react-hot-toast';\r\nimport { TableSkeleton } from '../components/LoadingSkeleton';\r\n\r\ninterface NightAudit {\r\n  id: string;\r\n  auditDate: string;\r\n  status: 'completed' | 'completed_with_warnings';\r\n  summary: {\r\n    totalRooms: number;\r\n    checkedIn: number;\r\n    checkedOut: number;\r\n    noShows: number;\r\n    cancellations: number;\r\n    roomNights: number;\r\n    occupancyRate: number;\r\n    totalRevenue: number;\r\n    revenueByMethod: Record<string, number>;\r\n    totalCharges: number;\r\n    totalPayments: number;\r\n    outstandingBalance: number;\r\n    adr: number;\r\n    revpar: number;\r\n    openShifts: number;\r\n    roomsUpdated: number;\r\n  };\r\n  discrepancies: string[] | null;\r\n  auditDateTime: string | Date;\r\n  performedByUser?: {\r\n    id: string;\r\n    firstName: string | null;\r\n    lastName: string | null;\r\n    email: string | null;\r\n  } | null;\r\n}\r\n\r\nexport default function NightAuditPage() {\r\n  const { user } = useAuthStore();\r\n  const [audits, setAudits] = useState<NightAudit[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [runningAudit, setRunningAudit] = useState(false);\r\n  const [selectedAudit, setSelectedAudit] = useState<NightAudit | null>(null);\r\n  const [showRunModal, setShowRunModal] = useState(false);\r\n  const [auditDate, setAuditDate] = useState(format(subDays(new Date(), 1), 'yyyy-MM-dd'));\r\n\r\n  useEffect(() => {\r\n    if (!user?.tenantId) return;\r\n    fetchAudits();\r\n  }, [user]);\r\n\r\n  const fetchAudits = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await api.get(`/tenants/${user?.tenantId}/reports/night-audit`, {\r\n        params: { limit: 50 },\r\n      });\r\n      setAudits(response.data.data || []);\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch night audits:', error);\r\n      toast.error(error.response?.data?.message || 'Failed to fetch night audits');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleRunAudit = async () => {\r\n    if (!auditDate) {\r\n      toast.error('Please select a date');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setRunningAudit(true);\r\n      const response = await api.post(`/tenants/${user?.tenantId}/reports/night-audit`, {\r\n        auditDate,\r\n      });\r\n      toast.success(response.data.message || 'Night audit completed successfully');\r\n      setShowRunModal(false);\r\n      fetchAudits();\r\n      \r\n      // If there are discrepancies, show them\r\n      if (response.data.data?.discrepancies?.length > 0) {\r\n        toast.error(`Audit completed with ${response.data.data.discrepancies.length} discrepancy(ies)`, {\r\n          duration: 5000,\r\n        });\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Failed to run night audit:', error);\r\n      toast.error(error.response?.data?.message || 'Failed to run night audit');\r\n    } finally {\r\n      setRunningAudit(false);\r\n    }\r\n  };\r\n\r\n  const handleViewAudit = async (auditDate: string) => {\r\n    try {\r\n      const response = await api.get(`/tenants/${user?.tenantId}/reports/night-audit/${auditDate}`);\r\n      setSelectedAudit(response.data.data);\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch audit details:', error);\r\n      toast.error(error.response?.data?.message || 'Failed to fetch audit details');\r\n    }\r\n  };\r\n\r\n  // Check if user has permission (owner, general_manager, accountant)\r\n  const canRunAudit = user?.role === 'owner' || \r\n                      user?.role === 'general_manager' || \r\n                      user?.role === 'accountant' || \r\n                      user?.role === 'iitech_admin';\r\n\r\n  if (loading) {\r\n    return (\r\n      <Layout>\r\n        <div style={{ padding: '2rem' }}>\r\n          <TableSkeleton />\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Layout>\r\n      <div style={{ padding: '2rem' }}>\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '2rem' }}>\r\n          <div>\r\n            <h1 style={{ margin: 0, fontSize: '1.875rem', fontWeight: '700', color: '#000' }}>\r\n              Night Audit\r\n            </h1>\r\n            <p style={{ margin: '0.5rem 0 0 0', color: '#64748b', fontSize: '0.875rem' }}>\r\n              Daily closing reports and transaction reconciliation\r\n            </p>\r\n          </div>\r\n          {canRunAudit && (\r\n            <button\r\n              onClick={() => setShowRunModal(true)}\r\n              style={{\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: '0.5rem',\r\n                padding: '0.75rem 1.5rem',\r\n                background: '#000',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '6px',\r\n                cursor: 'pointer',\r\n                fontWeight: '600',\r\n                fontSize: '0.875rem',\r\n              }}\r\n              onMouseEnter={(e) => {\r\n                e.currentTarget.style.background = '#333';\r\n              }}\r\n              onMouseLeave={(e) => {\r\n                e.currentTarget.style.background = '#000';\r\n              }}\r\n            >\r\n              <Play size={16} />\r\n              Run Night Audit\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        {audits.length === 0 ? (\r\n          <div\r\n            style={{\r\n              background: 'white',\r\n              borderRadius: '8px',\r\n              padding: '3rem',\r\n              textAlign: 'center',\r\n              border: '1px solid #e2e8f0',\r\n            }}\r\n          >\r\n            <Moon size={48} style={{ margin: '0 auto 1rem', color: '#cbd5e1' }} />\r\n            <h3 style={{ margin: '0 0 0.5rem 0', color: '#000', fontSize: '1.25rem' }}>\r\n              No Night Audits Yet\r\n            </h3>\r\n            <p style={{ margin: 0, color: '#64748b' }}>\r\n              {canRunAudit\r\n                ? 'Run your first night audit to generate daily closing reports'\r\n                : 'Contact your manager to run night audits'}\r\n            </p>\r\n          </div>\r\n        ) : (\r\n          <div\r\n            style={{\r\n              background: 'white',\r\n              borderRadius: '8px',\r\n              border: '1px solid #e2e8f0',\r\n              overflow: 'hidden',\r\n            }}\r\n          >\r\n            <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n              <thead>\r\n                <tr style={{ background: '#f8fafc', borderBottom: '1px solid #e2e8f0' }}>\r\n                  <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#000', fontSize: '0.875rem' }}>\r\n                    Audit Date\r\n                  </th>\r\n                  <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#000', fontSize: '0.875rem' }}>\r\n                    Status\r\n                  </th>\r\n                  <th style={{ padding: '1rem', textAlign: 'right', fontWeight: '600', color: '#000', fontSize: '0.875rem' }}>\r\n                    Revenue\r\n                  </th>\r\n                  <th style={{ padding: '1rem', textAlign: 'right', fontWeight: '600', color: '#000', fontSize: '0.875rem' }}>\r\n                    Occupancy\r\n                  </th>\r\n                  <th style={{ padding: '1rem', textAlign: 'right', fontWeight: '600', color: '#000', fontSize: '0.875rem' }}>\r\n                    ADR\r\n                  </th>\r\n                  <th style={{ padding: '1rem', textAlign: 'right', fontWeight: '600', color: '#000', fontSize: '0.875rem' }}>\r\n                    RevPAR\r\n                  </th>\r\n                  <th style={{ padding: '1rem', textAlign: 'center', fontWeight: '600', color: '#000', fontSize: '0.875rem' }}>\r\n                    Actions\r\n                  </th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {audits.map((audit) => (\r\n                  <tr\r\n                    key={audit.id}\r\n                    style={{\r\n                      borderBottom: '1px solid #f1f5f9',\r\n                      cursor: 'pointer',\r\n                    }}\r\n                    onMouseEnter={(e) => {\r\n                      e.currentTarget.style.background = '#f8fafc';\r\n                    }}\r\n                    onMouseLeave={(e) => {\r\n                      e.currentTarget.style.background = 'white';\r\n                    }}\r\n                  >\r\n                    <td style={{ padding: '1rem', color: '#000' }}>\r\n                      <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n                        <Calendar size={16} style={{ color: '#64748b' }} />\r\n                        {format(new Date(audit.auditDate), 'MMM dd, yyyy')}\r\n                      </div>\r\n                    </td>\r\n                    <td style={{ padding: '1rem' }}>\r\n                      <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n                        {audit.status === 'completed' ? (\r\n                          <>\r\n                            <CheckCircle size={16} style={{ color: '#10b981' }} />\r\n                            <span style={{ color: '#10b981', fontSize: '0.875rem' }}>Completed</span>\r\n                          </>\r\n                        ) : (\r\n                          <>\r\n                            <AlertTriangle size={16} style={{ color: '#f59e0b' }} />\r\n                            <span style={{ color: '#f59e0b', fontSize: '0.875rem' }}>Warnings</span>\r\n                          </>\r\n                        )}\r\n                      </div>\r\n                    </td>\r\n                    <td style={{ padding: '1rem', textAlign: 'right', color: '#000', fontWeight: '500' }}>\r\n                      {audit.summary.totalRevenue.toLocaleString()}\r\n                    </td>\r\n                    <td style={{ padding: '1rem', textAlign: 'right', color: '#000' }}>\r\n                      {audit.summary.occupancyRate.toFixed(1)}%\r\n                    </td>\r\n                    <td style={{ padding: '1rem', textAlign: 'right', color: '#000' }}>\r\n                      {audit.summary.adr.toLocaleString()}\r\n                    </td>\r\n                    <td style={{ padding: '1rem', textAlign: 'right', color: '#000' }}>\r\n                      {audit.summary.revpar.toLocaleString()}\r\n                    </td>\r\n                    <td style={{ padding: '1rem', textAlign: 'center' }}>\r\n                      <button\r\n                        onClick={() => handleViewAudit(audit.auditDate)}\r\n                        style={{\r\n                          padding: '0.5rem',\r\n                          background: 'transparent',\r\n                          border: 'none',\r\n                          cursor: 'pointer',\r\n                          color: '#64748b',\r\n                        }}\r\n                        title=\"View Details\"\r\n                        onMouseEnter={(e) => {\r\n                          e.currentTarget.style.color = '#000';\r\n                        }}\r\n                        onMouseLeave={(e) => {\r\n                          e.currentTarget.style.color = '#64748b';\r\n                        }}\r\n                      >\r\n                        <Eye size={16} />\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        )}\r\n\r\n        {/* Run Audit Modal */}\r\n        {showRunModal && (\r\n          <div\r\n            style={{\r\n              position: 'fixed',\r\n              top: 0,\r\n              left: 0,\r\n              right: 0,\r\n              bottom: 0,\r\n              background: 'rgba(0,0,0,0.5)',\r\n              display: 'flex',\r\n              justifyContent: 'center',\r\n              alignItems: 'center',\r\n              zIndex: 1000,\r\n            }}\r\n            onClick={() => setShowRunModal(false)}\r\n          >\r\n            <div\r\n              style={{\r\n                background: 'white',\r\n                borderRadius: '8px',\r\n                padding: '2rem',\r\n                width: '90%',\r\n                maxWidth: '500px',\r\n                boxShadow: '0 10px 25px rgba(0,0,0,0.2)',\r\n              }}\r\n              onClick={(e) => e.stopPropagation()}\r\n            >\r\n              <h2 style={{ marginTop: 0, marginBottom: '1.5rem', color: '#000', fontSize: '1.5rem', fontWeight: '700' }}>\r\n                Run Night Audit\r\n              </h2>\r\n              <div style={{ marginBottom: '1.5rem' }}>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#000', fontWeight: '500' }}>\r\n                  Audit Date\r\n                </label>\r\n                <input\r\n                  type=\"date\"\r\n                  value={auditDate}\r\n                  onChange={(e) => setAuditDate(e.target.value)}\r\n                  max={format(subDays(new Date(), 1), 'yyyy-MM-dd')}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '0.875rem',\r\n                    outline: 'none',\r\n                  }}\r\n                  onFocus={(e) => {\r\n                    e.currentTarget.style.borderColor = '#000';\r\n                  }}\r\n                  onBlur={(e) => {\r\n                    e.currentTarget.style.borderColor = '#e2e8f0';\r\n                  }}\r\n                />\r\n                <p style={{ margin: '0.5rem 0 0 0', color: '#64748b', fontSize: '0.75rem' }}>\r\n                  Select the date to audit (typically yesterday). Today's date cannot be audited.\r\n                </p>\r\n              </div>\r\n              <div style={{ display: 'flex', gap: '1rem', justifyContent: 'flex-end' }}>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowRunModal(false)}\r\n                  disabled={runningAudit}\r\n                  style={{\r\n                    padding: '0.75rem 1.5rem',\r\n                    background: '#f1f5f9',\r\n                    color: '#000',\r\n                    border: 'none',\r\n                    borderRadius: '6px',\r\n                    cursor: runningAudit ? 'not-allowed' : 'pointer',\r\n                    fontWeight: '500',\r\n                    opacity: runningAudit ? 0.5 : 1,\r\n                  }}\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  onClick={handleRunAudit}\r\n                  disabled={runningAudit || !auditDate}\r\n                  style={{\r\n                    padding: '0.75rem 1.5rem',\r\n                    background: runningAudit ? '#94a3b8' : '#000',\r\n                    color: 'white',\r\n                    border: 'none',\r\n                    borderRadius: '6px',\r\n                    cursor: runningAudit ? 'not-allowed' : 'pointer',\r\n                    fontWeight: '600',\r\n                  }}\r\n                >\r\n                  {runningAudit ? 'Running...' : 'Run Audit'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Audit Details Modal */}\r\n        {selectedAudit && (\r\n          <AuditDetailsModal audit={selectedAudit} onClose={() => setSelectedAudit(null)} />\r\n        )}\r\n      </div>\r\n    </Layout>\r\n  );\r\n}\r\n\r\nfunction AuditDetailsModal({ audit, onClose }: { audit: NightAudit; onClose: () => void }) {\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0,0,0,0.5)',\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        zIndex: 1000,\r\n        padding: '1rem',\r\n      }}\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        style={{\r\n          background: 'white',\r\n          borderRadius: '8px',\r\n          padding: '2rem',\r\n          width: '100%',\r\n          maxWidth: '900px',\r\n          maxHeight: '90vh',\r\n          overflow: 'auto',\r\n          boxShadow: '0 10px 25px rgba(0,0,0,0.2)',\r\n        }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '2rem' }}>\r\n          <div>\r\n            <h2 style={{ margin: 0, fontSize: '1.5rem', fontWeight: '700', color: '#000' }}>\r\n              Night Audit Report\r\n            </h2>\r\n            <p style={{ margin: '0.5rem 0 0 0', color: '#64748b', fontSize: '0.875rem' }}>\r\n              {format(new Date(audit.auditDate), 'MMMM dd, yyyy')}\r\n            </p>\r\n          </div>\r\n          <button\r\n            onClick={onClose}\r\n            style={{\r\n              padding: '0.5rem',\r\n              background: 'transparent',\r\n              border: 'none',\r\n              cursor: 'pointer',\r\n              color: '#64748b',\r\n            }}\r\n          >\r\n            \r\n          </button>\r\n        </div>\r\n\r\n        {audit.discrepancies && audit.discrepancies.length > 0 && (\r\n          <div\r\n            style={{\r\n              background: '#fef3c7',\r\n              border: '1px solid #fbbf24',\r\n              borderRadius: '6px',\r\n              padding: '1rem',\r\n              marginBottom: '2rem',\r\n            }}\r\n          >\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.5rem' }}>\r\n              <AlertTriangle size={20} style={{ color: '#f59e0b' }} />\r\n              <h3 style={{ margin: 0, color: '#92400e', fontSize: '1rem', fontWeight: '600' }}>\r\n                Discrepancies Found\r\n              </h3>\r\n            </div>\r\n            <ul style={{ margin: 0, paddingLeft: '1.5rem', color: '#92400e' }}>\r\n              {audit.discrepancies.map((disc, idx) => (\r\n                <li key={idx} style={{ marginBottom: '0.25rem' }}>\r\n                  {disc}\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          </div>\r\n        )}\r\n\r\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem', marginBottom: '2rem' }}>\r\n          <MetricCard label=\"Total Rooms\" value={audit.summary.totalRooms.toString()} />\r\n          <MetricCard label=\"Checked In\" value={audit.summary.checkedIn.toString()} />\r\n          <MetricCard label=\"Checked Out\" value={audit.summary.checkedOut.toString()} />\r\n          <MetricCard label=\"No Shows\" value={audit.summary.noShows.toString()} />\r\n          <MetricCard label=\"Cancellations\" value={audit.summary.cancellations.toString()} />\r\n          <MetricCard label=\"Room Nights\" value={audit.summary.roomNights.toString()} />\r\n        </div>\r\n\r\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem', marginBottom: '2rem' }}>\r\n          <MetricCard label=\"Occupancy Rate\" value={`${audit.summary.occupancyRate.toFixed(1)}%`} />\r\n          <MetricCard label=\"Total Revenue\" value={`${audit.summary.totalRevenue.toLocaleString()}`} />\r\n          <MetricCard label=\"ADR\" value={`${audit.summary.adr.toLocaleString()}`} />\r\n          <MetricCard label=\"RevPAR\" value={`${audit.summary.revpar.toLocaleString()}`} />\r\n          <MetricCard label=\"Outstanding Balance\" value={`${audit.summary.outstandingBalance.toLocaleString()}`} />\r\n          <MetricCard label=\"Rooms Updated\" value={audit.summary.roomsUpdated.toString()} />\r\n        </div>\r\n\r\n        {Object.keys(audit.summary.revenueByMethod).length > 0 && (\r\n          <div style={{ marginBottom: '2rem' }}>\r\n            <h3 style={{ margin: '0 0 1rem 0', color: '#000', fontSize: '1rem', fontWeight: '600' }}>\r\n              Revenue by Payment Method\r\n            </h3>\r\n            <div style={{ display: 'grid', gap: '0.5rem' }}>\r\n              {Object.entries(audit.summary.revenueByMethod).map(([method, amount]) => (\r\n                <div\r\n                  key={method}\r\n                  style={{\r\n                    display: 'flex',\r\n                    justifyContent: 'space-between',\r\n                    padding: '0.75rem',\r\n                    background: '#f8fafc',\r\n                    borderRadius: '6px',\r\n                  }}\r\n                >\r\n                  <span style={{ color: '#64748b', textTransform: 'capitalize' }}>{method.replace('_', ' ')}</span>\r\n                  <span style={{ color: '#000', fontWeight: '500' }}>{amount.toLocaleString()}</span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {audit.performedByUser && (\r\n          <div style={{ paddingTop: '1rem', borderTop: '1px solid #e2e8f0', color: '#64748b', fontSize: '0.875rem' }}>\r\n            Performed by: {audit.performedByUser.firstName} {audit.performedByUser.lastName}\r\n            {audit.auditDateTime && (\r\n              <> on {format(new Date(audit.auditDateTime), 'MMM dd, yyyy HH:mm')}</>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction MetricCard({ label, value }: { label: string; value: string }) {\r\n  return (\r\n    <div\r\n      style={{\r\n        padding: '1rem',\r\n        background: '#f8fafc',\r\n        borderRadius: '6px',\r\n        border: '1px solid #e2e8f0',\r\n      }}\r\n    >\r\n      <div style={{ color: '#64748b', fontSize: '0.75rem', marginBottom: '0.25rem' }}>{label}</div>\r\n      <div style={{ color: '#000', fontSize: '1.25rem', fontWeight: '600' }}>{value}</div>\r\n    </div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\PaymentsPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'pagination.page'. Either include it or remove the dependency array.","line":89,"column":6,"nodeType":"ArrayExpression","endLine":89,"endColumn":60,"suggestions":[{"desc":"Update the dependencies array to be: [pagination.page, pagination.limit, user.tenantId, activeTab, filters.status, filters.method, filters.reconciled, filters.startDate, filters.endDate]","fix":{"range":[3041,3095],"text":"[pagination.page, pagination.limit, user.tenantId, activeTab, filters.status, filters.method, filters.reconciled, filters.startDate, filters.endDate]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useCallback, useMemo } from 'react';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Layout from '../components/Layout';\r\nimport { CreditCard, CheckCircle, Filter, Search } from 'lucide-react';\r\nimport { format } from 'date-fns';\r\nimport toast from 'react-hot-toast';\r\nimport { TableSkeleton } from '../components/LoadingSkeleton';\r\nimport Pagination from '../components/Pagination';\r\nimport { useDebounce } from '../hooks/useDebounce';\r\nimport EmptyState from '../components/EmptyState';\r\n\r\ninterface Payment {\r\n  id: string;\r\n  amount: number;\r\n  method: string;\r\n  status: string;\r\n  reference?: string;\r\n  paymentGateway?: string;\r\n  gatewayTransactionId?: string;\r\n  reconciled: boolean;\r\n  reconciledAt?: string;\r\n  createdAt: string;\r\n  folio: {\r\n    id: string;\r\n    guestName: string;\r\n    room: {\r\n      roomNumber: string;\r\n    };\r\n  };\r\n  user: {\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n}\r\n\r\nexport default function PaymentsPage() {\r\n  const { user } = useAuthStore();\r\n  const [payments, setPayments] = useState<Payment[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const debouncedSearchTerm = useDebounce(searchTerm, 500);\r\n  const [reconcilingPayments, setReconcilingPayments] = useState<Set<string>>(new Set());\r\n  const [filters, setFilters] = useState({\r\n    status: '',\r\n    method: '',\r\n    reconciled: '',\r\n    startDate: '',\r\n    endDate: '',\r\n  });\r\n  const [showFilters, setShowFilters] = useState(false);\r\n  const [activeTab, setActiveTab] = useState<'all' | 'reconcile'>('all');\r\n  const [pagination, setPagination] = useState({\r\n    page: 1,\r\n    limit: 20,\r\n    total: 0,\r\n    totalPages: 0,\r\n  });\r\n\r\n  const fetchPayments = useCallback(async (page = pagination.page) => {\r\n    if (!user?.tenantId) return;\r\n    setLoading(true);\r\n    try {\r\n      let response;\r\n      if (activeTab === 'reconcile') {\r\n        response = await api.get(`/tenants/${user.tenantId}/payments/reconcile`, {\r\n          params: { page, limit: pagination.limit },\r\n        });\r\n      } else {\r\n        const params: any = { page, limit: pagination.limit };\r\n        if (filters.status) params.status = filters.status;\r\n        if (filters.method) params.method = filters.method;\r\n        if (filters.reconciled) params.reconciled = filters.reconciled;\r\n        if (filters.startDate) params.startDate = filters.startDate;\r\n        if (filters.endDate) params.endDate = filters.endDate;\r\n        response = await api.get(`/tenants/${user.tenantId}/payments`, { params });\r\n      }\r\n      setPayments(response.data.data || []);\r\n      if (response.data.pagination) {\r\n        setPagination(response.data.pagination);\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch payments:', error);\r\n      toast.error(error.response?.data?.error?.message || 'Failed to fetch payments');\r\n      setPayments([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [user?.tenantId, activeTab, filters, pagination.limit]);\r\n\r\n  useEffect(() => {\r\n    fetchPayments(pagination.page);\r\n  }, [fetchPayments, pagination.page]);\r\n\r\n  const handleReconcile = async (paymentId: string) => {\r\n    setReconcilingPayments(prev => new Set(prev).add(paymentId));\r\n    try {\r\n      await api.post(`/tenants/${user?.tenantId}/payments/${paymentId}/reconcile`);\r\n      toast.success('Payment reconciled successfully');\r\n      fetchPayments();\r\n    } catch (error: any) {\r\n      // Error handled by API interceptor\r\n    } finally {\r\n      setReconcilingPayments(prev => {\r\n        const next = new Set(prev);\r\n        next.delete(paymentId);\r\n        return next;\r\n      });\r\n    }\r\n  };\r\n\r\n  const filteredPayments = useMemo(() => payments.filter((payment) => {\r\n    if (!debouncedSearchTerm) return true;\r\n    const searchLower = debouncedSearchTerm.toLowerCase();\r\n    return (\r\n      payment.reference?.toLowerCase().includes(searchLower) ||\r\n      payment.folio.guestName.toLowerCase().includes(searchLower) ||\r\n      payment.folio.room.roomNumber.toLowerCase().includes(searchLower) ||\r\n      payment.gatewayTransactionId?.toLowerCase().includes(searchLower) ||\r\n      `${payment.user.firstName} ${payment.user.lastName}`.toLowerCase().includes(searchLower)\r\n    );\r\n  }), [payments, debouncedSearchTerm]);\r\n\r\n  const getMethodColor = (method: string) => {\r\n    const colors: Record<string, { bg: string; text: string }> = {\r\n      card: { bg: '#dbeafe', text: '#1e40af' },\r\n      bank_transfer: { bg: '#d1fae5', text: '#065f46' },\r\n      cash: { bg: '#fef3c7', text: '#92400e' },\r\n      other: { bg: '#e5e7eb', text: '#374151' },\r\n    };\r\n    return colors[method] || colors.other;\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    const colors: Record<string, { bg: string; text: string }> = {\r\n      completed: { bg: '#d1fae5', text: '#065f46' },\r\n      pending: { bg: '#fef3c7', text: '#92400e' },\r\n      failed: { bg: '#fee2e2', text: '#991b1b' },\r\n      refunded: { bg: '#e5e7eb', text: '#374151' },\r\n    };\r\n    return colors[status] || colors.completed;\r\n  };\r\n\r\n  const totalAmount = filteredPayments.reduce((sum, p) => sum + Number(p.amount), 0);\r\n  const unreconciledCount = payments.filter((p) => !p.reconciled).length;\r\n\r\n  if (loading) {\r\n    return (\r\n      <Layout>\r\n        <div>\r\n          <h1 style={{ marginBottom: '1.5rem', color: '#1e293b' }}>Payments</h1>\r\n          <TableSkeleton rows={8} columns={8} />\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Layout>\r\n      <div>\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <div>\r\n            <h1 style={{ margin: 0, color: '#1e293b' }}>Payments</h1>\r\n            <div style={{ display: 'flex', gap: '1rem', marginTop: '0.5rem', fontSize: '0.875rem', color: '#64748b' }}>\r\n              <span>{payments.length} total payments</span>\r\n              <span style={{ fontWeight: '500', color: '#1e293b' }}>\r\n                Total: {totalAmount.toLocaleString()}\r\n              </span>\r\n              {unreconciledCount > 0 && (\r\n                <span style={{ color: '#f59e0b', fontWeight: '500' }}>{unreconciledCount} unreconciled</span>\r\n              )}\r\n            </div>\r\n          </div>\r\n          <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n            <button\r\n              onClick={() => setShowFilters(!showFilters)}\r\n              style={{\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: '0.5rem',\r\n                padding: '0.75rem 1.5rem',\r\n                background: showFilters ? '#3b82f6' : '#f1f5f9',\r\n                color: showFilters ? 'white' : '#475569',\r\n                border: 'none',\r\n                borderRadius: '6px',\r\n                cursor: 'pointer',\r\n                fontWeight: '500',\r\n              }}\r\n            >\r\n              <Filter size={20} />\r\n              Filters\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Tabs */}\r\n        <div\r\n          style={{\r\n            display: 'flex',\r\n            gap: '0.5rem',\r\n            marginBottom: '1.5rem',\r\n            borderBottom: '2px solid #e2e8f0',\r\n          }}\r\n        >\r\n          <button\r\n            onClick={() => setActiveTab('all')}\r\n            style={{\r\n              padding: '0.75rem 1.5rem',\r\n              background: 'transparent',\r\n              border: 'none',\r\n              borderBottom: activeTab === 'all' ? '2px solid #3b82f6' : '2px solid transparent',\r\n              color: activeTab === 'all' ? '#3b82f6' : '#64748b',\r\n              cursor: 'pointer',\r\n              fontWeight: activeTab === 'all' ? '500' : '400',\r\n              marginBottom: '-2px',\r\n            }}\r\n          >\r\n            All Payments\r\n          </button>\r\n          <button\r\n            onClick={() => setActiveTab('reconcile')}\r\n            style={{\r\n              padding: '0.75rem 1.5rem',\r\n              background: 'transparent',\r\n              border: 'none',\r\n              borderBottom: activeTab === 'reconcile' ? '2px solid #3b82f6' : '2px solid transparent',\r\n              color: activeTab === 'reconcile' ? '#3b82f6' : '#64748b',\r\n              cursor: 'pointer',\r\n              fontWeight: activeTab === 'reconcile' ? '500' : '400',\r\n              marginBottom: '-2px',\r\n            }}\r\n          >\r\n            Reconciliation\r\n            {unreconciledCount > 0 && (\r\n              <span\r\n                style={{\r\n                  marginLeft: '0.5rem',\r\n                  padding: '0.125rem 0.5rem',\r\n                  background: '#f59e0b',\r\n                  color: 'white',\r\n                  borderRadius: '12px',\r\n                  fontSize: '0.75rem',\r\n                }}\r\n              >\r\n                {unreconciledCount}\r\n              </span>\r\n            )}\r\n          </button>\r\n        </div>\r\n\r\n        {/* Search */}\r\n        <div style={{ marginBottom: '1.5rem' }}>\r\n          <div style={{ position: 'relative', maxWidth: '400px' }}>\r\n            <Search\r\n              size={20}\r\n              style={{\r\n                position: 'absolute',\r\n                left: '0.75rem',\r\n                top: '50%',\r\n                transform: 'translateY(-50%)',\r\n                color: '#94a3b8',\r\n              }}\r\n            />\r\n            <input\r\n              type=\"text\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              placeholder=\"Search by reference, guest name, room, or transaction ID...\"\r\n              style={{\r\n                width: '100%',\r\n                padding: '0.75rem 0.75rem 0.75rem 2.5rem',\r\n                border: '1px solid #cbd5e1',\r\n                borderRadius: '6px',\r\n                fontSize: '0.875rem',\r\n              }}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Filters */}\r\n        {showFilters && activeTab === 'all' && (\r\n          <div\r\n            style={{\r\n              background: 'white',\r\n              padding: '1.5rem',\r\n              borderRadius: '8px',\r\n              marginBottom: '1.5rem',\r\n              display: 'flex',\r\n              gap: '1rem',\r\n              flexWrap: 'wrap',\r\n            }}\r\n          >\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n                Status\r\n              </label>\r\n              <select\r\n                value={filters.status}\r\n                onChange={(e) => setFilters({ ...filters, status: e.target.value })}\r\n                style={{\r\n                  padding: '0.5rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '4px',\r\n                  fontSize: '0.875rem',\r\n                }}\r\n              >\r\n                <option value=\"\">All</option>\r\n                <option value=\"completed\">Completed</option>\r\n                <option value=\"pending\">Pending</option>\r\n                <option value=\"failed\">Failed</option>\r\n                <option value=\"refunded\">Refunded</option>\r\n              </select>\r\n            </div>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n                Method\r\n              </label>\r\n              <select\r\n                value={filters.method}\r\n                onChange={(e) => setFilters({ ...filters, method: e.target.value })}\r\n                style={{\r\n                  padding: '0.5rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '4px',\r\n                  fontSize: '0.875rem',\r\n                }}\r\n              >\r\n                <option value=\"\">All</option>\r\n                <option value=\"card\">Card</option>\r\n                <option value=\"bank_transfer\">Bank Transfer</option>\r\n                <option value=\"cash\">Cash</option>\r\n                <option value=\"other\">Other</option>\r\n              </select>\r\n            </div>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n                Reconciled\r\n              </label>\r\n              <select\r\n                value={filters.reconciled}\r\n                onChange={(e) => setFilters({ ...filters, reconciled: e.target.value })}\r\n                style={{\r\n                  padding: '0.5rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '4px',\r\n                  fontSize: '0.875rem',\r\n                }}\r\n              >\r\n                <option value=\"\">All</option>\r\n                <option value=\"true\">Reconciled</option>\r\n                <option value=\"false\">Unreconciled</option>\r\n              </select>\r\n            </div>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n                Date From\r\n              </label>\r\n              <input\r\n                type=\"date\"\r\n                value={filters.startDate}\r\n                onChange={(e) => setFilters({ ...filters, startDate: e.target.value })}\r\n                style={{\r\n                  padding: '0.5rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '4px',\r\n                  fontSize: '0.875rem',\r\n                }}\r\n              />\r\n            </div>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n                Date To\r\n              </label>\r\n              <input\r\n                type=\"date\"\r\n                value={filters.endDate}\r\n                onChange={(e) => setFilters({ ...filters, endDate: e.target.value })}\r\n                style={{\r\n                  padding: '0.5rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '4px',\r\n                  fontSize: '0.875rem',\r\n                }}\r\n              />\r\n            </div>\r\n            <div style={{ display: 'flex', alignItems: 'flex-end' }}>\r\n              <button\r\n                onClick={() => setFilters({ status: '', method: '', reconciled: '', startDate: '', endDate: '' })}\r\n                style={{\r\n                  padding: '0.5rem 1rem',\r\n                  background: '#f1f5f9',\r\n                  color: '#475569',\r\n                  border: 'none',\r\n                  borderRadius: '4px',\r\n                  cursor: 'pointer',\r\n                  fontSize: '0.875rem',\r\n                }}\r\n              >\r\n                Clear Filters\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Payments Table */}\r\n        <div\r\n          style={{\r\n            background: 'white',\r\n            borderRadius: '8px',\r\n            boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n            overflow: 'hidden',\r\n          }}\r\n        >\r\n          {filteredPayments.length === 0 ? (\r\n            <div style={{ padding: '3rem', textAlign: 'center', color: '#94a3b8' }}>\r\n              <CreditCard size={48} style={{ margin: '0 auto 1rem', opacity: 0.5 }} />\r\n              {filteredPayments.length === 0 ? (\r\n                <EmptyState\r\n                  icon={CreditCard}\r\n                  title={searchTerm || filters.status || filters.method || filters.startDate \r\n                    ? 'No payments match your filters' \r\n                    : 'No payments yet'}\r\n                  description={searchTerm || filters.status || filters.method || filters.startDate\r\n                    ? 'Try adjusting your search or filter criteria'\r\n                    : 'Payments will appear here when guests make transactions'}\r\n                />\r\n              ) : null}\r\n            </div>\r\n          ) : (\r\n            <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n              <thead>\r\n                <tr style={{ background: '#f8fafc', borderBottom: '1px solid #e2e8f0' }}>\r\n                  <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Date</th>\r\n                  <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Guest</th>\r\n                  <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Room</th>\r\n                  <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Amount</th>\r\n                  <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Method</th>\r\n                  <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Reference</th>\r\n                  <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Status</th>\r\n                  <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Actions</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {filteredPayments.map((payment) => {\r\n                  const methodColor = getMethodColor(payment.method);\r\n                  const statusColor = getStatusColor(payment.status);\r\n                  return (\r\n                    <tr key={payment.id} style={{ borderBottom: '1px solid #e2e8f0' }}>\r\n                      <td style={{ padding: '1rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n                        {format(new Date(payment.createdAt), 'MMM dd, yyyy HH:mm')}\r\n                      </td>\r\n                      <td style={{ padding: '1rem', color: '#1e293b' }}>{payment.folio.guestName}</td>\r\n                      <td style={{ padding: '1rem', color: '#1e293b' }}>{payment.folio.room.roomNumber}</td>\r\n                      <td style={{ padding: '1rem', color: '#1e293b', fontWeight: '500' }}>\r\n                        {Number(payment.amount).toLocaleString()}\r\n                      </td>\r\n                      <td style={{ padding: '1rem' }}>\r\n                        <span\r\n                          style={{\r\n                            padding: '0.25rem 0.75rem',\r\n                            borderRadius: '12px',\r\n                            fontSize: '0.75rem',\r\n                            fontWeight: '500',\r\n                            background: methodColor.bg,\r\n                            color: methodColor.text,\r\n                          }}\r\n                        >\r\n                          {payment.method.replace('_', ' ').toUpperCase()}\r\n                        </span>\r\n                      </td>\r\n                      <td style={{ padding: '1rem', color: '#64748b', fontSize: '0.875rem', fontFamily: 'monospace' }}>\r\n                        {payment.reference || '-'}\r\n                      </td>\r\n                      <td style={{ padding: '1rem' }}>\r\n                        <div style={{ display: 'flex', flexDirection: 'column', gap: '0.25rem' }}>\r\n                          <span\r\n                            style={{\r\n                              padding: '0.25rem 0.75rem',\r\n                              borderRadius: '12px',\r\n                              fontSize: '0.75rem',\r\n                              fontWeight: '500',\r\n                              background: statusColor.bg,\r\n                              color: statusColor.text,\r\n                              width: 'fit-content',\r\n                            }}\r\n                          >\r\n                            {payment.status.toUpperCase()}\r\n                          </span>\r\n                          {!payment.reconciled && (\r\n                            <span\r\n                              style={{\r\n                                padding: '0.125rem 0.5rem',\r\n                                borderRadius: '8px',\r\n                                fontSize: '0.7rem',\r\n                                background: '#fef3c7',\r\n                                color: '#92400e',\r\n                                width: 'fit-content',\r\n                              }}\r\n                            >\r\n                              UNRECONCILED\r\n                            </span>\r\n                          )}\r\n                        </div>\r\n                      </td>\r\n                      <td style={{ padding: '1rem' }}>\r\n                        {!payment.reconciled && activeTab === 'reconcile' && (\r\n                          <button\r\n                            onClick={() => handleReconcile(payment.id)}\r\n                            style={{\r\n                              display: 'flex',\r\n                              alignItems: 'center',\r\n                              gap: '0.5rem',\r\n                              padding: '0.5rem 1rem',\r\n                              background: reconcilingPayments.has(payment.id) ? '#94a3b8' : '#10b981',\r\n                              color: 'white',\r\n                              border: 'none',\r\n                              borderRadius: '4px',\r\n                              cursor: reconcilingPayments.has(payment.id) ? 'not-allowed' : 'pointer',\r\n                              opacity: reconcilingPayments.has(payment.id) ? 0.6 : 1,\r\n                              fontSize: '0.875rem',\r\n                            }}\r\n                          >\r\n                            <CheckCircle size={16} />\r\n                            {reconcilingPayments.has(payment.id) ? 'Reconciling...' : 'Reconcile'}\r\n                          </button>\r\n                        )}\r\n                        {payment.reconciled && (\r\n                          <div style={{ fontSize: '0.75rem', color: '#94a3b8' }}>\r\n                            Reconciled {payment.reconciledAt && format(new Date(payment.reconciledAt), 'MMM dd')}\r\n                          </div>\r\n                        )}\r\n                      </td>\r\n                    </tr>\r\n                  );\r\n                })}\r\n              </tbody>\r\n            </table>\r\n          )}\r\n          {pagination.totalPages > 1 && filteredPayments.length > 0 && (\r\n            <Pagination\r\n              page={pagination.page}\r\n              totalPages={pagination.totalPages}\r\n              total={pagination.total}\r\n              limit={pagination.limit}\r\n              onPageChange={(newPage) => {\r\n                setPagination({ ...pagination, page: newPage });\r\n                fetchPayments(newPage);\r\n              }}\r\n            />\r\n          )}\r\n        </div>\r\n      </div>\r\n    </Layout>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\PlaceholderPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\PublicCheckoutPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\RatePlansPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'primaryCategoryNames'. Either include it or remove the dependency array.","line":264,"column":9,"nodeType":"ArrayExpression","endLine":264,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [categoryGroups, primaryCategoryNames]","fix":{"range":[9745,9761],"text":"[categoryGroups, primaryCategoryNames]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'primaryCategoryNames'. Either include it or remove the dependency array.","line":272,"column":9,"nodeType":"ArrayExpression","endLine":272,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [categoryGroups, primaryCategoryNames]","fix":{"range":[10037,10053],"text":"[categoryGroups, primaryCategoryNames]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useCallback, useMemo } from 'react';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Layout from '../components/Layout';\r\nimport { Plus, Edit, Trash2, DollarSign, X } from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\nimport { CardSkeleton } from '../components/LoadingSkeleton';\r\nimport SearchInput from '../components/SearchInput';\r\nimport { useDebounce } from '../hooks/useDebounce';\r\nimport EmptyState from '../components/EmptyState';\r\n\r\ninterface RatePlan {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  baseRate: number;\r\n  currency: string;\r\n  seasonalRules?: any;\r\n  isActive: boolean;\r\n  categoryId?: string | null;\r\n  category?: {\r\n    id: string;\r\n    name: string;\r\n    color?: string;\r\n  } | null;\r\n  roomCount?: number;\r\n  createdAt?: Date;\r\n  updatedAt?: Date;\r\n}\r\n\r\ninterface RoomCategory {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  color?: string;\r\n}\r\n\r\nexport default function RatePlansPage() {\r\n  const { user } = useAuthStore();\r\n  const [ratePlans, setRatePlans] = useState<RatePlan[]>([]);\r\n  const [categories, setCategories] = useState<RoomCategory[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const [selectedRatePlan, setSelectedRatePlan] = useState<RatePlan | null>(null);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const debouncedSearchTerm = useDebounce(searchTerm, 500);\r\n  const [filterActive, setFilterActive] = useState<boolean | null>(null);\r\n  const [filterCategory, setFilterCategory] = useState<string | null>(null);\r\n  const [saving, setSaving] = useState(false);\r\n  const [deletingPlans, setDeletingPlans] = useState<Set<string>>(new Set());\r\n  const [formData, setFormData] = useState({\r\n    name: '',\r\n    description: '',\r\n    baseRate: '',\r\n    currency: 'NGN',\r\n    isActive: true,\r\n    categoryId: '',\r\n  });\r\n\r\n  const fetchCategories = useCallback(async () => {\r\n    if (!user?.tenantId) return;\r\n    try {\r\n      const response = await api.get(`/tenants/${user.tenantId}/room-categories`);\r\n      setCategories(response.data.data || []);\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch categories:', error);\r\n      toast.error(error.response?.data?.error?.message || 'Failed to fetch categories');\r\n    }\r\n  }, [user?.tenantId]);\r\n\r\n  const fetchRatePlans = useCallback(async () => {\r\n    if (!user?.tenantId) return;\r\n    setLoading(true);\r\n    try {\r\n      const params: any = {};\r\n      if (filterActive !== null) {\r\n        params.isActive = filterActive.toString();\r\n      }\r\n      if (filterCategory !== null) {\r\n        params.categoryId = filterCategory;\r\n      }\r\n      const response = await api.get(`/tenants/${user.tenantId}/rate-plans`, { params });\r\n      setRatePlans(response.data.data || []);\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch rate plans:', error);\r\n      toast.error(error.response?.data?.error?.message || error.response?.data?.message || 'Failed to fetch rate plans');\r\n      setRatePlans([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [user?.tenantId, filterActive, filterCategory]);\r\n\r\n  useEffect(() => {\r\n    fetchRatePlans();\r\n    fetchCategories();\r\n  }, [fetchRatePlans, fetchCategories]);\r\n\r\n  const handleCreate = async () => {\r\n    if (!formData.categoryId || !formData.baseRate) {\r\n      toast.error('Please select a category and enter a base rate');\r\n      return;\r\n    }\r\n\r\n    const selectedCategory = categories.find(cat => cat.id === formData.categoryId);\r\n    if (!selectedCategory) {\r\n      toast.error('Selected category not found');\r\n      return;\r\n    }\r\n\r\n    setSaving(true);\r\n    try {\r\n      await api.post(`/tenants/${user?.tenantId}/rate-plans`, {\r\n        name: selectedCategory.name, // Use category name as rate plan name\r\n        description: formData.description || selectedCategory.description || undefined,\r\n        baseRate: parseFloat(formData.baseRate),\r\n        currency: formData.currency,\r\n        isActive: formData.isActive,\r\n        categoryId: formData.categoryId,\r\n      });\r\n      toast.success('Rate plan created successfully');\r\n      setShowCreateModal(false);\r\n      resetForm();\r\n      fetchRatePlans();\r\n    } catch (error: any) {\r\n      console.error('Failed to create rate plan:', error);\r\n      toast.error(error.response?.data?.error?.message || error.response?.data?.message || 'Failed to create rate plan');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleEdit = async () => {\r\n    if (!selectedRatePlan) return;\r\n\r\n    if (!formData.categoryId || !formData.baseRate) {\r\n      toast.error('Please select a category and enter a base rate');\r\n      return;\r\n    }\r\n\r\n    const selectedCategory = categories.find(cat => cat.id === formData.categoryId);\r\n    if (!selectedCategory) {\r\n      toast.error('Selected category not found');\r\n      return;\r\n    }\r\n\r\n    setSaving(true);\r\n    try {\r\n      await api.patch(`/tenants/${user?.tenantId}/rate-plans/${selectedRatePlan.id}`, {\r\n        name: selectedCategory.name, // Use category name as rate plan name\r\n        description: formData.description || selectedCategory.description || undefined,\r\n        baseRate: parseFloat(formData.baseRate),\r\n        currency: formData.currency,\r\n        isActive: formData.isActive,\r\n        categoryId: formData.categoryId,\r\n      });\r\n      toast.success('Rate plan updated successfully');\r\n      setShowEditModal(false);\r\n      setSelectedRatePlan(null);\r\n      resetForm();\r\n      fetchRatePlans();\r\n    } catch (error: any) {\r\n      console.error('Failed to update rate plan:', error);\r\n      toast.error(error.response?.data?.error?.message || error.response?.data?.message || 'Failed to update rate plan');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (ratePlanId: string) => {\r\n    if (!window.confirm('Are you sure you want to delete this rate plan?')) return;\r\n\r\n    setDeletingPlans(prev => new Set(prev).add(ratePlanId));\r\n    try {\r\n      await api.delete(`/tenants/${user?.tenantId}/rate-plans/${ratePlanId}`);\r\n      toast.success('Rate plan deleted successfully');\r\n      fetchRatePlans();\r\n    } catch (error: any) {\r\n      console.error('Failed to delete rate plan:', error);\r\n      toast.error(error.response?.data?.error?.message || error.response?.data?.message || 'Failed to delete rate plan');\r\n    } finally {\r\n      setDeletingPlans(prev => {\r\n        const next = new Set(prev);\r\n        next.delete(ratePlanId);\r\n        return next;\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleEditClick = (ratePlan: RatePlan) => {\r\n    setSelectedRatePlan(ratePlan);\r\n    const category = categories.find(cat => cat.id === ratePlan.categoryId);\r\n    setFormData({\r\n      name: ratePlan.name, // Keep for display but won't be used\r\n      description: ratePlan.description || category?.description || '',\r\n      baseRate: ratePlan.baseRate.toString(),\r\n      currency: ratePlan.currency,\r\n      isActive: ratePlan.isActive,\r\n      categoryId: ratePlan.categoryId || '',\r\n    });\r\n    setShowEditModal(true);\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFormData({\r\n      name: '',\r\n      description: '',\r\n      baseRate: '',\r\n      currency: 'NGN',\r\n      isActive: true,\r\n      categoryId: '',\r\n    });\r\n  };\r\n\r\n  const handleCategoryChange = (categoryId: string) => {\r\n    const selectedCategory = categories.find(cat => cat.id === categoryId);\r\n    setFormData({\r\n      ...formData,\r\n      categoryId,\r\n      description: selectedCategory?.description || formData.description,\r\n    });\r\n  };\r\n\r\n  const filteredRatePlans = useMemo(() => ratePlans.filter((plan) => {\r\n    if (!debouncedSearchTerm) return true;\r\n    const searchLower = debouncedSearchTerm.toLowerCase();\r\n    return (\r\n      plan.name.toLowerCase().includes(searchLower) ||\r\n      plan.description?.toLowerCase().includes(searchLower) ||\r\n      plan.currency.toLowerCase().includes(searchLower) ||\r\n      plan.category?.name.toLowerCase().includes(searchLower)\r\n    );\r\n  }), [ratePlans, debouncedSearchTerm]);\r\n\r\n  // Group rate plans by category\r\n  const groupedRatePlans = useMemo(() => filteredRatePlans.reduce((acc: Record<string, { category: { id: string; name: string; color?: string } | null; plans: RatePlan[] }>, plan: RatePlan) => {\r\n    const categoryKey = plan.categoryId || 'none';\r\n    if (!acc[categoryKey]) {\r\n      acc[categoryKey] = {\r\n        category: plan.category || null,\r\n        plans: [],\r\n      };\r\n    }\r\n    acc[categoryKey].plans.push(plan);\r\n    return acc;\r\n  }, {} as Record<string, { category: { id: string; name: string; color?: string } | null; plans: RatePlan[] }>), [filteredRatePlans]);\r\n\r\n  const categoryGroups = useMemo(() => Object.entries(groupedRatePlans).sort((a, b) => {\r\n    if (a[0] === 'none') return 1;\r\n    if (b[0] === 'none') return -1;\r\n    const aGroup = a[1] as { category: { id: string; name: string; color?: string } | null; plans: RatePlan[] };\r\n    const bGroup = b[1] as { category: { id: string; name: string; color?: string } | null; plans: RatePlan[] };\r\n    return (aGroup.category?.name || '').localeCompare(bGroup.category?.name || '');\r\n  }), [groupedRatePlans]);\r\n\r\n  // Separate primary categories (Standard, Deluxe, Executive) from others\r\n  const primaryCategoryNames = ['Standard', 'Deluxe', 'Executive'];\r\n  const primaryCategories = useMemo(() => \r\n    categoryGroups.filter(([_, group]) => {\r\n      const categoryName = group.category?.name || '';\r\n      return primaryCategoryNames.some(name => \r\n        categoryName.toLowerCase() === name.toLowerCase()\r\n      );\r\n    }), [categoryGroups]);\r\n\r\n  const otherCategories = useMemo(() => \r\n    categoryGroups.filter(([_, group]) => {\r\n      const categoryName = group.category?.name || '';\r\n      return !primaryCategoryNames.some(name => \r\n        categoryName.toLowerCase() === name.toLowerCase()\r\n      );\r\n    }), [categoryGroups]);\r\n\r\n  const renderCategoryGroup = ([categoryKey, group]: [string, { category: { id: string; name: string; color?: string } | null; plans: RatePlan[] }]) => (\r\n    <div key={categoryKey} style={{ flex: '1 1 400px', minWidth: '350px', maxWidth: '100%' }}>\r\n      <div style={{ marginBottom: '1rem', paddingBottom: '0.5rem', borderBottom: '2px solid #e2e8f0' }}>\r\n        <h2 style={{ margin: 0, color: '#1e293b', fontSize: '1.25rem', fontWeight: '600', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n          {group.category ? (\r\n            <>\r\n              {group.category.color && (\r\n                <span\r\n                  style={{\r\n                    width: '12px',\r\n                    height: '12px',\r\n                    borderRadius: '50%',\r\n                    background: group.category.color,\r\n                    display: 'inline-block',\r\n                  }}\r\n                />\r\n              )}\r\n              {group.category.name}\r\n            </>\r\n          ) : (\r\n            'No Category'\r\n          )}\r\n          <span style={{ fontSize: '0.875rem', fontWeight: '400', color: '#64748b' }}>\r\n            ({group.plans.length})\r\n          </span>\r\n        </h2>\r\n      </div>\r\n      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(280px, 1fr))', gap: '1rem' }}>\r\n        {group.plans.map((plan: RatePlan) => (\r\n          <div\r\n            key={plan.id}\r\n            style={{\r\n              background: 'white',\r\n              border: '1px solid #e2e8f0',\r\n              borderRadius: '8px',\r\n              padding: '1.5rem',\r\n              boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n            }}\r\n          >\r\n            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1rem' }}>\r\n              <div style={{ flex: 1 }}>\r\n                <h3 style={{ margin: 0, color: '#1e293b', fontSize: '1.25rem', fontWeight: '600' }}>\r\n                  {plan.name}\r\n                </h3>\r\n                {plan.description && (\r\n                  <p style={{ margin: '0.5rem 0 0', color: '#64748b', fontSize: '0.875rem' }}>\r\n                    {plan.description}\r\n                  </p>\r\n                )}\r\n                {plan.category && (\r\n                  <div style={{ marginTop: '0.5rem', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n                    {plan.category.color && (\r\n                      <span\r\n                        style={{\r\n                          width: '8px',\r\n                          height: '8px',\r\n                          borderRadius: '50%',\r\n                          background: plan.category.color,\r\n                          display: 'inline-block',\r\n                        }}\r\n                      />\r\n                    )}\r\n                    <span style={{ fontSize: '0.75rem', color: '#64748b' }}>\r\n                      {plan.category.name}\r\n                    </span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div style={{ textAlign: 'right' }}>\r\n                <span\r\n                  style={{\r\n                    display: 'inline-block',\r\n                    padding: '0.25rem 0.75rem',\r\n                    borderRadius: '12px',\r\n                    fontSize: '0.75rem',\r\n                    fontWeight: '500',\r\n                    background: plan.isActive ? '#d1fae5' : '#fee2e2',\r\n                    color: plan.isActive ? '#065f46' : '#991b1b',\r\n                  }}\r\n                >\r\n                  {plan.isActive ? 'Active' : 'Inactive'}\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            <div style={{ marginBottom: '1rem', paddingBottom: '1rem', borderBottom: '1px solid #e2e8f0' }}>\r\n              <div style={{ display: 'flex', alignItems: 'baseline', gap: '0.5rem' }}>\r\n                <span style={{ fontSize: '2rem', fontWeight: '700', color: '#1e293b' }}>\r\n                  {plan.currency} {plan.baseRate.toLocaleString()}\r\n                </span>\r\n              </div>\r\n              {plan.roomCount !== undefined && plan.roomCount > 0 && (\r\n                <p style={{ margin: '0.5rem 0 0', fontSize: '0.875rem', color: '#64748b' }}>\r\n                  {plan.roomCount} room{plan.roomCount !== 1 ? 's' : ''} using this plan\r\n                </p>\r\n              )}\r\n            </div>\r\n\r\n            <div style={{ display: 'flex', gap: '0.5rem', borderTop: '1px solid #e2e8f0', paddingTop: '1rem' }}>\r\n              <button\r\n                onClick={() => handleEditClick(plan)}\r\n                style={{\r\n                  flex: 1,\r\n                  padding: '0.5rem',\r\n                  border: '1px solid #e2e8f0',\r\n                  borderRadius: '6px',\r\n                  background: 'white',\r\n                  color: '#64748b',\r\n                  cursor: 'pointer',\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  justifyContent: 'center',\r\n                  gap: '0.5rem',\r\n                }}\r\n              >\r\n                <Edit size={16} />\r\n                Edit\r\n              </button>\r\n              <button\r\n                onClick={() => handleDelete(plan.id)}\r\n                disabled={deletingPlans.has(plan.id)}\r\n                style={{\r\n                  flex: 1,\r\n                  padding: '0.5rem',\r\n                  border: '1px solid #fee2e2',\r\n                  borderRadius: '6px',\r\n                  opacity: deletingPlans.has(plan.id) ? 0.6 : 1,\r\n                  cursor: deletingPlans.has(plan.id) ? 'not-allowed' : 'pointer',\r\n                  background: 'white',\r\n                  color: '#ef4444',\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  justifyContent: 'center',\r\n                  gap: '0.5rem',\r\n                }}\r\n              >\r\n                <Trash2 size={16} />\r\n                {deletingPlans.has(plan.id) ? 'Deleting...' : 'Delete'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  if (loading) {\r\n    return (\r\n      <Layout>\r\n        <div>\r\n          <h1 style={{ marginBottom: '1.5rem', color: '#1e293b' }}>Rate Plans</h1>\r\n          <CardSkeleton count={6} />\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Layout>\r\n      <div>\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <h1 style={{ color: '#1e293b' }}>Rate Plans</h1>\r\n          <button\r\n            onClick={() => {\r\n              resetForm();\r\n              setShowCreateModal(true);\r\n            }}\r\n            style={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.5rem',\r\n              padding: '0.75rem 1.5rem',\r\n              background: '#3b82f6',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '6px',\r\n              cursor: 'pointer',\r\n              fontWeight: '500',\r\n            }}\r\n          >\r\n            <Plus size={20} />\r\n            Create Rate Plan\r\n          </button>\r\n        </div>\r\n\r\n        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1.5rem', flexWrap: 'wrap' }}>\r\n          <div style={{ flex: 1, minWidth: '300px' }}>\r\n            <SearchInput\r\n              placeholder=\"Search rate plans...\"\r\n              value={searchTerm}\r\n              onChange={(value) => setSearchTerm(value)}\r\n            />\r\n          </div>\r\n          <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>\r\n            <select\r\n              value={filterCategory || ''}\r\n              onChange={(e) => setFilterCategory(e.target.value || null)}\r\n              style={{\r\n                padding: '0.5rem 1rem',\r\n                border: '1px solid #e2e8f0',\r\n                borderRadius: '6px',\r\n                background: 'white',\r\n                color: '#64748b',\r\n                cursor: 'pointer',\r\n              }}\r\n            >\r\n              <option value=\"\">All Categories</option>\r\n              <option value=\"none\">No Category</option>\r\n              {categories.map((cat) => (\r\n                <option key={cat.id} value={cat.id}>\r\n                  {cat.name}\r\n                </option>\r\n              ))}\r\n            </select>\r\n            <button\r\n              onClick={() => setFilterActive(null)}\r\n              style={{\r\n                padding: '0.5rem 1rem',\r\n                border: '1px solid #e2e8f0',\r\n                borderRadius: '6px',\r\n                background: filterActive === null ? '#3b82f6' : 'white',\r\n                color: filterActive === null ? 'white' : '#64748b',\r\n                cursor: 'pointer',\r\n              }}\r\n            >\r\n              All\r\n            </button>\r\n            <button\r\n              onClick={() => setFilterActive(true)}\r\n              style={{\r\n                padding: '0.5rem 1rem',\r\n                border: '1px solid #e2e8f0',\r\n                borderRadius: '6px',\r\n                background: filterActive === true ? '#10b981' : 'white',\r\n                color: filterActive === true ? 'white' : '#64748b',\r\n                cursor: 'pointer',\r\n              }}\r\n            >\r\n              Active\r\n            </button>\r\n            <button\r\n              onClick={() => setFilterActive(false)}\r\n              style={{\r\n                padding: '0.5rem 1rem',\r\n                border: '1px solid #e2e8f0',\r\n                borderRadius: '6px',\r\n                background: filterActive === false ? '#ef4444' : 'white',\r\n                color: filterActive === false ? 'white' : '#64748b',\r\n                cursor: 'pointer',\r\n              }}\r\n            >\r\n              Inactive\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {!loading && filteredRatePlans.length === 0 ? (\r\n          <EmptyState\r\n            icon={DollarSign}\r\n            title={searchTerm || filterActive !== null || filterCategory ? 'No rate plans match your filters' : 'No rate plans yet'}\r\n            description={searchTerm || filterActive !== null || filterCategory\r\n              ? 'Try adjusting your search or filter criteria'\r\n              : 'Create your first rate plan to get started'}\r\n            action={searchTerm || filterActive !== null || filterCategory ? undefined : {\r\n              label: 'Create Rate Plan',\r\n              onClick: () => {\r\n                resetForm();\r\n                setShowCreateModal(true);\r\n              },\r\n            }}\r\n          />\r\n        ) : (\r\n          <div>\r\n            {/* Primary Categories Row (Standard, Deluxe, Executive) */}\r\n            {primaryCategories.length > 0 && (\r\n              <div style={{ display: 'flex', flexDirection: 'row', gap: '1.5rem', marginBottom: '2rem', flexWrap: 'wrap', alignItems: 'flex-start' }}>\r\n                {primaryCategories.map(renderCategoryGroup)}\r\n              </div>\r\n            )}\r\n\r\n            {/* Other Categories */}\r\n            {otherCategories.length > 0 && (\r\n              <div style={{ display: 'flex', flexDirection: 'row', gap: '1.5rem', flexWrap: 'wrap', alignItems: 'flex-start' }}>\r\n                {otherCategories.map(renderCategoryGroup)}\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Create Modal */}\r\n        {showCreateModal && (\r\n          <div\r\n            style={{\r\n              position: 'fixed',\r\n              top: 0,\r\n              left: 0,\r\n              right: 0,\r\n              bottom: 0,\r\n              background: 'rgba(0,0,0,0.5)',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              zIndex: 1000,\r\n            }}\r\n            onClick={() => setShowCreateModal(false)}\r\n          >\r\n            <div\r\n              style={{\r\n                background: 'white',\r\n                borderRadius: '8px',\r\n                padding: '2rem',\r\n                width: '90%',\r\n                maxWidth: '500px',\r\n                maxHeight: '90vh',\r\n                overflow: 'auto',\r\n              }}\r\n              onClick={(e) => e.stopPropagation()}\r\n            >\r\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n                <h2 style={{ margin: 0, color: '#1e293b' }}>Create Rate Plan</h2>\r\n                <button\r\n                  onClick={() => setShowCreateModal(false)}\r\n                  style={{\r\n                    background: 'none',\r\n                    border: 'none',\r\n                    cursor: 'pointer',\r\n                    padding: '0.5rem',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                  }}\r\n                >\r\n                  <X size={20} color=\"#64748b\" />\r\n                </button>\r\n              </div>\r\n\r\n              <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                    Category *\r\n                  </label>\r\n                  <select\r\n                    value={formData.categoryId}\r\n                    onChange={(e) => handleCategoryChange(e.target.value)}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      fontSize: '1rem',\r\n                    }}\r\n                  >\r\n                    <option value=\"\">Select a category...</option>\r\n                    {categories.map((category) => (\r\n                      <option key={category.id} value={category.id}>\r\n                        {category.name}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                  {formData.categoryId && (\r\n                    <p style={{ margin: '0.5rem 0 0', fontSize: '0.875rem', color: '#64748b', fontStyle: 'italic' }}>\r\n                      Rate plan name will be: {categories.find(c => c.id === formData.categoryId)?.name}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                    Description\r\n                  </label>\r\n                  <textarea\r\n                    value={formData.description}\r\n                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      fontSize: '1rem',\r\n                      minHeight: '80px',\r\n                      resize: 'vertical',\r\n                    }}\r\n                    placeholder={categories.find(c => c.id === formData.categoryId)?.description || \"Optional description (will use category description if available)\"}\r\n                  />\r\n                  {formData.categoryId && categories.find(c => c.id === formData.categoryId)?.description && (\r\n                    <p style={{ margin: '0.5rem 0 0', fontSize: '0.75rem', color: '#64748b' }}>\r\n                      Category description: {categories.find(c => c.id === formData.categoryId)?.description}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr', gap: '1rem' }}>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                      Base Rate *\r\n                    </label>\r\n                    <input\r\n                      type=\"number\"\r\n                      step=\"0.01\"\r\n                      value={formData.baseRate}\r\n                      onChange={(e) => setFormData({ ...formData, baseRate: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem',\r\n                      }}\r\n                      placeholder=\"0.00\"\r\n                    />\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                      Currency\r\n                    </label>\r\n                    <select\r\n                      value={formData.currency}\r\n                      onChange={(e) => setFormData({ ...formData, currency: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem',\r\n                      }}\r\n                    >\r\n                      <option value=\"NGN\">NGN</option>\r\n                      <option value=\"USD\">USD</option>\r\n                      <option value=\"EUR\">EUR</option>\r\n                      <option value=\"GBP\">GBP</option>\r\n                    </select>\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={formData.isActive}\r\n                      onChange={(e) => setFormData({ ...formData, isActive: e.target.checked })}\r\n                    />\r\n                    <span style={{ color: '#1e293b' }}>Active</span>\r\n                  </label>\r\n                </div>\r\n\r\n                <div style={{ display: 'flex', gap: '1rem', marginTop: '1rem' }}>\r\n                  <button\r\n                    onClick={() => setShowCreateModal(false)}\r\n                    style={{\r\n                      flex: 1,\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      background: 'white',\r\n                      color: '#64748b',\r\n                      cursor: 'pointer',\r\n                      fontWeight: '500',\r\n                    }}\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                  <button\r\n                    onClick={handleCreate}\r\n                    disabled={saving}\r\n                    style={{\r\n                      flex: 1,\r\n                      padding: '0.75rem',\r\n                      border: 'none',\r\n                      borderRadius: '6px',\r\n                      background: '#3b82f6',\r\n                      color: 'white',\r\n                      cursor: saving ? 'not-allowed' : 'pointer',\r\n                      fontWeight: '500',\r\n                      opacity: saving ? 0.6 : 1,\r\n                    }}\r\n                  >\r\n                    {saving ? 'Creating...' : 'Create'}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Edit Modal */}\r\n        {showEditModal && selectedRatePlan && (\r\n          <div\r\n            style={{\r\n              position: 'fixed',\r\n              top: 0,\r\n              left: 0,\r\n              right: 0,\r\n              bottom: 0,\r\n              background: 'rgba(0,0,0,0.5)',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              zIndex: 1000,\r\n            }}\r\n            onClick={() => {\r\n              setShowEditModal(false);\r\n              setSelectedRatePlan(null);\r\n            }}\r\n          >\r\n            <div\r\n              style={{\r\n                background: 'white',\r\n                borderRadius: '8px',\r\n                padding: '2rem',\r\n                width: '90%',\r\n                maxWidth: '500px',\r\n                maxHeight: '90vh',\r\n                overflow: 'auto',\r\n              }}\r\n              onClick={(e) => e.stopPropagation()}\r\n            >\r\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n                <h2 style={{ margin: 0, color: '#1e293b' }}>Edit Rate Plan</h2>\r\n                <button\r\n                  onClick={() => {\r\n                    setShowEditModal(false);\r\n                    setSelectedRatePlan(null);\r\n                  }}\r\n                  style={{\r\n                    background: 'none',\r\n                    border: 'none',\r\n                    cursor: 'pointer',\r\n                    padding: '0.5rem',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                  }}\r\n                >\r\n                  <X size={20} color=\"#64748b\" />\r\n                </button>\r\n              </div>\r\n\r\n              <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                    Category *\r\n                  </label>\r\n                  <select\r\n                    value={formData.categoryId}\r\n                    onChange={(e) => handleCategoryChange(e.target.value)}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      fontSize: '1rem',\r\n                    }}\r\n                  >\r\n                    <option value=\"\">Select a category...</option>\r\n                    {categories.map((category) => (\r\n                      <option key={category.id} value={category.id}>\r\n                        {category.name}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                  {formData.categoryId && (\r\n                    <p style={{ margin: '0.5rem 0 0', fontSize: '0.875rem', color: '#64748b', fontStyle: 'italic' }}>\r\n                      Rate plan name will be: {categories.find(c => c.id === formData.categoryId)?.name}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                    Description\r\n                  </label>\r\n                  <textarea\r\n                    value={formData.description}\r\n                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      fontSize: '1rem',\r\n                      minHeight: '80px',\r\n                      resize: 'vertical',\r\n                    }}\r\n                    placeholder={categories.find(c => c.id === formData.categoryId)?.description || \"Optional description (will use category description if available)\"}\r\n                  />\r\n                  {formData.categoryId && categories.find(c => c.id === formData.categoryId)?.description && (\r\n                    <p style={{ margin: '0.5rem 0 0', fontSize: '0.75rem', color: '#64748b' }}>\r\n                      Category description: {categories.find(c => c.id === formData.categoryId)?.description}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr', gap: '1rem' }}>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                      Base Rate *\r\n                    </label>\r\n                    <input\r\n                      type=\"number\"\r\n                      step=\"0.01\"\r\n                      value={formData.baseRate}\r\n                      onChange={(e) => setFormData({ ...formData, baseRate: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem',\r\n                      }}\r\n                    />\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                      Currency\r\n                    </label>\r\n                    <select\r\n                      value={formData.currency}\r\n                      onChange={(e) => setFormData({ ...formData, currency: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem',\r\n                      }}\r\n                    >\r\n                      <option value=\"NGN\">NGN</option>\r\n                      <option value=\"USD\">USD</option>\r\n                      <option value=\"EUR\">EUR</option>\r\n                      <option value=\"GBP\">GBP</option>\r\n                    </select>\r\n                  </div>\r\n                </div>\r\n\r\n\r\n                <div>\r\n                  <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={formData.isActive}\r\n                      onChange={(e) => setFormData({ ...formData, isActive: e.target.checked })}\r\n                    />\r\n                    <span style={{ color: '#1e293b' }}>Active</span>\r\n                  </label>\r\n                </div>\r\n\r\n                <div style={{ display: 'flex', gap: '1rem', marginTop: '1rem' }}>\r\n                  <button\r\n                    onClick={() => {\r\n                      setShowEditModal(false);\r\n                      setSelectedRatePlan(null);\r\n                    }}\r\n                    style={{\r\n                      flex: 1,\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      background: 'white',\r\n                      color: '#64748b',\r\n                      cursor: 'pointer',\r\n                      fontWeight: '500',\r\n                    }}\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                  <button\r\n                    onClick={handleEdit}\r\n                    style={{\r\n                      flex: 1,\r\n                      padding: '0.75rem',\r\n                      border: 'none',\r\n                      borderRadius: '6px',\r\n                      background: '#3b82f6',\r\n                      color: 'white',\r\n                      cursor: 'pointer',\r\n                      fontWeight: '500',\r\n                    }}\r\n                  >\r\n                    Update\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </Layout>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\ReportsPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadCustomReports' and 'loadReportData'. Either include them or remove the dependency array.","line":126,"column":6,"nodeType":"ArrayExpression","endLine":126,"endColumn":44,"suggestions":[{"desc":"Update the dependencies array to be: [user.tenantId, activeTab, dateRange, loadReportData, loadCustomReports]","fix":{"range":[3405,3443],"text":"[user.tenantId, activeTab, dateRange, loadReportData, loadCustomReports]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Button from '../components/Button';\r\nimport {\r\n  BarChart3,\r\n  TrendingUp,\r\n  DollarSign,\r\n  Users,\r\n  Building,\r\n  Target,\r\n  FileText,\r\n  Download,\r\n  RefreshCw,\r\n  Eye,\r\n  Settings,\r\n  Activity,\r\n  AlertTriangle,\r\n  Star,\r\n  Plus\r\n} from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\n\r\ninterface ReportData {\r\n  period: {\r\n    start: string;\r\n    end: string;\r\n  };\r\n  [key: string]: any;\r\n}\r\n\r\ninterface PerformanceMetrics {\r\n  period: {\r\n    start: Date;\r\n    end: Date;\r\n  };\r\n  metrics: {\r\n    occupancy?: {\r\n      occupiedRoomDays: number;\r\n      totalRoomDays: number;\r\n      occupancyRate: number;\r\n      totalRooms: number;\r\n    };\r\n    revenue?: {\r\n      totalRevenue: number;\r\n      transactionCount: number;\r\n    };\r\n    guestSatisfaction?: {\r\n      totalRequests: number;\r\n      resolvedRequests: number;\r\n      resolutionRate: number;\r\n    };\r\n    operationalEfficiency?: {\r\n      totalTasks: number;\r\n      completedTasks: number;\r\n      completionRate: number;\r\n    };\r\n    averageDailyRate?: {\r\n      totalRevenue: number;\r\n      totalRoomNights: number;\r\n      adr: number;\r\n    };\r\n    revpar?: {\r\n      totalRevenue: number;\r\n      totalRoomDays: number;\r\n      revpar: number;\r\n    };\r\n    goppar?: {\r\n      note: string;\r\n      value: number | null;\r\n    };\r\n  };\r\n}\r\n\r\ninterface CustomReport {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  dateRange: {\r\n    start: Date;\r\n    end: Date;\r\n  };\r\n  metrics: string[];\r\n  filters: any;\r\n  groupBy: string;\r\n  format: string;\r\n  status: string;\r\n  createdAt: Date;\r\n  completedAt?: Date;\r\n  createdBy: string;\r\n  data?: any;\r\n}\r\n\r\nexport default function ReportsPage() {\r\n  const { user } = useAuthStore();\r\n  const [activeTab, setActiveTab] = useState<'occupancy' | 'revenue' | 'performance' | 'financial' | 'feedback' | 'custom'>('performance');\r\n  const [loading, setLoading] = useState(false);\r\n  const [reportData, setReportData] = useState<ReportData | null>(null);\r\n  const [performanceData, setPerformanceData] = useState<PerformanceMetrics | null>(null);\r\n  const [customReports, setCustomReports] = useState<CustomReport[]>([]);\r\n  const [dateRange, setDateRange] = useState({\r\n    start: new Date(new Date().getFullYear(), new Date().getMonth(), 1).toISOString().split('T')[0],\r\n    end: new Date().toISOString().split('T')[0]\r\n  });\r\n  const [showCustomReportModal, setShowCustomReportModal] = useState(false);\r\n  const [customReportForm, setCustomReportForm] = useState({\r\n    name: '',\r\n    description: '',\r\n    metrics: [] as string[],\r\n    groupBy: 'day' as 'day' | 'month'\r\n  });\r\n\r\n  const availableMetrics = [\r\n    { id: 'occupancy', label: 'Occupancy Rate', icon: Building },\r\n    { id: 'revenue', label: 'Revenue', icon: DollarSign },\r\n    { id: 'guestSatisfaction', label: 'Guest Satisfaction', icon: Users },\r\n    { id: 'operationalEfficiency', label: 'Operational Efficiency', icon: Target },\r\n    { id: 'averageDailyRate', label: 'Average Daily Rate (ADR)', icon: TrendingUp },\r\n    { id: 'revpar', label: 'Revenue Per Available Room (RevPAR)', icon: BarChart3 },\r\n    { id: 'goppar', label: 'Gross Operating Profit Per Available Room (GOPPAR)', icon: Activity }\r\n  ];\r\n\r\n  useEffect(() => {\r\n    loadReportData();\r\n    loadCustomReports();\r\n  }, [user?.tenantId, activeTab, dateRange]);\r\n\r\n  const loadReportData = async () => {\r\n    if (!user?.tenantId) return;\r\n\r\n    try {\r\n      setLoading(true);\r\n\r\n      if (activeTab === 'performance') {\r\n        const response = await api.get(`/tenants/${user.tenantId}/reports/performance-metrics`, {\r\n          params: {\r\n            startDate: dateRange.start,\r\n            endDate: dateRange.end\r\n          }\r\n        });\r\n        setPerformanceData(response.data.data);\r\n      } else if (activeTab === 'occupancy') {\r\n        const response = await api.get(`/tenants/${user.tenantId}/reports/occupancy`, {\r\n          params: {\r\n            startDate: dateRange.start,\r\n            endDate: dateRange.end\r\n          }\r\n        });\r\n        setReportData(response.data.data);\r\n      } else if (activeTab === 'revenue') {\r\n        const response = await api.get(`/tenants/${user.tenantId}/reports/revenue`, {\r\n          params: {\r\n            startDate: dateRange.start,\r\n            endDate: dateRange.end\r\n          }\r\n        });\r\n        setReportData(response.data.data);\r\n      } else if (activeTab === 'financial') {\r\n        const response = await api.get(`/tenants/${user.tenantId}/reports/financial`, {\r\n          params: {\r\n            startDate: dateRange.start,\r\n            endDate: dateRange.end\r\n          }\r\n        });\r\n        setReportData(response.data.data);\r\n      } else if (activeTab === 'feedback') {\r\n        const response = await api.get(`/tenants/${user.tenantId}/reports/guest-feedback`, {\r\n          params: {\r\n            startDate: dateRange.start,\r\n            endDate: dateRange.end\r\n          }\r\n        });\r\n        setReportData(response.data.data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading report data:', error);\r\n      toast.error('Failed to load report data');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadCustomReports = async () => {\r\n    if (!user?.tenantId) return;\r\n\r\n    try {\r\n      const response = await api.get(`/tenants/${user.tenantId}/reports/custom`);\r\n      setCustomReports(response.data.data);\r\n    } catch (error) {\r\n      console.error('Error loading custom reports:', error);\r\n    }\r\n  };\r\n\r\n  const createCustomReport = async () => {\r\n    if (!user?.tenantId) return;\r\n\r\n    try {\r\n      await api.post(`/tenants/${user.tenantId}/reports/custom`, {\r\n        name: customReportForm.name,\r\n        description: customReportForm.description,\r\n        dateRange: {\r\n          start: dateRange.start,\r\n          end: dateRange.end\r\n        },\r\n        metrics: customReportForm.metrics,\r\n        groupBy: customReportForm.groupBy,\r\n        format: 'json'\r\n      });\r\n\r\n      toast.success('Custom report created successfully');\r\n      setShowCustomReportModal(false);\r\n      setCustomReportForm({\r\n        name: '',\r\n        description: '',\r\n        metrics: [],\r\n        groupBy: 'day'\r\n      });\r\n      loadCustomReports();\r\n    } catch (error) {\r\n      console.error('Error creating custom report:', error);\r\n      toast.error('Failed to create custom report');\r\n    }\r\n  };\r\n\r\n  const formatCurrency = (amount: number) => {\r\n    return new Intl.NumberFormat('en-NG', {\r\n      style: 'currency',\r\n      currency: 'NGN',\r\n      minimumFractionDigits: 0,\r\n      maximumFractionDigits: 0\r\n    }).format(amount);\r\n  };\r\n\r\n  const formatPercentage = (value: number) => {\r\n    return `${value.toFixed(1)}%`;\r\n  };\r\n\r\n  const getStatusColor = (rate: number, thresholds: { good: number; warning: number }) => {\r\n    if (rate >= thresholds.good) return '#10b981';\r\n    if (rate >= thresholds.warning) return '#f59e0b';\r\n    return '#ef4444';\r\n  };\r\n\r\n  const tabs = [\r\n    { id: 'performance', label: 'Performance Metrics', icon: Target },\r\n    { id: 'occupancy', label: 'Occupancy Reports', icon: Building },\r\n    { id: 'revenue', label: 'Revenue Reports', icon: DollarSign },\r\n    { id: 'financial', label: 'Financial Reports', icon: FileText },\r\n    { id: 'feedback', label: 'Guest Feedback', icon: Star },\r\n    { id: 'custom', label: 'Custom Reports', icon: Settings }\r\n  ];\r\n\r\n  return (\r\n    <div style={{ padding: '2rem', maxWidth: '1400px', margin: '0 auto' }}>\r\n      {/* Header */}\r\n      <div style={{\r\n        display: 'flex',\r\n        justifyContent: 'space-between',\r\n        alignItems: 'center',\r\n        marginBottom: '2rem'\r\n      }}>\r\n        <div>\r\n          <h1 style={{ fontSize: '2rem', fontWeight: 'bold', marginBottom: '0.5rem' }}>\r\n            Reports & Analytics\r\n          </h1>\r\n          <p style={{ color: '#64748b' }}>\r\n            Comprehensive business intelligence and performance metrics\r\n          </p>\r\n        </div>\r\n\r\n        <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n            <label style={{ fontSize: '0.875rem', color: '#64748b' }}>From:</label>\r\n            <input\r\n              type=\"date\"\r\n              value={dateRange.start}\r\n              onChange={(e) => setDateRange(prev => ({ ...prev, start: e.target.value }))}\r\n              style={{\r\n                padding: '0.5rem',\r\n                border: '1px solid #d1d5db',\r\n                borderRadius: '6px',\r\n                fontSize: '0.875rem'\r\n              }}\r\n            />\r\n          </div>\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n            <label style={{ fontSize: '0.875rem', color: '#64748b' }}>To:</label>\r\n            <input\r\n              type=\"date\"\r\n              value={dateRange.end}\r\n              onChange={(e) => setDateRange(prev => ({ ...prev, end: e.target.value }))}\r\n              style={{\r\n                padding: '0.5rem',\r\n                border: '1px solid #d1d5db',\r\n                borderRadius: '6px',\r\n                fontSize: '0.875rem'\r\n              }}\r\n            />\r\n          </div>\r\n          <Button variant=\"secondary\" onClick={loadReportData}>\r\n            <RefreshCw size={16} style={{ marginRight: '0.5rem' }} />\r\n            Refresh\r\n          </Button>\r\n          <Button variant=\"secondary\">\r\n            <Download size={16} style={{ marginRight: '0.5rem' }} />\r\n            Export\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tabs */}\r\n      <div style={{\r\n        display: 'flex',\r\n        borderBottom: '1px solid #e2e8f0',\r\n        marginBottom: '2rem',\r\n        overflowX: 'auto'\r\n      }}>\r\n        {tabs.map(tab => {\r\n          const Icon = tab.icon;\r\n          return (\r\n            <button\r\n              key={tab.id}\r\n              onClick={() => setActiveTab(tab.id as any)}\r\n              style={{\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: '0.5rem',\r\n                padding: '1rem 1.5rem',\r\n                border: 'none',\r\n                background: 'none',\r\n                borderBottom: activeTab === tab.id ? '2px solid #3b82f6' : '2px solid transparent',\r\n                color: activeTab === tab.id ? '#3b82f6' : '#64748b',\r\n                fontWeight: activeTab === tab.id ? '600' : '500',\r\n                cursor: 'pointer',\r\n                whiteSpace: 'nowrap'\r\n              }}\r\n            >\r\n              <Icon size={18} />\r\n              {tab.label}\r\n            </button>\r\n          );\r\n        })}\r\n      </div>\r\n\r\n      {/* Content */}\r\n      {loading ? (\r\n        <div style={{ textAlign: 'center', padding: '4rem' }}>\r\n          <RefreshCw size={32} style={{ animation: 'spin 1s linear infinite', color: '#64748b' }} />\r\n          <p style={{ marginTop: '1rem', color: '#64748b' }}>Loading report data...</p>\r\n        </div>\r\n      ) : (\r\n        <>\r\n          {/* Performance Metrics Tab */}\r\n          {activeTab === 'performance' && performanceData && (\r\n            <div style={{ display: 'grid', gap: '2rem' }}>\r\n              {/* Key Metrics Cards */}\r\n              <div style={{\r\n                display: 'grid',\r\n                gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))',\r\n                gap: '1.5rem'\r\n              }}>\r\n                {performanceData.metrics.occupancy && (\r\n                  <div style={{\r\n                    background: 'white',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '12px',\r\n                    padding: '2rem'\r\n                  }}>\r\n                    <div style={{\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: '0.5rem',\r\n                      marginBottom: '1rem'\r\n                    }}>\r\n                      <Building size={20} style={{ color: '#3b82f6' }} />\r\n                      <h3 style={{ fontSize: '1.125rem', fontWeight: '600' }}>Occupancy Rate</h3>\r\n                    </div>\r\n                    <div style={{\r\n                      fontSize: '2.5rem',\r\n                      fontWeight: 'bold',\r\n                      color: getStatusColor(performanceData.metrics.occupancy.occupancyRate, { good: 80, warning: 60 }),\r\n                      marginBottom: '0.5rem'\r\n                    }}>\r\n                      {formatPercentage(performanceData.metrics.occupancy.occupancyRate)}\r\n                    </div>\r\n                    <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                      {performanceData.metrics.occupancy.occupiedRoomDays} of {performanceData.metrics.occupancy.totalRoomDays} room-days\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {performanceData.metrics.revenue && (\r\n                  <div style={{\r\n                    background: 'white',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '12px',\r\n                    padding: '2rem'\r\n                  }}>\r\n                    <div style={{\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: '0.5rem',\r\n                      marginBottom: '1rem'\r\n                    }}>\r\n                      <DollarSign size={20} style={{ color: '#10b981' }} />\r\n                      <h3 style={{ fontSize: '1.125rem', fontWeight: '600' }}>Total Revenue</h3>\r\n                    </div>\r\n                    <div style={{\r\n                      fontSize: '2.5rem',\r\n                      fontWeight: 'bold',\r\n                      color: '#1f2937',\r\n                      marginBottom: '0.5rem'\r\n                    }}>\r\n                      {formatCurrency(performanceData.metrics.revenue.totalRevenue)}\r\n                    </div>\r\n                    <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                      {performanceData.metrics.revenue.transactionCount} transactions\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {performanceData.metrics.averageDailyRate && (\r\n                  <div style={{\r\n                    background: 'white',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '12px',\r\n                    padding: '2rem'\r\n                  }}>\r\n                    <div style={{\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: '0.5rem',\r\n                      marginBottom: '1rem'\r\n                    }}>\r\n                      <TrendingUp size={20} style={{ color: '#f59e0b' }} />\r\n                      <h3 style={{ fontSize: '1.125rem', fontWeight: '600' }}>Average Daily Rate</h3>\r\n                    </div>\r\n                    <div style={{\r\n                      fontSize: '2.5rem',\r\n                      fontWeight: 'bold',\r\n                      color: '#1f2937',\r\n                      marginBottom: '0.5rem'\r\n                    }}>\r\n                      {formatCurrency(performanceData.metrics.averageDailyRate.adr)}\r\n                    </div>\r\n                    <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                      Based on {performanceData.metrics.averageDailyRate.totalRoomNights} room nights\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {performanceData.metrics.revpar && (\r\n                  <div style={{\r\n                    background: 'white',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '12px',\r\n                    padding: '2rem'\r\n                  }}>\r\n                    <div style={{\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: '0.5rem',\r\n                      marginBottom: '1rem'\r\n                    }}>\r\n                      <BarChart3 size={20} style={{ color: '#8b5cf6' }} />\r\n                      <h3 style={{ fontSize: '1.125rem', fontWeight: '600' }}>Revenue Per Available Room</h3>\r\n                    </div>\r\n                    <div style={{\r\n                      fontSize: '2.5rem',\r\n                      fontWeight: 'bold',\r\n                      color: '#1f2937',\r\n                      marginBottom: '0.5rem'\r\n                    }}>\r\n                      {formatCurrency(performanceData.metrics.revpar.revpar)}\r\n                    </div>\r\n                    <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                      Per room per day\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {performanceData.metrics.guestSatisfaction && (\r\n                  <div style={{\r\n                    background: 'white',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '12px',\r\n                    padding: '2rem'\r\n                  }}>\r\n                    <div style={{\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: '0.5rem',\r\n                      marginBottom: '1rem'\r\n                    }}>\r\n                      <Users size={20} style={{ color: '#ec4899' }} />\r\n                      <h3 style={{ fontSize: '1.125rem', fontWeight: '600' }}>Guest Satisfaction</h3>\r\n                    </div>\r\n                    <div style={{\r\n                      fontSize: '2.5rem',\r\n                      fontWeight: 'bold',\r\n                      color: getStatusColor(performanceData.metrics.guestSatisfaction.resolutionRate, { good: 90, warning: 75 }),\r\n                      marginBottom: '0.5rem'\r\n                    }}>\r\n                      {formatPercentage(performanceData.metrics.guestSatisfaction.resolutionRate)}\r\n                    </div>\r\n                    <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                      {performanceData.metrics.guestSatisfaction.resolvedRequests} of {performanceData.metrics.guestSatisfaction.totalRequests} requests resolved\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {performanceData.metrics.operationalEfficiency && (\r\n                  <div style={{\r\n                    background: 'white',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '12px',\r\n                    padding: '2rem'\r\n                  }}>\r\n                    <div style={{\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: '0.5rem',\r\n                      marginBottom: '1rem'\r\n                    }}>\r\n                      <Target size={20} style={{ color: '#06b6d4' }} />\r\n                      <h3 style={{ fontSize: '1.125rem', fontWeight: '600' }}>Operational Efficiency</h3>\r\n                    </div>\r\n                    <div style={{\r\n                      fontSize: '2.5rem',\r\n                      fontWeight: 'bold',\r\n                      color: getStatusColor(performanceData.metrics.operationalEfficiency.completionRate, { good: 90, warning: 75 }),\r\n                      marginBottom: '0.5rem'\r\n                    }}>\r\n                      {formatPercentage(performanceData.metrics.operationalEfficiency.completionRate)}\r\n                    </div>\r\n                    <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                      {performanceData.metrics.operationalEfficiency.completedTasks} of {performanceData.metrics.operationalEfficiency.totalTasks} tasks completed\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* GOPPAR Note */}\r\n              {performanceData.metrics.goppar && (\r\n                <div style={{\r\n                  background: '#fef3c7',\r\n                  border: '1px solid #f59e0b',\r\n                  borderRadius: '8px',\r\n                  padding: '1rem',\r\n                  fontSize: '0.875rem',\r\n                  color: '#92400e'\r\n                }}>\r\n                  <AlertTriangle size={16} style={{ display: 'inline', marginRight: '0.5rem' }} />\r\n                  {performanceData.metrics.goppar.note}\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Occupancy Reports Tab */}\r\n          {activeTab === 'occupancy' && reportData && (\r\n            <div style={{\r\n              background: 'white',\r\n              border: '1px solid #e2e8f0',\r\n              borderRadius: '12px',\r\n              padding: '2rem'\r\n            }}>\r\n              <h3 style={{ fontSize: '1.5rem', fontWeight: '600', marginBottom: '1rem' }}>\r\n                Occupancy Report\r\n              </h3>\r\n              <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                Detailed occupancy analytics for the selected period\r\n              </div>\r\n              {/* Occupancy report content would go here */}\r\n              <div style={{\r\n                padding: '4rem',\r\n                textAlign: 'center',\r\n                color: '#64748b',\r\n                background: '#f8fafc',\r\n                borderRadius: '8px',\r\n                marginTop: '2rem'\r\n              }}>\r\n                Occupancy report visualization will be implemented here\r\n                <br />\r\n                Data available: {JSON.stringify(reportData, null, 2).length} characters\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Revenue Reports Tab */}\r\n          {activeTab === 'revenue' && reportData && (\r\n            <div style={{\r\n              background: 'white',\r\n              border: '1px solid #e2e8f0',\r\n              borderRadius: '12px',\r\n              padding: '2rem'\r\n            }}>\r\n              <h3 style={{ fontSize: '1.5rem', fontWeight: '600', marginBottom: '1rem' }}>\r\n                Revenue Report\r\n              </h3>\r\n              <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                Comprehensive revenue analysis and trends\r\n              </div>\r\n              {/* Revenue report content would go here */}\r\n              <div style={{\r\n                padding: '4rem',\r\n                textAlign: 'center',\r\n                color: '#64748b',\r\n                background: '#f8fafc',\r\n                borderRadius: '8px',\r\n                marginTop: '2rem'\r\n              }}>\r\n                Revenue report visualization will be implemented here\r\n                <br />\r\n                Data available: {JSON.stringify(reportData, null, 2).length} characters\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Financial Reports Tab */}\r\n          {activeTab === 'financial' && reportData && (\r\n            <div style={{ display: 'grid', gap: '2rem' }}>\r\n              {/* Summary Cards */}\r\n              <div style={{\r\n                display: 'grid',\r\n                gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',\r\n                gap: '1rem'\r\n              }}>\r\n                <div style={{\r\n                  background: 'white',\r\n                  border: '1px solid #e2e8f0',\r\n                  borderRadius: '8px',\r\n                  padding: '1.5rem'\r\n                }}>\r\n                  <h4 style={{ fontSize: '0.875rem', color: '#64748b', marginBottom: '0.5rem' }}>\r\n                    Total Revenue\r\n                  </h4>\r\n                  <div style={{ fontSize: '1.5rem', fontWeight: 'bold' }}>\r\n                    {formatCurrency(reportData.summary?.revenue?.totalRevenue || 0)}\r\n                  </div>\r\n                </div>\r\n\r\n                <div style={{\r\n                  background: 'white',\r\n                  border: '1px solid #e2e8f0',\r\n                  borderRadius: '8px',\r\n                  padding: '1.5rem'\r\n                }}>\r\n                  <h4 style={{ fontSize: '0.875rem', color: '#64748b', marginBottom: '0.5rem' }}>\r\n                    Total Expenses\r\n                  </h4>\r\n                  <div style={{ fontSize: '1.5rem', fontWeight: 'bold' }}>\r\n                    {formatCurrency(reportData.summary?.expenses?.totalExpenses || 0)}\r\n                  </div>\r\n                </div>\r\n\r\n                <div style={{\r\n                  background: 'white',\r\n                  border: '1px solid #e2e8f0',\r\n                  borderRadius: '8px',\r\n                  padding: '1.5rem'\r\n                }}>\r\n                  <h4 style={{ fontSize: '0.875rem', color: '#64748b', marginBottom: '0.5rem' }}>\r\n                    Net Profit\r\n                  </h4>\r\n                  <div style={{\r\n                    fontSize: '1.5rem',\r\n                    fontWeight: 'bold',\r\n                    color: (reportData.summary?.profitLoss?.netProfit || 0) >= 0 ? '#10b981' : '#ef4444'\r\n                  }}>\r\n                    {formatCurrency(reportData.summary?.profitLoss?.netProfit || 0)}\r\n                  </div>\r\n                </div>\r\n\r\n                <div style={{\r\n                  background: 'white',\r\n                  border: '1px solid #e2e8f0',\r\n                  borderRadius: '8px',\r\n                  padding: '1.5rem'\r\n                }}>\r\n                  <h4 style={{ fontSize: '0.875rem', color: '#64748b', marginBottom: '0.5rem' }}>\r\n                    Profit Margin\r\n                  </h4>\r\n                  <div style={{ fontSize: '1.5rem', fontWeight: 'bold' }}>\r\n                    {formatPercentage(reportData.summary?.profitLoss?.profitMargin || 0)}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Expense Note */}\r\n              {reportData.summary?.expenses?.note && (\r\n                <div style={{\r\n                  background: '#fef3c7',\r\n                  border: '1px solid #f59e0b',\r\n                  borderRadius: '8px',\r\n                  padding: '1rem',\r\n                  fontSize: '0.875rem',\r\n                  color: '#92400e'\r\n                }}>\r\n                  <AlertTriangle size={16} style={{ display: 'inline', marginRight: '0.5rem' }} />\r\n                  {reportData.summary.expenses.note}\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Guest Feedback Tab */}\r\n          {activeTab === 'feedback' && reportData && (\r\n            <div style={{\r\n              background: 'white',\r\n              border: '1px solid #e2e8f0',\r\n              borderRadius: '12px',\r\n              padding: '2rem'\r\n            }}>\r\n              <h3 style={{ fontSize: '1.5rem', fontWeight: '600', marginBottom: '1rem' }}>\r\n                Guest Feedback Report\r\n              </h3>\r\n              <div style={{ fontSize: '0.875rem', color: '#64748b', marginBottom: '2rem' }}>\r\n                {reportData.note}\r\n              </div>\r\n\r\n              {/* Feedback Summary */}\r\n              <div style={{\r\n                display: 'grid',\r\n                gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',\r\n                gap: '1rem',\r\n                marginBottom: '2rem'\r\n              }}>\r\n                <div style={{\r\n                  background: '#f8fafc',\r\n                  borderRadius: '8px',\r\n                  padding: '1rem',\r\n                  textAlign: 'center'\r\n                }}>\r\n                  <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#64748b' }}>\r\n                    {reportData.summary?.totalFeedback || 0}\r\n                  </div>\r\n                  <div style={{ fontSize: '0.875rem', color: '#64748b' }}>Total Feedback</div>\r\n                </div>\r\n\r\n                <div style={{\r\n                  background: '#f8fafc',\r\n                  borderRadius: '8px',\r\n                  padding: '1rem',\r\n                  textAlign: 'center'\r\n                }}>\r\n                  <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#64748b' }}>\r\n                    {reportData.summary?.averageRating ? reportData.summary.averageRating.toFixed(1) : '0.0'}\r\n                  </div>\r\n                  <div style={{ fontSize: '0.875rem', color: '#64748b' }}>Average Rating</div>\r\n                </div>\r\n\r\n                <div style={{\r\n                  background: '#f8fafc',\r\n                  borderRadius: '8px',\r\n                  padding: '1rem',\r\n                  textAlign: 'center'\r\n                }}>\r\n                  <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#64748b' }}>\r\n                    {formatPercentage(reportData.summary?.responseRate || 0)}\r\n                  </div>\r\n                  <div style={{ fontSize: '0.875rem', color: '#64748b' }}>Response Rate</div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Feedback Categories */}\r\n              <div style={{\r\n                display: 'grid',\r\n                gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',\r\n                gap: '1rem'\r\n              }}>\r\n                {Object.entries(reportData.summary?.categories || {}).map(([category, data]: [string, any]) => (\r\n                  <div key={category} style={{\r\n                    background: 'white',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '8px',\r\n                    padding: '1rem'\r\n                  }}>\r\n                    <h4 style={{ fontSize: '1rem', fontWeight: '600', marginBottom: '0.5rem', textTransform: 'capitalize' }}>\r\n                      {category}\r\n                    </h4>\r\n                    <div style={{ fontSize: '1.5rem', fontWeight: 'bold', marginBottom: '0.25rem' }}>\r\n                      {data.averageRating?.toFixed(1) || '0.0'}\r\n                    </div>\r\n                    <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                      {data.count || 0} reviews\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Custom Reports Tab */}\r\n          {activeTab === 'custom' && (\r\n            <div style={{ display: 'grid', gap: '2rem' }}>\r\n              {/* Create Custom Report Button */}\r\n              <div style={{\r\n                display: 'flex',\r\n                justifyContent: 'space-between',\r\n                alignItems: 'center'\r\n              }}>\r\n                <div>\r\n                  <h3 style={{ fontSize: '1.5rem', fontWeight: '600', marginBottom: '0.5rem' }}>\r\n                    Custom Reports\r\n                  </h3>\r\n                  <p style={{ color: '#64748b' }}>\r\n                    Create tailored reports with specific metrics and date ranges\r\n                  </p>\r\n                </div>\r\n                <Button onClick={() => setShowCustomReportModal(true)}>\r\n                  <Plus size={18} style={{ marginRight: '0.5rem' }} />\r\n                  Create Custom Report\r\n                </Button>\r\n              </div>\r\n\r\n              {/* Custom Reports List */}\r\n              <div style={{\r\n                display: 'grid',\r\n                gap: '1rem'\r\n              }}>\r\n                {customReports.map(report => (\r\n                  <div key={report.id} style={{\r\n                    background: 'white',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '8px',\r\n                    padding: '1.5rem',\r\n                    display: 'flex',\r\n                    justifyContent: 'space-between',\r\n                    alignItems: 'center'\r\n                  }}>\r\n                    <div style={{ flex: 1 }}>\r\n                      <h4 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '0.25rem' }}>\r\n                        {report.name}\r\n                      </h4>\r\n                      <p style={{ color: '#64748b', marginBottom: '0.5rem' }}>\r\n                        {report.description}\r\n                      </p>\r\n                      <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                        Created: {report.createdAt.toLocaleDateString()} \r\n                        Metrics: {report.metrics.join(', ')} \r\n                        Group by: {report.groupBy}\r\n                      </div>\r\n                    </div>\r\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>\r\n                      <span style={{\r\n                        padding: '0.25rem 0.75rem',\r\n                        borderRadius: '9999px',\r\n                        fontSize: '0.75rem',\r\n                        fontWeight: '500',\r\n                        background: report.status === 'completed' ? '#dcfce7' : '#fef3c7',\r\n                        color: report.status === 'completed' ? '#166534' : '#92400e'\r\n                      }}>\r\n                        {report.status}\r\n                      </span>\r\n                      <Button variant=\"secondary\" size=\"sm\">\r\n                        <Eye size={14} style={{ marginRight: '0.5rem' }} />\r\n                        View\r\n                      </Button>\r\n                      <Button variant=\"secondary\" size=\"sm\">\r\n                        <Download size={14} style={{ marginRight: '0.5rem' }} />\r\n                        Export\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n\r\n                {customReports.length === 0 && (\r\n                  <div style={{\r\n                    textAlign: 'center',\r\n                    padding: '4rem',\r\n                    color: '#64748b',\r\n                    background: '#f8fafc',\r\n                    borderRadius: '8px'\r\n                  }}>\r\n                    <FileText size={48} style={{ margin: '0 auto 1rem', opacity: 0.5 }} />\r\n                    <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '0.5rem' }}>\r\n                      No Custom Reports Yet\r\n                    </h3>\r\n                    <p>Create your first custom report to get started with tailored analytics</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </>\r\n      )}\r\n\r\n      {/* Custom Report Modal */}\r\n      {showCustomReportModal && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: 'rgba(0, 0, 0, 0.5)',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          zIndex: 1000\r\n        }}>\r\n          <div style={{\r\n            background: 'white',\r\n            borderRadius: '12px',\r\n            padding: '2rem',\r\n            width: '600px',\r\n            maxWidth: '90vw',\r\n            maxHeight: '90vh',\r\n            overflow: 'auto'\r\n          }}>\r\n            <h3 style={{ fontSize: '1.5rem', fontWeight: '600', marginBottom: '1.5rem' }}>\r\n              Create Custom Report\r\n            </h3>\r\n\r\n            <div style={{ display: 'grid', gap: '1rem' }}>\r\n              <div>\r\n                <label style={{ display: 'block', fontSize: '0.875rem', fontWeight: '500', marginBottom: '0.5rem' }}>\r\n                  Report Name\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={customReportForm.name}\r\n                  onChange={(e) => setCustomReportForm(prev => ({ ...prev, name: e.target.value }))}\r\n                  placeholder=\"Enter report name\"\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #d1d5db',\r\n                    borderRadius: '6px',\r\n                    fontSize: '0.875rem'\r\n                  }}\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label style={{ display: 'block', fontSize: '0.875rem', fontWeight: '500', marginBottom: '0.5rem' }}>\r\n                  Description\r\n                </label>\r\n                <textarea\r\n                  value={customReportForm.description}\r\n                  onChange={(e) => setCustomReportForm(prev => ({ ...prev, description: e.target.value }))}\r\n                  placeholder=\"Describe what this report will show\"\r\n                  rows={3}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #d1d5db',\r\n                    borderRadius: '6px',\r\n                    fontSize: '0.875rem',\r\n                    resize: 'vertical'\r\n                  }}\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label style={{ display: 'block', fontSize: '0.875rem', fontWeight: '500', marginBottom: '0.5rem' }}>\r\n                  Metrics to Include\r\n                </label>\r\n                <div style={{\r\n                  display: 'grid',\r\n                  gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',\r\n                  gap: '0.5rem'\r\n                }}>\r\n                  {availableMetrics.map(metric => {\r\n                    const Icon = metric.icon;\r\n                    const isSelected = customReportForm.metrics.includes(metric.id);\r\n                    return (\r\n                      <label\r\n                        key={metric.id}\r\n                        style={{\r\n                          display: 'flex',\r\n                          alignItems: 'center',\r\n                          gap: '0.5rem',\r\n                          padding: '0.75rem',\r\n                          border: `1px solid ${isSelected ? '#3b82f6' : '#d1d5db'}`,\r\n                          borderRadius: '6px',\r\n                          background: isSelected ? '#eff6ff' : 'white',\r\n                          cursor: 'pointer'\r\n                        }}\r\n                      >\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={isSelected}\r\n                          onChange={(e) => {\r\n                            if (e.target.checked) {\r\n                              setCustomReportForm(prev => ({\r\n                                ...prev,\r\n                                metrics: [...prev.metrics, metric.id]\r\n                              }));\r\n                            } else {\r\n                              setCustomReportForm(prev => ({\r\n                                ...prev,\r\n                                metrics: prev.metrics.filter(m => m !== metric.id)\r\n                              }));\r\n                            }\r\n                          }}\r\n                          style={{ display: 'none' }}\r\n                        />\r\n                        <Icon size={16} style={{ color: isSelected ? '#3b82f6' : '#64748b' }} />\r\n                        <span style={{ fontSize: '0.875rem' }}>{metric.label}</span>\r\n                      </label>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <label style={{ display: 'block', fontSize: '0.875rem', fontWeight: '500', marginBottom: '0.5rem' }}>\r\n                  Group Data By\r\n                </label>\r\n                <select\r\n                  value={customReportForm.groupBy}\r\n                  onChange={(e) => setCustomReportForm(prev => ({ ...prev, groupBy: e.target.value as 'day' | 'month' }))}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #d1d5db',\r\n                    borderRadius: '6px',\r\n                    fontSize: '0.875rem'\r\n                  }}\r\n                >\r\n                  <option value=\"day\">Daily</option>\r\n                  <option value=\"month\">Monthly</option>\r\n                </select>\r\n              </div>\r\n            </div>\r\n\r\n            <div style={{\r\n              display: 'flex',\r\n              justifyContent: 'flex-end',\r\n              gap: '1rem',\r\n              marginTop: '2rem'\r\n            }}>\r\n              <Button variant=\"secondary\" onClick={() => setShowCustomReportModal(false)}>\r\n                Cancel\r\n              </Button>\r\n              <Button onClick={createCustomReport} disabled={!customReportForm.name || customReportForm.metrics.length === 0}>\r\n                Create Report\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\ReservationsPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchRooms'. Either include it or remove the dependency array.","line":81,"column":6,"nodeType":"ArrayExpression","endLine":81,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [fetchRooms, user]","fix":{"range":[2550,2556],"text":"[fetchRooms, user]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchReservations'. Either include it or remove the dependency array.","line":86,"column":6,"nodeType":"ArrayExpression","endLine":86,"endColumn":38,"suggestions":[{"desc":"Update the dependencies array to be: [user, pagination.page, filters, fetchReservations]","fix":{"range":[2663,2695],"text":"[user, pagination.page, filters, fetchReservations]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchCategories', 'fetchMeetingHalls', and 'fetchRooms'. Either include them or remove the dependency array.","line":802,"column":6,"nodeType":"ArrayExpression","endLine":802,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [fetchCategories, fetchMeetingHalls, fetchRooms, user?.tenantId]","fix":{"range":[30491,30507],"text":"[fetchCategories, fetchMeetingHalls, fetchRooms, user?.tenantId]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchAvailability'. Either include it or remove the dependency array.","line":895,"column":6,"nodeType":"ArrayExpression","endLine":895,"endColumn":87,"suggestions":[{"desc":"Update the dependencies array to be: [formData.checkInDate, formData.checkOutDate, formData.adults, formData.children, fetchAvailability]","fix":{"range":[33440,33521],"text":"[formData.checkInDate, formData.checkOutDate, formData.adults, formData.children, fetchAvailability]"}}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":1545,"column":29,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[55469,55532],"text":"\r\n          Bulk select (e.g. &quot;101-105\" or \"201,203\")\r\n        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[55469,55532],"text":"\r\n          Bulk select (e.g. &ldquo;101-105\" or \"201,203\")\r\n        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[55469,55532],"text":"\r\n          Bulk select (e.g. &#34;101-105\" or \"201,203\")\r\n        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[55469,55532],"text":"\r\n          Bulk select (e.g. &rdquo;101-105\" or \"201,203\")\r\n        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":1545,"column":37,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[55469,55532],"text":"\r\n          Bulk select (e.g. \"101-105&quot; or \"201,203\")\r\n        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[55469,55532],"text":"\r\n          Bulk select (e.g. \"101-105&ldquo; or \"201,203\")\r\n        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[55469,55532],"text":"\r\n          Bulk select (e.g. \"101-105&#34; or \"201,203\")\r\n        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[55469,55532],"text":"\r\n          Bulk select (e.g. \"101-105&rdquo; or \"201,203\")\r\n        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":1545,"column":42,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[55469,55532],"text":"\r\n          Bulk select (e.g. \"101-105\" or &quot;201,203\")\r\n        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[55469,55532],"text":"\r\n          Bulk select (e.g. \"101-105\" or &ldquo;201,203\")\r\n        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[55469,55532],"text":"\r\n          Bulk select (e.g. \"101-105\" or &#34;201,203\")\r\n        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[55469,55532],"text":"\r\n          Bulk select (e.g. \"101-105\" or &rdquo;201,203\")\r\n        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":1545,"column":50,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[55469,55532],"text":"\r\n          Bulk select (e.g. \"101-105\" or \"201,203&quot;)\r\n        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[55469,55532],"text":"\r\n          Bulk select (e.g. \"101-105\" or \"201,203&ldquo;)\r\n        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[55469,55532],"text":"\r\n          Bulk select (e.g. \"101-105\" or \"201,203&#34;)\r\n        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[55469,55532],"text":"\r\n          Bulk select (e.g. \"101-105\" or \"201,203&rdquo;)\r\n        "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from 'react';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Layout from '../components/Layout';\r\nimport { Plus, CheckCircle, XCircle, Filter } from 'lucide-react';\r\nimport { format, subDays } from 'date-fns';\r\nimport toast from 'react-hot-toast';\r\nimport { TableSkeleton } from '../components/LoadingSkeleton';\r\nimport SearchInput from '../components/SearchInput';\r\nimport Pagination from '../components/Pagination';\r\n\r\ninterface Reservation {\r\n  id: string;\r\n  reservationNumber: string;\r\n  guestName: string;\r\n  checkInDate: string;\r\n  checkOutDate: string;\r\n  status: string;\r\n  rate: number;\r\n  room: {\r\n    roomNumber: string;\r\n    roomType: string;\r\n  };\r\n}\r\n\r\ntype HallReservationForm = {\r\n  id: string;\r\n  hallId: string;\r\n  eventName: string;\r\n  purpose: string;\r\n  setupType: string;\r\n  attendeeCount: string;\r\n  startDateTime: string;\r\n  endDateTime: string;\r\n  cateringNotes: string;\r\n  avRequirements: string;\r\n  rate: string;\r\n};\r\n\r\nconst getRoomEffectiveRate = (room: any): number | null => {\r\n  if (!room) return null;\r\n  if (room.effectiveRate !== undefined && room.effectiveRate !== null) {\r\n    return Number(room.effectiveRate);\r\n  }\r\n  if (room.customRate !== undefined && room.customRate !== null) {\r\n    return Number(room.customRate);\r\n  }\r\n  if (room.ratePlan?.baseRate !== undefined && room.ratePlan?.baseRate !== null) {\r\n    return Number(room.ratePlan.baseRate);\r\n  }\r\n  return null;\r\n};\r\n\r\nexport default function ReservationsPage() {\r\n  const { user } = useAuthStore();\r\n  const [reservations, setReservations] = useState<Reservation[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [showFilters, setShowFilters] = useState(false);\r\n  const [filters, setFilters] = useState({\r\n    status: '',\r\n    roomId: '',\r\n    startDate: '',\r\n    endDate: '',\r\n  });\r\n  const [pagination, setPagination] = useState({\r\n    page: 1,\r\n    limit: 20,\r\n    total: 0,\r\n    totalPages: 0,\r\n  });\r\n  const [rooms, setRooms] = useState<Array<{ id: string; roomNumber: string }>>([]);\r\n  const [selectedReservations, setSelectedReservations] = useState<Set<string>>(new Set());\r\n  const [isBulkProcessing, setIsBulkProcessing] = useState(false);\r\n  const [processingReservations, setProcessingReservations] = useState<Set<string>>(new Set());\r\n\r\n  useEffect(() => {\r\n    if (!user?.tenantId) return;\r\n    fetchRooms();\r\n  }, [user]);\r\n\r\n  useEffect(() => {\r\n    if (!user?.tenantId) return;\r\n    fetchReservations(pagination.page);\r\n  }, [user, pagination.page, filters]);\r\n\r\n  const fetchRooms = async () => {\r\n    try {\r\n      const response = await api.get(`/tenants/${user?.tenantId}/rooms`);\r\n      setRooms(response.data.data || []);\r\n    } catch (error) {\r\n      console.error('Failed to fetch rooms:', error);\r\n    }\r\n  };\r\n\r\n  const fetchReservations = async (page = pagination.page) => {\r\n    try {\r\n      const params: any = {\r\n        page,\r\n        limit: pagination.limit,\r\n      };\r\n      if (filters.status) params.status = filters.status;\r\n      if (filters.roomId) params.roomId = filters.roomId;\r\n      if (filters.startDate) params.startDate = filters.startDate;\r\n      if (filters.endDate) params.endDate = filters.endDate;\r\n\r\n      const response = await api.get(`/tenants/${user?.tenantId}/reservations`, { params });\r\n      setReservations(response.data.data || []);\r\n      if (response.data.pagination) {\r\n        setPagination(response.data.pagination);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch reservations:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleCheckIn = async (reservationId: string) => {\r\n    setProcessingReservations(prev => new Set(prev).add(reservationId));\r\n    try {\r\n      await api.post(`/tenants/${user?.tenantId}/reservations/${reservationId}/checkin`);\r\n      fetchReservations();\r\n      toast.success('Guest checked in successfully');\r\n    } catch (error: any) {\r\n      // Error handled by API interceptor\r\n    } finally {\r\n      setProcessingReservations(prev => {\r\n        const next = new Set(prev);\r\n        next.delete(reservationId);\r\n        return next;\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleCheckOut = async (reservationId: string) => {\r\n    setProcessingReservations(prev => new Set(prev).add(reservationId));\r\n    try {\r\n      await api.post(`/tenants/${user?.tenantId}/reservations/${reservationId}/checkout`, {\r\n        finalCharges: {},\r\n        paymentInfo: {},\r\n      });\r\n      fetchReservations();\r\n      toast.success('Guest checked out successfully');\r\n    } catch (error: any) {\r\n      // Error handled by API interceptor\r\n    } finally {\r\n      setProcessingReservations(prev => {\r\n        const next = new Set(prev);\r\n        next.delete(reservationId);\r\n        return next;\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleBulkCheckIn = async () => {\r\n    if (selectedReservations.size === 0) {\r\n      toast.error('Please select at least one reservation');\r\n      return;\r\n    }\r\n\r\n    const confirmMessage = `Are you sure you want to check in ${selectedReservations.size} reservation(s)?`;\r\n    if (!window.confirm(confirmMessage)) return;\r\n\r\n    setIsBulkProcessing(true);\r\n    const reservationIds = Array.from(selectedReservations);\r\n    let successCount = 0;\r\n    let failCount = 0;\r\n\r\n    for (const reservationId of reservationIds) {\r\n      try {\r\n        await api.post(`/tenants/${user?.tenantId}/reservations/${reservationId}/checkin`);\r\n        successCount++;\r\n      } catch (error) {\r\n        failCount++;\r\n      }\r\n    }\r\n\r\n    setIsBulkProcessing(false);\r\n    setSelectedReservations(new Set());\r\n    fetchReservations();\r\n\r\n    if (failCount === 0) {\r\n      toast.success(`Successfully checked in ${successCount} reservation(s)`);\r\n    } else {\r\n      toast.error(`Checked in ${successCount}, failed ${failCount}`);\r\n    }\r\n  };\r\n\r\n  const handleBulkCheckOut = async () => {\r\n    if (selectedReservations.size === 0) {\r\n      toast.error('Please select at least one reservation');\r\n      return;\r\n    }\r\n\r\n    const confirmMessage = `Are you sure you want to check out ${selectedReservations.size} reservation(s)?`;\r\n    if (!window.confirm(confirmMessage)) return;\r\n\r\n    setIsBulkProcessing(true);\r\n    const reservationIds = Array.from(selectedReservations);\r\n    let successCount = 0;\r\n    let failCount = 0;\r\n\r\n    for (const reservationId of reservationIds) {\r\n      try {\r\n        await api.post(`/tenants/${user?.tenantId}/reservations/${reservationId}/checkout`, {\r\n          finalCharges: {},\r\n          paymentInfo: {},\r\n        });\r\n        successCount++;\r\n      } catch (error) {\r\n        failCount++;\r\n      }\r\n    }\r\n\r\n    setIsBulkProcessing(false);\r\n    setSelectedReservations(new Set());\r\n    fetchReservations();\r\n\r\n    if (failCount === 0) {\r\n      toast.success(`Successfully checked out ${successCount} reservation(s)`);\r\n    } else {\r\n      toast.error(`Checked out ${successCount}, failed ${failCount}`);\r\n    }\r\n  };\r\n\r\n  const toggleSelectReservation = (reservationId: string) => {\r\n    const newSelected = new Set(selectedReservations);\r\n    if (newSelected.has(reservationId)) {\r\n      newSelected.delete(reservationId);\r\n    } else {\r\n      newSelected.add(reservationId);\r\n    }\r\n    setSelectedReservations(newSelected);\r\n  };\r\n\r\n  const toggleSelectAll = () => {\r\n    if (selectedReservations.size === filteredReservations.length) {\r\n      setSelectedReservations(new Set());\r\n    } else {\r\n      setSelectedReservations(new Set(filteredReservations.map((r) => r.id)));\r\n    }\r\n  };\r\n\r\n  const filteredReservations = reservations.filter((reservation) => {\r\n    if (!searchTerm) return true;\r\n    const searchLower = searchTerm.toLowerCase();\r\n    return (\r\n      reservation.reservationNumber.toLowerCase().includes(searchLower) ||\r\n      reservation.guestName.toLowerCase().includes(searchLower) ||\r\n      reservation.room.roomNumber.toLowerCase().includes(searchLower) ||\r\n      reservation.room.roomType.toLowerCase().includes(searchLower)\r\n    );\r\n  });\r\n\r\n  const getStatusBadge = (status: string) => {\r\n    const styles: Record<string, any> = {\r\n      confirmed: { background: '#dbeafe', color: '#1e40af' },\r\n      checked_in: { background: '#d1fae5', color: '#065f46' },\r\n      checked_out: { background: '#e5e7eb', color: '#374151' },\r\n      cancelled: { background: '#fee2e2', color: '#991b1b' },\r\n    };\r\n    const style = styles[status] || styles.confirmed;\r\n    return (\r\n      <span\r\n        style={{\r\n          padding: '0.25rem 0.75rem',\r\n          borderRadius: '12px',\r\n          fontSize: '0.75rem',\r\n          fontWeight: '500',\r\n          ...style,\r\n        }}\r\n      >\r\n        {status.replace('_', ' ').toUpperCase()}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Layout>\r\n        <div>\r\n          <h1 style={{ marginBottom: '1.5rem', color: '#1e293b' }}>Reservations</h1>\r\n          <TableSkeleton rows={8} columns={7} />\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Layout>\r\n      <div>\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <div>\r\n            <h1 style={{ margin: 0, color: '#1e293b' }}>Reservations</h1>\r\n            {pagination.total > 0 && (\r\n              <p style={{ margin: '0.25rem 0 0 0', color: '#64748b', fontSize: '0.875rem' }}>\r\n                {pagination.total} total reservation{pagination.total !== 1 ? 's' : ''}\r\n              </p>\r\n            )}\r\n          </div>\r\n          <button\r\n            onClick={() => setShowCreateModal(true)}\r\n            style={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.5rem',\r\n              padding: '0.75rem 1.5rem',\r\n              background: '#3b82f6',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '6px',\r\n              cursor: 'pointer',\r\n              fontWeight: '500',\r\n            }}\r\n          >\r\n            <Plus size={20} />\r\n            New Reservation\r\n          </button>\r\n        </div>\r\n\r\n        {selectedReservations.size > 0 && (\r\n          <div\r\n            style={{\r\n              background: '#dbeafe',\r\n              padding: '1rem',\r\n              borderRadius: '8px',\r\n              marginBottom: '1.5rem',\r\n              display: 'flex',\r\n              justifyContent: 'space-between',\r\n              alignItems: 'center',\r\n            }}\r\n          >\r\n            <span style={{ color: '#1e40af', fontWeight: '500' }}>\r\n              {selectedReservations.size} reservation{selectedReservations.size !== 1 ? 's' : ''} selected\r\n            </span>\r\n            <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n              <button\r\n                onClick={handleBulkCheckIn}\r\n                disabled={isBulkProcessing}\r\n                style={{\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  gap: '0.5rem',\r\n                  padding: '0.5rem 1rem',\r\n                  background: isBulkProcessing ? '#94a3b8' : '#10b981',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  borderRadius: '4px',\r\n                  cursor: isBulkProcessing ? 'not-allowed' : 'pointer',\r\n                  fontSize: '0.875rem',\r\n                }}\r\n              >\r\n                <CheckCircle size={16} />\r\n                Bulk Check In\r\n              </button>\r\n              <button\r\n                onClick={handleBulkCheckOut}\r\n                disabled={isBulkProcessing}\r\n                style={{\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  gap: '0.5rem',\r\n                  padding: '0.5rem 1rem',\r\n                  background: isBulkProcessing ? '#94a3b8' : '#f59e0b',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  borderRadius: '4px',\r\n                  cursor: isBulkProcessing ? 'not-allowed' : 'pointer',\r\n                  fontSize: '0.875rem',\r\n                }}\r\n              >\r\n                <XCircle size={16} />\r\n                Bulk Check Out\r\n              </button>\r\n              <button\r\n                onClick={() => setSelectedReservations(new Set())}\r\n                style={{\r\n                  padding: '0.5rem 1rem',\r\n                  background: '#f1f5f9',\r\n                  color: '#475569',\r\n                  border: 'none',\r\n                  borderRadius: '4px',\r\n                  cursor: 'pointer',\r\n                  fontSize: '0.875rem',\r\n                }}\r\n              >\r\n                Clear Selection\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {showFilters && (\r\n          <div\r\n            style={{\r\n              background: 'white',\r\n              padding: '1.5rem',\r\n              borderRadius: '8px',\r\n              marginBottom: '1.5rem',\r\n              boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n            }}\r\n          >\r\n            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>\r\n              <h3 style={{ color: '#1e293b', fontSize: '1rem', fontWeight: '600' }}>Filter Reservations</h3>\r\n              <button\r\n                onClick={() => {\r\n                  setFilters({ status: '', roomId: '', startDate: '', endDate: '' });\r\n                  setPagination({ ...pagination, page: 1 });\r\n                }}\r\n                style={{\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  gap: '0.5rem',\r\n                  padding: '0.5rem 1rem',\r\n                  background: '#f1f5f9',\r\n                  color: '#475569',\r\n                  border: 'none',\r\n                  borderRadius: '4px',\r\n                  cursor: 'pointer',\r\n                  fontSize: '0.875rem',\r\n                }}\r\n              >\r\n                Clear All\r\n              </button>\r\n            </div>\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem' }}>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n                  Status\r\n                </label>\r\n                <select\r\n                  value={filters.status}\r\n                  onChange={(e) => {\r\n                    setFilters({ ...filters, status: e.target.value });\r\n                    setPagination({ ...pagination, page: 1 });\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.5rem',\r\n                    border: '1px solid #cbd5e1',\r\n                    borderRadius: '4px',\r\n                    fontSize: '0.875rem',\r\n                  }}\r\n                >\r\n                  <option value=\"\">All Statuses</option>\r\n                  <option value=\"confirmed\">Confirmed</option>\r\n                  <option value=\"checked_in\">Checked In</option>\r\n                  <option value=\"checked_out\">Checked Out</option>\r\n                  <option value=\"cancelled\">Cancelled</option>\r\n                  <option value=\"no_show\">No Show</option>\r\n                </select>\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n                  Room\r\n                </label>\r\n                <select\r\n                  value={filters.roomId}\r\n                  onChange={(e) => {\r\n                    setFilters({ ...filters, roomId: e.target.value });\r\n                    setPagination({ ...pagination, page: 1 });\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.5rem',\r\n                    border: '1px solid #cbd5e1',\r\n                    borderRadius: '4px',\r\n                    fontSize: '0.875rem',\r\n                  }}\r\n                >\r\n                  <option value=\"\">All Rooms</option>\r\n                  {rooms.map((room) => (\r\n                    <option key={room.id} value={room.id}>\r\n                      {room.roomNumber}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n                  Check-in From\r\n                </label>\r\n                <input\r\n                  type=\"date\"\r\n                  value={filters.startDate}\r\n                  onChange={(e) => {\r\n                    setFilters({ ...filters, startDate: e.target.value });\r\n                    setPagination({ ...pagination, page: 1 });\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.5rem',\r\n                    border: '1px solid #cbd5e1',\r\n                    borderRadius: '4px',\r\n                    fontSize: '0.875rem',\r\n                  }}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n                  Check-out To\r\n                </label>\r\n                <input\r\n                  type=\"date\"\r\n                  value={filters.endDate}\r\n                  onChange={(e) => {\r\n                    setFilters({ ...filters, endDate: e.target.value });\r\n                    setPagination({ ...pagination, page: 1 });\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.5rem',\r\n                    border: '1px solid #cbd5e1',\r\n                    borderRadius: '4px',\r\n                    fontSize: '0.875rem',\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div style={{ marginTop: '1rem', display: 'flex', gap: '0.5rem' }}>\r\n              <button\r\n                onClick={() => {\r\n                  setFilters({\r\n                    status: '',\r\n                    roomId: '',\r\n                    startDate: format(subDays(new Date(), 7), 'yyyy-MM-dd'),\r\n                    endDate: format(new Date(), 'yyyy-MM-dd'),\r\n                  });\r\n                  setPagination({ ...pagination, page: 1 });\r\n                }}\r\n                style={{\r\n                  padding: '0.5rem 1rem',\r\n                  background: '#f1f5f9',\r\n                  color: '#475569',\r\n                  border: 'none',\r\n                  borderRadius: '4px',\r\n                  cursor: 'pointer',\r\n                  fontSize: '0.875rem',\r\n                }}\r\n              >\r\n                Last 7 Days\r\n              </button>\r\n              <button\r\n                onClick={() => {\r\n                  setFilters({\r\n                    status: '',\r\n                    roomId: '',\r\n                    startDate: format(subDays(new Date(), 30), 'yyyy-MM-dd'),\r\n                    endDate: format(new Date(), 'yyyy-MM-dd'),\r\n                  });\r\n                  setPagination({ ...pagination, page: 1 });\r\n                }}\r\n                style={{\r\n                  padding: '0.5rem 1rem',\r\n                  background: '#f1f5f9',\r\n                  color: '#475569',\r\n                  border: 'none',\r\n                  borderRadius: '4px',\r\n                  cursor: 'pointer',\r\n                  fontSize: '0.875rem',\r\n                }}\r\n              >\r\n                Last 30 Days\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div style={{ marginBottom: '1.5rem', display: 'flex', gap: '1rem', alignItems: 'center' }}>\r\n          <div style={{ flex: 1 }}>\r\n            <SearchInput\r\n              value={searchTerm}\r\n              onChange={setSearchTerm}\r\n              placeholder=\"Search by guest name, reservation number, or room...\"\r\n            />\r\n          </div>\r\n          <button\r\n            onClick={() => setShowFilters(!showFilters)}\r\n            style={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.5rem',\r\n              padding: '0.75rem 1.5rem',\r\n              background: showFilters ? '#3b82f6' : '#f1f5f9',\r\n              color: showFilters ? 'white' : '#475569',\r\n              border: 'none',\r\n              borderRadius: '6px',\r\n              cursor: 'pointer',\r\n              fontWeight: '500',\r\n            }}\r\n          >\r\n            <Filter size={20} />\r\n            Filters\r\n          </button>\r\n        </div>\r\n\r\n        <div\r\n          style={{\r\n            background: 'white',\r\n            borderRadius: '8px',\r\n            boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n            overflow: 'hidden',\r\n          }}\r\n        >\r\n          <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n            <thead>\r\n              <tr style={{ background: '#f8fafc', borderBottom: '1px solid #e2e8f0' }}>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569', width: '50px' }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedReservations.size === filteredReservations.length && filteredReservations.length > 0}\r\n                    onChange={toggleSelectAll}\r\n                    style={{ cursor: 'pointer' }}\r\n                  />\r\n                </th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>\r\n                  Reservation #\r\n                </th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Guest</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Room</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Check-in</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Check-out</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Rate</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Status</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {filteredReservations.length === 0 ? (\r\n                <tr>\r\n                  <td colSpan={8} style={{ padding: '3rem', textAlign: 'center', color: '#94a3b8' }}>\r\n                    {searchTerm ? 'No reservations match your search' : 'No reservations found'}\r\n                  </td>\r\n                </tr>\r\n              ) : (\r\n                filteredReservations.map((reservation) => (\r\n                  <tr key={reservation.id} style={{ borderBottom: '1px solid #e2e8f0' }}>\r\n                    <td style={{ padding: '1rem' }}>\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={selectedReservations.has(reservation.id)}\r\n                        onChange={() => toggleSelectReservation(reservation.id)}\r\n                        style={{ cursor: 'pointer' }}\r\n                      />\r\n                    </td>\r\n                    <td style={{ padding: '1rem', color: '#1e293b' }}>{reservation.reservationNumber}</td>\r\n                    <td style={{ padding: '1rem', color: '#1e293b' }}>{reservation.guestName}</td>\r\n                    <td style={{ padding: '1rem', color: '#1e293b' }}>\r\n                      {reservation.room?.roomNumber} ({reservation.room?.roomType})\r\n                    </td>\r\n                    <td style={{ padding: '1rem', color: '#64748b' }}>\r\n                      {format(new Date(reservation.checkInDate), 'MMM dd, yyyy')}\r\n                    </td>\r\n                    <td style={{ padding: '1rem', color: '#64748b' }}>\r\n                      {format(new Date(reservation.checkOutDate), 'MMM dd, yyyy')}\r\n                    </td>\r\n                    <td style={{ padding: '1rem', color: '#1e293b', fontWeight: '500' }}>\r\n                      {Number(reservation.rate).toLocaleString()}\r\n                    </td>\r\n                    <td style={{ padding: '1rem' }}>{getStatusBadge(reservation.status)}</td>\r\n                    <td style={{ padding: '1rem' }}>\r\n                      <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n                        {reservation.status === 'confirmed' && (\r\n                          <button\r\n                            onClick={() => handleCheckIn(reservation.id)}\r\n                            disabled={processingReservations.has(reservation.id) || isBulkProcessing}\r\n                            style={{\r\n                              padding: '0.5rem',\r\n                              background: processingReservations.has(reservation.id) ? '#94a3b8' : '#10b981',\r\n                              color: 'white',\r\n                              border: 'none',\r\n                              borderRadius: '4px',\r\n                              cursor: processingReservations.has(reservation.id) ? 'not-allowed' : 'pointer',\r\n                              opacity: processingReservations.has(reservation.id) ? 0.6 : 1,\r\n                            }}\r\n                            title=\"Check In\"\r\n                          >\r\n                            <CheckCircle size={16} />\r\n                          </button>\r\n                        )}\r\n                        {reservation.status === 'checked_in' && (\r\n                          <button\r\n                            onClick={() => handleCheckOut(reservation.id)}\r\n                            disabled={processingReservations.has(reservation.id) || isBulkProcessing}\r\n                            style={{\r\n                              padding: '0.5rem',\r\n                              background: processingReservations.has(reservation.id) ? '#94a3b8' : '#f59e0b',\r\n                              color: 'white',\r\n                              border: 'none',\r\n                              borderRadius: '4px',\r\n                              cursor: processingReservations.has(reservation.id) ? 'not-allowed' : 'pointer',\r\n                              opacity: processingReservations.has(reservation.id) ? 0.6 : 1,\r\n                            }}\r\n                            title=\"Check Out\"\r\n                          >\r\n                            <XCircle size={16} />\r\n                          </button>\r\n                        )}\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n              )}\r\n            </tbody>\r\n          </table>\r\n          {pagination.totalPages > 1 && (\r\n            <Pagination\r\n              page={pagination.page}\r\n              totalPages={pagination.totalPages}\r\n              total={pagination.total}\r\n              limit={pagination.limit}\r\n              onPageChange={(newPage) => {\r\n                setPagination({ ...pagination, page: newPage });\r\n                fetchReservations(newPage);\r\n              }}\r\n            />\r\n          )}\r\n        </div>\r\n\r\n        {showCreateModal && (\r\n          <CreateReservationModal\r\n            onClose={() => setShowCreateModal(false)}\r\n            onSuccess={() => {\r\n              setShowCreateModal(false);\r\n              fetchReservations();\r\n            }}\r\n          />\r\n        )}\r\n      </div>\r\n    </Layout>\r\n  );\r\n}\r\n\r\nfunction CreateReservationModal({ onClose, onSuccess }: { onClose: () => void; onSuccess: () => void }) {\r\n  const { user } = useAuthStore();\r\n  const [allRooms, setAllRooms] = useState<any[]>([]);\r\n  const [availableRooms, setAvailableRooms] = useState<any[]>([]);\r\n  const [categories, setCategories] = useState<any[]>([]);\r\n  const [meetingHalls, setMeetingHalls] = useState<any[]>([]);\r\n  const [hasAvailabilityRun, setHasAvailabilityRun] = useState(false);\r\n  const [roomSearch, setRoomSearch] = useState('');\r\n  const [categoryFilter, setCategoryFilter] = useState('all');\r\n  const [bulkSelectionInput, setBulkSelectionInput] = useState('');\r\n  const [bulkSelectionError, setBulkSelectionError] = useState<string | null>(null);\r\n  const [unavailableRooms, setUnavailableRooms] = useState<Set<string>>(new Set());\r\n  const [roomRates, setRoomRates] = useState<Record<string, number>>({});\r\n  const [formData, setFormData] = useState({\r\n    guestName: '',\r\n    guestEmail: '',\r\n    guestPhone: '',\r\n    guestAddress: '',\r\n    checkInDate: '',\r\n    checkOutDate: '',\r\n    adults: 1,\r\n    children: 0,\r\n    specialRequests: '',\r\n  });\r\n  const [modalLoading, setModalLoading] = useState(false);\r\n  const [checkingAvailability, setCheckingAvailability] = useState(false);\r\n  const [availabilityError, setAvailabilityError] = useState<string | null>(null);\r\n  const [availabilitySummary, setAvailabilitySummary] = useState<{ total: number; available: number } | null>(null);\r\n  const [currentStep, setCurrentStep] = useState(0);\r\n  const [selectedRoomIds, setSelectedRoomIds] = useState<Set<string>>(new Set());\r\n  const [includeHall, setIncludeHall] = useState(false);\r\n  const [hallReservations, setHallReservations] = useState<HallReservationForm[]>([]);\r\n  useEffect(() => {\r\n    if (includeHall) {\r\n      setHallReservations((prev) => {\r\n        if (prev.length > 0) return prev;\r\n        const defaultHallId = meetingHalls[0]?.id || '';\r\n        return [\r\n          {\r\n            id: generateTempId(),\r\n            hallId: defaultHallId,\r\n            eventName: '',\r\n            purpose: '',\r\n            setupType: '',\r\n            attendeeCount: '',\r\n            startDateTime: '',\r\n            endDateTime: '',\r\n            cateringNotes: '',\r\n            avRequirements: '',\r\n            rate: '',\r\n          },\r\n        ];\r\n      });\r\n    } else {\r\n      setHallReservations([]);\r\n    }\r\n  }, [includeHall, meetingHalls]);\r\n\r\n  const steps = ['Guest Information', 'Stay Details', 'Rooms', 'Hall Booking', 'Invoice'];\r\n  const generateTempId = () => Math.random().toString(36).substring(2, 9);\r\n\r\n  useEffect(() => {\r\n    if (!user?.tenantId) return;\r\n    fetchRooms();\r\n    fetchCategories();\r\n    fetchMeetingHalls();\r\n  }, [user?.tenantId]);\r\n\r\n  const fetchRooms = async () => {\r\n    if (!user?.tenantId) return;\r\n    try {\r\n      const response = await api.get(`/tenants/${user?.tenantId}/rooms`);\r\n      setAllRooms(response.data.data || []);\r\n    } catch (error) {\r\n      console.error('Failed to fetch rooms:', error);\r\n    }\r\n  };\r\n\r\n  const fetchCategories = async () => {\r\n    if (!user?.tenantId) return;\r\n    try {\r\n      const response = await api.get(`/tenants/${user?.tenantId}/room-categories`);\r\n      setCategories(response.data.data || []);\r\n    } catch (error) {\r\n      console.error('Failed to fetch categories:', error);\r\n    }\r\n  };\r\n\r\n  const fetchMeetingHalls = async () => {\r\n    if (!user?.tenantId) return;\r\n    try {\r\n      const response = await api.get(`/tenants/${user?.tenantId}/halls`);\r\n      setMeetingHalls(response.data.data || []);\r\n    } catch (error) {\r\n      console.error('Failed to fetch meeting halls:', error);\r\n      toast.error('Unable to load meeting halls');\r\n    }\r\n  };\r\n\r\n  const fetchAvailability = async (checkIn: Date, checkOut: Date, minGuests: number) => {\r\n    if (!user?.tenantId) return;\r\n\r\n    setCheckingAvailability(true);\r\n    setAvailabilityError(null);\r\n\r\n    const params: Record<string, any> = {\r\n      startDate: checkIn.toISOString(),\r\n      endDate: checkOut.toISOString(),\r\n      minOccupancy: Math.max(1, minGuests),\r\n    };\r\n\r\n    try {\r\n      const response = await api.get(`/tenants/${user?.tenantId}/reservations/availability`, {\r\n        params,\r\n      });\r\n\r\n      const data = response.data.data || {};\r\n      const rooms = data.availableRooms || [];\r\n      setAvailableRooms(rooms);\r\n      setAvailabilitySummary({\r\n        total: data.totalRooms ?? rooms.length,\r\n        available: data.availableCount ?? rooms.length,\r\n      });\r\n      setHasAvailabilityRun(true);\r\n    } catch (error) {\r\n      console.error('Failed to fetch availability:', error);\r\n      setAvailabilityError('Unable to load availability. Please try again.');\r\n      setAvailableRooms([]);\r\n      setAvailabilitySummary(null);\r\n      setHasAvailabilityRun(true);\r\n    } finally {\r\n      setCheckingAvailability(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!formData.checkInDate || !formData.checkOutDate) {\r\n      setAvailableRooms([]);\r\n      setAvailabilitySummary(null);\r\n      setAvailabilityError(null);\r\n      setHasAvailabilityRun(false);\r\n      return;\r\n    }\r\n\r\n    const checkIn = new Date(formData.checkInDate);\r\n    const checkOut = new Date(formData.checkOutDate);\r\n\r\n    if (isNaN(checkIn.getTime()) || isNaN(checkOut.getTime())) {\r\n      return;\r\n    }\r\n    if (checkOut <= checkIn) {\r\n      setAvailabilityError('Check-out date must be after check-in date');\r\n      setAvailableRooms([]);\r\n      setAvailabilitySummary(null);\r\n      return;\r\n    }\r\n\r\n    const minGuests = Number(formData.adults || 0) + Number(formData.children || 0);\r\n    fetchAvailability(checkIn, checkOut, minGuests);\r\n  }, [formData.checkInDate, formData.checkOutDate, formData.adults, formData.children]);\r\n\r\n  const roomOptions = hasAvailabilityRun ? availableRooms : allRooms;\r\n  useEffect(() => {\r\n    setSelectedRoomIds((prev) => {\r\n      if (!prev.size) return prev;\r\n      const validIds = new Set(roomOptions.map((room) => room.id));\r\n      const next = new Set<string>();\r\n      prev.forEach((id) => {\r\n        if (validIds.has(id)) {\r\n          next.add(id);\r\n        }\r\n      });\r\n      return next;\r\n    });\r\n  }, [roomOptions]);\r\n\r\n  useEffect(() => {\r\n    const next: Record<string, number> = {};\r\n    roomOptions.forEach((room) => {\r\n      const effectiveRate = getRoomEffectiveRate(room);\r\n      if (effectiveRate !== null) {\r\n        next[room.id] = effectiveRate;\r\n      }\r\n    });\r\n    setRoomRates(next);\r\n  }, [roomOptions]);\r\n\r\n  const filteredRooms = roomOptions.filter((room) => {\r\n    const matchesCategory =\r\n      categoryFilter === 'all'\r\n        ? true\r\n        : categoryFilter === 'none'\r\n          ? !room.category?.id\r\n          : room.category?.id === categoryFilter;\r\n    if (!matchesCategory) return false;\r\n    if (roomSearch.trim()) {\r\n      const query = roomSearch.toLowerCase();\r\n      const matchesQuery =\r\n        (room.roomNumber || '').toLowerCase().includes(query) ||\r\n        (room.roomType || '').toLowerCase().includes(query) ||\r\n        (room.category?.name || '').toLowerCase().includes(query);\r\n      if (!matchesQuery) return false;\r\n    }\r\n    return true;\r\n  });\r\n\r\n  const roomsByCategory = Object.values(\r\n    filteredRooms.reduce<Record<string, { id: string; name: string; rooms: any[] }>>((acc, room) => {\r\n      const key = room.category?.id || 'uncategorized';\r\n      if (!acc[key]) {\r\n        acc[key] = {\r\n          id: key,\r\n          name: room.category?.name || 'Uncategorized',\r\n          rooms: [],\r\n        };\r\n      }\r\n      acc[key].rooms.push(room);\r\n      return acc;\r\n    }, {})\r\n  ).sort((a, b) => a.name.localeCompare(b.name));\r\n\r\n  const selectedRoomDetails = Array.from(selectedRoomIds)\r\n    .map((roomId) => roomOptions.find((room) => room.id === roomId) || allRooms.find((room) => room.id === roomId))\r\n    .filter(Boolean);\r\n\r\n  const resolveRoomRate = (room: any) => {\r\n    if (!room) return 0;\r\n    return roomRates[room.id] ?? getRoomEffectiveRate(room) ?? 0;\r\n  };\r\n\r\n  const getNights = () => {\r\n    if (!formData.checkInDate || !formData.checkOutDate) return 0;\r\n    const start = new Date(formData.checkInDate);\r\n    const end = new Date(formData.checkOutDate);\r\n    if (Number.isNaN(start.getTime()) || Number.isNaN(end.getTime())) return 0;\r\n    const diff = end.getTime() - start.getTime();\r\n    if (diff <= 0) return 0;\r\n    return Math.ceil(diff / (1000 * 60 * 60 * 24));\r\n  };\r\n\r\n  const nights = getNights();\r\n  const nightMultiplier = Math.max(nights, 1);\r\n  const roomSubtotal = selectedRoomDetails.reduce((sum, room: any) => sum + resolveRoomRate(room) * nightMultiplier, 0);\r\n  const hallTotal = hallReservations.reduce((sum, hall) => sum + (Number(hall.rate) || 0), 0);\r\n  const invoiceTotal = roomSubtotal + (includeHall ? hallTotal : 0);\r\n\r\n  const formatCurrency = (value: number) => `${Number(value).toLocaleString()}`;\r\n\r\n  const validateHallReservations = () => {\r\n    if (!includeHall) return true;\r\n    if (hallReservations.length === 0) return false;\r\n    return hallReservations.every((reservation) => {\r\n      if (!reservation.hallId || !reservation.startDateTime || !reservation.endDateTime) return false;\r\n      const start = new Date(reservation.startDateTime);\r\n      const end = new Date(reservation.endDateTime);\r\n      if (Number.isNaN(start.getTime()) || Number.isNaN(end.getTime())) return false;\r\n      if (end <= start) return false;\r\n      return Number(reservation.rate) > 0;\r\n    });\r\n  };\r\n\r\n  const parseBulkSelection = (input: string): string[] => {\r\n    const roomNumbers: string[] = [];\r\n    const parts = input\r\n      .split(',')\r\n      .map((part) => part.trim())\r\n      .filter(Boolean);\r\n\r\n    parts.forEach((part) => {\r\n      if (part.includes('-')) {\r\n        const [startRaw, endRaw] = part.split('-');\r\n        const start = parseInt(startRaw.trim(), 10);\r\n        const end = parseInt(endRaw.trim(), 10);\r\n        if (Number.isNaN(start) || Number.isNaN(end)) {\r\n          throw new Error(`Invalid range \"${part}\"`);\r\n        }\r\n        if (start > end) {\r\n          throw new Error(`Range start (${start}) must be <= end (${end})`);\r\n        }\r\n        for (let i = start; i <= end; i += 1) {\r\n          roomNumbers.push(String(i));\r\n        }\r\n      } else {\r\n        const num = parseInt(part, 10);\r\n        if (Number.isNaN(num)) {\r\n          throw new Error(`Invalid room number \"${part}\"`);\r\n        }\r\n        roomNumbers.push(String(num));\r\n      }\r\n    });\r\n\r\n    return roomNumbers;\r\n  };\r\n\r\n  const handleBulkSelection = () => {\r\n    if (!bulkSelectionInput.trim()) {\r\n      setBulkSelectionError('Enter room numbers to add');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const numbers = parseBulkSelection(bulkSelectionInput);\r\n      const nextSelected = new Set(selectedRoomIds);\r\n      const notFound = new Set<string>();\r\n      numbers.forEach((roomNumber) => {\r\n        const match = roomOptions.find(\r\n          (room: any) => (room.roomNumber || '').toString() === roomNumber.toString()\r\n        );\r\n        if (match) {\r\n          nextSelected.add(match.id);\r\n        } else {\r\n          notFound.add(roomNumber);\r\n        }\r\n      });\r\n      setSelectedRoomIds(nextSelected);\r\n      setUnavailableRooms(notFound);\r\n      if (notFound.size > 0) {\r\n        setBulkSelectionError(`Rooms unavailable: ${Array.from(notFound).join(', ')}`);\r\n      } else {\r\n        setBulkSelectionError(null);\r\n        setBulkSelectionInput('');\r\n        toast.success(`Added ${numbers.length} room${numbers.length === 1 ? '' : 's'}`);\r\n      }\r\n    } catch (error: any) {\r\n      setBulkSelectionError(error.message || 'Invalid format');\r\n    }\r\n  };\r\n\r\n  const handleHallChange = (index: number, field: keyof HallReservationForm, value: string) => {\r\n    setHallReservations((prev) => {\r\n      const next = [...prev];\r\n      next[index] = { ...next[index], [field]: value };\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const addHallReservation = () => {\r\n    setHallReservations((prev) => [\r\n      ...prev,\r\n      {\r\n        id: generateTempId(),\r\n        hallId: meetingHalls[0]?.id || '',\r\n        eventName: '',\r\n        purpose: '',\r\n        setupType: '',\r\n        attendeeCount: '',\r\n        startDateTime: '',\r\n        endDateTime: '',\r\n        cateringNotes: '',\r\n        avRequirements: '',\r\n        rate: '',\r\n      },\r\n    ]);\r\n  };\r\n\r\n  const removeHallReservation = (id: string) => {\r\n    setHallReservations((prev) => prev.filter((reservation) => reservation.id !== id));\r\n  };\r\n\r\n  const validateStep = (stepIndex: number) => {\r\n    switch (stepIndex) {\r\n      case 0:\r\n        return (\r\n          formData.guestName.trim().length > 1 &&\r\n          formData.guestEmail.trim().length > 3 &&\r\n          formData.guestPhone.trim().length > 3 &&\r\n          formData.guestAddress.trim().length > 3\r\n        );\r\n      case 1: {\r\n        if (!formData.checkInDate || !formData.checkOutDate) return false;\r\n        const start = new Date(formData.checkInDate);\r\n        const end = new Date(formData.checkOutDate);\r\n        if (Number.isNaN(start.getTime()) || Number.isNaN(end.getTime())) return false;\r\n        if (end <= start) return false;\r\n        return !availabilityError;\r\n      }\r\n      case 2:\r\n        return selectedRoomIds.size > 0 && !availabilityError;\r\n      case 3:\r\n        return !includeHall || validateHallReservations();\r\n      case 4:\r\n        return selectedRoomIds.size > 0 && (!includeHall || validateHallReservations());\r\n      default:\r\n        return true;\r\n    }\r\n  };\r\n\r\n  const canProceed = validateStep(currentStep);\r\n\r\n  const handleRoomToggle = (roomId: string) => {\r\n    setSelectedRoomIds((prev) => {\r\n      const next = new Set(prev);\r\n      if (next.has(roomId)) {\r\n        next.delete(roomId);\r\n      } else {\r\n        next.add(roomId);\r\n      }\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const handleCategorySelectAll = (rooms: any[]) => {\r\n    setSelectedRoomIds((prev) => {\r\n      const next = new Set(prev);\r\n      rooms.forEach((room) => next.add(room.id));\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const handleCategoryClear = (rooms: any[]) => {\r\n    setSelectedRoomIds((prev) => {\r\n      const next = new Set(prev);\r\n      rooms.forEach((room) => next.delete(room.id));\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const clearAllRooms = () => setSelectedRoomIds(new Set());\r\n\r\n  const toIsoString = (value: string) => {\r\n    if (!value) return '';\r\n    const date = new Date(value);\r\n    if (Number.isNaN(date.getTime())) {\r\n      return '';\r\n    }\r\n    return date.toISOString();\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    if (!validateStep(steps.length - 1)) {\r\n      toast.error('Please complete all required details before creating reservations.');\r\n      return;\r\n    }\r\n\r\n    const checkInIso = toIsoString(formData.checkInDate);\r\n    const checkOutIso = toIsoString(formData.checkOutDate);\r\n\r\n    if (!checkInIso || !checkOutIso) {\r\n      toast.error('Please select valid check-in and check-out dates.');\r\n      return;\r\n    }\r\n\r\n    if (selectedRoomIds.size === 0) {\r\n      toast.error('Select at least one room to continue.');\r\n      return;\r\n    }\r\n\r\n    const email = formData.guestEmail.trim();\r\n    const phone = formData.guestPhone.trim();\r\n    const specialRequestsNote = formData.specialRequests.trim();\r\n    const combinedSpecialRequests = [\r\n      formData.guestAddress ? `Guest address: ${formData.guestAddress.trim()}` : null,\r\n      specialRequestsNote || null,\r\n    ]\r\n      .filter(Boolean)\r\n      .join('\\n');\r\n\r\n    const roomsPayload = Array.from(selectedRoomIds)\r\n      .map((roomId) => {\r\n        const room =\r\n          availableRooms.find((r) => r.id === roomId) || allRooms.find((r) => r.id === roomId);\r\n        const nightly = resolveRoomRate(room);\r\n        return {\r\n          room,\r\n          roomId,\r\n          nightly,\r\n        };\r\n      })\r\n      .filter((entry) => entry.room);\r\n\r\n    const invalidRates = roomsPayload\r\n      .filter((entry) => !entry.nightly || entry.nightly <= 0)\r\n      .map((entry) => entry.room?.roomNumber || entry.roomId);\r\n\r\n    if (invalidRates.length > 0) {\r\n      toast.error(`Please provide valid nightly rates for: ${invalidRates.join(', ')}`);\r\n      return;\r\n    }\r\n\r\n    const hallReservationsPayload = includeHall\r\n      ? hallReservations.map((reservation) => ({\r\n          hallId: reservation.hallId,\r\n          eventName: reservation.eventName || undefined,\r\n          purpose: reservation.purpose || undefined,\r\n          setupType: reservation.setupType || undefined,\r\n          attendeeCount: reservation.attendeeCount || undefined,\r\n          startDateTime: new Date(reservation.startDateTime).toISOString(),\r\n          endDateTime: new Date(reservation.endDateTime).toISOString(),\r\n          cateringNotes: reservation.cateringNotes || undefined,\r\n          avRequirements: reservation.avRequirements || undefined,\r\n          rate: reservation.rate || undefined,\r\n        }))\r\n      : undefined;\r\n\r\n    setModalLoading(true);\r\n    try {\r\n      const response = await api.post(`/tenants/${user?.tenantId}/reservations/batch`, {\r\n        guestName: formData.guestName.trim(),\r\n        guestEmail: email === '' ? undefined : email,\r\n        guestPhone: phone === '' ? undefined : phone,\r\n        checkInDate: checkInIso,\r\n        checkOutDate: checkOutIso,\r\n        adults: formData.adults,\r\n        children: formData.children,\r\n        specialRequests: combinedSpecialRequests || undefined,\r\n        rooms: roomsPayload.map((entry) => ({\r\n          roomId: entry.roomId,\r\n          rate: Number(entry.nightly),\r\n        })),\r\n        hallReservations: hallReservationsPayload,\r\n      });\r\n\r\n      const createdCount = response?.data?.data?.reservations?.length || roomsPayload.length;\r\n      toast.success(`Created ${createdCount} reservation${createdCount > 1 ? 's' : ''}`);\r\n      onSuccess();\r\n    } catch (error: any) {\r\n      // Error handled by API interceptor\r\n      toast.error('Unable to create reservations. Please try again.');\r\n    } finally {\r\n      setModalLoading(false);\r\n    }\r\n  };\r\n\r\n  const goToNextStep = () => {\r\n    if (!canProceed) {\r\n      toast.error('Please complete the required fields before continuing');\r\n      return;\r\n    }\r\n    if (currentStep === steps.length - 1) return;\r\n    setCurrentStep((prev) => Math.min(prev + 1, steps.length - 1));\r\n  };\r\n\r\n  const goToPreviousStep = () => {\r\n    if (currentStep === 0) return;\r\n    setCurrentStep((prev) => prev - 1);\r\n  };\r\n\r\n  const renderGuestStep = () => (\r\n    <div style={{ display: 'grid', gap: '1rem' }}>\r\n      <div>\r\n        <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>\r\n          Guest Name *\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          value={formData.guestName}\r\n          onChange={(e) => setFormData({ ...formData, guestName: e.target.value })}\r\n          required\r\n          style={{\r\n            width: '100%',\r\n            padding: '0.75rem',\r\n            border: '1px solid #cbd5e1',\r\n            borderRadius: '8px',\r\n          }}\r\n        />\r\n      </div>\r\n      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(220px, 1fr))', gap: '1rem' }}>\r\n        <div>\r\n          <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>\r\n            Email *\r\n          </label>\r\n          <input\r\n            type=\"email\"\r\n            value={formData.guestEmail}\r\n            onChange={(e) => setFormData({ ...formData, guestEmail: e.target.value })}\r\n            required\r\n            style={{\r\n              width: '100%',\r\n              padding: '0.75rem',\r\n              border: '1px solid #cbd5e1',\r\n              borderRadius: '8px',\r\n            }}\r\n          />\r\n        </div>\r\n        <div>\r\n          <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>\r\n            Phone *\r\n          </label>\r\n          <input\r\n            type=\"tel\"\r\n            value={formData.guestPhone}\r\n            onChange={(e) => setFormData({ ...formData, guestPhone: e.target.value })}\r\n            required\r\n            style={{\r\n              width: '100%',\r\n              padding: '0.75rem',\r\n              border: '1px solid #cbd5e1',\r\n              borderRadius: '8px',\r\n            }}\r\n          />\r\n        </div>\r\n      </div>\r\n      <div>\r\n        <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>\r\n          Address *\r\n        </label>\r\n        <textarea\r\n          rows={3}\r\n          value={formData.guestAddress}\r\n          onChange={(e) => setFormData({ ...formData, guestAddress: e.target.value })}\r\n          required\r\n          style={{\r\n            width: '100%',\r\n            padding: '0.75rem',\r\n            border: '1px solid #cbd5e1',\r\n            borderRadius: '8px',\r\n            resize: 'vertical',\r\n          }}\r\n        />\r\n      </div>\r\n      <div>\r\n        <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>Notes</label>\r\n        <textarea\r\n          rows={3}\r\n          value={formData.specialRequests}\r\n          onChange={(e) => setFormData({ ...formData, specialRequests: e.target.value })}\r\n          placeholder=\"Optional requests or remarks\"\r\n          style={{\r\n            width: '100%',\r\n            padding: '0.75rem',\r\n            border: '1px solid #cbd5e1',\r\n            borderRadius: '8px',\r\n            resize: 'vertical',\r\n          }}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderStayStep = () => (\r\n    <div style={{ display: 'grid', gap: '1rem' }}>\r\n      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(220px, 1fr))', gap: '1rem' }}>\r\n        <div>\r\n          <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>\r\n            Check-in *\r\n          </label>\r\n          <input\r\n            type=\"date\"\r\n            value={formData.checkInDate}\r\n            onChange={(e) => setFormData({ ...formData, checkInDate: e.target.value })}\r\n            style={{\r\n              width: '100%',\r\n              padding: '0.75rem',\r\n              border: '1px solid #cbd5e1',\r\n              borderRadius: '8px',\r\n            }}\r\n          />\r\n        </div>\r\n        <div>\r\n          <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>\r\n            Check-out *\r\n          </label>\r\n          <input\r\n            type=\"date\"\r\n            value={formData.checkOutDate}\r\n            onChange={(e) => setFormData({ ...formData, checkOutDate: e.target.value })}\r\n            style={{\r\n              width: '100%',\r\n              padding: '0.75rem',\r\n              border: '1px solid #cbd5e1',\r\n              borderRadius: '8px',\r\n            }}\r\n          />\r\n        </div>\r\n        <div>\r\n          <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>Adults *</label>\r\n          <input\r\n            type=\"number\"\r\n            min={1}\r\n            value={formData.adults}\r\n            onChange={(e) =>\r\n              setFormData({ ...formData, adults: Math.max(1, parseInt(e.target.value || '0', 10) || 1) })\r\n            }\r\n            style={{\r\n              width: '100%',\r\n              padding: '0.75rem',\r\n              border: '1px solid #cbd5e1',\r\n              borderRadius: '8px',\r\n            }}\r\n          />\r\n        </div>\r\n        <div>\r\n          <label style={{ display: 'block', marginBottom: '0.45rem', color: '#475569', fontWeight: 600 }}>Children</label>\r\n          <input\r\n            type=\"number\"\r\n            min={0}\r\n            value={formData.children}\r\n            onChange={(e) =>\r\n              setFormData({ ...formData, children: Math.max(0, parseInt(e.target.value || '0', 10) || 0) })\r\n            }\r\n            style={{\r\n              width: '100%',\r\n              padding: '0.75rem',\r\n              border: '1px solid #cbd5e1',\r\n              borderRadius: '8px',\r\n            }}\r\n          />\r\n        </div>\r\n      </div>\r\n      <div\r\n        style={{\r\n          border: '1px solid #e2e8f0',\r\n          borderRadius: '10px',\r\n          padding: '1rem',\r\n          background: '#f8fafc',\r\n        }}\r\n      >\r\n        {checkingAvailability ? (\r\n          <p style={{ margin: 0, color: '#64748b' }}>Checking availability...</p>\r\n        ) : availabilityError ? (\r\n          <p style={{ margin: 0, color: '#ef4444' }}>{availabilityError}</p>\r\n        ) : availabilitySummary ? (\r\n          <p style={{ margin: 0, color: '#0f172a' }}>\r\n            {availabilitySummary.available} of {availabilitySummary.total} rooms available for {getNights()} night\r\n            {getNights() === 1 ? '' : 's'}.\r\n          </p>\r\n        ) : (\r\n          <p style={{ margin: 0, color: '#64748b' }}>Select dates to view availability.</p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderRoomsStep = () => (\r\n    <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\r\n      <div style={{ display: 'flex', flexDirection: 'column', gap: '0.35rem' }}>\r\n        <label style={{ color: '#475569', fontWeight: 600 }}>Room filters</label>\r\n        <div\r\n          style={{\r\n            display: 'flex',\r\n            flexWrap: 'wrap',\r\n            gap: '0.85rem',\r\n            alignItems: 'stretch',\r\n            border: '1px solid #cbd5e1',\r\n            borderRadius: '10px',\r\n            padding: '0.25rem',\r\n            background: '#fff',\r\n          }}\r\n        >\r\n          <div\r\n            style={{\r\n              flex: 1,\r\n              minWidth: '220px',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              padding: '0 0.75rem',\r\n            }}\r\n          >\r\n            <input\r\n              type=\"text\"\r\n              value={roomSearch}\r\n              onChange={(e) => setRoomSearch(e.target.value)}\r\n              placeholder=\"Search by room #, type, category\"\r\n              style={{\r\n                width: '100%',\r\n                border: 'none',\r\n                outline: 'none',\r\n                fontSize: '0.95rem',\r\n                color: '#0f172a',\r\n              }}\r\n            />\r\n          </div>\r\n          <div\r\n            style={{\r\n              minWidth: '220px',\r\n              borderLeft: '1px solid #e2e8f0',\r\n              display: 'flex',\r\n              alignItems: 'stretch',\r\n            }}\r\n          >\r\n            <select\r\n              value={categoryFilter}\r\n              onChange={(e) => setCategoryFilter(e.target.value)}\r\n              style={{\r\n                width: '100%',\r\n                border: 'none',\r\n                outline: 'none',\r\n                borderRadius: '0 8px 8px 0',\r\n                padding: '0.7rem',\r\n                background: '#f8fafc',\r\n                color: '#0f172a',\r\n                fontWeight: 500,\r\n              }}\r\n            >\r\n              <option value=\"all\" style={{ color: '#0f172a' }}>\r\n                All categories\r\n              </option>\r\n              <option value=\"none\" style={{ color: '#0f172a' }}>\r\n                Uncategorized\r\n              </option>\r\n              {categories.map((category) => (\r\n                <option key={category.id} value={category.id} style={{ color: '#0f172a' }}>\r\n                  {category.name}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div\r\n        style={{\r\n          padding: '1rem',\r\n          borderRadius: '10px',\r\n          border: '1px solid #e2e8f0',\r\n          background: '#f8fafc',\r\n        }}\r\n      >\r\n        <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: 600 }}>\r\n          Bulk select (e.g. \"101-105\" or \"201,203\")\r\n        </label>\r\n        <div style={{ display: 'flex', gap: '0.75rem', flexWrap: 'wrap' }}>\r\n          <input\r\n            type=\"text\"\r\n            value={bulkSelectionInput}\r\n            onChange={(e) => {\r\n              setBulkSelectionInput(e.target.value);\r\n              setBulkSelectionError(null);\r\n            }}\r\n            placeholder=\"101-105, 210\"\r\n            style={{\r\n              flex: 1,\r\n              minWidth: '220px',\r\n              padding: '0.75rem',\r\n              borderRadius: '8px',\r\n              border: `1px solid ${bulkSelectionError ? '#ef4444' : '#cbd5e1'}`,\r\n            }}\r\n          />\r\n          <button\r\n            type=\"button\"\r\n            onClick={handleBulkSelection}\r\n            style={{\r\n              padding: '0.8rem 1.5rem',\r\n              borderRadius: '8px',\r\n              border: 'none',\r\n              background: '#2563eb',\r\n              color: 'white',\r\n              cursor: 'pointer',\r\n              fontWeight: 600,\r\n            }}\r\n          >\r\n            Add Rooms\r\n          </button>\r\n          {selectedRoomIds.size > 0 && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={clearAllRooms}\r\n              style={{\r\n                padding: '0.8rem 1.5rem',\r\n                borderRadius: '8px',\r\n                border: '1px solid #e2e8f0',\r\n                background: '#fff',\r\n                color: '#475569',\r\n                cursor: 'pointer',\r\n                fontWeight: 600,\r\n              }}\r\n            >\r\n              Clear Selection\r\n            </button>\r\n          )}\r\n        </div>\r\n        {bulkSelectionError && (\r\n          <p style={{ marginTop: '0.4rem', color: '#ef4444', fontSize: '0.85rem' }}>{bulkSelectionError}</p>\r\n        )}\r\n        {unavailableRooms.size > 0 && (\r\n          <p style={{ marginTop: '0.4rem', color: '#f97316', fontSize: '0.85rem' }}>\r\n            Unavailable: {Array.from(unavailableRooms).join(', ')}\r\n          </p>\r\n        )}\r\n      </div>\r\n\r\n      {roomsByCategory.length === 0 ? (\r\n        <p style={{ color: '#94a3b8', textAlign: 'center' }}>\r\n          {formData.checkInDate && formData.checkOutDate\r\n            ? 'No rooms available for the selected filters'\r\n            : 'Select stay details first to load rooms'}\r\n        </p>\r\n      ) : (\r\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem', maxHeight: '320px', overflowY: 'auto' }}>\r\n          {roomsByCategory.map((group) => {\r\n            const selectedCount = group.rooms.filter((room) => selectedRoomIds.has(room.id)).length;\r\n            return (\r\n              <div\r\n                key={group.id}\r\n                style={{\r\n                  border: '1px solid #e2e8f0',\r\n                  borderRadius: '10px',\r\n                  padding: '1rem',\r\n                  background: '#fff',\r\n                }}\r\n              >\r\n                <div\r\n                  style={{\r\n                    display: 'flex',\r\n                    justifyContent: 'space-between',\r\n                    alignItems: 'center',\r\n                    flexWrap: 'wrap',\r\n                    gap: '0.75rem',\r\n                    marginBottom: '0.75rem',\r\n                  }}\r\n                >\r\n                  <div>\r\n                    <p style={{ margin: 0, fontWeight: 600, color: '#0f172a' }}>{group.name}</p>\r\n                    <p style={{ margin: '0.2rem 0 0', color: '#64748b', fontSize: '0.85rem' }}>\r\n                      {selectedCount}/{group.rooms.length} selected\r\n                    </p>\r\n                  </div>\r\n                  <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => handleCategorySelectAll(group.rooms)}\r\n                      style={{\r\n                        padding: '0.35rem 0.9rem',\r\n                        borderRadius: '6px',\r\n                        border: '1px solid #cbd5e1',\r\n                        background: '#fff',\r\n                        cursor: 'pointer',\r\n                        fontSize: '0.8rem',\r\n                      }}\r\n                    >\r\n                      Select all\r\n                    </button>\r\n                    {selectedCount > 0 && (\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => handleCategoryClear(group.rooms)}\r\n                        style={{\r\n                          padding: '0.35rem 0.9rem',\r\n                          borderRadius: '6px',\r\n                          border: '1px solid #fecaca',\r\n                          background: '#fee2e2',\r\n                          color: '#b91c1c',\r\n                          cursor: 'pointer',\r\n                          fontSize: '0.8rem',\r\n                        }}\r\n                      >\r\n                        Clear\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '0.6rem' }}>\r\n                  {group.rooms.map((room) => {\r\n                    const isSelected = selectedRoomIds.has(room.id);\r\n                    const rate = resolveRoomRate(room);\r\n                    const hasCustomRate = room.customRate !== undefined && room.customRate !== null;\r\n                    return (\r\n                      <div\r\n                        key={room.id}\r\n                        onClick={() => handleRoomToggle(room.id)}\r\n                        style={{\r\n                          display: 'flex',\r\n                          justifyContent: 'space-between',\r\n                          alignItems: 'center',\r\n                          padding: '0.85rem',\r\n                          border: `2px solid ${isSelected ? '#2563eb' : '#e2e8f0'}`,\r\n                          borderRadius: '8px',\r\n                          cursor: 'pointer',\r\n                          background: isSelected ? '#eff6ff' : '#fff',\r\n                        }}\r\n                      >\r\n                        <div>\r\n                          <p style={{ margin: 0, fontWeight: 600, color: '#0f172a' }}>\r\n                            Room {room.roomNumber}  {room.roomType}\r\n                          </p>\r\n                          <p style={{ margin: '0.2rem 0 0', color: '#475569', fontSize: '0.85rem' }}>\r\n                            {hasCustomRate ? 'Custom rate' : room.ratePlan?.name || 'Category rate'}\r\n                          </p>\r\n                        </div>\r\n                        <div style={{ textAlign: 'right' }}>\r\n                          <input\r\n                            type=\"text\"\r\n                            value={formatCurrency(rate)}\r\n                            readOnly\r\n                            tabIndex={-1}\r\n                            style={{\r\n                              width: '130px',\r\n                              padding: '0.45rem',\r\n                              borderRadius: '6px',\r\n                              border: '1px solid #cbd5e1',\r\n                              textAlign: 'right',\r\n                              background: '#f1f5f9',\r\n                              color: '#0f172a',\r\n                              fontWeight: 600,\r\n                              cursor: 'not-allowed',\r\n                            }}\r\n                          />\r\n                          <p style={{ margin: '0.2rem 0 0', color: '#64748b', fontSize: '0.75rem' }}>per night</p>\r\n                        </div>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      )}\r\n\r\n      {selectedRoomIds.size > 0 && (\r\n        <div\r\n          style={{\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '10px',\r\n            padding: '1rem',\r\n            background: '#f8fafc',\r\n          }}\r\n        >\r\n          <p style={{ margin: 0, color: '#64748b', fontSize: '0.85rem' }}>Selected</p>\r\n          <p style={{ margin: '0.25rem 0', fontWeight: 700, color: '#0f172a', fontSize: '1.25rem' }}>\r\n            {selectedRoomIds.size} room{selectedRoomIds.size === 1 ? '' : 's'}  {formatCurrency(roomSubtotal)}\r\n          </p>\r\n          <p style={{ margin: 0, color: '#475569', fontSize: '0.85rem' }}>\r\n            {selectedRoomDetails\r\n              .map((room: any) => `${room.roomNumber} (${formatCurrency(resolveRoomRate(room))}/night)`)\r\n              .join(', ')}\r\n          </p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  const renderHallStep = () => (\r\n    <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\r\n      <div\r\n        style={{\r\n          border: '1px solid #e2e8f0',\r\n          borderRadius: '10px',\r\n          padding: '1rem',\r\n          background: '#f8fafc',\r\n          display: 'flex',\r\n          justifyContent: 'space-between',\r\n          alignItems: 'center',\r\n          flexWrap: 'wrap',\r\n          gap: '0.5rem',\r\n        }}\r\n      >\r\n        <div>\r\n          <p style={{ margin: 0, fontWeight: 600, color: '#0f172a' }}>Add hall or event space</p>\r\n          <p style={{ margin: '0.2rem 0 0', color: '#64748b', fontSize: '0.85rem' }}>\r\n            Attach meeting halls to this reservation\r\n          </p>\r\n        </div>\r\n        <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>\r\n          <input type=\"checkbox\" checked={includeHall} onChange={(e) => setIncludeHall(e.target.checked)} />\r\n          Include hall booking\r\n        </label>\r\n      </div>\r\n\r\n      {includeHall && meetingHalls.length === 0 && (\r\n        <p style={{ color: '#ef4444' }}>No meeting halls configured for this property yet.</p>\r\n      )}\r\n\r\n      {includeHall && meetingHalls.length > 0 && (\r\n        <>\r\n          {hallReservations.map((reservation, index) => (\r\n            <div\r\n              key={reservation.id}\r\n              style={{\r\n                border: '1px solid #e2e8f0',\r\n                borderRadius: '10px',\r\n                padding: '1rem',\r\n                background: '#fff',\r\n                display: 'flex',\r\n                flexDirection: 'column',\r\n                gap: '0.8rem',\r\n              }}\r\n            >\r\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                <p style={{ margin: 0, fontWeight: 600, color: '#0f172a' }}>Hall Reservation #{index + 1}</p>\r\n                {hallReservations.length > 1 && (\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => removeHallReservation(reservation.id)}\r\n                    style={{\r\n                      border: 'none',\r\n                      background: 'transparent',\r\n                      color: '#ef4444',\r\n                      cursor: 'pointer',\r\n                      fontWeight: 600,\r\n                    }}\r\n                  >\r\n                    Remove\r\n                  </button>\r\n                )}\r\n              </div>\r\n              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '0.85rem' }}>\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>\r\n                    Hall *\r\n                  </label>\r\n                  <select\r\n                    value={reservation.hallId}\r\n                    onChange={(e) => handleHallChange(index, 'hallId', e.target.value)}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.7rem',\r\n                      borderRadius: '8px',\r\n                      border: '1px solid #cbd5e1',\r\n                    }}\r\n                  >\r\n                    <option value=\"\">Select hall</option>\r\n                    {meetingHalls.map((hall) => (\r\n                      <option key={hall.id} value={hall.id}>\r\n                        {hall.name} (cap. {hall.capacity})\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>\r\n                    Event Name\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={reservation.eventName}\r\n                    onChange={(e) => handleHallChange(index, 'eventName', e.target.value)}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.7rem',\r\n                      borderRadius: '8px',\r\n                      border: '1px solid #cbd5e1',\r\n                    }}\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>\r\n                    Rate (flat) *\r\n                  </label>\r\n                  <input\r\n                    type=\"number\"\r\n                    value={reservation.rate}\r\n                    onChange={(e) => handleHallChange(index, 'rate', e.target.value)}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.7rem',\r\n                      borderRadius: '8px',\r\n                      border: '1px solid #cbd5e1',\r\n                    }}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '0.85rem' }}>\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>\r\n                    Start *\r\n                  </label>\r\n                  <input\r\n                    type=\"datetime-local\"\r\n                    value={reservation.startDateTime}\r\n                    onChange={(e) => handleHallChange(index, 'startDateTime', e.target.value)}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.7rem',\r\n                      borderRadius: '8px',\r\n                      border: '1px solid #cbd5e1',\r\n                    }}\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>\r\n                    End *\r\n                  </label>\r\n                  <input\r\n                    type=\"datetime-local\"\r\n                    value={reservation.endDateTime}\r\n                    onChange={(e) => handleHallChange(index, 'endDateTime', e.target.value)}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.7rem',\r\n                      borderRadius: '8px',\r\n                      border: '1px solid #cbd5e1',\r\n                    }}\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>\r\n                    Attendees\r\n                  </label>\r\n                  <input\r\n                    type=\"number\"\r\n                    min={0}\r\n                    value={reservation.attendeeCount}\r\n                    onChange={(e) => handleHallChange(index, 'attendeeCount', e.target.value)}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.7rem',\r\n                      borderRadius: '8px',\r\n                      border: '1px solid #cbd5e1',\r\n                    }}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '0.85rem' }}>\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>\r\n                    Purpose\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={reservation.purpose}\r\n                    onChange={(e) => handleHallChange(index, 'purpose', e.target.value)}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.7rem',\r\n                      borderRadius: '8px',\r\n                      border: '1px solid #cbd5e1',\r\n                    }}\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.35rem', color: '#475569', fontWeight: 600 }}>\r\n                    Setup Type\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={reservation.setupType}\r\n                    onChange={(e) => handleHallChange(index, 'setupType', e.target.value)}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.7rem',\r\n                      borderRadius: '8px',\r\n                      border: '1px solid #cbd5e1',\r\n                    }}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <textarea\r\n                value={reservation.cateringNotes}\r\n                onChange={(e) => handleHallChange(index, 'cateringNotes', e.target.value)}\r\n                placeholder=\"Catering notes\"\r\n                rows={2}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.7rem',\r\n                  borderRadius: '8px',\r\n                  border: '1px solid #cbd5e1',\r\n                  resize: 'vertical',\r\n                }}\r\n              />\r\n              <textarea\r\n                value={reservation.avRequirements}\r\n                onChange={(e) => handleHallChange(index, 'avRequirements', e.target.value)}\r\n                placeholder=\"A/V requirements\"\r\n                rows={2}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.7rem',\r\n                  borderRadius: '8px',\r\n                  border: '1px solid #cbd5e1',\r\n                  resize: 'vertical',\r\n                }}\r\n              />\r\n            </div>\r\n          ))}\r\n          <button\r\n            type=\"button\"\r\n            onClick={addHallReservation}\r\n            style={{\r\n              padding: '0.75rem 1rem',\r\n              borderRadius: '8px',\r\n              border: '1px dashed #94a3b8',\r\n              background: '#fff',\r\n              cursor: 'pointer',\r\n              fontWeight: 600,\r\n              color: '#2563eb',\r\n            }}\r\n          >\r\n            + Add another hall\r\n          </button>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  const renderInvoiceStep = () => (\r\n    <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\r\n      <div\r\n        style={{\r\n          border: '1px solid #e2e8f0',\r\n          borderRadius: '10px',\r\n          padding: '1rem',\r\n          background: '#fff',\r\n        }}\r\n      >\r\n        <p style={{ margin: 0, fontWeight: 600, color: '#0f172a' }}>Guest</p>\r\n        <p style={{ margin: '0.2rem 0 0', color: '#475569' }}>{formData.guestName}</p>\r\n        <p style={{ margin: '0.2rem 0 0', color: '#94a3b8', fontSize: '0.85rem' }}>\r\n          {formData.guestEmail}  {formData.guestPhone}\r\n        </p>\r\n        <p style={{ margin: '0.2rem 0 0', color: '#94a3b8', fontSize: '0.85rem' }}>{formData.guestAddress}</p>\r\n      </div>\r\n      <div\r\n        style={{\r\n          border: '1px solid #e2e8f0',\r\n          borderRadius: '10px',\r\n          padding: '1rem',\r\n          background: '#fff',\r\n        }}\r\n      >\r\n        <p style={{ margin: 0, fontWeight: 600, color: '#0f172a' }}>Stay</p>\r\n        <p style={{ margin: '0.2rem 0 0', color: '#475569' }}>\r\n          {formData.checkInDate || ''}  {formData.checkOutDate || ''}  {nightMultiplier} night\r\n          {nightMultiplier === 1 ? '' : 's'}\r\n        </p>\r\n        <p style={{ margin: '0.2rem 0 0', color: '#94a3b8', fontSize: '0.85rem' }}>\r\n          {formData.adults} adult{formData.adults === 1 ? '' : 's'}\r\n          {formData.children ? `  ${formData.children} child${formData.children === 1 ? '' : 'ren'}` : ''}\r\n        </p>\r\n      </div>\r\n      <div\r\n        style={{\r\n          border: '1px solid #e2e8f0',\r\n          borderRadius: '10px',\r\n          padding: '1rem',\r\n          background: '#fff',\r\n        }}\r\n      >\r\n        <p style={{ margin: 0, fontWeight: 600, color: '#0f172a' }}>Rooms ({selectedRoomIds.size})</p>\r\n        <div style={{ marginTop: '0.75rem', display: 'flex', flexDirection: 'column', gap: '0.65rem' }}>\r\n          {selectedRoomDetails.map((room: any) => {\r\n            const nightly = roomRates[room.id] || 0;\r\n            return (\r\n              <div\r\n                key={room.id}\r\n                style={{\r\n                  display: 'flex',\r\n                  justifyContent: 'space-between',\r\n                  color: '#475569',\r\n                }}\r\n              >\r\n                <span>\r\n                  Room {room.roomNumber}  {room.roomType}\r\n                </span>\r\n                <span>\r\n                  {formatCurrency(nightly)}  {nightMultiplier} = {formatCurrency(nightly * nightMultiplier)}\r\n                </span>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n        <p style={{ marginTop: '0.8rem', fontWeight: 600, color: '#0f172a' }}>\r\n          Subtotal: {formatCurrency(roomSubtotal)}\r\n        </p>\r\n      </div>\r\n      {includeHall && hallReservations.length > 0 && (\r\n        <div\r\n          style={{\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '10px',\r\n            padding: '1rem',\r\n            background: '#fff',\r\n          }}\r\n        >\r\n          <p style={{ margin: 0, fontWeight: 600, color: '#0f172a' }}>Hall bookings</p>\r\n          <div style={{ marginTop: '0.75rem', display: 'flex', flexDirection: 'column', gap: '0.65rem' }}>\r\n            {hallReservations.map((reservation, index) => {\r\n              const hallName = meetingHalls.find((hall) => hall.id === reservation.hallId)?.name || `Hall ${index + 1}`;\r\n              return (\r\n                <div\r\n                  key={reservation.id}\r\n                  style={{\r\n                    display: 'flex',\r\n                    justifyContent: 'space-between',\r\n                    color: '#475569',\r\n                  }}\r\n                >\r\n                  <span>\r\n                    {hallName}  {reservation.startDateTime || 'TBD'}\r\n                  </span>\r\n                  <span>{formatCurrency(Number(reservation.rate) || 0)}</span>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n          <p style={{ marginTop: '0.8rem', fontWeight: 600, color: '#0f172a' }}>\r\n            Hall total: {formatCurrency(hallTotal)}\r\n          </p>\r\n        </div>\r\n      )}\r\n      <div\r\n        style={{\r\n          border: '1px solid #cbd5e1',\r\n          borderRadius: '12px',\r\n          padding: '1.25rem',\r\n          background: '#0f172a',\r\n          color: '#fff',\r\n        }}\r\n      >\r\n        <p style={{ margin: 0, fontSize: '0.9rem', letterSpacing: '0.08em', textTransform: 'uppercase' }}>Invoice total</p>\r\n        <p style={{ margin: '0.25rem 0 0', fontSize: '2rem', fontWeight: 700 }}>{formatCurrency(invoiceTotal)}</p>\r\n        <p style={{ margin: '0.25rem 0 0', color: '#cbd5f5' }}>\r\n          Rooms: {formatCurrency(roomSubtotal)}  Halls: {formatCurrency(includeHall ? hallTotal : 0)}\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderStep = () => {\r\n    switch (currentStep) {\r\n      case 0:\r\n        return renderGuestStep();\r\n      case 1:\r\n        return renderStayStep();\r\n      case 2:\r\n        return renderRoomsStep();\r\n      case 3:\r\n        return renderHallStep();\r\n      case 4:\r\n        return renderInvoiceStep();\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(15, 23, 42, 0.45)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 1000,\r\n        padding: '1rem',\r\n      }}\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        style={{\r\n          width: '95%',\r\n          maxWidth: '960px',\r\n          background: '#fff',\r\n          borderRadius: '18px',\r\n          padding: '2rem',\r\n          maxHeight: '90vh',\r\n          overflowY: 'auto',\r\n          boxShadow: '0 25px 70px rgba(15, 23, 42, 0.18)',\r\n        }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <div>\r\n            <h2 style={{ margin: 0, fontSize: '1.75rem', color: '#0f172a' }}>New Reservation</h2>\r\n            <p style={{ margin: '0.3rem 0 0', color: '#64748b' }}>\r\n              Capture guest info, stay, rooms, optional halls, and review invoice\r\n            </p>\r\n          </div>\r\n          <button\r\n            type=\"button\"\r\n            onClick={onClose}\r\n            style={{ border: 'none', background: 'transparent', cursor: 'pointer', color: '#94a3b8' }}\r\n          >\r\n            <XCircle size={28} />\r\n          </button>\r\n        </div>\r\n\r\n        <div\r\n          style={{\r\n            display: 'grid',\r\n            gridTemplateColumns: `repeat(${steps.length}, minmax(0, 1fr))`,\r\n            gap: '0.35rem',\r\n            marginBottom: '1.5rem',\r\n          }}\r\n        >\r\n          {steps.map((label, index) => {\r\n            const isActive = index === currentStep;\r\n            const isComplete = index < currentStep;\r\n            return (\r\n              <div\r\n                key={label}\r\n                style={{\r\n                  padding: '0.55rem 0.4rem',\r\n                  borderRadius: '999px',\r\n                  textAlign: 'center',\r\n                  fontSize: '0.78rem',\r\n                  fontWeight: 600,\r\n                  background: isComplete ? '#dbeafe' : isActive ? '#2563eb' : '#f1f5f9',\r\n                  color: isActive ? '#fff' : isComplete ? '#1d4ed8' : '#94a3b8',\r\n                  textTransform: 'uppercase',\r\n                  letterSpacing: '0.08em',\r\n                }}\r\n              >\r\n                {label}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '1.25rem' }}>{renderStep()}</div>\r\n\r\n        <div\r\n          style={{\r\n            marginTop: '2rem',\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            gap: '1rem',\r\n            flexWrap: 'wrap',\r\n          }}\r\n        >\r\n          <button\r\n            type=\"button\"\r\n            onClick={onClose}\r\n            style={{\r\n              padding: '0.9rem 1.5rem',\r\n              borderRadius: '999px',\r\n              border: '1px solid #e2e8f0',\r\n              background: '#fff',\r\n              color: '#475569',\r\n              fontWeight: 600,\r\n              flex: 1,\r\n              maxWidth: '160px',\r\n            }}\r\n          >\r\n            Cancel\r\n          </button>\r\n          {currentStep > 0 && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={goToPreviousStep}\r\n              style={{\r\n                padding: '0.9rem 1.5rem',\r\n                borderRadius: '999px',\r\n                border: '1px solid #cbd5e1',\r\n                background: '#fff',\r\n                color: '#0f172a',\r\n                fontWeight: 600,\r\n                flex: 1,\r\n                maxWidth: '160px',\r\n              }}\r\n            >\r\n              Back\r\n            </button>\r\n          )}\r\n          {currentStep < steps.length - 1 && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={goToNextStep}\r\n              disabled={!canProceed}\r\n              style={{\r\n                padding: '0.9rem 1.5rem',\r\n                borderRadius: '999px',\r\n                border: 'none',\r\n                background: canProceed ? '#2563eb' : '#cbd5e1',\r\n                color: '#fff',\r\n                fontWeight: 600,\r\n                flex: 1,\r\n                maxWidth: '200px',\r\n                cursor: canProceed ? 'pointer' : 'not-allowed',\r\n              }}\r\n            >\r\n              Next\r\n            </button>\r\n          )}\r\n          {currentStep === steps.length - 1 && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleSubmit}\r\n              disabled={modalLoading}\r\n              style={{\r\n                padding: '0.9rem 1.5rem',\r\n                borderRadius: '999px',\r\n                border: 'none',\r\n                background: modalLoading ? '#cbd5e1' : '#16a34a',\r\n                color: '#fff',\r\n                fontWeight: 600,\r\n                flex: 1,\r\n                maxWidth: '220px',\r\n                cursor: modalLoading ? 'not-allowed' : 'pointer',\r\n              }}\r\n            >\r\n              {modalLoading ? 'Saving...' : 'Create Reservation'}\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\RoomServicePage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadMenuData', 'loadOrders', and 'loadStats'. Either include them or remove the dependency array.","line":90,"column":6,"nodeType":"ArrayExpression","endLine":90,"endColumn":47,"suggestions":[{"desc":"Update the dependencies array to be: [user.tenantId, activeTab, statusFilter, loadMenuData, loadOrders, loadStats]","fix":{"range":[2260,2301],"text":"[user.tenantId, activeTab, statusFilter, loadMenuData, loadOrders, loadStats]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Button from '../components/Button';\r\nimport {\r\n  Plus,\r\n  Search,\r\n  ChefHat,\r\n  Clock,\r\n  DollarSign,\r\n  Edit,\r\n  Trash2,\r\n  ShoppingCart,\r\n  AlertTriangle\r\n} from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\n\r\ninterface MenuCategory {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  displayOrder: number;\r\n  isActive: boolean;\r\n  imageUrl?: string;\r\n}\r\n\r\ninterface MenuItem {\r\n  id: string;\r\n  categoryId: string;\r\n  name: string;\r\n  description?: string;\r\n  price: number;\r\n  imageUrl?: string;\r\n  isActive: boolean;\r\n  isVegetarian: boolean;\r\n  isVegan: boolean;\r\n  isGlutenFree: boolean;\r\n  containsNuts: boolean;\r\n  spiceLevel: string;\r\n  preparationTime?: number;\r\n  allergens: string[];\r\n}\r\n\r\ninterface RoomServiceOrder {\r\n  id: string;\r\n  orderNumber: string;\r\n  guestName: string;\r\n  roomNumber: string;\r\n  guestPhone?: string;\r\n  status: string;\r\n  orderType: string;\r\n  specialInstructions?: string;\r\n  subtotal: number;\r\n  taxAmount: number;\r\n  serviceCharge: number;\r\n  totalAmount: number;\r\n  requestedAt: string;\r\n  confirmedAt?: string;\r\n  estimatedDelivery?: string;\r\n  deliveredAt?: string;\r\n  preparedAt?: string;\r\n  items: any[];\r\n}\r\n\r\ninterface OrderStats {\r\n  totalOrders: number;\r\n  totalRevenue: number;\r\n  averageOrderValue: number;\r\n  popularItems: Array<{ name: string; count: number }>;\r\n}\r\n\r\nexport default function RoomServicePage() {\r\n  const { user } = useAuthStore();\r\n  const [activeTab, setActiveTab] = useState<'orders' | 'menu' | 'analytics'>('orders');\r\n  const [categories, setCategories] = useState<MenuCategory[]>([]);\r\n  const [menuItems, setMenuItems] = useState<MenuItem[]>([]);\r\n  const [orders, setOrders] = useState<RoomServiceOrder[]>([]);\r\n  const [stats, setStats] = useState<OrderStats | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [statusFilter, setStatusFilter] = useState<string>('all');\r\n\r\n  useEffect(() => {\r\n    if (activeTab === 'menu') {\r\n      loadMenuData();\r\n    } else if (activeTab === 'orders') {\r\n      loadOrders();\r\n      loadStats();\r\n    }\r\n  }, [user?.tenantId, activeTab, statusFilter]);\r\n\r\n  const loadMenuData = async () => {\r\n    if (!user?.tenantId) return;\r\n\r\n    try {\r\n      const [categoriesResponse, itemsResponse] = await Promise.all([\r\n        api.get(`/tenants/${user.tenantId}/menu/categories`),\r\n        api.get(`/tenants/${user.tenantId}/menu/items`)\r\n      ]);\r\n\r\n      setCategories(categoriesResponse.data.data);\r\n      setMenuItems(itemsResponse.data.data);\r\n    } catch (error) {\r\n      console.error('Error loading menu data:', error);\r\n      toast.error('Failed to load menu data');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadOrders = async () => {\r\n    if (!user?.tenantId) return;\r\n\r\n    try {\r\n      const params = new URLSearchParams();\r\n      if (statusFilter !== 'all') params.append('status', statusFilter);\r\n\r\n      const response = await api.get(`/tenants/${user.tenantId}/room-service/orders?${params}`);\r\n      setOrders(response.data.data);\r\n    } catch (error) {\r\n      console.error('Error loading orders:', error);\r\n      toast.error('Failed to load orders');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadStats = async () => {\r\n    if (!user?.tenantId) return;\r\n\r\n    try {\r\n      const response = await api.get(`/tenants/${user.tenantId}/room-service/stats/summary`);\r\n      setStats(response.data.data);\r\n    } catch (error) {\r\n      console.error('Error loading stats:', error);\r\n    }\r\n  };\r\n\r\n  const filteredOrders = orders.filter(order =>\r\n    order.guestName.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    order.roomNumber.includes(searchTerm) ||\r\n    order.orderNumber.toLowerCase().includes(searchTerm)\r\n  );\r\n\r\n  const filteredItems = menuItems.filter(item =>\r\n    item.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    item.description?.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'pending': return '#fbbf24';\r\n      case 'confirmed': return '#3b82f6';\r\n      case 'preparing': return '#8b5cf6';\r\n      case 'ready': return '#f97316';\r\n      case 'delivered': return '#10b981';\r\n      case 'cancelled': return '#ef4444';\r\n      default: return '#6b7280';\r\n    }\r\n  };\r\n\r\n  const getSpiceLevelColor = (level: string) => {\r\n    switch (level) {\r\n      case 'mild': return '#10b981';\r\n      case 'medium': return '#f97316';\r\n      case 'hot': return '#ef4444';\r\n      case 'very_hot': return '#991b1b';\r\n      default: return '#6b7280';\r\n    }\r\n  };\r\n\r\n  const formatCurrency = (amount: number) => {\r\n    return new Intl.NumberFormat('en-NG', {\r\n      style: 'currency',\r\n      currency: 'NGN'\r\n    }).format(amount);\r\n  };\r\n\r\n  const formatDate = (dateString: string) => {\r\n    return new Date(dateString).toLocaleDateString('en-US', {\r\n      month: 'short',\r\n      day: 'numeric',\r\n      hour: '2-digit',\r\n      minute: '2-digit'\r\n    });\r\n  };\r\n\r\n  const tabs = [\r\n    { id: 'orders', label: 'Orders', icon: ShoppingCart },\r\n    { id: 'menu', label: 'Menu', icon: ChefHat },\r\n    { id: 'analytics', label: 'Analytics', icon: DollarSign }\r\n  ];\r\n\r\n  return (\r\n    <div style={{ padding: '2rem', maxWidth: '1400px', margin: '0 auto' }}>\r\n      <div style={{ marginBottom: '2rem' }}>\r\n        <h1 style={{ fontSize: '2rem', fontWeight: 'bold', marginBottom: '0.5rem' }}>\r\n          Room Service\r\n        </h1>\r\n        <p style={{ color: '#64748b' }}>\r\n          Manage menu items, orders, and room service operations\r\n        </p>\r\n      </div>\r\n\r\n      {/* Tab Navigation */}\r\n      <div style={{\r\n        display: 'flex',\r\n        borderBottom: '1px solid #e2e8f0',\r\n        marginBottom: '2rem'\r\n      }}>\r\n        {tabs.map((tab) => (\r\n          <button\r\n            key={tab.id}\r\n            onClick={() => setActiveTab(tab.id as any)}\r\n            style={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.5rem',\r\n              padding: '1rem 1.5rem',\r\n              border: 'none',\r\n              background: 'none',\r\n              borderBottom: activeTab === tab.id ? '2px solid #3b82f6' : '2px solid transparent',\r\n              color: activeTab === tab.id ? '#3b82f6' : '#64748b',\r\n              fontWeight: activeTab === tab.id ? '600' : '500',\r\n              cursor: 'pointer',\r\n              transition: 'all 0.2s'\r\n            }}\r\n          >\r\n            <tab.icon size={18} />\r\n            {tab.label}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Orders Tab */}\r\n      {activeTab === 'orders' && (\r\n        <div>\r\n          {/* Stats Cards */}\r\n          {stats && (\r\n            <div style={{\r\n              display: 'grid',\r\n              gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',\r\n              gap: '1rem',\r\n              marginBottom: '2rem'\r\n            }}>\r\n              <div style={{\r\n                background: 'white',\r\n                border: '1px solid #e2e8f0',\r\n                borderRadius: '8px',\r\n                padding: '1.5rem',\r\n                textAlign: 'center'\r\n              }}>\r\n                <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#1f2937' }}>\r\n                  {stats.totalOrders}\r\n                </div>\r\n                <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Total Orders</div>\r\n              </div>\r\n\r\n              <div style={{\r\n                background: 'white',\r\n                border: '1px solid #e2e8f0',\r\n                borderRadius: '8px',\r\n                padding: '1.5rem',\r\n                textAlign: 'center'\r\n              }}>\r\n                <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#10b981' }}>\r\n                  {formatCurrency(stats.totalRevenue)}\r\n                </div>\r\n                <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Total Revenue</div>\r\n              </div>\r\n\r\n              <div style={{\r\n                background: 'white',\r\n                border: '1px solid #e2e8f0',\r\n                borderRadius: '8px',\r\n                padding: '1.5rem',\r\n                textAlign: 'center'\r\n              }}>\r\n                <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#3b82f6' }}>\r\n                  {formatCurrency(stats.averageOrderValue)}\r\n                </div>\r\n                <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Avg Order Value</div>\r\n              </div>\r\n\r\n              <div style={{\r\n                background: 'white',\r\n                border: '1px solid #e2e8f0',\r\n                borderRadius: '8px',\r\n                padding: '1.5rem',\r\n                textAlign: 'center'\r\n              }}>\r\n                <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#f97316' }}>\r\n                  {stats.popularItems.length > 0 ? stats.popularItems[0].name : 'N/A'}\r\n                </div>\r\n                <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Top Item</div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Filters */}\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            marginBottom: '2rem'\r\n          }}>\r\n            <div style={{\r\n              display: 'flex',\r\n              flexWrap: 'wrap',\r\n              gap: '1rem',\r\n              alignItems: 'center'\r\n            }}>\r\n              <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', flex: 1, minWidth: '200px' }}>\r\n                <Search size={18} style={{ color: '#64748b' }} />\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Search orders...\"\r\n                  value={searchTerm}\r\n                  onChange={(e) => setSearchTerm(e.target.value)}\r\n                  style={{\r\n                    flex: 1,\r\n                    padding: '0.5rem 0.75rem',\r\n                    border: '1px solid #d1d5db',\r\n                    borderRadius: '6px',\r\n                    fontSize: '0.875rem'\r\n                  }}\r\n                />\r\n              </div>\r\n\r\n              <select\r\n                value={statusFilter}\r\n                onChange={(e) => setStatusFilter(e.target.value)}\r\n                style={{\r\n                  padding: '0.5rem 0.75rem',\r\n                  border: '1px solid #d1d5db',\r\n                  borderRadius: '6px',\r\n                  fontSize: '0.875rem',\r\n                  minWidth: '140px'\r\n                }}\r\n              >\r\n                <option value=\"all\">All Status</option>\r\n                <option value=\"pending\">Pending</option>\r\n                <option value=\"confirmed\">Confirmed</option>\r\n                <option value=\"preparing\">Preparing</option>\r\n                <option value=\"ready\">Ready</option>\r\n                <option value=\"delivered\">Delivered</option>\r\n                <option value=\"cancelled\">Cancelled</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Orders List */}\r\n          {loading ? (\r\n            <div style={{ textAlign: 'center', padding: '3rem' }}>\r\n              Loading orders...\r\n            </div>\r\n          ) : filteredOrders.length === 0 ? (\r\n            <div style={{\r\n              textAlign: 'center',\r\n              padding: '3rem',\r\n              border: '2px dashed #e2e8f0',\r\n              borderRadius: '8px'\r\n            }}>\r\n              <ShoppingCart size={48} style={{ color: '#cbd5e1', marginBottom: '1rem' }} />\r\n              <h3 style={{ fontSize: '1.25rem', fontWeight: '600', marginBottom: '0.5rem' }}>\r\n                No Orders Found\r\n              </h3>\r\n              <p style={{ color: '#64748b' }}>\r\n                {searchTerm || statusFilter !== 'all'\r\n                  ? 'No orders match your current filters.'\r\n                  : 'No room service orders have been placed yet.'}\r\n              </p>\r\n            </div>\r\n          ) : (\r\n            <div style={{ display: 'grid', gap: '1rem' }}>\r\n              {filteredOrders.map((order) => (\r\n                <div\r\n                  key={order.id}\r\n                  style={{\r\n                    background: 'white',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '8px',\r\n                    padding: '1.5rem'\r\n                  }}\r\n                >\r\n                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1rem' }}>\r\n                    <div>\r\n                      <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '0.25rem' }}>\r\n                        Order #{order.orderNumber}\r\n                      </h3>\r\n                      <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', fontSize: '0.875rem', color: '#64748b' }}>\r\n                        <span>{order.guestName}</span>\r\n                        <span>Room {order.roomNumber}</span>\r\n                        <span>{formatDate(order.requestedAt)}</span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n                      <span style={{\r\n                        padding: '0.25rem 0.75rem',\r\n                        borderRadius: '9999px',\r\n                        fontSize: '0.75rem',\r\n                        fontWeight: '600',\r\n                        background: `${getStatusColor(order.status)}20`,\r\n                        color: getStatusColor(order.status)\r\n                      }}>\r\n                        {order.status.toUpperCase()}\r\n                      </span>\r\n                      <div style={{ fontSize: '1.25rem', fontWeight: 'bold', color: '#1f2937' }}>\r\n                        {formatCurrency(order.totalAmount)}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {order.specialInstructions && (\r\n                    <div style={{\r\n                      background: '#fef3c7',\r\n                      border: '1px solid #f59e0b',\r\n                      borderRadius: '6px',\r\n                      padding: '0.75rem',\r\n                      marginBottom: '1rem'\r\n                    }}>\r\n                      <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.25rem' }}>\r\n                        <AlertTriangle size={16} style={{ color: '#f59e0b' }} />\r\n                        <span style={{ fontSize: '0.875rem', fontWeight: '600', color: '#92400e' }}>\r\n                          Special Instructions\r\n                        </span>\r\n                      </div>\r\n                      <p style={{ fontSize: '0.875rem', color: '#92400e', margin: 0 }}>\r\n                        {order.specialInstructions}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n\r\n                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                    <div style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                      {order.items.length} item{order.items.length !== 1 ? 's' : ''}\r\n                      {order.estimatedDelivery && (\r\n                        <span style={{ marginLeft: '1rem' }}>\r\n                          Est. delivery: {formatDate(order.estimatedDelivery)}\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n\r\n                    <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n                      <Button variant=\"ghost\" size=\"sm\">\r\n                        View Details\r\n                      </Button>\r\n                      <Button variant=\"ghost\" size=\"sm\">\r\n                        Update Status\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Menu Tab */}\r\n      {activeTab === 'menu' && (\r\n        <div>\r\n          <div style={{\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            marginBottom: '2rem'\r\n          }}>\r\n            <h2 style={{ fontSize: '1.5rem', fontWeight: '600' }}>Menu Management</h2>\r\n            <div style={{ display: 'flex', gap: '1rem' }}>\r\n              <Button onClick={() => alert('Add category functionality coming soon!')}>\r\n                <Plus size={18} style={{ marginRight: '0.5rem' }} />\r\n                Add Category\r\n              </Button>\r\n              <Button onClick={() => alert('Add item functionality coming soon!')}>\r\n                <Plus size={18} style={{ marginRight: '0.5rem' }} />\r\n                Add Item\r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Search */}\r\n          <div style={{\r\n            background: 'white',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '8px',\r\n            padding: '1.5rem',\r\n            marginBottom: '2rem'\r\n          }}>\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', maxWidth: '400px' }}>\r\n              <Search size={18} style={{ color: '#64748b' }} />\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Search menu items...\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                style={{\r\n                  flex: 1,\r\n                  padding: '0.5rem 0.75rem',\r\n                  border: '1px solid #d1d5db',\r\n                  borderRadius: '6px',\r\n                  fontSize: '0.875rem'\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Menu Items Grid */}\r\n          {loading ? (\r\n            <div style={{ textAlign: 'center', padding: '3rem' }}>\r\n              Loading menu...\r\n            </div>\r\n          ) : filteredItems.length === 0 ? (\r\n            <div style={{\r\n              textAlign: 'center',\r\n              padding: '3rem',\r\n              border: '2px dashed #e2e8f0',\r\n              borderRadius: '8px'\r\n            }}>\r\n              <ChefHat size={48} style={{ color: '#cbd5e1', marginBottom: '1rem' }} />\r\n              <h3 style={{ fontSize: '1.25rem', fontWeight: '600', marginBottom: '0.5rem' }}>\r\n                No Menu Items Found\r\n              </h3>\r\n              <p style={{ color: '#64748b' }}>\r\n                {searchTerm ? 'No items match your search.' : 'Start by adding menu categories and items.'}\r\n              </p>\r\n            </div>\r\n          ) : (\r\n            <div style={{\r\n              display: 'grid',\r\n              gridTemplateColumns: 'repeat(auto-fill, minmax(300px, 1fr))',\r\n              gap: '1.5rem'\r\n            }}>\r\n              {filteredItems.map((item) => {\r\n                const category = categories.find(c => c.id === item.categoryId);\r\n                return (\r\n                  <div\r\n                    key={item.id}\r\n                    style={{\r\n                      background: 'white',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '12px',\r\n                      overflow: 'hidden'\r\n                    }}\r\n                  >\r\n                    {item.imageUrl && (\r\n                      <div style={{\r\n                        height: '150px',\r\n                        backgroundImage: `url(${item.imageUrl})`,\r\n                        backgroundSize: 'cover',\r\n                        backgroundPosition: 'center'\r\n                      }} />\r\n                    )}\r\n\r\n                    <div style={{ padding: '1.5rem' }}>\r\n                      <div style={{\r\n                        display: 'flex',\r\n                        justifyContent: 'space-between',\r\n                        alignItems: 'flex-start',\r\n                        marginBottom: '0.75rem'\r\n                      }}>\r\n                        <div>\r\n                          <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '0.25rem' }}>\r\n                            {item.name}\r\n                          </h3>\r\n                          <p style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n                            {category?.name}\r\n                          </p>\r\n                        </div>\r\n                        <div style={{ fontSize: '1.25rem', fontWeight: 'bold', color: '#1f2937' }}>\r\n                          {formatCurrency(item.price)}\r\n                        </div>\r\n                      </div>\r\n\r\n                      {item.description && (\r\n                        <p style={{\r\n                          fontSize: '0.875rem',\r\n                          color: '#64748b',\r\n                          marginBottom: '1rem',\r\n                          lineHeight: '1.4'\r\n                        }}>\r\n                          {item.description}\r\n                        </p>\r\n                      )}\r\n\r\n                      {/* Dietary Info */}\r\n                      <div style={{\r\n                        display: 'flex',\r\n                        flexWrap: 'wrap',\r\n                        gap: '0.5rem',\r\n                        marginBottom: '1rem'\r\n                      }}>\r\n                        {item.isVegetarian && (\r\n                          <span style={{\r\n                            padding: '0.125rem 0.5rem',\r\n                            background: '#dcfce7',\r\n                            color: '#166534',\r\n                            borderRadius: '4px',\r\n                            fontSize: '0.75rem',\r\n                            fontWeight: '500'\r\n                          }}>\r\n                            Vegetarian\r\n                          </span>\r\n                        )}\r\n                        {item.isVegan && (\r\n                          <span style={{\r\n                            padding: '0.125rem 0.5rem',\r\n                            background: '#dcfce7',\r\n                            color: '#166534',\r\n                            borderRadius: '4px',\r\n                            fontSize: '0.75rem',\r\n                            fontWeight: '500'\r\n                          }}>\r\n                            Vegan\r\n                          </span>\r\n                        )}\r\n                        {item.isGlutenFree && (\r\n                          <span style={{\r\n                            padding: '0.125rem 0.5rem',\r\n                            background: '#dbeafe',\r\n                            color: '#1e40af',\r\n                            borderRadius: '4px',\r\n                            fontSize: '0.75rem',\r\n                            fontWeight: '500'\r\n                          }}>\r\n                            Gluten Free\r\n                          </span>\r\n                        )}\r\n                        {item.spiceLevel !== 'mild' && (\r\n                          <span style={{\r\n                            padding: '0.125rem 0.5rem',\r\n                            background: `${getSpiceLevelColor(item.spiceLevel)}20`,\r\n                            color: getSpiceLevelColor(item.spiceLevel),\r\n                            borderRadius: '4px',\r\n                            fontSize: '0.75rem',\r\n                            fontWeight: '500'\r\n                          }}>\r\n                            {item.spiceLevel.replace('_', ' ').toUpperCase()}\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n\r\n                      <div style={{\r\n                        display: 'flex',\r\n                        justifyContent: 'space-between',\r\n                        alignItems: 'center'\r\n                      }}>\r\n                        <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n                          {item.preparationTime && (\r\n                            <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem', fontSize: '0.875rem', color: '#64748b' }}>\r\n                              <Clock size={14} />\r\n                              {item.preparationTime}min\r\n                            </div>\r\n                          )}\r\n                          <span style={{\r\n                            padding: '0.125rem 0.5rem',\r\n                            borderRadius: '9999px',\r\n                            fontSize: '0.75rem',\r\n                            fontWeight: '500',\r\n                            background: item.isActive ? '#dcfce7' : '#fee2e2',\r\n                            color: item.isActive ? '#166534' : '#991b1b'\r\n                          }}>\r\n                            {item.isActive ? 'Active' : 'Inactive'}\r\n                          </span>\r\n                        </div>\r\n\r\n                        <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n                          <Button variant=\"ghost\" size=\"sm\">\r\n                            <Edit size={16} />\r\n                          </Button>\r\n                          <Button variant=\"ghost\" size=\"sm\" style={{ color: '#ef4444' }}>\r\n                            <Trash2 size={16} />\r\n                          </Button>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Analytics Tab */}\r\n      {activeTab === 'analytics' && (\r\n        <div>\r\n          <h2 style={{ fontSize: '1.5rem', fontWeight: '600', marginBottom: '1.5rem' }}>\r\n            Room Service Analytics\r\n          </h2>\r\n\r\n          <div style={{\r\n            textAlign: 'center',\r\n            padding: '3rem',\r\n            border: '2px dashed #e2e8f0',\r\n            borderRadius: '8px'\r\n          }}>\r\n            <DollarSign size={48} style={{ color: '#cbd5e1', marginBottom: '1rem' }} />\r\n            <h3 style={{ fontSize: '1.25rem', fontWeight: '600', marginBottom: '0.5rem' }}>\r\n              Analytics Coming Soon\r\n            </h3>\r\n            <p style={{ color: '#64748b' }}>\r\n              Advanced analytics and reporting features will be available here\r\n            </p>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\RoomsPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchCategories', 'fetchLatestReport', 'fetchRatePlans', 'fetchRooms', and 'pagination.limit'. Either include them or remove the dependency array.","line":201,"column":6,"nodeType":"ArrayExpression","endLine":201,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [fetchCategories, fetchLatestReport, fetchRatePlans, fetchRooms, pagination.limit, user?.tenantId]","fix":{"range":[6782,6798],"text":"[fetchCategories, fetchLatestReport, fetchRatePlans, fetchRooms, pagination.limit, user?.tenantId]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchRooms', 'loading', 'pagination.limit', and 'user?.tenantId'. Either include them or remove the dependency array.","line":223,"column":6,"nodeType":"ArrayExpression","endLine":223,"endColumn":51,"suggestions":[{"desc":"Update the dependencies array to be: [fetchRooms, loading, pagination.limit, selectedCategoryFilter, selectedFloorFilter, user?.tenantId]","fix":{"range":[7556,7601],"text":"[fetchRooms, loading, pagination.limit, selectedCategoryFilter, selectedFloorFilter, user?.tenantId]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'statusLabels'. Either include it or remove the dependency array.","line":441,"column":6,"nodeType":"ArrayExpression","endLine":448,"endColumn":4,"suggestions":[{"desc":"Update the dependencies array to be: [searchTerm, selectedCategoryFilter, selectedFloorFilter, selectedRoomTypeFilter, selectedStatusFilter, categories, statusLabels]","fix":{"range":[14651,14802],"text":"[searchTerm, selectedCategoryFilter, selectedFloorFilter, selectedRoomTypeFilter, selectedStatusFilter, categories, statusLabels]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'accountabilityThresholdMs'. Either include it or remove the dependency array.","line":480,"column":6,"nodeType":"ArrayExpression","endLine":480,"endColumn":13,"suggestions":[{"desc":"Update the dependencies array to be: [accountabilityThresholdMs, rooms]","fix":{"range":[15879,15886],"text":"[accountabilityThresholdMs, rooms]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'boardStatuses'. Either include it or remove the dependency array.","line":492,"column":6,"nodeType":"ArrayExpression","endLine":492,"endColumn":13,"suggestions":[{"desc":"Update the dependencies array to be: [boardStatuses, rooms]","fix":{"range":[16213,16220],"text":"[boardStatuses, rooms]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'editingCategory'. Either include it or remove the dependency array.","line":2109,"column":6,"nodeType":"ArrayExpression","endLine":2109,"endColumn":27,"suggestions":[{"desc":"Update the dependencies array to be: [editingCategory, editingCategory.id]","fix":{"range":[80674,80695],"text":"[editingCategory, editingCategory.id]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useMemo, useState, useCallback } from 'react';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Layout from '../components/Layout';\r\nimport { Plus, DoorOpen, Tag, X, Edit, Trash2 } from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\nimport { CardSkeleton } from '../components/LoadingSkeleton';\r\nimport SearchInput from '../components/SearchInput';\r\nimport Pagination from '../components/Pagination';\r\nimport { useDebounce } from '../hooks/useDebounce';\r\nimport EmptyState from '../components/EmptyState';\r\n\r\ninterface RoomCategory {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  totalRooms?: number;\r\n  actualRoomCount: number;\r\n  color?: string;\r\n  minPrice?: number | null;\r\n  maxPrice?: number | null;\r\n}\r\n\r\ninterface Room {\r\n  id: string;\r\n  roomNumber: string;\r\n  roomType: string;\r\n  floor: number;\r\n  status: string;\r\n  maxOccupancy: number;\r\n  description?: string;\r\n  categoryId?: string | null;\r\n  category?: {\r\n    id: string;\r\n    name: string;\r\n  };\r\n  ratePlan?: {\r\n    id: string;\r\n    name: string;\r\n    baseRate: number | null;\r\n  } | null;\r\n  ratePlanId?: string | null;\r\n  customRate?: number | null;\r\n  effectiveRate?: number | null;\r\n  lastLogType?: string | null;\r\n  lastLogSummary?: string | null;\r\n  lastLogUserName?: string | null;\r\n  lastLogAt?: string | Date | null;\r\n}\r\n\r\ninterface RoomLog {\r\n  id: string;\r\n  type: string;\r\n  summary: string;\r\n  details?: string | null;\r\n  metadata?: Record<string, any> | null;\r\n  user?: {\r\n    id?: string | null;\r\n    name?: string | null;\r\n  } | null;\r\n  createdAt: string;\r\n}\r\n\r\nexport default function RoomsPage() {\r\n  const { user } = useAuthStore();\r\n  const [rooms, setRooms] = useState<Room[]>([]);\r\n  const [categories, setCategories] = useState<RoomCategory[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [ratePlans, setRatePlans] = useState<Array<{ id: string; name: string; baseRate: number | null }>>([]);\r\n  const [showCategoryModal, setShowCategoryModal] = useState(false);\r\n  const [rateEditRoom, setRateEditRoom] = useState<Room | null>(null);\r\n  const [editingCategory, setEditingCategory] = useState<RoomCategory | null>(null);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const debouncedSearchTerm = useDebounce(searchTerm, 500);\r\n  const [selectedCategoryFilter, setSelectedCategoryFilter] = useState<string>('');\r\n  const [selectedFloorFilter, setSelectedFloorFilter] = useState<string>('');\r\n  const [selectedRoomTypeFilter, setSelectedRoomTypeFilter] = useState<string>('');\r\n  const [selectedStatusFilter, setSelectedStatusFilter] = useState<string>('');\r\n  const [selectedRooms, setSelectedRooms] = useState<Set<string>>(new Set());\r\n  const [isBulkProcessing, setIsBulkProcessing] = useState(false);\r\n  const [showActivityModal, setShowActivityModal] = useState(false);\r\n  const [activityRoom, setActivityRoom] = useState<Room | null>(null);\r\n  const [roomLogs, setRoomLogs] = useState<RoomLog[]>([]);\r\n  const [roomLogsLoading, setRoomLogsLoading] = useState(false);\r\n  const [roomLogsPagination, setRoomLogsPagination] = useState({\r\n    page: 1,\r\n    limit: 10,\r\n    total: 0,\r\n    totalPages: 1,\r\n    hasNext: false,\r\n    hasPrev: false,\r\n  });\r\n  const [pagination, setPagination] = useState({\r\n    page: 1,\r\n    limit: 50, // Increased from 20 to reduce pagination overhead\r\n    total: 0,\r\n    totalPages: 1,\r\n    hasNext: false,\r\n    hasPrev: false,\r\n  });\r\n  const [latestReport, setLatestReport] = useState<any>(null);\r\n\r\n  const fetchRooms = useCallback(async (page = 1, limit = pagination.limit, showLoading = false) => {\r\n    if (!user?.tenantId) return;\r\n    \r\n    // Only show full loading skeleton on initial load\r\n    if (showLoading) {\r\n      setLoading(true);\r\n    }\r\n    \r\n    try {\r\n      const response = await api.get(`/tenants/${user.tenantId}/rooms`, {\r\n        params: {\r\n          page,\r\n          limit,\r\n          categoryId:\r\n            selectedCategoryFilter && selectedCategoryFilter !== ''\r\n              ? selectedCategoryFilter === 'none'\r\n                ? 'none'\r\n                : selectedCategoryFilter\r\n              : undefined,\r\n          floor: selectedFloorFilter || undefined,\r\n        },\r\n      });\r\n      setRooms(response.data.data || []);\r\n      if (response.data.pagination) {\r\n        setPagination(response.data.pagination);\r\n      } else {\r\n        setPagination((prev) => ({\r\n          ...prev,\r\n          page,\r\n          limit,\r\n          total: response.data.data?.length || 0,\r\n          totalPages: 1,\r\n          hasNext: false,\r\n          hasPrev: false,\r\n        }));\r\n      }\r\n      setSelectedRooms(new Set());\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch rooms:', error);\r\n      toast.error(error.response?.data?.error?.message || 'Failed to fetch rooms');\r\n      setRooms([]);\r\n    } finally {\r\n      if (showLoading) {\r\n        setLoading(false);\r\n      }\r\n    }\r\n  }, [user?.tenantId, selectedCategoryFilter, selectedFloorFilter, pagination.limit]);\r\n\r\n  const fetchCategories = async () => {\r\n    try {\r\n      const response = await api.get(`/tenants/${user?.tenantId}/room-categories`);\r\n      const newCategories = response.data.data || [];\r\n      setCategories(newCategories);\r\n      \r\n      // If we're editing a category, update it with fresh data from the refetch\r\n      if (editingCategory) {\r\n        const updatedCategory = newCategories.find((cat: RoomCategory) => cat.id === editingCategory.id);\r\n        if (updatedCategory) {\r\n          setEditingCategory(updatedCategory);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch categories:', error);\r\n    }\r\n  };\r\n\r\n  const fetchLatestReport = async () => {\r\n    if (!user?.tenantId) return;\r\n    try {\r\n      const response = await api.get(`/tenants/${user.tenantId}/rooms/accountability-report/latest`);\r\n      setLatestReport(response.data.data);\r\n    } catch (error) {\r\n      console.error('Failed to fetch latest accountability report:', error);\r\n      setLatestReport(null);\r\n    }\r\n  };\r\n\r\n  // Initial data fetch - load rooms and categories in parallel\r\n  useEffect(() => {\r\n    if (!user?.tenantId) return;\r\n    \r\n    const loadInitialData = async () => {\r\n      try {\r\n        // Fetch all data in parallel for faster loading\r\n        await Promise.all([\r\n          fetchRooms(1, pagination.limit, true), // showLoading = true for initial load\r\n          fetchCategories(),\r\n          fetchLatestReport(),\r\n          fetchRatePlans(),\r\n        ]);\r\n      } catch (error) {\r\n        console.error('Failed to load initial data:', error);\r\n        setLoading(false);\r\n      }\r\n    };\r\n    \r\n    loadInitialData();\r\n  }, [user?.tenantId]);\r\n\r\n  const fetchRatePlans = async () => {\r\n    if (!user?.tenantId) return;\r\n    try {\r\n      const response = await api.get(`/tenants/${user.tenantId}/rate-plans`);\r\n      setRatePlans(\r\n        (response.data.data || []).map((plan: any) => ({\r\n          id: plan.id,\r\n          name: plan.name,\r\n          baseRate: plan.baseRate !== undefined && plan.baseRate !== null ? Number(plan.baseRate) : null,\r\n        }))\r\n      );\r\n    } catch (error) {\r\n      console.error('Failed to fetch rate plans:', error);\r\n    }\r\n  };\r\n  \r\n  // Refetch when filters change (without showing loading skeleton)\r\n  useEffect(() => {\r\n    if (!user?.tenantId || loading) return;\r\n    fetchRooms(1, pagination.limit, false); // showLoading = false for filter changes\r\n  }, [selectedCategoryFilter, selectedFloorFilter]);\r\n\r\n  const fetchRoomLogs = async (roomId: string, page = 1, limit = roomLogsPagination.limit) => {\r\n    setRoomLogsLoading(true);\r\n    try {\r\n      const response = await api.get(`/tenants/${user?.tenantId}/rooms/${roomId}/logs`, {\r\n        params: { page, limit },\r\n      });\r\n      setRoomLogs(response.data.data || []);\r\n      if (response.data.pagination) {\r\n        setRoomLogsPagination(response.data.pagination);\r\n      } else {\r\n        setRoomLogsPagination((prev) => ({\r\n          ...prev,\r\n          page,\r\n          limit,\r\n          total: response.data.data?.length || 0,\r\n          totalPages: 1,\r\n          hasNext: false,\r\n          hasPrev: false,\r\n        }));\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch room logs:', error);\r\n    } finally {\r\n      setRoomLogsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleBulkStatusUpdate = async (newStatus: string) => {\r\n    if (selectedRooms.size === 0) {\r\n      toast.error('Please select at least one room');\r\n      return;\r\n    }\r\n\r\n    const confirmMessage = `Are you sure you want to update ${selectedRooms.size} room(s) to \"${newStatus.replace('_', ' ')}\"?`;\r\n    if (!window.confirm(confirmMessage)) return;\r\n\r\n    setIsBulkProcessing(true);\r\n    const roomIds = Array.from(selectedRooms);\r\n    let successCount = 0;\r\n    let failCount = 0;\r\n\r\n    for (const roomId of roomIds) {\r\n      try {\r\n        await api.patch(`/tenants/${user?.tenantId}/rooms/${roomId}`, { status: newStatus });\r\n        successCount++;\r\n      } catch (error) {\r\n        failCount++;\r\n      }\r\n    }\r\n\r\n    setIsBulkProcessing(false);\r\n    setSelectedRooms(new Set());\r\n    fetchRooms(pagination.page);\r\n\r\n    if (failCount === 0) {\r\n      toast.success(`Successfully updated ${successCount} room(s)`);\r\n    } else {\r\n      toast.error(`Updated ${successCount}, failed ${failCount}`);\r\n    }\r\n  };\r\n\r\n  const toggleSelectRoom = (roomId: string) => {\r\n    const newSelected = new Set(selectedRooms);\r\n    if (newSelected.has(roomId)) {\r\n      newSelected.delete(roomId);\r\n    } else {\r\n      newSelected.add(roomId);\r\n    }\r\n    setSelectedRooms(newSelected);\r\n  };\r\n\r\n  const toggleSelectAll = () => {\r\n    if (selectedRooms.size === filteredRooms.length) {\r\n      setSelectedRooms(new Set());\r\n    } else {\r\n      setSelectedRooms(new Set(filteredRooms.map((r) => r.id)));\r\n    }\r\n  };\r\n\r\n  const handleViewActivity = (room: Room) => {\r\n    setActivityRoom(room);\r\n    setShowActivityModal(true);\r\n    fetchRoomLogs(room.id, 1);\r\n  };\r\n\r\n  const handleActivityPageChange = (newPage: number) => {\r\n    if (!activityRoom) return;\r\n    if (newPage < 1 || newPage > roomLogsPagination.totalPages) return;\r\n    fetchRoomLogs(activityRoom.id, newPage);\r\n  };\r\n\r\n  const closeActivityModal = () => {\r\n    setShowActivityModal(false);\r\n    setActivityRoom(null);\r\n    setRoomLogs([]);\r\n  };\r\n\r\n  const filteredRooms = useMemo(() => rooms.filter((room) => {\r\n    // Filter by search term (use debounced value for actual filtering but immediate for UI responsiveness)\r\n    if (debouncedSearchTerm) {\r\n      const searchLower = debouncedSearchTerm.toLowerCase();\r\n      const matchesSearch =\r\n        room.roomNumber.toLowerCase().includes(searchLower) ||\r\n        room.roomType.toLowerCase().includes(searchLower) ||\r\n        room.status.toLowerCase().includes(searchLower) ||\r\n        room.description?.toLowerCase().includes(searchLower) ||\r\n        room.category?.name.toLowerCase().includes(searchLower);\r\n      if (!matchesSearch) return false;\r\n    }\r\n\r\n    // Filter by category (support both legacy categoryId and populated category object)\r\n    if (selectedCategoryFilter) {\r\n      const roomCategoryId = room.categoryId || room.category?.id || null;\r\n      if (selectedCategoryFilter === 'none') {\r\n        if (roomCategoryId) return false;\r\n      } else if (!roomCategoryId || roomCategoryId !== selectedCategoryFilter) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    // Filter by room type\r\n    if (selectedRoomTypeFilter) {\r\n      if (room.roomType !== selectedRoomTypeFilter) return false;\r\n    }\r\n\r\n    // Filter by status\r\n    if (selectedStatusFilter) {\r\n      if (room.status !== selectedStatusFilter) return false;\r\n    }\r\n\r\n    // Filter by floor\r\n    if (selectedFloorFilter) {\r\n        const floorNumber = parseInt(selectedFloorFilter, 10);\r\n      if (!isNaN(floorNumber)) {\r\n        if (room.floor !== floorNumber) return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }), [rooms, debouncedSearchTerm, selectedCategoryFilter, selectedRoomTypeFilter, selectedStatusFilter, selectedFloorFilter]);\r\n\r\n  const roomTypeOptions = useMemo(() => {\r\n    return Array.from(new Set(rooms.map((room) => room.roomType).filter(Boolean)));\r\n  }, [rooms]);\r\n\r\n  const statusLabels: Record<string, string> = {\r\n    available: 'Available',\r\n    reserved: 'Reserved',\r\n    occupied: 'Occupied',\r\n    dirty: 'Dirty',\r\n    clean: 'Clean',\r\n    inspected: 'Inspected',\r\n    out_of_order: 'Out of Order',\r\n    maintenance: 'Maintenance',\r\n  };\r\n\r\n  const statusOptions = Object.keys(statusLabels);\r\n\r\n  const srOnlyStyle: React.CSSProperties = {\r\n    position: 'absolute',\r\n    width: '1px',\r\n    height: '1px',\r\n    padding: 0,\r\n    margin: '-1px',\r\n    overflow: 'hidden',\r\n    clip: 'rect(0,0,0,0)',\r\n    whiteSpace: 'nowrap',\r\n    border: 0,\r\n  };\r\n\r\n  const formatTimeAgo = (date?: Date | null) => {\r\n    if (!date) return 'No activity yet';\r\n    const now = Date.now();\r\n    const diffMs = now - date.getTime();\r\n    if (diffMs < 60 * 1000) return 'just now';\r\n    if (diffMs < 60 * 60 * 1000) return `${Math.floor(diffMs / (60 * 1000))}m ago`;\r\n    if (diffMs < 24 * 60 * 60 * 1000) return `${Math.floor(diffMs / (60 * 60 * 1000))}h ago`;\r\n    return `${Math.floor(diffMs / (24 * 60 * 60 * 1000))}d ago`;\r\n  };\r\n\r\n  const boardStatuses = [\r\n    'dirty',\r\n    'maintenance',\r\n    'inspected',\r\n    'clean',\r\n    'available',\r\n    'reserved',\r\n    'occupied',\r\n    'out_of_order',\r\n  ];\r\n\r\n  const boardRoles = ['housekeeping', 'housekeeping_manager', 'maintenance', 'front_desk'];\r\n  const canActOnBoard = boardRoles.includes(user?.role || '');\r\n\r\n  const activeFilters = useMemo(() => {\r\n    const chips: { key: string; label: string }[] = [];\r\n    if (searchTerm) {\r\n      chips.push({ key: 'search', label: `Search: ${searchTerm}` });\r\n    }\r\n    if (selectedCategoryFilter) {\r\n      const categoryLabel =\r\n        selectedCategoryFilter === 'none'\r\n          ? 'No Category'\r\n          : categories.find((cat) => cat.id === selectedCategoryFilter)?.name || 'Category';\r\n      chips.push({ key: 'category', label: `Category: ${categoryLabel}` });\r\n    }\r\n    if (selectedFloorFilter) {\r\n      chips.push({ key: 'floor', label: `Floor: ${selectedFloorFilter}` });\r\n    }\r\n    if (selectedRoomTypeFilter) {\r\n      chips.push({ key: 'roomType', label: `Room type: ${selectedRoomTypeFilter}` });\r\n    }\r\n    if (selectedStatusFilter) {\r\n      chips.push({ key: 'status', label: `Status: ${statusLabels[selectedStatusFilter] || selectedStatusFilter}` });\r\n    }\r\n    return chips;\r\n  }, [\r\n    searchTerm,\r\n    selectedCategoryFilter,\r\n    selectedFloorFilter,\r\n    selectedRoomTypeFilter,\r\n    selectedStatusFilter,\r\n    categories,\r\n  ]);\r\n\r\n  const accountabilityThresholdMs = 6 * 60 * 60 * 1000;\r\n  const accountabilityMetrics = useMemo(() => {\r\n    const now = new Date();\r\n    const staleRoomsRaw = rooms\r\n      .map((room) => ({\r\n        ...room,\r\n        parsedLastLogAt: room.lastLogAt ? new Date(room.lastLogAt) : null,\r\n      }))\r\n      .sort((a, b) => {\r\n        if (!a.parsedLastLogAt) return 1;\r\n        if (!b.parsedLastLogAt) return -1;\r\n        return a.parsedLastLogAt.getTime() - b.parsedLastLogAt.getTime();\r\n      });\r\n\r\n    const roomsStale = staleRoomsRaw.filter(\r\n      (room) => !room.parsedLastLogAt || now.getTime() - (room.parsedLastLogAt?.getTime() || 0) > accountabilityThresholdMs\r\n    );\r\n\r\n    const roomsFlagged = rooms.filter((room) =>\r\n      ['dirty', 'out_of_order', 'maintenance', 'reserved'].includes(room.status)\r\n    );\r\n\r\n    const staleRoomsList = roomsStale.slice(0, 5);\r\n\r\n    return {\r\n      staleCount: roomsStale.length,\r\n      flaggedCount: roomsFlagged.length,\r\n      noLogCount: rooms.filter((room) => !room.lastLogAt).length,\r\n      staleRoomsList,\r\n    };\r\n  }, [rooms]);\r\n\r\n  const roomsByStatus = useMemo(() => {\r\n    const groups: Record<string, Room[]> = {};\r\n    boardStatuses.forEach((status) => {\r\n      groups[status] = [];\r\n    });\r\n    rooms.forEach((room) => {\r\n      const bucket = groups[room.status] || groups.available;\r\n      bucket.push(room);\r\n    });\r\n    return groups;\r\n  }, [rooms]);\r\n\r\n  const quickStatusNext: Record<string, string> = {\r\n    dirty: 'clean',\r\n    maintenance: 'available',\r\n    clean: 'inspected',\r\n    inspected: 'available',\r\n    reserved: 'occupied',\r\n    available: 'occupied',\r\n    occupied: 'available',\r\n    out_of_order: 'maintenance',\r\n  };\r\n\r\n  const handleBoardStatusChange = async (room: Room, targetStatus: string) => {\r\n    if (!user?.tenantId) return;\r\n    try {\r\n      await api.patch(`/tenants/${user.tenantId}/rooms/${room.id}`, {\r\n        status: targetStatus,\r\n      });\r\n      toast.success(`Room ${room.roomNumber} marked ${statusLabels[targetStatus] || targetStatus}`);\r\n      // Refetch via Rooms pages fetchRooms (triggers RoomsPage state)\r\n      fetchRooms(pagination.page);\r\n    } catch (error: any) {\r\n      toast.error(error.response?.data?.error?.message || 'Unable to update status');\r\n    }\r\n  };\r\n\r\n  const clearFilter = (key: string) => {\r\n    if (key === 'search') {\r\n      setSearchTerm('');\r\n    } else if (key === 'category') {\r\n      setSelectedCategoryFilter('');\r\n    } else if (key === 'floor') {\r\n      setSelectedFloorFilter('');\r\n    } else if (key === 'roomType') {\r\n      setSelectedRoomTypeFilter('');\r\n    } else if (key === 'status') {\r\n      setSelectedStatusFilter('');\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    const colors: Record<string, string> = {\r\n      available: '#10b981',\r\n      reserved: '#f59e0b',\r\n      occupied: '#3b82f6',\r\n      dirty: '#f59e0b',\r\n      clean: '#8b5cf6',\r\n      inspected: '#06b6d4',\r\n      out_of_order: '#ef4444',\r\n      maintenance: '#f97316',\r\n    };\r\n    return colors[status] || '#94a3b8';\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Layout>\r\n        <div>\r\n          <h1 style={{ marginBottom: '1.5rem', color: '#1e293b' }}>Rooms</h1>\r\n          <CardSkeleton count={6} />\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  const handleDeleteCategory = async (categoryId: string) => {\r\n    if (!window.confirm('Are you sure you want to delete this category? Rooms assigned to it will not be deleted.')) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await api.delete(`/tenants/${user?.tenantId}/room-categories/${categoryId}`);\r\n      toast.success('Category deleted successfully');\r\n      fetchCategories();\r\n      // Clear category filter if it was selected\r\n      if (selectedCategoryFilter === categoryId) {\r\n        setSelectedCategoryFilter('');\r\n      }\r\n    } catch (error: any) {\r\n      // Error handled by API interceptor\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Layout>\r\n      <div>\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <h1 style={{ color: '#1e293b' }}>Rooms</h1>\r\n          <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n            <button\r\n              onClick={() => {\r\n                setEditingCategory(null);\r\n                setShowCategoryModal(true);\r\n              }}\r\n              style={{\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: '0.5rem',\r\n                padding: '0.75rem 1.5rem',\r\n                background: '#8b5cf6',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '6px',\r\n                cursor: 'pointer',\r\n                fontWeight: '500',\r\n              }}\r\n            >\r\n              <Tag size={20} />\r\n              Manage Categories\r\n            </button>\r\n            <button\r\n              onClick={() => setShowCreateModal(true)}\r\n              style={{\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: '0.5rem',\r\n                padding: '0.75rem 1.5rem',\r\n                background: '#3b82f6',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '6px',\r\n                cursor: 'pointer',\r\n                fontWeight: '500',\r\n              }}\r\n            >\r\n              <Plus size={20} />\r\n              Add Room\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {selectedRooms.size > 0 && (\r\n          <div\r\n            style={{\r\n              background: '#dbeafe',\r\n              padding: '1rem',\r\n              borderRadius: '8px',\r\n              marginBottom: '1.5rem',\r\n              display: 'flex',\r\n              justifyContent: 'space-between',\r\n              alignItems: 'center',\r\n            }}\r\n          >\r\n            <span style={{ color: '#1e40af', fontWeight: '500' }}>\r\n              {selectedRooms.size} room{selectedRooms.size !== 1 ? 's' : ''} selected\r\n            </span>\r\n            <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>\r\n              <select\r\n                onChange={(e) => {\r\n                  if (e.target.value) {\r\n                    handleBulkStatusUpdate(e.target.value);\r\n                    e.target.value = '';\r\n                  }\r\n                }}\r\n                disabled={isBulkProcessing}\r\n                style={{\r\n                  padding: '0.5rem 1rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '4px',\r\n                  fontSize: '0.875rem',\r\n                  cursor: isBulkProcessing ? 'not-allowed' : 'pointer',\r\n                }}\r\n              >\r\n                <option value=\"\">Update Status To...</option>\r\n                <option value=\"available\">Available</option>\r\n                <option value=\"clean\">Clean</option>\r\n                <option value=\"dirty\">Dirty</option>\r\n                <option value=\"inspected\">Inspected</option>\r\n                <option value=\"out_of_order\">Out of Order</option>\r\n                <option value=\"maintenance\">Maintenance</option>\r\n              </select>\r\n              <button\r\n                onClick={() => setSelectedRooms(new Set())}\r\n                style={{\r\n                  padding: '0.5rem 1rem',\r\n                  background: '#f1f5f9',\r\n                  color: '#475569',\r\n                  border: 'none',\r\n                  borderRadius: '4px',\r\n                  cursor: 'pointer',\r\n                  fontSize: '0.875rem',\r\n                }}\r\n              >\r\n                Clear Selection\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div style={{ marginBottom: '1.5rem', display: 'flex', gap: '1rem', alignItems: 'center', flexWrap: 'wrap' }}>\r\n          <div style={{ flex: 1 }}>\r\n            <SearchInput\r\n              value={searchTerm}\r\n              onChange={setSearchTerm}\r\n              placeholder=\"Search by room number, type, status, or description...\"\r\n            />\r\n          </div>\r\n          <select\r\n            value={selectedCategoryFilter}\r\n            onChange={(e) => setSelectedCategoryFilter(e.target.value)}\r\n            style={{\r\n              padding: '0.75rem',\r\n              border: '1px solid #cbd5e1',\r\n              borderRadius: '6px',\r\n              fontSize: '0.875rem',\r\n              cursor: 'pointer',\r\n              minWidth: '200px',\r\n            }}\r\n          >\r\n            <option value=\"\">All Categories</option>\r\n            <option value=\"none\">No Category</option>\r\n            {categories.map((cat) => (\r\n              <option key={cat.id} value={cat.id}>\r\n                {cat.name} ({cat.actualRoomCount})\r\n              </option>\r\n            ))}\r\n          </select>\r\n          <select\r\n            value={selectedRoomTypeFilter}\r\n            onChange={(e) => setSelectedRoomTypeFilter(e.target.value)}\r\n            style={{\r\n              padding: '0.75rem',\r\n              border: '1px solid #cbd5e1',\r\n              borderRadius: '6px',\r\n              fontSize: '0.875rem',\r\n              cursor: 'pointer',\r\n              minWidth: '150px',\r\n            }}\r\n          >\r\n            <option value=\"\">All Room Types</option>\r\n            {roomTypeOptions.map((type) => (\r\n              <option key={type} value={type}>\r\n                {type}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          <select\r\n            value={selectedStatusFilter}\r\n            onChange={(e) => setSelectedStatusFilter(e.target.value)}\r\n            style={{\r\n              padding: '0.75rem',\r\n              border: '1px solid #cbd5e1',\r\n              borderRadius: '6px',\r\n              fontSize: '0.875rem',\r\n              cursor: 'pointer',\r\n              minWidth: '150px',\r\n            }}\r\n          >\r\n            <option value=\"\">All Statuses</option>\r\n            {statusOptions.map((status) => (\r\n              <option key={status} value={status}>\r\n                {statusLabels[status]}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          <input\r\n            type=\"number\"\r\n            value={selectedFloorFilter}\r\n            onChange={(e) => setSelectedFloorFilter(e.target.value)}\r\n            placeholder=\"Floor\"\r\n            style={{\r\n              padding: '0.75rem',\r\n              border: '1px solid #cbd5e1',\r\n              borderRadius: '6px',\r\n              fontSize: '0.875rem',\r\n              minWidth: '120px',\r\n            }}\r\n          />\r\n          {(searchTerm || selectedCategoryFilter || selectedFloorFilter || selectedRoomTypeFilter || selectedStatusFilter) && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => {\r\n                setSearchTerm('');\r\n                setSelectedCategoryFilter('');\r\n                setSelectedFloorFilter('');\r\n                setSelectedRoomTypeFilter('');\r\n                setSelectedStatusFilter('');\r\n              }}\r\n              style={{\r\n                padding: '0.75rem 1rem',\r\n                border: '1px solid #cbd5e1',\r\n                borderRadius: '6px',\r\n                background: '#f8fafc',\r\n                color: '#475569',\r\n                cursor: 'pointer',\r\n                fontSize: '0.875rem',\r\n              }}\r\n            >\r\n              Clear Filters\r\n            </button>\r\n          )}\r\n        </div>\r\n        {activeFilters.length > 0 && (\r\n          <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>\r\n            {activeFilters.map((filter) => (\r\n              <span\r\n                key={filter.key}\r\n                style={{\r\n                  display: 'inline-flex',\r\n                  alignItems: 'center',\r\n                  gap: '0.35rem',\r\n                  padding: '0.35rem 0.75rem',\r\n                  borderRadius: '999px',\r\n                  background: '#eef2ff',\r\n                  color: '#312e81',\r\n                  fontSize: '0.75rem',\r\n                  fontWeight: 500,\r\n                }}\r\n              >\r\n                {filter.label}\r\n                <button\r\n                  onClick={() => clearFilter(filter.key)}\r\n                  style={{\r\n                    border: 'none',\r\n                    background: 'transparent',\r\n                    cursor: 'pointer',\r\n                    fontSize: '0.8rem',\r\n                    color: '#312e81',\r\n                    padding: 0,\r\n                  }}\r\n                  aria-label={`Clear ${filter.label} filter`}\r\n                >\r\n                  \r\n                </button>\r\n              </span>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {rooms.length > 0 && (\r\n          <section\r\n            style={{\r\n              marginBottom: '1.5rem',\r\n              background: 'white',\r\n              borderRadius: '12px',\r\n              border: '1px solid #e2e8f0',\r\n              padding: '1.25rem',\r\n            }}\r\n          >\r\n            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'baseline', marginBottom: '1rem', flexWrap: 'wrap', gap: '1rem' }}>\r\n              <div>\r\n                <h2 style={{ margin: 0, fontSize: '1.125rem', color: '#0f172a' }}>Room accountability snapshot</h2>\r\n                <p style={{ margin: '0.25rem 0 0 0', color: '#475569', fontSize: '0.85rem' }}>\r\n                  Rooms with stale logs, flagged statuses, and missing accountability details.\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit,minmax(180px,1fr))', gap: '0.75rem', marginBottom: '1rem' }}>\r\n              <div style={{ padding: '1rem', borderRadius: '8px', background: '#fdf2f8', border: '1px solid #f5d0fe' }}>\r\n                <div style={{ fontSize: '1.25rem', fontWeight: '600', color: '#be185d' }}>{accountabilityMetrics.staleCount}</div>\r\n                <div style={{ fontSize: '0.85rem', color: '#6b21a8' }}>Rooms with no log in 6h</div>\r\n              </div>\r\n              <div style={{ padding: '1rem', borderRadius: '8px', background: '#eef2ff', border: '1px solid #bfdbfe' }}>\r\n                <div style={{ fontSize: '1.25rem', fontWeight: '600', color: '#1d4ed8' }}>{accountabilityMetrics.flaggedCount}</div>\r\n                <div style={{ fontSize: '0.85rem', color: '#1e3a8a' }}>Rooms flagged dirty/reserved/maintenance</div>\r\n              </div>\r\n              <div style={{ padding: '1rem', borderRadius: '8px', background: '#ecfccb', border: '1px solid #bef264' }}>\r\n                <div style={{ fontSize: '1.25rem', fontWeight: '600', color: '#15803d' }}>{accountabilityMetrics.noLogCount}</div>\r\n                <div style={{ fontSize: '0.85rem', color: '#166534' }}>Rooms never logged</div>\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <h3 style={{ margin: '0 0 0.75rem 0', color: '#0f172a', fontSize: '1rem', fontWeight: '600' }}>Most overdue rooms</h3>\r\n              {accountabilityMetrics.staleRoomsList.length === 0 ? (\r\n                <p style={{ margin: 0, color: '#475569', fontSize: '0.85rem' }}>All rooms have fresh logs.</p>\r\n              ) : (\r\n                <div style={{ overflowX: 'auto' }}>\r\n                  <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n                    <thead>\r\n                      <tr>\r\n                        <th style={{ textAlign: 'left', padding: '0.5rem 0', borderBottom: '1px solid #e5e7eb', fontSize: '0.75rem', color: '#475569' }}>Room</th>\r\n                        <th style={{ textAlign: 'left', padding: '0.5rem 0', borderBottom: '1px solid #e5e7eb', fontSize: '0.75rem', color: '#475569' }}>Status</th>\r\n                        <th style={{ textAlign: 'left', padding: '0.5rem 0', borderBottom: '1px solid #e5e7eb', fontSize: '0.75rem', color: '#475569' }}>Last action</th>\r\n                        <th style={{ textAlign: 'left', padding: '0.5rem 0', borderBottom: '1px solid #e5e7eb', fontSize: '0.75rem', color: '#475569' }}>Responsible</th>\r\n                        <th style={{ textAlign: 'right', padding: '0.5rem 0', borderBottom: '1px solid #e5e7eb' }} />\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {accountabilityMetrics.staleRoomsList.map((room) => (\r\n                        <tr key={room.id} style={{ borderBottom: '1px solid #f1f5f9' }}>\r\n                          <td style={{ padding: '0.5rem 0' }}>\r\n                            <strong>Room {room.roomNumber}</strong>\r\n                            <div style={{ fontSize: '0.75rem', color: '#475569' }}>\r\n                              Last logged {formatTimeAgo(room.parsedLastLogAt)}\r\n                            </div>\r\n                          </td>\r\n                          <td style={{ padding: '0.5rem 0' }}>\r\n                            <span\r\n                              style={{\r\n                                padding: '0.25rem 0.5rem',\r\n                                borderRadius: '999px',\r\n                                background: `${getStatusColor(room.status)}20`,\r\n                                color: getStatusColor(room.status),\r\n                                fontSize: '0.75rem',\r\n                                fontWeight: 600,\r\n                              }}\r\n                            >\r\n                              {room.status.replace('_', ' ').toUpperCase()}\r\n                            </span>\r\n                          </td>\r\n                          <td style={{ padding: '0.5rem 0', color: '#475569', fontSize: '0.85rem' }}>\r\n                            {room.lastLogSummary || 'No log yet'}\r\n                          </td>\r\n                          <td style={{ padding: '0.5rem 0', color: '#475569', fontSize: '0.85rem' }}>\r\n                            {room.lastLogUserName || 'Unassigned'}\r\n                          </td>\r\n                          <td style={{ padding: '0.5rem 0', textAlign: 'right' }}>\r\n                            <button\r\n                              onClick={() => handleViewActivity(room)}\r\n                              style={{\r\n                                padding: '0.25rem 0.75rem',\r\n                                borderRadius: '6px',\r\n                                border: '1px solid #cbd5e1',\r\n                                background: '#fff',\r\n                                cursor: 'pointer',\r\n                                fontSize: '0.75rem',\r\n                              }}\r\n                            >\r\n                              View history\r\n                            </button>\r\n                          </td>\r\n                        </tr>\r\n                      ))}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </section>\r\n        )}\r\n\r\n        {latestReport && (\r\n          <section\r\n            style={{\r\n              marginBottom: '1.5rem',\r\n              background: '#0f172a',\r\n              borderRadius: '12px',\r\n              color: 'white',\r\n              padding: '1rem',\r\n            }}\r\n          >\r\n            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', flexWrap: 'wrap', gap: '0.5rem' }}>\r\n              <div>\r\n                <h3 style={{ margin: 0 }}>Latest accountability snapshot</h3>\r\n                <p style={{ margin: '0.25rem 0 0 0', fontSize: '0.85rem', color: '#cbd5f5' }}>\r\n                  Generated on {new Date(latestReport.lastReportAt?.seconds ? latestReport.lastReportAt.seconds * 1000 : latestReport.lastReportAt)?.toLocaleString() || 'unknown'}\r\n                </p>\r\n              </div>\r\n              <span style={{ fontSize: '0.8rem', color: '#cbd5f5' }}>\r\n                Generated by {latestReport.generatedBy || 'system'}\r\n              </span>\r\n            </div>\r\n            <div style={{ display: 'flex', gap: '1rem', flexWrap: 'wrap', marginTop: '0.75rem' }}>\r\n              <div>\r\n                <strong style={{ fontSize: '1.1rem' }}>{latestReport.staleCount}</strong>\r\n                <p style={{ margin: '0.15rem 0 0 0', color: '#cbd5f5', fontSize: '0.85rem' }}>Rooms without a recent log</p>\r\n              </div>\r\n              <div>\r\n                <strong style={{ fontSize: '1.1rem' }}>{latestReport.flaggedCount}</strong>\r\n                <p style={{ margin: '0.15rem 0 0 0', color: '#cbd5f5', fontSize: '0.85rem' }}>Rooms flagged dirty/reserved/maintenance</p>\r\n              </div>\r\n              <div>\r\n                <strong style={{ fontSize: '1.1rem' }}>{latestReport.noLogCount}</strong>\r\n                <p style={{ margin: '0.15rem 0 0 0', color: '#cbd5f5', fontSize: '0.85rem' }}>Rooms lacking any logs</p>\r\n              </div>\r\n            </div>\r\n          </section>\r\n        )}\r\n\r\n        {rooms.length > 0 && (\r\n          <section\r\n            style={{\r\n              marginBottom: '1.5rem',\r\n              background: 'white',\r\n              borderRadius: '12px',\r\n              border: '1px solid #e2e8f0',\r\n              padding: '1.25rem',\r\n            }}\r\n          >\r\n            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'baseline', marginBottom: '1rem', flexWrap: 'wrap', gap: '1rem' }}>\r\n              <div>\r\n                <h2 style={{ margin: 0, fontSize: '1.125rem', color: '#0f172a' }}>Status board</h2>\r\n                <p style={{ margin: '0.25rem 0 0 0', color: '#475569', fontSize: '0.85rem' }}>\r\n                  Rooms organized by current status. Quick actions let staff move rooms through the workflow.\r\n                </p>\r\n              </div>\r\n              <span style={{ color: '#475569', fontSize: '0.85rem' }}>Role: {user?.role || 'Unknown'}</span>\r\n            </div>\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(220px, 1fr))', gap: '0.75rem' }}>\r\n              {boardStatuses.map((status) => (\r\n                <div key={status} style={{ borderRadius: '8px', border: '1px solid #e5e7eb', padding: '0.75rem', background: '#f8fafc' }}>\r\n                  <h3 style={{ margin: 0, fontSize: '0.95rem', color: '#0f172a' }}>{statusLabels[status]}</h3>\r\n                  <p style={{ margin: '0.35rem 0 0 0', color: '#475569', fontSize: '0.75rem' }}>\r\n                    {roomsByStatus[status]?.length || 0} room{roomsByStatus[status]?.length === 1 ? '' : 's'}\r\n                  </p>\r\n                  <div style={{ marginTop: '0.75rem', display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>\r\n                    {(roomsByStatus[status] ?? []).slice(0, 4).map((room) => (\r\n                      <div\r\n                        key={room.id}\r\n                        style={{\r\n                          padding: '0.5rem',\r\n                          borderRadius: '6px',\r\n                          border: '1px solid rgba(126, 145, 191, 0.3)',\r\n                          background: '#fff',\r\n                          display: 'flex',\r\n                          flexDirection: 'column',\r\n                          gap: '0.25rem',\r\n                        }}\r\n                      >\r\n                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'baseline' }}>\r\n                          <strong style={{ color: '#1e293b' }}>Room {room.roomNumber}</strong>\r\n                          <span style={{ fontSize: '0.75rem', color: '#475569' }}>\r\n                            {formatTimeAgo(room.lastLogAt ? new Date(room.lastLogAt) : undefined)}\r\n                          </span>\r\n                        </div>\r\n                        <div style={{ fontSize: '0.8rem', color: '#475569' }}>\r\n                          {room.lastLogSummary || 'No log entry yet'}\r\n                        </div>\r\n                        <div style={{ display: 'flex', gap: '0.4rem', alignItems: 'center' }}>\r\n                          <span style={{ fontSize: '0.75rem', color: '#475569' }}>\r\n                            {room.lastLogUserName || 'Unassigned'}\r\n                          </span>\r\n                          <button\r\n                            onClick={() => handleViewActivity(room)}\r\n                            style={{\r\n                              marginLeft: 'auto',\r\n                              border: 'none',\r\n                              background: 'transparent',\r\n                              color: '#1d4ed8',\r\n                              cursor: 'pointer',\r\n                              fontSize: '0.75rem',\r\n                            }}\r\n                          >\r\n                            History\r\n                          </button>\r\n                        </div>\r\n                        {canActOnBoard && quickStatusNext[room.status] && (\r\n                          <button\r\n                            onClick={() => handleBoardStatusChange(room, quickStatusNext[room.status])}\r\n                            style={{\r\n                              marginTop: '0.25rem',\r\n                              padding: '0.35rem 0.65rem',\r\n                              borderRadius: '4px',\r\n                              border: '1px solid #cbd5e1',\r\n                              background: '#f8fafc',\r\n                              fontSize: '0.75rem',\r\n                              cursor: 'pointer',\r\n                            }}\r\n                          >\r\n                            Mark as {statusLabels[quickStatusNext[room.status]] || quickStatusNext[room.status]}\r\n                          </button>\r\n                        )}\r\n                      </div>\r\n                    ))}\r\n                    {(roomsByStatus[status] ?? []).length > 4 && (\r\n                      <span style={{ fontSize: '0.7rem', color: '#475569' }}>\r\n                        +{(roomsByStatus[status] ?? []).length - 4} more\r\n                      </span>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </section>\r\n        )}\r\n\r\n        <div style={{ marginBottom: '1rem', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={selectedRooms.size === filteredRooms.length && filteredRooms.length > 0}\r\n            onChange={toggleSelectAll}\r\n            style={{ cursor: 'pointer' }}\r\n          />\r\n          <span style={{ fontSize: '0.875rem', color: '#64748b' }}>\r\n            Select All ({filteredRooms.length} rooms)\r\n          </span>\r\n        </div>\r\n\r\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(300px, 1fr))', gap: '1.5rem' }}>\r\n          {filteredRooms.map((room) => (\r\n            <div\r\n              key={room.id}\r\n              style={{\r\n                background: 'white',\r\n                borderRadius: '8px',\r\n                padding: '1.5rem',\r\n                boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n                borderLeft: `4px solid ${getStatusColor(room.status)}`,\r\n                border: selectedRooms.has(room.id) ? `2px solid #3b82f6` : undefined,\r\n              }}\r\n            >\r\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start', marginBottom: '1rem' }}>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={selectedRooms.has(room.id)}\r\n                  onChange={() => toggleSelectRoom(room.id)}\r\n                  style={{ cursor: 'pointer', marginTop: '0.25rem' }}\r\n                />\r\n                <div style={{ flex: 1, marginLeft: '0.5rem' }}>\r\n                  <h3 style={{ margin: 0, color: '#1e293b', fontSize: '1.25rem', fontWeight: 'bold' }}>\r\n                    Room {room.roomNumber}\r\n                  </h3>\r\n                  <p style={{ margin: '0.25rem 0 0 0', color: '#64748b', fontSize: '0.875rem' }}>\r\n                    {room.roomType}  Floor {room.floor}\r\n                    {room.category && (() => {\r\n                      const categoryData = categories.find(cat => cat.id === room.category?.id);\r\n                      const categoryColor = categoryData?.color || '#8b5cf6';\r\n                      return (\r\n                        <span style={{ marginLeft: '0.5rem', display: 'inline-flex', alignItems: 'center', gap: '0.25rem' }}>\r\n                          <span\r\n                            role=\"img\"\r\n                            aria-label={`Category color ${room.category?.name}`}\r\n                            style={{\r\n                              display: 'inline-block',\r\n                              width: '8px',\r\n                              height: '8px',\r\n                              borderRadius: '50%',\r\n                              background: categoryColor,\r\n                            }}\r\n                          >\r\n                            <span style={srOnlyStyle}>{categoryColor}</span>\r\n                          </span>\r\n                          <span style={{ color: categoryColor, fontWeight: '500' }}>\r\n                            {room.category.name}\r\n                          </span>\r\n                        </span>\r\n                      );\r\n                    })()}\r\n                  </p>\r\n                  {room.description && (\r\n                    <p style={{ margin: '0.5rem 0 0 0', color: '#64748b', fontSize: '0.875rem', fontStyle: 'italic' }}>\r\n                      {room.description}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n                <div\r\n                  style={{\r\n                    padding: '0.25rem 0.75rem',\r\n                    borderRadius: '12px',\r\n                    fontSize: '0.75rem',\r\n                    fontWeight: '500',\r\n                    background: `${getStatusColor(room.status)}20`,\r\n                    color: getStatusColor(room.status),\r\n                  }}\r\n                >\r\n                  {room.status.replace('_', ' ').toUpperCase()}\r\n                </div>\r\n              </div>\r\n\r\n              <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem', marginTop: '1rem' }}>\r\n                <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n                  <span style={{ color: '#64748b' }}>Max Occupancy</span>\r\n                  <span style={{ fontWeight: '500', color: '#1e293b' }}>{room.maxOccupancy} guests</span>\r\n                </div>\r\n                <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n                  <span style={{ color: '#64748b' }}>Rate Plan</span>\r\n                  <span style={{ fontWeight: '500', color: '#1e293b' }}>{room.ratePlan?.name || 'N/A'}</span>\r\n                </div>\r\n                <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n                  <span style={{ color: '#64748b' }}>Custom Rate</span>\r\n                  <span style={{ fontWeight: '500', color: room.customRate ? '#0f172a' : '#94a3b8' }}>\r\n                    {room.customRate ? `${Number(room.customRate).toLocaleString()}` : 'Not set'}\r\n                  </span>\r\n                </div>\r\n                {room.effectiveRate && (\r\n                  <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n                    <span style={{ color: '#64748b' }}>Effective Rate</span>\r\n                    <span style={{ fontWeight: '600', color: '#0f172a' }}>\r\n                      {Number(room.effectiveRate).toLocaleString()}\r\n                    </span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div style={{ marginTop: '1rem', display: 'flex', justifyContent: 'flex-end', gap: '0.5rem', flexWrap: 'wrap' }}>\r\n                <button\r\n                  onClick={() => setRateEditRoom(room)}\r\n                  style={{\r\n                    padding: '0.5rem 0.75rem',\r\n                    border: '1px solid #cbd5e1',\r\n                    borderRadius: '6px',\r\n                    background: '#f8fafc',\r\n                    color: '#0f172a',\r\n                    cursor: 'pointer',\r\n                    fontSize: '0.875rem',\r\n                  }}\r\n                >\r\n                  Edit Rate\r\n                </button>\r\n                <button\r\n                  onClick={() => handleViewActivity(room)}\r\n                  style={{\r\n                    padding: '0.5rem 0.75rem',\r\n                    border: '1px solid #cbd5e1',\r\n                    borderRadius: '6px',\r\n                    background: 'white',\r\n                    color: '#3b82f6',\r\n                    cursor: 'pointer',\r\n                    fontSize: '0.875rem',\r\n                  }}\r\n                >\r\n                  View Activity\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        {filteredRooms.length === 0 && (\r\n          <div\r\n            style={{\r\n              background: 'white',\r\n              padding: '3rem',\r\n              borderRadius: '8px',\r\n              textAlign: 'center',\r\n              color: '#94a3b8',\r\n            }}\r\n          >\r\n            <EmptyState\r\n              icon={DoorOpen}\r\n              title={searchTerm || selectedCategoryFilter || selectedFloorFilter ? 'No rooms found' : 'No rooms yet'}\r\n              description={searchTerm || selectedCategoryFilter || selectedFloorFilter \r\n                ? 'Try adjusting your filters to find rooms' \r\n                : 'Create your first room to get started'}\r\n              action={searchTerm || selectedCategoryFilter || selectedFloorFilter ? undefined : {\r\n                label: 'Create Room',\r\n                onClick: () => setShowCreateModal(true),\r\n              }}\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        {rooms.length > 0 && (\r\n          <div style={{ marginTop: '1.5rem' }}>\r\n            <Pagination\r\n              page={pagination.page}\r\n              totalPages={pagination.totalPages}\r\n              total={pagination.total}\r\n              limit={pagination.limit}\r\n              onPageChange={(newPage) => {\r\n                if (newPage === pagination.page) return;\r\n                if (newPage < 1 || newPage > pagination.totalPages) return;\r\n                fetchRooms(newPage, pagination.limit);\r\n              }}\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        {showCreateModal && (\r\n          <CreateRoomModal\r\n            categories={categories}\r\n            onClose={() => setShowCreateModal(false)}\r\n            onSuccess={() => {\r\n              setShowCreateModal(false);\r\n              fetchRooms(pagination.page);\r\n            }}\r\n            ratePlans={ratePlans}\r\n          />\r\n        )}\r\n\r\n        {rateEditRoom && (\r\n          <EditRoomRateModal\r\n            room={rateEditRoom}\r\n            categories={categories}\r\n            ratePlans={ratePlans}\r\n            onClose={() => setRateEditRoom(null)}\r\n            onSuccess={() => {\r\n              setRateEditRoom(null);\r\n              fetchRooms(pagination.page);\r\n            }}\r\n          />\r\n        )}\r\n\r\n        {showCategoryModal && (\r\n          <CategoryManagementModal\r\n            categories={categories}\r\n            editingCategory={editingCategory}\r\n            setEditingCategory={setEditingCategory}\r\n            onClose={() => {\r\n              setShowCategoryModal(false);\r\n              setEditingCategory(null);\r\n            }}\r\n            onSuccess={() => {\r\n              fetchCategories();\r\n            }}\r\n            onDelete={handleDeleteCategory}\r\n          />\r\n        )}\r\n\r\n        {showActivityModal && activityRoom && (\r\n          <RoomActivityModal\r\n            room={activityRoom}\r\n            logs={roomLogs}\r\n            pagination={roomLogsPagination}\r\n            loading={roomLogsLoading}\r\n            onClose={closeActivityModal}\r\n            onPageChange={handleActivityPageChange}\r\n          />\r\n        )}\r\n      </div>\r\n    </Layout>\r\n  );\r\n}\r\n\r\ninterface EditRoomModalProps {\r\n  room: Room;\r\n  categories: RoomCategory[];\r\n  ratePlans: Array<{ id: string; name: string; baseRate: number | null }>;\r\n  onClose: () => void;\r\n  onSuccess: () => void;\r\n}\r\n\r\nfunction CreateRoomModal({\r\n  categories,\r\n  ratePlans,\r\n  onClose,\r\n  onSuccess,\r\n}: {\r\n  categories: RoomCategory[];\r\n  ratePlans: Array<{ id: string; name: string; baseRate: number | null }>;\r\n  onClose: () => void;\r\n  onSuccess: () => void;\r\n}) {\r\n  const { user } = useAuthStore();\r\n  const [mode, setMode] = useState<'single' | 'bulk'>('single');\r\n  const [formData, setFormData] = useState({\r\n    roomNumber: '',\r\n    roomNumberRange: '',\r\n    roomType: 'single',\r\n    floor: '',\r\n    maxOccupancy: 1,\r\n    ratePlanId: '',\r\n    categoryId: '',\r\n    description: '',\r\n    overrideDescription: false,\r\n    customRate: '',\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n  const [parsedRoomNumbers, setParsedRoomNumbers] = useState<string[]>([]);\r\n  const [creationProgress, setCreationProgress] = useState<{\r\n    total: number;\r\n    created: number;\r\n    failed: number;\r\n  } | null>(null);\r\n\r\n  // Parse room number range (e.g., \"100-150\" or \"101, 102, 105-110\")\r\n  const parseRoomNumbers = (input: string): string[] => {\r\n    const numbers: string[] = [];\r\n    const parts = input.split(',').map(p => p.trim());\r\n    \r\n    for (const part of parts) {\r\n      if (part.includes('-')) {\r\n        const [start, end] = part.split('-').map(s => s.trim());\r\n        const startNum = parseInt(start, 10);\r\n        const endNum = parseInt(end, 10);\r\n        if (!isNaN(startNum) && !isNaN(endNum) && startNum <= endNum) {\r\n          for (let i = startNum; i <= endNum; i++) {\r\n            numbers.push(String(i));\r\n          }\r\n        }\r\n      } else {\r\n        const num = part.trim();\r\n        if (num) {\r\n          numbers.push(num);\r\n        }\r\n      }\r\n    }\r\n    \r\n    return [...new Set(numbers)]; // Remove duplicates\r\n  };\r\n\r\n  // Auto-fill description from category\r\n  useEffect(() => {\r\n    if (!!formData.categoryId && !formData.overrideDescription) {\r\n      const category = categories.find(cat => cat.id === formData.categoryId);\r\n      if (category?.description) {\r\n        setFormData(prev => ({ ...prev, description: category.description || '' }));\r\n      }\r\n    }\r\n  }, [formData.categoryId, categories, formData.overrideDescription]);\r\n\r\n  // Parse room numbers when range input changes (bulk mode)\r\n  useEffect(() => {\r\n    if (mode === 'bulk' && formData.roomNumberRange) {\r\n      const parsed = parseRoomNumbers(formData.roomNumberRange);\r\n      setParsedRoomNumbers(parsed);\r\n    } else {\r\n      setParsedRoomNumbers([]);\r\n    }\r\n  }, [mode, formData.roomNumberRange]);\r\n\r\n  // Auto-detect floor from room number\r\n  const autoDetectFloor = (roomNumber: string): number | null => {\r\n    const num = parseInt(roomNumber, 10);\r\n    if (isNaN(num)) return null;\r\n    // If room number is 3+ digits, first digit(s) might be floor\r\n    if (num >= 100) {\r\n      const firstDigit = Math.floor(num / 100);\r\n      return firstDigit;\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setCreationProgress(null);\r\n\r\n    try {\r\n      if (mode === 'single') {\r\n        // Single room creation\r\n        const floorValue = formData.floor \r\n          ? parseInt(formData.floor, 10) \r\n          : autoDetectFloor(formData.roomNumber);\r\n        \r\n        await api.post(`/tenants/${user?.tenantId}/rooms`, {\r\n          roomNumber: formData.roomNumber,\r\n          roomType: formData.roomType,\r\n          floor: floorValue,\r\n          maxOccupancy: formData.maxOccupancy,\r\n          ratePlanId: formData.ratePlanId || null,\r\n          categoryId: formData.categoryId || null,\r\n          description: formData.description || null,\r\n          customRate: formData.customRate ? Number(formData.customRate) : null,\r\n        });\r\n        onSuccess();\r\n        toast.success('Room created successfully');\r\n      } else {\r\n        // Bulk room creation\r\n        if (parsedRoomNumbers.length === 0) {\r\n          toast.error('Please enter valid room numbers');\r\n          setLoading(false);\r\n          return;\r\n        }\r\n\r\n        const floorValue = formData.floor ? parseInt(formData.floor, 10) : null;\r\n        \r\n        setCreationProgress({ total: parsedRoomNumbers.length, created: 0, failed: 0 });\r\n        \r\n        try {\r\n          const response = await api.post(`/tenants/${user?.tenantId}/rooms/bulk`, {\r\n            roomNumbers: parsedRoomNumbers,\r\n            roomType: formData.roomType,\r\n            floor: floorValue,\r\n            maxOccupancy: formData.maxOccupancy,\r\n            ratePlanId: formData.ratePlanId || null,\r\n            categoryId: formData.categoryId || null,\r\n            description: formData.overrideDescription ? formData.description : null,\r\n            customRate: formData.customRate ? Number(formData.customRate) : null,\r\n          });\r\n\r\n          const created = response.data.data?.created || 0;\r\n          setCreationProgress({ total: parsedRoomNumbers.length, created, failed: 0 });\r\n          \r\n          onSuccess();\r\n          toast.success(`Successfully created ${created} room(s)`);\r\n          \r\n          // Close modal after a brief delay\r\n          setTimeout(() => {\r\n            onClose();\r\n          }, 1500);\r\n        } catch (error: any) {\r\n          setCreationProgress(null);\r\n          // Error handled by API interceptor\r\n        }\r\n      }\r\n    } catch (error: any) {\r\n      // Error handled by API interceptor\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0,0,0,0.5)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 1000,\r\n      }}\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        style={{\r\n          background: 'white',\r\n          borderRadius: '8px',\r\n          padding: '2rem',\r\n          width: '90%',\r\n          maxWidth: '500px',\r\n        }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <h2 style={{ marginBottom: '1.5rem', color: '#1e293b' }}>\r\n          {mode === 'single' ? 'Add New Room' : 'Bulk Create Rooms'}\r\n        </h2>\r\n\r\n        {/* Mode Toggle */}\r\n        <div style={{ marginBottom: '1.5rem', display: 'flex', gap: '0.5rem', background: '#f1f5f9', padding: '0.25rem', borderRadius: '6px' }}>\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => {\r\n              setMode('single');\r\n              setFormData(prev => ({ ...prev, roomNumberRange: '', overrideDescription: false }));\r\n            }}\r\n            style={{\r\n              flex: 1,\r\n              padding: '0.5rem 1rem',\r\n              background: mode === 'single' ? '#3b82f6' : 'transparent',\r\n              color: mode === 'single' ? 'white' : '#64748b',\r\n              border: 'none',\r\n              borderRadius: '4px',\r\n              cursor: 'pointer',\r\n              fontWeight: '500',\r\n              fontSize: '0.875rem',\r\n            }}\r\n          >\r\n            Single Room\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => {\r\n              setMode('bulk');\r\n              setFormData(prev => ({ ...prev, roomNumber: '', overrideDescription: false }));\r\n            }}\r\n            style={{\r\n              flex: 1,\r\n              padding: '0.5rem 1rem',\r\n              background: mode === 'bulk' ? '#3b82f6' : 'transparent',\r\n              color: mode === 'bulk' ? 'white' : '#64748b',\r\n              border: 'none',\r\n              borderRadius: '4px',\r\n              cursor: 'pointer',\r\n              fontWeight: '500',\r\n              fontSize: '0.875rem',\r\n            }}\r\n          >\r\n            Bulk Create\r\n          </button>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit}>\r\n          <div style={{ display: 'grid', gap: '1rem' }}>\r\n            {/* Room Number Input - Different for each mode */}\r\n            {mode === 'single' ? (\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                  Room Number *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={formData.roomNumber}\r\n                  onChange={(e) => {\r\n                    const value = e.target.value;\r\n                    setFormData({ ...formData, roomNumber: value });\r\n                    // Auto-detect floor if not set\r\n                    if (!formData.floor && value) {\r\n                      const detectedFloor = autoDetectFloor(value);\r\n                      if (detectedFloor !== null) {\r\n                        setFormData(prev => ({ ...prev, roomNumber: value, floor: String(detectedFloor) }));\r\n                      }\r\n                    }\r\n                  }}\r\n                  required\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #cbd5e1',\r\n                    borderRadius: '6px',\r\n                  }}\r\n                  placeholder=\"e.g., 101\"\r\n                />\r\n              </div>\r\n            ) : (\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                  Room Numbers *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={formData.roomNumberRange}\r\n                  onChange={(e) => setFormData({ ...formData, roomNumberRange: e.target.value })}\r\n                  required\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #cbd5e1',\r\n                    borderRadius: '6px',\r\n                  }}\r\n                  placeholder=\"e.g., 100-150 or 101, 102, 105-110\"\r\n                />\r\n                {parsedRoomNumbers.length > 0 && (\r\n                  <div style={{ marginTop: '0.5rem', padding: '0.75rem', background: '#f0f9ff', borderRadius: '6px', fontSize: '0.875rem', color: '#0369a1' }}>\r\n                    <strong>{parsedRoomNumbers.length}</strong> room{parsedRoomNumbers.length !== 1 ? 's' : ''} will be created\r\n                    {parsedRoomNumbers.length <= 10 && (\r\n                      <div style={{ marginTop: '0.25rem', color: '#64748b' }}>\r\n                        {parsedRoomNumbers.join(', ')}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                  Room Type *\r\n                </label>\r\n                <select\r\n                  value={formData.roomType}\r\n                  onChange={(e) => setFormData({ ...formData, roomType: e.target.value })}\r\n                  required\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #cbd5e1',\r\n                    borderRadius: '6px',\r\n                  }}\r\n                >\r\n                  <option value=\"single\">Single</option>\r\n                  <option value=\"double\">Double</option>\r\n                  <option value=\"twin\">Twin</option>\r\n                  <option value=\"suite\">Suite</option>\r\n                  <option value=\"deluxe\">Deluxe</option>\r\n                </select>\r\n              </div>\r\n              <div>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                  Floor\r\n                </label>\r\n                <input\r\n                  type=\"number\"\r\n                  value={formData.floor}\r\n                  onChange={(e) => {\r\n                    const value = e.target.value;\r\n                    setFormData({ ...formData, floor: value === '' ? '' : value });\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #cbd5e1',\r\n                    borderRadius: '6px',\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Max Occupancy *\r\n              </label>\r\n              <input\r\n                type=\"number\"\r\n                value={formData.maxOccupancy}\r\n                onChange={(e) => {\r\n                  const value = e.target.value;\r\n                  const numValue = value === '' ? 1 : parseInt(value, 10);\r\n                  if (!isNaN(numValue) && numValue >= 1) {\r\n                    setFormData({ ...formData, maxOccupancy: numValue });\r\n                  }\r\n                }}\r\n                min=\"1\"\r\n                required\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                }}\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Category\r\n              </label>\r\n              <select\r\n                value={formData.categoryId}\r\n                onChange={(e) => setFormData({ ...formData, categoryId: e.target.value })}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                }}\r\n              >\r\n                <option value=\"\">No Category</option>\r\n                {categories.map((cat) => (\r\n                  <option key={cat.id} value={cat.id}>\r\n                    {cat.name}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                Rate Plan\r\n              </label>\r\n              <select\r\n                value={formData.ratePlanId}\r\n                onChange={(e) => {\r\n                  const value = e.target.value;\r\n                  setFormData((prev) => ({\r\n                    ...prev,\r\n                    ratePlanId: value,\r\n                    customRate: prev.customRate || value === '' ? prev.customRate : '',\r\n                  }));\r\n                }}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                }}\r\n              >\r\n                <option value=\"\">No Rate Plan</option>\r\n                {ratePlans.map((plan) => (\r\n                  <option key={plan.id} value={plan.id}>\r\n                    {plan.name} {plan.baseRate ? ` ${plan.baseRate.toLocaleString()}` : ''}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.5rem' }}>\r\n                <label style={{ color: '#475569', fontWeight: '500' }}>Custom Rate (optional)</label>\r\n                {formData.ratePlanId && (\r\n                  <span style={{ fontSize: '0.75rem', color: '#94a3b8' }}>\r\n                    Overrides {ratePlans.find((plan) => plan.id === formData.ratePlanId)?.name || 'selected plan'}\r\n                  </span>\r\n                )}\r\n              </div>\r\n              <input\r\n                type=\"number\"\r\n                min=\"0\"\r\n                step=\"0.01\"\r\n                value={formData.customRate}\r\n                onChange={(e) => setFormData({ ...formData, customRate: e.target.value })}\r\n                placeholder=\"Enter a custom rate (e.g., 45000)\"\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                }}\r\n              />\r\n              {formData.customRate && (\r\n                <div style={{ marginTop: '0.25rem', fontSize: '0.85rem', color: '#0f172a' }}>\r\n                  Effective rate will be {Number(formData.customRate).toLocaleString()}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <div>\r\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.5rem' }}>\r\n                <label style={{ color: '#475569', fontWeight: '500' }}>\r\n                  Description\r\n                </label>\r\n                {!!formData.categoryId && (\r\n                  <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', fontSize: '0.875rem', color: '#64748b', cursor: 'pointer' }}>\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={formData.overrideDescription}\r\n                      onChange={(e) => setFormData({ ...formData, overrideDescription: e.target.checked })}\r\n                      style={{ cursor: 'pointer' }}\r\n                    />\r\n                    Override category description\r\n                  </label>\r\n                )}\r\n              </div>\r\n              <textarea\r\n                value={formData.description}\r\n                onChange={(e) => setFormData({ ...formData, description: e.target.value, overrideDescription: true })}\r\n                disabled={!!formData.categoryId && !formData.overrideDescription}\r\n                rows={3}\r\n                style={{\r\n                  width: '100%',\r\n                  padding: '0.75rem',\r\n                  border: '1px solid #cbd5e1',\r\n                  borderRadius: '6px',\r\n                  fontFamily: 'inherit',\r\n                  resize: 'vertical',\r\n                  background: !!formData.categoryId && !formData.overrideDescription ? '#f8fafc' : 'white',\r\n                  color: !!formData.categoryId && !formData.overrideDescription ? '#94a3b8' : '#1e293b',\r\n                }}\r\n                  placeholder={\r\n                  !!formData.categoryId && !formData.overrideDescription\r\n                    ? 'Description will be inherited from category'\r\n                    : 'Room description, features, or notes...'\r\n                }\r\n              />\r\n              {!!formData.categoryId && !formData.overrideDescription && (\r\n                <div style={{ marginTop: '0.25rem', fontSize: '0.75rem', color: '#64748b', fontStyle: 'italic' }}>\r\n                  Using description from category\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Progress indicator for bulk creation */}\r\n            {creationProgress && (\r\n              <div style={{ padding: '1rem', background: '#f0f9ff', borderRadius: '6px', border: '1px solid #bae6fd' }}>\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem', fontSize: '0.875rem' }}>\r\n                  <span style={{ color: '#0369a1', fontWeight: '500' }}>Creating rooms...</span>\r\n                  <span style={{ color: '#64748b' }}>\r\n                    {creationProgress.created} / {creationProgress.total}\r\n                  </span>\r\n                </div>\r\n                <div style={{ width: '100%', height: '8px', background: '#e0f2fe', borderRadius: '4px', overflow: 'hidden' }}>\r\n                  <div\r\n                    style={{\r\n                      width: `${(creationProgress.created / creationProgress.total) * 100}%`,\r\n                      height: '100%',\r\n                      background: '#3b82f6',\r\n                      transition: 'width 0.3s',\r\n                    }}\r\n                  />\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            <div style={{ display: 'flex', gap: '1rem', justifyContent: 'flex-end', marginTop: '1rem' }}>\r\n              <button\r\n                type=\"button\"\r\n                onClick={onClose}\r\n                style={{\r\n                  padding: '0.75rem 1.5rem',\r\n                  background: '#f1f5f9',\r\n                  color: '#475569',\r\n                  border: 'none',\r\n                  borderRadius: '6px',\r\n                  cursor: 'pointer',\r\n                }}\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                type=\"submit\"\r\n                disabled={loading || (mode === 'bulk' && parsedRoomNumbers.length === 0)}\r\n                style={{\r\n                  padding: '0.75rem 1.5rem',\r\n                  background: '#3b82f6',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  borderRadius: '6px',\r\n                  cursor: loading || (mode === 'bulk' && parsedRoomNumbers.length === 0) ? 'not-allowed' : 'pointer',\r\n                  opacity: loading || (mode === 'bulk' && parsedRoomNumbers.length === 0) ? 0.6 : 1,\r\n                }}\r\n              >\r\n                {loading\r\n                  ? 'Creating...'\r\n                  : mode === 'single'\r\n                  ? 'Create Room'\r\n                  : `Create ${parsedRoomNumbers.length || 0} Room${parsedRoomNumbers.length !== 1 ? 's' : ''}`}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction EditRoomRateModal({ room, categories, ratePlans, onClose, onSuccess }: EditRoomModalProps) {\r\n  const { user } = useAuthStore();\r\n  const [formData, setFormData] = useState({\r\n    ratePlanId: room.ratePlanId || room.ratePlan?.id || '',\r\n    customRate: room.customRate ? String(room.customRate) : '',\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n  const selectedPlan = ratePlans.find((plan) => plan.id === formData.ratePlanId);\r\n  const category = room.categoryId\r\n    ? categories.find((cat) => cat.id === room.categoryId)\r\n    : null;\r\n  const effectiveRate =\r\n    formData.customRate !== ''\r\n      ? Number(formData.customRate)\r\n      : selectedPlan?.baseRate ?? null;\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    try {\r\n      await api.patch(`/tenants/${user?.tenantId}/rooms/${room.id}`, {\r\n        ratePlanId: formData.ratePlanId || null,\r\n        customRate: formData.customRate ? Number(formData.customRate) : null,\r\n      });\r\n      toast.success('Room rate updated');\r\n      onSuccess();\r\n    } catch (error: any) {\r\n      // handled globally\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0,0,0,0.5)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 1000,\r\n      }}\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        style={{\r\n          background: 'white',\r\n          borderRadius: '8px',\r\n          padding: '2rem',\r\n          width: '90%',\r\n          maxWidth: '480px',\r\n        }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <h2 style={{ marginBottom: '0.5rem', color: '#1e293b' }}>Edit Room Rate</h2>\r\n        <p style={{ margin: 0, color: '#64748b' }}>\r\n          Room {room.roomNumber}  {room.roomType}\r\n        </p>\r\n        {category && (\r\n          <p style={{ marginTop: '0.25rem', color: '#94a3b8', fontSize: '0.85rem' }}>\r\n            Category: {category.name}\r\n          </p>\r\n        )}\r\n\r\n        <form onSubmit={handleSubmit} style={{ marginTop: '1.5rem', display: 'grid', gap: '1rem' }}>\r\n          <div>\r\n            <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n              Rate Plan\r\n            </label>\r\n            <select\r\n              value={formData.ratePlanId}\r\n              onChange={(e) =>\r\n                setFormData((prev) => ({\r\n                  ...prev,\r\n                  ratePlanId: e.target.value,\r\n                  customRate: prev.customRate,\r\n                }))\r\n              }\r\n              style={{\r\n                width: '100%',\r\n                padding: '0.75rem',\r\n                border: '1px solid #cbd5e1',\r\n                borderRadius: '6px',\r\n              }}\r\n            >\r\n              <option value=\"\">No Rate Plan</option>\r\n              {ratePlans.map((plan) => (\r\n                <option key={plan.id} value={plan.id}>\r\n                  {plan.name} {plan.baseRate ? ` ${plan.baseRate.toLocaleString()}` : ''}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          <div>\r\n            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.5rem' }}>\r\n              <label style={{ color: '#475569', fontWeight: '500' }}>Custom Rate (optional)</label>\r\n              {selectedPlan?.baseRate !== undefined && selectedPlan?.baseRate !== null && (\r\n                <span style={{ fontSize: '0.75rem', color: '#94a3b8' }}>\r\n                  Plan base {Number(selectedPlan.baseRate).toLocaleString()}\r\n                </span>\r\n              )}\r\n            </div>\r\n            <input\r\n              type=\"number\"\r\n              min=\"0\"\r\n              step=\"0.01\"\r\n              value={formData.customRate}\r\n              onChange={(e) => setFormData({ ...formData, customRate: e.target.value })}\r\n              placeholder=\"Leave blank to use plan rate\"\r\n              style={{\r\n                width: '100%',\r\n                padding: '0.75rem',\r\n                border: '1px solid #cbd5e1',\r\n                borderRadius: '6px',\r\n              }}\r\n            />\r\n            {formData.customRate && (\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setFormData((prev) => ({ ...prev, customRate: '' }))}\r\n                style={{\r\n                  marginTop: '0.5rem',\r\n                  background: 'none',\r\n                  border: 'none',\r\n                  color: '#ef4444',\r\n                  cursor: 'pointer',\r\n                  fontSize: '0.85rem',\r\n                }}\r\n              >\r\n                Remove custom rate\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          <div\r\n            style={{\r\n              marginTop: '0.5rem',\r\n              padding: '0.75rem',\r\n              borderRadius: '6px',\r\n              background: '#f8fafc',\r\n              border: '1px solid #e2e8f0',\r\n              fontSize: '0.9rem',\r\n              color: '#0f172a',\r\n            }}\r\n          >\r\n            <strong>Effective nightly rate:</strong>{' '}\r\n            {effectiveRate !== null ? `${Number(effectiveRate).toLocaleString()}` : 'Not set'}\r\n          </div>\r\n\r\n          <div style={{ display: 'flex', gap: '0.75rem', justifyContent: 'flex-end' }}>\r\n            <button\r\n              type=\"button\"\r\n              onClick={onClose}\r\n              style={{\r\n                padding: '0.65rem 1.25rem',\r\n                background: '#f1f5f9',\r\n                color: '#475569',\r\n                border: 'none',\r\n                borderRadius: '6px',\r\n                cursor: 'pointer',\r\n              }}\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              type=\"submit\"\r\n              disabled={loading}\r\n              style={{\r\n                padding: '0.65rem 1.25rem',\r\n                background: '#3b82f6',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '6px',\r\n                cursor: loading ? 'not-allowed' : 'pointer',\r\n                opacity: loading ? 0.7 : 1,\r\n              }}\r\n            >\r\n              {loading ? 'Saving...' : 'Save Changes'}\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction CategoryManagementModal({\r\n  categories,\r\n  editingCategory,\r\n  setEditingCategory,\r\n  onClose,\r\n  onSuccess,\r\n  onDelete,\r\n}: {\r\n  categories: RoomCategory[];\r\n  editingCategory: RoomCategory | null;\r\n  setEditingCategory: (category: RoomCategory | null) => void;\r\n  onClose: () => void;\r\n  onSuccess: () => void;\r\n  onDelete: (id: string) => void;\r\n}) {\r\n  const { user } = useAuthStore();\r\n  const [formData, setFormData] = useState({\r\n    name: '',\r\n    description: '',\r\n    totalRooms: '',\r\n    color: '#8b5cf6',\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (editingCategory) {\r\n      // Only update form data if we're switching to a different category or starting fresh\r\n      // Don't reset if we're already editing this category (to prevent losing user input while typing)\r\n      setFormData((prev) => {\r\n        // Only update if the category ID changed or if form is empty\r\n        if (prev.name === '' || prev.name !== editingCategory.name) {\r\n          return {\r\n            name: editingCategory.name,\r\n            description: editingCategory.description || '',\r\n            totalRooms: editingCategory.totalRooms?.toString() || '',\r\n            color: editingCategory.color || '#8b5cf6',\r\n          };\r\n        }\r\n        return prev;\r\n      });\r\n    } else {\r\n      // Only clear if we're not currently editing\r\n      setFormData((prev) => {\r\n        if (prev.name !== '') {\r\n          return prev; // Keep current form data\r\n        }\r\n        return {\r\n          name: '',\r\n          description: '',\r\n          totalRooms: '',\r\n          color: '#8b5cf6',\r\n        };\r\n      });\r\n    }\r\n  }, [editingCategory?.id]); // Only depend on the ID, not the whole object\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    try {\r\n      const payload: any = {\r\n        name: formData.name,\r\n        description: formData.description || null,\r\n        color: formData.color || '#8b5cf6',\r\n      };\r\n      if (formData.totalRooms) {\r\n        payload.totalRooms = parseInt(formData.totalRooms, 10);\r\n      }\r\n\r\n      if (editingCategory) {\r\n        const response = await api.patch(`/tenants/${user?.tenantId}/room-categories/${editingCategory.id}`, payload);\r\n        toast.success('Category updated successfully');\r\n        // Update editingCategory with fresh data from response\r\n        if (response.data?.data) {\r\n          setEditingCategory(response.data.data);\r\n        }\r\n        // Refetch categories to update the list\r\n        onSuccess();\r\n      } else {\r\n        await api.post(`/tenants/${user?.tenantId}/room-categories`, payload);\r\n        toast.success('Category created successfully');\r\n        // Clear form and refetch categories\r\n        setFormData({ name: '', description: '', totalRooms: '', color: '#8b5cf6' });\r\n        setEditingCategory(null);\r\n        onSuccess();\r\n      }\r\n    } catch (error: any) {\r\n      // Error handled by API interceptor\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0,0,0,0.5)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 1000,\r\n      }}\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        style={{\r\n          background: 'white',\r\n          borderRadius: '8px',\r\n          padding: '2rem',\r\n          width: '90%',\r\n          maxWidth: '800px',\r\n          maxHeight: '90vh',\r\n          overflow: 'auto',\r\n        }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <h2 style={{ margin: 0, color: '#1e293b' }}>\r\n            {editingCategory ? 'Edit Category' : 'Manage Room Categories'}\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            style={{\r\n              background: 'none',\r\n              border: 'none',\r\n              cursor: 'pointer',\r\n              padding: '0.5rem',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n            }}\r\n          >\r\n            <X size={24} />\r\n          </button>\r\n        </div>\r\n\r\n        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '2rem' }}>\r\n          {/* Form Section */}\r\n          <div>\r\n            <h3 style={{ marginBottom: '1rem', color: '#475569', fontSize: '1rem', fontWeight: '600' }}>\r\n              {editingCategory ? 'Edit Category' : 'Create New Category'}\r\n            </h3>\r\n            <form onSubmit={handleSubmit}>\r\n              <div style={{ display: 'grid', gap: '1rem' }}>\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                    Category Name *\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={formData.name}\r\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                    required\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #cbd5e1',\r\n                      borderRadius: '6px',\r\n                    }}\r\n                    placeholder=\"e.g., Standard, Premium, Deluxe\"\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                    Description\r\n                  </label>\r\n                  <textarea\r\n                    value={formData.description}\r\n                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\r\n                    rows={3}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #cbd5e1',\r\n                      borderRadius: '6px',\r\n                      fontFamily: 'inherit',\r\n                      resize: 'vertical',\r\n                    }}\r\n                    placeholder=\"Category description...\"\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                    Total Rooms (Optional)\r\n                  </label>\r\n                  <input\r\n                    type=\"number\"\r\n                    value={formData.totalRooms}\r\n                    onChange={(e) => setFormData({ ...formData, totalRooms: e.target.value })}\r\n                    min=\"0\"\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #cbd5e1',\r\n                      borderRadius: '6px',\r\n                    }}\r\n                    placeholder=\"Expected number of rooms in this category\"\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#475569', fontWeight: '500' }}>\r\n                    Category Color\r\n                  </label>\r\n                  <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>\r\n                    <input\r\n                      type=\"color\"\r\n                      value={formData.color}\r\n                      onChange={(e) => setFormData({ ...formData, color: e.target.value })}\r\n                      style={{\r\n                        width: '60px',\r\n                        height: '40px',\r\n                        border: '1px solid #cbd5e1',\r\n                        borderRadius: '6px',\r\n                        cursor: 'pointer',\r\n                      }}\r\n                    />\r\n                    <input\r\n                      type=\"text\"\r\n                      value={formData.color}\r\n                      onChange={(e) => setFormData({ ...formData, color: e.target.value })}\r\n                      pattern=\"^#[0-9A-Fa-f]{6}$\"\r\n                      style={{\r\n                        flex: 1,\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #cbd5e1',\r\n                        borderRadius: '6px',\r\n                        fontFamily: 'monospace',\r\n                      }}\r\n                      placeholder=\"#8b5cf6\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div style={{ display: 'flex', gap: '0.5rem', marginTop: '0.5rem' }}>\r\n                  <button\r\n                    type=\"submit\"\r\n                    disabled={loading}\r\n                    style={{\r\n                      flex: 1,\r\n                      padding: '0.75rem 1.5rem',\r\n                      background: '#8b5cf6',\r\n                      color: 'white',\r\n                      border: 'none',\r\n                      borderRadius: '6px',\r\n                      cursor: loading ? 'not-allowed' : 'pointer',\r\n                      opacity: loading ? 0.6 : 1,\r\n                      fontWeight: '500',\r\n                    }}\r\n                  >\r\n                    {loading ? 'Saving...' : editingCategory ? 'Update Category' : 'Create Category'}\r\n                  </button>\r\n                  {editingCategory && (\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => {\r\n                        setFormData({ name: '', description: '', totalRooms: '', color: '#8b5cf6' });\r\n                        setEditingCategory(null);\r\n                        onSuccess();\r\n                      }}\r\n                      style={{\r\n                        padding: '0.75rem 1rem',\r\n                        background: '#f1f5f9',\r\n                        color: '#475569',\r\n                        border: 'none',\r\n                        borderRadius: '6px',\r\n                        cursor: 'pointer',\r\n                      }}\r\n                    >\r\n                      Cancel\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </form>\r\n          </div>\r\n\r\n          {/* Categories List */}\r\n          <div>\r\n            <h3 style={{ marginBottom: '1rem', color: '#475569', fontSize: '1rem', fontWeight: '600' }}>\r\n              Existing Categories ({categories.length})\r\n            </h3>\r\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem', maxHeight: '400px', overflow: 'auto' }}>\r\n              {categories.length === 0 ? (\r\n                <p style={{ color: '#94a3b8', fontSize: '0.875rem', textAlign: 'center', padding: '2rem' }}>\r\n                  No categories yet. Create your first category!\r\n                </p>\r\n              ) : (\r\n                categories.map((category) => (\r\n                  <div\r\n                    key={category.id}\r\n                    style={{\r\n                      background: '#f8fafc',\r\n                      padding: '1rem',\r\n                      borderRadius: '6px',\r\n                      border: '1px solid #e2e8f0',\r\n                    }}\r\n                  >\r\n                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start' }}>\r\n                      <div style={{ flex: 1 }}>\r\n                        <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.25rem' }}>\r\n                          <div\r\n                            style={{\r\n                              width: '16px',\r\n                              height: '16px',\r\n                              borderRadius: '4px',\r\n                              background: category.color || '#8b5cf6',\r\n                              border: '1px solid rgba(0,0,0,0.1)',\r\n                            }}\r\n                          />\r\n                          <h4 style={{ margin: 0, color: '#1e293b', fontSize: '0.875rem', fontWeight: '600' }}>\r\n                            {category.name}\r\n                          </h4>\r\n                        </div>\r\n                        {category.description && (\r\n                          <p style={{ margin: '0.25rem 0', color: '#64748b', fontSize: '0.75rem' }}>\r\n                            {category.description}\r\n                          </p>\r\n                        )}\r\n                        <div style={{ marginTop: '0.5rem', fontSize: '0.75rem', color: '#64748b' }}>\r\n                          <div>\r\n                            <span style={{ fontWeight: '500' }}>{category.actualRoomCount}</span> room\r\n                            {category.actualRoomCount !== 1 ? 's' : ''} assigned\r\n                            {category.totalRooms && (\r\n                              <span>\r\n                                {' '}\r\n                                / {category.totalRooms} total\r\n                              </span>\r\n                            )}\r\n                          </div>\r\n                          {category.minPrice !== null && category.minPrice !== undefined && (\r\n                            <div style={{ marginTop: '0.25rem', fontWeight: '600', color: '#3b82f6' }}>\r\n                              {category.minPrice === category.maxPrice ? (\r\n                                <>{category.minPrice.toLocaleString()}</>\r\n                              ) : (\r\n                                <>\r\n                                  {category.minPrice.toLocaleString()} - {category.maxPrice?.toLocaleString()}\r\n                                </>\r\n                              )}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                      <div style={{ display: 'flex', gap: '0.25rem', marginLeft: '0.5rem' }}>\r\n                        <button\r\n                          onClick={() => {\r\n                            setEditingCategory(category);\r\n                            setFormData({\r\n                              name: category.name,\r\n                              description: category.description || '',\r\n                              totalRooms: category.totalRooms?.toString() || '',\r\n                              color: category.color || '#8b5cf6',\r\n                            });\r\n                          }}\r\n                          style={{\r\n                            padding: '0.5rem',\r\n                            background: 'transparent',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            color: '#64748b',\r\n                          }}\r\n                          title=\"Edit\"\r\n                        >\r\n                          <Edit size={16} />\r\n                        </button>\r\n                        <button\r\n                          onClick={() => onDelete(category.id)}\r\n                          disabled={category.actualRoomCount > 0}\r\n                          style={{\r\n                            padding: '0.5rem',\r\n                            background: 'transparent',\r\n                            border: 'none',\r\n                            cursor: category.actualRoomCount > 0 ? 'not-allowed' : 'pointer',\r\n                            color: category.actualRoomCount > 0 ? '#cbd5e1' : '#ef4444',\r\n                            opacity: category.actualRoomCount > 0 ? 0.5 : 1,\r\n                          }}\r\n                          title={category.actualRoomCount > 0 ? 'Cannot delete: has rooms assigned' : 'Delete'}\r\n                        >\r\n                          <Trash2 size={16} />\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction RoomActivityModal({\r\n  room,\r\n  logs,\r\n  pagination,\r\n  loading,\r\n  onClose,\r\n  onPageChange,\r\n}: {\r\n  room: Room;\r\n  logs: RoomLog[];\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    totalPages: number;\r\n    hasNext: boolean;\r\n    hasPrev: boolean;\r\n  };\r\n  loading: boolean;\r\n  onClose: () => void;\r\n  onPageChange: (page: number) => void;\r\n}) {\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: 'rgba(0,0,0,0.5)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 1000,\r\n      }}\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        style={{\r\n          background: 'white',\r\n          borderRadius: '8px',\r\n          padding: '1.5rem',\r\n          width: '90%',\r\n          maxWidth: '700px',\r\n          maxHeight: '85vh',\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n        }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>\r\n          <div>\r\n            <h2 style={{ margin: 0, color: '#1e293b' }}>Room {room.roomNumber} Activity</h2>\r\n            <p style={{ margin: '0.25rem 0 0 0', color: '#64748b', fontSize: '0.875rem' }}>\r\n              Latest actions and updates logged for this room.\r\n            </p>\r\n          </div>\r\n          <button\r\n            onClick={onClose}\r\n            style={{\r\n              background: 'none',\r\n              border: 'none',\r\n              cursor: 'pointer',\r\n              padding: '0.25rem',\r\n              color: '#475569',\r\n            }}\r\n          >\r\n            <X size={24} />\r\n          </button>\r\n        </div>\r\n\r\n        <div style={{ flex: 1, overflowY: 'auto', border: '1px solid #e2e8f0', borderRadius: '8px', padding: '1rem' }}>\r\n          {loading ? (\r\n            <div style={{ textAlign: 'center', color: '#94a3b8' }}>Loading activity...</div>\r\n          ) : logs.length === 0 ? (\r\n            <div style={{ textAlign: 'center', color: '#94a3b8' }}>No activity logs yet for this room.</div>\r\n          ) : (\r\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\r\n              {logs.map((log) => (\r\n                <div\r\n                  key={log.id}\r\n                  style={{\r\n                    borderLeft: '3px solid #3b82f6',\r\n                    paddingLeft: '1rem',\r\n                    paddingRight: '0.5rem',\r\n                  }}\r\n                >\r\n                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                    <span\r\n                      style={{\r\n                        fontSize: '0.75rem',\r\n                        textTransform: 'uppercase',\r\n                        fontWeight: '600',\r\n                        color: '#3b82f6',\r\n                      }}\r\n                    >\r\n                      {log.type.replace('_', ' ')}\r\n                    </span>\r\n                    <span style={{ fontSize: '0.75rem', color: '#94a3b8' }}>\r\n                      {new Date(log.createdAt).toLocaleString()}\r\n                    </span>\r\n                  </div>\r\n                  <p style={{ margin: '0.25rem 0', color: '#1e293b', fontWeight: '500' }}>{log.summary}</p>\r\n                  {log.details && (\r\n                    <p style={{ margin: 0, color: '#64748b', fontSize: '0.875rem' }}>{log.details}</p>\r\n                  )}\r\n                  {log.metadata && (\r\n                    <div style={{ marginTop: '0.5rem', display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>\r\n                      {Object.entries(log.metadata).map(([key, value]) => (\r\n                        <span\r\n                          key={key}\r\n                          style={{\r\n                            background: '#f1f5f9',\r\n                            borderRadius: '999px',\r\n                            padding: '0.25rem 0.75rem',\r\n                            fontSize: '0.75rem',\r\n                            color: '#475569',\r\n                          }}\r\n                        >\r\n                          {key}: {String(value)}\r\n                        </span>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                  {log.user?.name && (\r\n                    <p style={{ margin: '0.5rem 0 0 0', color: '#94a3b8', fontSize: '0.75rem' }}>\r\n                      Logged by {log.user.name}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {logs.length > 0 && pagination.totalPages > 1 && (\r\n          <div style={{ marginTop: '1rem' }}>\r\n            <Pagination\r\n              page={pagination.page}\r\n              totalPages={pagination.totalPages}\r\n              total={pagination.total}\r\n              limit={pagination.limit}\r\n              onPageChange={onPageChange}\r\n            />\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\SettingsPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\StaffPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\TenantLoginPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\TenantsPage.tsx","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'react-hooks/exhaustive-deps').","line":77,"column":5,"severity":2,"nodeType":null,"fix":{"range":[2364,2419],"text":" "}}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuthStore, useIsAuthenticated } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Layout from '../components/Layout';\r\nimport { Building2, Plus, Users, DoorOpen, Search, Edit, Trash2 } from 'lucide-react';\r\nimport { DashboardSkeleton } from '../components/LoadingSkeleton';\r\nimport toast from 'react-hot-toast';\r\n\r\ninterface Tenant {\r\n  id: string;\r\n  name: string;\r\n  slug: string;\r\n  email: string;\r\n  phone?: string;\r\n  address?: string;\r\n  subscriptionStatus: string;\r\n  createdAt: string;\r\n  _count?: {\r\n    users: number;\r\n    rooms: number;\r\n  };\r\n}\r\n\r\nexport default function TenantsPage() {\r\n  const navigate = useNavigate();\r\n  const { user } = useAuthStore();\r\n  const isAuthenticated = useIsAuthenticated();\r\n  const [tenants, setTenants] = useState<Tenant[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const [editingTenant, setEditingTenant] = useState<Tenant | null>(null);\r\n  const [formData, setFormData] = useState({\r\n    name: '',\r\n    slug: '',\r\n    email: '',\r\n    phone: '',\r\n    address: '',\r\n    ownerEmail: '',\r\n    ownerPassword: '',\r\n    ownerFirstName: '',\r\n    ownerLastName: '',\r\n  });\r\n  const [editFormData, setEditFormData] = useState({\r\n    name: '',\r\n    slug: '',\r\n    email: '',\r\n    phone: '',\r\n    address: '',\r\n  });\r\n\r\n  useEffect(() => {\r\n    console.log('TenantsPage useEffect - isAuthenticated:', isAuthenticated, 'user:', user);\r\n    \r\n    // Check authentication\r\n    if (!isAuthenticated) {\r\n      console.log('Not authenticated, redirecting to login');\r\n      navigate('/login', { replace: true });\r\n      return;\r\n    }\r\n\r\n    // Check admin role\r\n    if (user?.role !== 'iitech_admin') {\r\n      console.log('Not admin, redirecting to dashboard. Role:', user?.role);\r\n      toast.error('Access denied. Admin privileges required.');\r\n      navigate('/dashboard', { replace: true });\r\n      return;\r\n    }\r\n\r\n    // Fetch tenants if authenticated and admin\r\n    if (isAuthenticated && user?.role === 'iitech_admin') {\r\n      console.log('Fetching tenants...');\r\n      fetchTenants();\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [user, isAuthenticated, navigate]);\r\n\r\n  useEffect(() => {\r\n    console.log('Edit modal state changed - showEditModal:', showEditModal, 'editingTenant:', editingTenant?.id);\r\n  }, [showEditModal, editingTenant]);\r\n\r\n  const fetchTenants = async () => {\r\n    try {\r\n      setLoading(true);\r\n      console.log('Making API call to /tenants');\r\n      const response = await api.get('/tenants');\r\n      console.log('Tenants API response:', response.data);\r\n      setTenants(response.data?.data || []);\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch tenants:', error);\r\n      const errorMessage = error.response?.data?.error?.message || error.message || 'Failed to fetch tenants';\r\n      toast.error(errorMessage);\r\n      setTenants([]); // Set empty array on error\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleCreateTenant = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    try {\r\n      await api.post('/tenants', formData);\r\n      toast.success('Tenant created successfully');\r\n      setShowCreateModal(false);\r\n      setFormData({\r\n        name: '',\r\n        slug: '',\r\n        email: '',\r\n        phone: '',\r\n        address: '',\r\n        ownerEmail: '',\r\n        ownerPassword: '',\r\n        ownerFirstName: '',\r\n        ownerLastName: '',\r\n      });\r\n      fetchTenants();\r\n    } catch (error: any) {\r\n      console.error('Failed to create tenant:', error);\r\n      const errorMessage = error.response?.data?.error?.message || error.message || 'Failed to create tenant';\r\n      toast.error(errorMessage);\r\n    }\r\n  };\r\n\r\n  const handleEditTenant = (tenant: Tenant) => {\r\n    console.log('handleEditTenant called with tenant:', tenant);\r\n    setEditingTenant(tenant);\r\n    setEditFormData({\r\n      name: tenant.name,\r\n      slug: tenant.slug,\r\n      email: tenant.email,\r\n      phone: tenant.phone || '',\r\n      address: tenant.address || '',\r\n    });\r\n    setShowEditModal(true);\r\n    console.log('Edit modal should be open now, showEditModal:', true);\r\n  };\r\n\r\n  const handleUpdateTenant = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!editingTenant) return;\r\n\r\n    try {\r\n      await api.patch(`/tenants/${editingTenant.id}`, editFormData);\r\n      toast.success('Tenant updated successfully');\r\n      setShowEditModal(false);\r\n      setEditingTenant(null);\r\n      fetchTenants();\r\n    } catch (error: any) {\r\n      console.error('Failed to update tenant:', error);\r\n      const errorMessage = error.response?.data?.error?.message || error.response?.data?.message || error.message || 'Failed to update tenant';\r\n      toast.error(errorMessage);\r\n    }\r\n  };\r\n\r\n  const filteredTenants = tenants.filter(\r\n    (tenant) =>\r\n      tenant.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      tenant.email.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      tenant.slug.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  // Early return if not authenticated or not admin - show loading skeleton\r\n  if (!isAuthenticated || user?.role !== 'iitech_admin') {\r\n    return (\r\n      <Layout>\r\n        <div style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', minHeight: '50vh', padding: '3rem' }}>\r\n          <DashboardSkeleton />\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  // Show loading state\r\n  if (loading) {\r\n    return (\r\n      <Layout>\r\n        <div style={{ padding: '2rem' }}>\r\n          <div style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', minHeight: '50vh' }}>\r\n            <DashboardSkeleton />\r\n          </div>\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Layout>\r\n      <div style={{ padding: '2rem' }}>\r\n        {/* Header */}\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '2rem' }}>\r\n          <h1 style={{ margin: 0, color: '#1e293b', fontSize: '2rem', fontWeight: '700' }}>Tenants Management</h1>\r\n          <button\r\n            onClick={() => setShowCreateModal(true)}\r\n            style={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.5rem',\r\n              padding: '0.75rem 1.5rem',\r\n              background: '#000',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '8px',\r\n              cursor: 'pointer',\r\n              fontWeight: '600',\r\n              fontSize: '0.875rem',\r\n            }}\r\n            onMouseEnter={(e) => {\r\n              e.currentTarget.style.background = '#333';\r\n            }}\r\n            onMouseLeave={(e) => {\r\n              e.currentTarget.style.background = '#000';\r\n            }}\r\n          >\r\n            <Plus size={20} />\r\n            Create Tenant\r\n          </button>\r\n        </div>\r\n\r\n        {/* Search */}\r\n        <div style={{ marginBottom: '1.5rem' }}>\r\n          <div style={{ position: 'relative', maxWidth: '400px' }}>\r\n            <Search\r\n              size={20}\r\n              style={{\r\n                position: 'absolute',\r\n                left: '12px',\r\n                top: '50%',\r\n                transform: 'translateY(-50%)',\r\n                color: '#94a3b8',\r\n              }}\r\n            />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search tenants...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              style={{\r\n                width: '100%',\r\n                padding: '0.75rem 1rem 0.75rem 2.5rem',\r\n                border: '1px solid #e2e8f0',\r\n                borderRadius: '8px',\r\n                fontSize: '0.875rem',\r\n                outline: 'none',\r\n              }}\r\n              onFocus={(e) => {\r\n                e.currentTarget.style.borderColor = '#000';\r\n              }}\r\n              onBlur={(e) => {\r\n                e.currentTarget.style.borderColor = '#e2e8f0';\r\n              }}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Stats Cards */}\r\n        <div\r\n          style={{\r\n            display: 'grid',\r\n            gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',\r\n            gap: '1rem',\r\n            marginBottom: '2rem',\r\n          }}\r\n        >\r\n          <div\r\n            style={{\r\n              background: 'white',\r\n              padding: '1.5rem',\r\n              borderRadius: '8px',\r\n              boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n              border: '1px solid #e2e8f0',\r\n            }}\r\n          >\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '0.5rem' }}>\r\n              <Building2 size={24} color=\"#000\" />\r\n              <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Total Tenants</div>\r\n            </div>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#000' }}>{tenants.length}</div>\r\n          </div>\r\n          <div\r\n            style={{\r\n              background: 'white',\r\n              padding: '1.5rem',\r\n              borderRadius: '8px',\r\n              boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n              border: '1px solid #e2e8f0',\r\n            }}\r\n          >\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '0.5rem' }}>\r\n              <Users size={24} color=\"#000\" />\r\n              <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Total Users</div>\r\n            </div>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#000' }}>\r\n              {tenants.reduce((sum, t) => sum + (t._count?.users || 0), 0)}\r\n            </div>\r\n          </div>\r\n          <div\r\n            style={{\r\n              background: 'white',\r\n              padding: '1.5rem',\r\n              borderRadius: '8px',\r\n              boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n              border: '1px solid #e2e8f0',\r\n            }}\r\n          >\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '0.5rem' }}>\r\n              <DoorOpen size={24} color=\"#000\" />\r\n              <div style={{ color: '#64748b', fontSize: '0.875rem' }}>Total Rooms</div>\r\n            </div>\r\n            <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#000' }}>\r\n              {tenants.reduce((sum, t) => sum + (t._count?.rooms || 0), 0)}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Tenants Table */}\r\n        <div\r\n          style={{\r\n            background: 'white',\r\n            borderRadius: '8px',\r\n            boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n            overflow: 'hidden',\r\n            border: '1px solid #e2e8f0',\r\n          }}\r\n        >\r\n          <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n            <thead>\r\n              <tr style={{ background: '#f8fafc', borderBottom: '1px solid #e2e8f0' }}>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#000' }}>Name</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#000' }}>Slug</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#000' }}>Email</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#000' }}>Status</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#000' }}>Users</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#000' }}>Rooms</th>\r\n                <th style={{ padding: '1rem', textAlign: 'left', fontWeight: '600', color: '#000' }}>Created</th>\r\n                <th style={{ padding: '1rem', textAlign: 'right', fontWeight: '600', color: '#000' }}>Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {filteredTenants.length === 0 ? (\r\n                <tr>\r\n                  <td colSpan={8} style={{ padding: '3rem', textAlign: 'center', color: '#94a3b8' }}>\r\n                    {tenants.length === 0 ? 'No tenants found. Create your first tenant to get started.' : 'No tenants match your search.'}\r\n                  </td>\r\n                </tr>\r\n              ) : (\r\n                filteredTenants.map((tenant) => (\r\n                  <tr key={tenant.id} style={{ borderBottom: '1px solid #e2e8f0' }}>\r\n                    <td style={{ padding: '1rem', color: '#000', fontWeight: '500' }}>{tenant.name}</td>\r\n                    <td style={{ padding: '1rem', color: '#64748b', fontFamily: 'monospace', fontSize: '0.875rem' }}>\r\n                      {tenant.slug}\r\n                    </td>\r\n                    <td style={{ padding: '1rem', color: '#64748b' }}>{tenant.email}</td>\r\n                    <td style={{ padding: '1rem' }}>\r\n                      <span\r\n                        style={{\r\n                          padding: '0.25rem 0.75rem',\r\n                          borderRadius: '12px',\r\n                          fontSize: '0.75rem',\r\n                          fontWeight: '600',\r\n                          background: tenant.subscriptionStatus === 'active' ? '#d1fae5' : '#fee2e2',\r\n                          color: tenant.subscriptionStatus === 'active' ? '#065f46' : '#991b1b',\r\n                        }}\r\n                      >\r\n                        {tenant.subscriptionStatus}\r\n                      </span>\r\n                    </td>\r\n                    <td style={{ padding: '1rem', color: '#64748b' }}>{tenant._count?.users || 0}</td>\r\n                    <td style={{ padding: '1rem', color: '#64748b' }}>{tenant._count?.rooms || 0}</td>\r\n                    <td style={{ padding: '1rem', color: '#64748b', fontSize: '0.875rem' }}>\r\n                      {new Date(tenant.createdAt).toLocaleDateString()}\r\n                    </td>\r\n                    <td style={{ padding: '1rem', textAlign: 'right' }}>\r\n                      <div style={{ display: 'flex', gap: '0.5rem', justifyContent: 'flex-end' }}>\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={(e) => {\r\n                            e.preventDefault();\r\n                            e.stopPropagation();\r\n                            console.log('Edit button clicked for tenant:', tenant.id);\r\n                            handleEditTenant(tenant);\r\n                          }}\r\n                          style={{\r\n                            padding: '0.5rem',\r\n                            background: 'transparent',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            color: '#64748b',\r\n                            display: 'flex',\r\n                            alignItems: 'center',\r\n                            justifyContent: 'center',\r\n                            zIndex: 10,\r\n                            position: 'relative',\r\n                          }}\r\n                          title=\"Edit Tenant\"\r\n                          onMouseEnter={(e) => {\r\n                            e.currentTarget.style.color = '#000';\r\n                          }}\r\n                          onMouseLeave={(e) => {\r\n                            e.currentTarget.style.color = '#64748b';\r\n                          }}\r\n                        >\r\n                          <Edit size={16} />\r\n                        </button>\r\n                        <button\r\n                          style={{\r\n                            padding: '0.5rem',\r\n                            background: 'transparent',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            color: '#ef4444',\r\n                          }}\r\n                          title=\"Delete\"\r\n                          onMouseEnter={(e) => {\r\n                            e.currentTarget.style.color = '#dc2626';\r\n                          }}\r\n                          onMouseLeave={(e) => {\r\n                            e.currentTarget.style.color = '#ef4444';\r\n                          }}\r\n                        >\r\n                          <Trash2 size={16} />\r\n                        </button>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        {/* Create Tenant Modal */}\r\n        {showCreateModal && (\r\n          <div\r\n            style={{\r\n              position: 'fixed',\r\n              top: 0,\r\n              left: 0,\r\n              right: 0,\r\n              bottom: 0,\r\n              background: 'rgba(0,0,0,0.5)',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              zIndex: 1000,\r\n            }}\r\n            onClick={() => setShowCreateModal(false)}\r\n          >\r\n            <div\r\n              style={{\r\n                background: 'white',\r\n                borderRadius: '8px',\r\n                padding: '2rem',\r\n                maxWidth: '600px',\r\n                width: '90%',\r\n                maxHeight: '90vh',\r\n                overflow: 'auto',\r\n                boxShadow: '0 10px 25px rgba(0,0,0,0.2)',\r\n              }}\r\n              onClick={(e) => e.stopPropagation()}\r\n            >\r\n              <h2 style={{ marginTop: 0, marginBottom: '1.5rem', color: '#000', fontSize: '1.5rem', fontWeight: '700' }}>\r\n                Create New Tenant\r\n              </h2>\r\n              <form onSubmit={handleCreateTenant}>\r\n                <div style={{ display: 'grid', gap: '1rem', marginBottom: '1.5rem' }}>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#000', fontWeight: '500' }}>\r\n                      Tenant Name *\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      required\r\n                      value={formData.name}\r\n                      onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '0.875rem',\r\n                        outline: 'none',\r\n                      }}\r\n                      onFocus={(e) => {\r\n                        e.currentTarget.style.borderColor = '#000';\r\n                      }}\r\n                      onBlur={(e) => {\r\n                        e.currentTarget.style.borderColor = '#e2e8f0';\r\n                      }}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#000', fontWeight: '500' }}>\r\n                      Slug *\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      required\r\n                      value={formData.slug}\r\n                      onChange={(e) =>\r\n                        setFormData({ ...formData, slug: e.target.value.toLowerCase().replace(/[^a-z0-9-]/g, '') })\r\n                      }\r\n                      placeholder=\"e.g., grand-hotel\"\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontFamily: 'monospace',\r\n                        fontSize: '0.875rem',\r\n                        outline: 'none',\r\n                      }}\r\n                      onFocus={(e) => {\r\n                        e.currentTarget.style.borderColor = '#000';\r\n                      }}\r\n                      onBlur={(e) => {\r\n                        e.currentTarget.style.borderColor = '#e2e8f0';\r\n                      }}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#000', fontWeight: '500' }}>\r\n                      Email *\r\n                    </label>\r\n                    <input\r\n                      type=\"email\"\r\n                      required\r\n                      value={formData.email}\r\n                      onChange={(e) => setFormData({ ...formData, email: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '0.875rem',\r\n                        outline: 'none',\r\n                      }}\r\n                      onFocus={(e) => {\r\n                        e.currentTarget.style.borderColor = '#000';\r\n                      }}\r\n                      onBlur={(e) => {\r\n                        e.currentTarget.style.borderColor = '#e2e8f0';\r\n                      }}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#000', fontWeight: '500' }}>\r\n                      Phone\r\n                    </label>\r\n                    <input\r\n                      type=\"tel\"\r\n                      value={formData.phone}\r\n                      onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '0.875rem',\r\n                        outline: 'none',\r\n                      }}\r\n                      onFocus={(e) => {\r\n                        e.currentTarget.style.borderColor = '#000';\r\n                      }}\r\n                      onBlur={(e) => {\r\n                        e.currentTarget.style.borderColor = '#e2e8f0';\r\n                      }}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#000', fontWeight: '500' }}>\r\n                      Address\r\n                    </label>\r\n                    <textarea\r\n                      value={formData.address}\r\n                      onChange={(e) => setFormData({ ...formData, address: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        resize: 'vertical',\r\n                        fontSize: '0.875rem',\r\n                        outline: 'none',\r\n                      }}\r\n                      rows={3}\r\n                      onFocus={(e) => {\r\n                        e.currentTarget.style.borderColor = '#000';\r\n                      }}\r\n                      onBlur={(e) => {\r\n                        e.currentTarget.style.borderColor = '#e2e8f0';\r\n                      }}\r\n                    />\r\n                  </div>\r\n                  <div style={{ borderTop: '1px solid #e2e8f0', paddingTop: '1rem', marginTop: '0.5rem' }}>\r\n                    <h3 style={{ marginBottom: '1rem', color: '#000', fontSize: '1rem', fontWeight: '600' }}>\r\n                      Owner Account\r\n                    </h3>\r\n                    <div style={{ display: 'grid', gap: '1rem' }}>\r\n                      <div>\r\n                        <label style={{ display: 'block', marginBottom: '0.5rem', color: '#000', fontWeight: '500' }}>\r\n                          Owner Email *\r\n                        </label>\r\n                        <input\r\n                          type=\"email\"\r\n                          required\r\n                          value={formData.ownerEmail}\r\n                          onChange={(e) => setFormData({ ...formData, ownerEmail: e.target.value })}\r\n                          style={{\r\n                            width: '100%',\r\n                            padding: '0.75rem',\r\n                            border: '1px solid #e2e8f0',\r\n                            borderRadius: '6px',\r\n                            fontSize: '0.875rem',\r\n                            outline: 'none',\r\n                          }}\r\n                          onFocus={(e) => {\r\n                            e.currentTarget.style.borderColor = '#000';\r\n                          }}\r\n                          onBlur={(e) => {\r\n                            e.currentTarget.style.borderColor = '#e2e8f0';\r\n                          }}\r\n                        />\r\n                      </div>\r\n                      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>\r\n                        <div>\r\n                          <label style={{ display: 'block', marginBottom: '0.5rem', color: '#000', fontWeight: '500' }}>\r\n                            First Name *\r\n                          </label>\r\n                          <input\r\n                            type=\"text\"\r\n                            required\r\n                            value={formData.ownerFirstName}\r\n                            onChange={(e) => setFormData({ ...formData, ownerFirstName: e.target.value })}\r\n                            style={{\r\n                              width: '100%',\r\n                              padding: '0.75rem',\r\n                              border: '1px solid #e2e8f0',\r\n                              borderRadius: '6px',\r\n                              fontSize: '0.875rem',\r\n                              outline: 'none',\r\n                            }}\r\n                            onFocus={(e) => {\r\n                              e.currentTarget.style.borderColor = '#000';\r\n                            }}\r\n                            onBlur={(e) => {\r\n                              e.currentTarget.style.borderColor = '#e2e8f0';\r\n                            }}\r\n                          />\r\n                        </div>\r\n                        <div>\r\n                          <label style={{ display: 'block', marginBottom: '0.5rem', color: '#000', fontWeight: '500' }}>\r\n                            Last Name *\r\n                          </label>\r\n                          <input\r\n                            type=\"text\"\r\n                            required\r\n                            value={formData.ownerLastName}\r\n                            onChange={(e) => setFormData({ ...formData, ownerLastName: e.target.value })}\r\n                            style={{\r\n                              width: '100%',\r\n                              padding: '0.75rem',\r\n                              border: '1px solid #e2e8f0',\r\n                              borderRadius: '6px',\r\n                              fontSize: '0.875rem',\r\n                              outline: 'none',\r\n                            }}\r\n                            onFocus={(e) => {\r\n                              e.currentTarget.style.borderColor = '#000';\r\n                            }}\r\n                            onBlur={(e) => {\r\n                              e.currentTarget.style.borderColor = '#e2e8f0';\r\n                            }}\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                      <div>\r\n                        <label style={{ display: 'block', marginBottom: '0.5rem', color: '#000', fontWeight: '500' }}>\r\n                          Password *\r\n                        </label>\r\n                        <input\r\n                          type=\"password\"\r\n                          required\r\n                          minLength={6}\r\n                          value={formData.ownerPassword}\r\n                          onChange={(e) => setFormData({ ...formData, ownerPassword: e.target.value })}\r\n                          style={{\r\n                            width: '100%',\r\n                            padding: '0.75rem',\r\n                            border: '1px solid #e2e8f0',\r\n                            borderRadius: '6px',\r\n                            fontSize: '0.875rem',\r\n                            outline: 'none',\r\n                          }}\r\n                          onFocus={(e) => {\r\n                            e.currentTarget.style.borderColor = '#000';\r\n                          }}\r\n                          onBlur={(e) => {\r\n                            e.currentTarget.style.borderColor = '#e2e8f0';\r\n                          }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div style={{ display: 'flex', gap: '1rem', justifyContent: 'flex-end' }}>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => setShowCreateModal(false)}\r\n                    style={{\r\n                      padding: '0.75rem 1.5rem',\r\n                      background: '#f1f5f9',\r\n                      color: '#000',\r\n                      border: 'none',\r\n                      borderRadius: '6px',\r\n                      cursor: 'pointer',\r\n                      fontWeight: '500',\r\n                    }}\r\n                    onMouseEnter={(e) => {\r\n                      e.currentTarget.style.background = '#e2e8f0';\r\n                    }}\r\n                    onMouseLeave={(e) => {\r\n                      e.currentTarget.style.background = '#f1f5f9';\r\n                    }}\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                  <button\r\n                    type=\"submit\"\r\n                    style={{\r\n                      padding: '0.75rem 1.5rem',\r\n                      background: '#000',\r\n                      color: 'white',\r\n                      border: 'none',\r\n                      borderRadius: '6px',\r\n                      cursor: 'pointer',\r\n                      fontWeight: '600',\r\n                    }}\r\n                    onMouseEnter={(e) => {\r\n                      e.currentTarget.style.background = '#333';\r\n                    }}\r\n                    onMouseLeave={(e) => {\r\n                      e.currentTarget.style.background = '#000';\r\n                    }}\r\n                  >\r\n                    Create Tenant\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Edit Tenant Modal */}\r\n        {showEditModal && editingTenant && (\r\n          <div\r\n            style={{\r\n              position: 'fixed',\r\n              top: 0,\r\n              left: 0,\r\n              right: 0,\r\n              bottom: 0,\r\n              background: 'rgba(0,0,0,0.5)',\r\n              display: 'flex',\r\n              justifyContent: 'center',\r\n              alignItems: 'center',\r\n              zIndex: 1000,\r\n            }}\r\n            onClick={() => {\r\n              setShowEditModal(false);\r\n              setEditingTenant(null);\r\n            }}\r\n          >\r\n            <div\r\n              style={{\r\n                background: 'white',\r\n                borderRadius: '8px',\r\n                padding: '2rem',\r\n                width: '90%',\r\n                maxWidth: '600px',\r\n                maxHeight: '90vh',\r\n                overflow: 'auto',\r\n                boxShadow: '0 10px 25px rgba(0,0,0,0.2)',\r\n              }}\r\n              onClick={(e) => e.stopPropagation()}\r\n            >\r\n              <h2 style={{ marginTop: 0, marginBottom: '1.5rem', color: '#000', fontSize: '1.5rem', fontWeight: '700' }}>\r\n                Edit Tenant\r\n              </h2>\r\n              <form onSubmit={handleUpdateTenant}>\r\n                <div style={{ display: 'grid', gap: '1rem', marginBottom: '1.5rem' }}>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#000', fontWeight: '500' }}>\r\n                      Tenant Name *\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      required\r\n                      value={editFormData.name}\r\n                      onChange={(e) => setEditFormData({ ...editFormData, name: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '0.875rem',\r\n                        outline: 'none',\r\n                      }}\r\n                      onFocus={(e) => {\r\n                        e.currentTarget.style.borderColor = '#000';\r\n                      }}\r\n                      onBlur={(e) => {\r\n                        e.currentTarget.style.borderColor = '#e2e8f0';\r\n                      }}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#000', fontWeight: '500' }}>\r\n                      Slug *\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      required\r\n                      value={editFormData.slug}\r\n                      onChange={(e) =>\r\n                        setEditFormData({ ...editFormData, slug: e.target.value.toLowerCase().replace(/[^a-z0-9-]/g, '') })\r\n                      }\r\n                      placeholder=\"e.g., grand-hotel\"\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontFamily: 'monospace',\r\n                        fontSize: '0.875rem',\r\n                        outline: 'none',\r\n                      }}\r\n                      onFocus={(e) => {\r\n                        e.currentTarget.style.borderColor = '#000';\r\n                      }}\r\n                      onBlur={(e) => {\r\n                        e.currentTarget.style.borderColor = '#e2e8f0';\r\n                      }}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#000', fontWeight: '500' }}>\r\n                      Email *\r\n                    </label>\r\n                    <input\r\n                      type=\"email\"\r\n                      required\r\n                      value={editFormData.email}\r\n                      onChange={(e) => setEditFormData({ ...editFormData, email: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '0.875rem',\r\n                        outline: 'none',\r\n                      }}\r\n                      onFocus={(e) => {\r\n                        e.currentTarget.style.borderColor = '#000';\r\n                      }}\r\n                      onBlur={(e) => {\r\n                        e.currentTarget.style.borderColor = '#e2e8f0';\r\n                      }}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#000', fontWeight: '500' }}>\r\n                      Phone\r\n                    </label>\r\n                    <input\r\n                      type=\"tel\"\r\n                      value={editFormData.phone}\r\n                      onChange={(e) => setEditFormData({ ...editFormData, phone: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '0.875rem',\r\n                        outline: 'none',\r\n                      }}\r\n                      onFocus={(e) => {\r\n                        e.currentTarget.style.borderColor = '#000';\r\n                      }}\r\n                      onBlur={(e) => {\r\n                        e.currentTarget.style.borderColor = '#e2e8f0';\r\n                      }}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#000', fontWeight: '500' }}>\r\n                      Address\r\n                    </label>\r\n                    <textarea\r\n                      value={editFormData.address}\r\n                      onChange={(e) => setEditFormData({ ...editFormData, address: e.target.value })}\r\n                      rows={3}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '0.875rem',\r\n                        outline: 'none',\r\n                        resize: 'vertical',\r\n                      }}\r\n                      onFocus={(e) => {\r\n                        e.currentTarget.style.borderColor = '#000';\r\n                      }}\r\n                      onBlur={(e) => {\r\n                        e.currentTarget.style.borderColor = '#e2e8f0';\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div style={{ display: 'flex', gap: '1rem', justifyContent: 'flex-end' }}>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => {\r\n                      setShowEditModal(false);\r\n                      setEditingTenant(null);\r\n                    }}\r\n                    style={{\r\n                      padding: '0.75rem 1.5rem',\r\n                      background: '#f1f5f9',\r\n                      color: '#000',\r\n                      border: 'none',\r\n                      borderRadius: '6px',\r\n                      cursor: 'pointer',\r\n                      fontWeight: '500',\r\n                    }}\r\n                    onMouseEnter={(e) => {\r\n                      e.currentTarget.style.background = '#e2e8f0';\r\n                    }}\r\n                    onMouseLeave={(e) => {\r\n                      e.currentTarget.style.background = '#f1f5f9';\r\n                    }}\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                  <button\r\n                    type=\"submit\"\r\n                    style={{\r\n                      padding: '0.75rem 1.5rem',\r\n                      background: '#000',\r\n                      color: 'white',\r\n                      border: 'none',\r\n                      borderRadius: '6px',\r\n                      cursor: 'pointer',\r\n                      fontWeight: '600',\r\n                    }}\r\n                    onMouseEnter={(e) => {\r\n                      e.currentTarget.style.background = '#333';\r\n                    }}\r\n                    onMouseLeave={(e) => {\r\n                      e.currentTarget.style.background = '#000';\r\n                    }}\r\n                  >\r\n                    Update Tenant\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </Layout>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\pages\\WagePlansPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchStaff'. Either include it or remove the dependency array.","line":108,"column":6,"nodeType":"ArrayExpression","endLine":108,"endColumn":28,"suggestions":[{"desc":"Update the dependencies array to be: [user, fetchWagePlans, fetchStaff]","fix":{"range":[3872,3894],"text":"[user, fetchWagePlans, fetchStaff]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useCallback, useMemo } from 'react';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport { api } from '../lib/api';\r\nimport Layout from '../components/Layout';\r\nimport { Plus, Edit, Trash2, X, Users, Wallet } from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\nimport { CardSkeleton } from '../components/LoadingSkeleton';\r\nimport SearchInput from '../components/SearchInput';\r\nimport { useDebounce } from '../hooks/useDebounce';\r\nimport EmptyState from '../components/EmptyState';\r\n\r\ninterface WagePlan {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  roleClassification: 'normal_staff' | 'supervisor' | 'manager' | 'senior_executive';\r\n  role?: string;\r\n  wageType: 'hourly' | 'daily' | 'weekly' | 'monthly' | 'annual';\r\n  baseAmount: number;\r\n  currency: string;\r\n  overtimeRate?: number;\r\n  benefits: string[];\r\n  isActive: boolean;\r\n  createdAt?: Date;\r\n  updatedAt?: Date;\r\n}\r\n\r\nconst roleClassificationLabels: Record<string, string> = {\r\n  normal_staff: 'Normal Staff',\r\n  supervisor: 'Supervisor',\r\n  manager: 'Manager',\r\n  senior_executive: 'Senior Executive',\r\n};\r\n\r\nconst wageTypeLabels: Record<string, string> = {\r\n  hourly: 'Per Hour',\r\n  daily: 'Per Day',\r\n  weekly: 'Per Week',\r\n  monthly: 'Per Month',\r\n  annual: 'Per Year',\r\n};\r\n\r\nexport default function WagePlansPage() {\r\n  const { user } = useAuthStore();\r\n  const [wagePlans, setWagePlans] = useState<WagePlan[]>([]);\r\n  const [staff, setStaff] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const [showAssignModal, setShowAssignModal] = useState(false);\r\n  const [selectedWagePlan, setSelectedWagePlan] = useState<WagePlan | null>(null);\r\n  const [selectedStaff, setSelectedStaff] = useState<string>('');\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const debouncedSearchTerm = useDebounce(searchTerm, 500);\r\n  const [filterClassification, setFilterClassification] = useState<string>('');\r\n  const [filterActive, setFilterActive] = useState<boolean | null>(null);\r\n  const [saving, setSaving] = useState(false);\r\n  const [deletingPlans, setDeletingPlans] = useState<Set<string>>(new Set());\r\n  const [formData, setFormData] = useState<{\r\n    name: string;\r\n    description: string;\r\n    roleClassification: 'normal_staff' | 'supervisor' | 'manager' | 'senior_executive';\r\n    role: string;\r\n    wageType: 'hourly' | 'daily' | 'weekly' | 'monthly' | 'annual';\r\n    baseAmount: string;\r\n    currency: string;\r\n    overtimeRate: string;\r\n    benefits: string[];\r\n    newBenefit: string;\r\n    isActive: boolean;\r\n  }>({\r\n    name: '',\r\n    description: '',\r\n    roleClassification: 'normal_staff',\r\n    role: '',\r\n    wageType: 'monthly',\r\n    baseAmount: '',\r\n    currency: 'NGN',\r\n    overtimeRate: '',\r\n    benefits: [],\r\n    newBenefit: '',\r\n    isActive: true,\r\n  });\r\n\r\n  const fetchWagePlans = useCallback(async () => {\r\n    if (!user?.tenantId) return;\r\n    setLoading(true);\r\n    try {\r\n      const params: any = {};\r\n      if (filterClassification) params.roleClassification = filterClassification;\r\n      if (filterActive !== null) params.isActive = filterActive.toString();\r\n\r\n      const response = await api.get(`/tenants/${user.tenantId}/wage-plans`, { params });\r\n      setWagePlans(response.data.data || []);\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch wage plans:', error);\r\n      toast.error(error.response?.data?.error?.message || error.response?.data?.message || 'Failed to fetch wage plans');\r\n      setWagePlans([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [user?.tenantId, filterClassification, filterActive]);\r\n\r\n  useEffect(() => {\r\n    if (!user?.tenantId) return;\r\n    fetchWagePlans();\r\n    fetchStaff();\r\n  }, [user, fetchWagePlans]);\r\n\r\n  const fetchStaff = useCallback(async () => {\r\n    if (!user?.tenantId) return;\r\n    try {\r\n      const response = await api.get(`/tenants/${user.tenantId}/staff`);\r\n      setStaff(response.data.data || []);\r\n    } catch (error: any) {\r\n      console.error('Failed to fetch staff:', error);\r\n      toast.error(error.response?.data?.error?.message || 'Failed to fetch staff');\r\n    }\r\n  }, [user?.tenantId]);\r\n\r\n  const handleCreate = async () => {\r\n    if (!formData.name || !formData.baseAmount) {\r\n      toast.error('Please fill in all required fields');\r\n      return;\r\n    }\r\n\r\n    setSaving(true);\r\n    try {\r\n      const wagePlanData: any = {\r\n        name: formData.name,\r\n        description: formData.description || undefined,\r\n        roleClassification: formData.roleClassification,\r\n        wageType: formData.wageType,\r\n        baseAmount: parseFloat(formData.baseAmount),\r\n        currency: formData.currency,\r\n        benefits: formData.benefits,\r\n        isActive: formData.isActive,\r\n      };\r\n\r\n      if (formData.role) {\r\n        wagePlanData.role = formData.role;\r\n      }\r\n\r\n      if (formData.overtimeRate) {\r\n        wagePlanData.overtimeRate = parseFloat(formData.overtimeRate);\r\n      }\r\n\r\n      await api.post(`/tenants/${user?.tenantId}/wage-plans`, wagePlanData);\r\n      toast.success('Wage plan created successfully');\r\n      setShowCreateModal(false);\r\n      resetForm();\r\n      fetchWagePlans();\r\n    } catch (error: any) {\r\n      console.error('Failed to create wage plan:', error);\r\n      toast.error(error.response?.data?.error?.message || error.response?.data?.message || 'Failed to create wage plan');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleEdit = async () => {\r\n    if (!selectedWagePlan) return;\r\n\r\n    if (!formData.name || !formData.baseAmount) {\r\n      toast.error('Please fill in all required fields');\r\n      return;\r\n    }\r\n\r\n    setSaving(true);\r\n    try {\r\n      const wagePlanData: any = {\r\n        name: formData.name,\r\n        description: formData.description || undefined,\r\n        roleClassification: formData.roleClassification,\r\n        wageType: formData.wageType,\r\n        baseAmount: parseFloat(formData.baseAmount),\r\n        currency: formData.currency,\r\n        benefits: formData.benefits,\r\n        isActive: formData.isActive,\r\n      };\r\n\r\n      if (formData.role) {\r\n        wagePlanData.role = formData.role;\r\n      } else {\r\n        wagePlanData.role = null;\r\n      }\r\n\r\n      if (formData.overtimeRate) {\r\n        wagePlanData.overtimeRate = parseFloat(formData.overtimeRate);\r\n      } else {\r\n        wagePlanData.overtimeRate = null;\r\n      }\r\n\r\n      await api.patch(`/tenants/${user?.tenantId}/wage-plans/${selectedWagePlan.id}`, wagePlanData);\r\n      toast.success('Wage plan updated successfully');\r\n      setShowEditModal(false);\r\n      setSelectedWagePlan(null);\r\n      resetForm();\r\n      fetchWagePlans();\r\n    } catch (error: any) {\r\n      console.error('Failed to update wage plan:', error);\r\n      toast.error(error.response?.data?.error?.message || error.response?.data?.message || 'Failed to update wage plan');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (wagePlanId: string) => {\r\n    if (!window.confirm('Are you sure you want to delete this wage plan?')) return;\r\n\r\n    setDeletingPlans(prev => new Set(prev).add(wagePlanId));\r\n    try {\r\n      await api.delete(`/tenants/${user?.tenantId}/wage-plans/${wagePlanId}`);\r\n      toast.success('Wage plan deleted successfully');\r\n      fetchWagePlans();\r\n    } catch (error: any) {\r\n      console.error('Failed to delete wage plan:', error);\r\n      toast.error(error.response?.data?.error?.message || error.response?.data?.message || 'Failed to delete wage plan');\r\n    } finally {\r\n      setDeletingPlans(prev => {\r\n        const next = new Set(prev);\r\n        next.delete(wagePlanId);\r\n        return next;\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleAssign = async () => {\r\n    if (!selectedWagePlan || !selectedStaff) {\r\n      toast.error('Please select a staff member');\r\n      return;\r\n    }\r\n\r\n    setSaving(true);\r\n    try {\r\n      await api.post(`/tenants/${user?.tenantId}/wage-plans/${selectedWagePlan.id}/assign-to-staff/${selectedStaff}`);\r\n      toast.success('Wage plan assigned successfully');\r\n      setShowAssignModal(false);\r\n      setSelectedWagePlan(null);\r\n      setSelectedStaff('');\r\n      fetchStaff();\r\n    } catch (error: any) {\r\n      console.error('Failed to assign wage plan:', error);\r\n      toast.error(error.response?.data?.error?.message || error.response?.data?.message || 'Failed to assign wage plan');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleEditClick = (wagePlan: WagePlan) => {\r\n    setSelectedWagePlan(wagePlan);\r\n    setFormData({\r\n      name: wagePlan.name,\r\n      description: wagePlan.description || '',\r\n      roleClassification: wagePlan.roleClassification,\r\n      role: wagePlan.role || '',\r\n      wageType: wagePlan.wageType,\r\n      baseAmount: wagePlan.baseAmount.toString(),\r\n      currency: wagePlan.currency,\r\n      overtimeRate: wagePlan.overtimeRate?.toString() || '',\r\n      benefits: wagePlan.benefits || [],\r\n      newBenefit: '',\r\n      isActive: wagePlan.isActive,\r\n    });\r\n    setShowEditModal(true);\r\n  };\r\n\r\n  const handleAssignClick = (wagePlan: WagePlan) => {\r\n    setSelectedWagePlan(wagePlan);\r\n    setSelectedStaff('');\r\n    setShowAssignModal(true);\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFormData({\r\n      name: '',\r\n      description: '',\r\n      roleClassification: 'normal_staff',\r\n      role: '',\r\n      wageType: 'monthly',\r\n      baseAmount: '',\r\n      currency: 'NGN',\r\n      overtimeRate: '',\r\n      benefits: [],\r\n      newBenefit: '',\r\n      isActive: true,\r\n    });\r\n  };\r\n\r\n  const addBenefit = () => {\r\n    if (formData.newBenefit.trim()) {\r\n      setFormData({\r\n        ...formData,\r\n        benefits: [...formData.benefits, formData.newBenefit.trim()],\r\n        newBenefit: '',\r\n      });\r\n    }\r\n  };\r\n\r\n  const removeBenefit = (index: number) => {\r\n    setFormData({\r\n      ...formData,\r\n      benefits: formData.benefits.filter((_, i) => i !== index),\r\n    });\r\n  };\r\n\r\n  const filteredWagePlans = useMemo(() => wagePlans.filter((plan) => {\r\n    if (!debouncedSearchTerm) return true;\r\n    const searchLower = debouncedSearchTerm.toLowerCase();\r\n    return (\r\n      plan.name.toLowerCase().includes(searchLower) ||\r\n      plan.description?.toLowerCase().includes(searchLower) ||\r\n      (plan.role && plan.role.toLowerCase().includes(searchLower))\r\n    );\r\n  }), [wagePlans, debouncedSearchTerm]);\r\n\r\n  // Group by classification\r\n  const groupedPlans = useMemo(() => filteredWagePlans.reduce((acc: Record<string, WagePlan[]>, plan: WagePlan) => {\r\n    const key = plan.roleClassification;\r\n    if (!acc[key]) {\r\n      acc[key] = [];\r\n    }\r\n    acc[key].push(plan);\r\n    return acc;\r\n  }, {} as Record<string, WagePlan[]>), [filteredWagePlans]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <Layout>\r\n        <div>\r\n          <h1 style={{ marginBottom: '1.5rem', color: '#1e293b' }}>Wage Plans</h1>\r\n          <CardSkeleton count={6} />\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Layout>\r\n      <div>\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n          <h1 style={{ color: '#1e293b' }}>Wage Plans</h1>\r\n          <button\r\n            onClick={() => {\r\n              resetForm();\r\n              setShowCreateModal(true);\r\n            }}\r\n            style={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '0.5rem',\r\n              padding: '0.75rem 1.5rem',\r\n              background: '#3b82f6',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '6px',\r\n              cursor: 'pointer',\r\n              fontWeight: '500',\r\n            }}\r\n          >\r\n            <Plus size={20} />\r\n            Create Wage Plan\r\n          </button>\r\n        </div>\r\n\r\n        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1.5rem', flexWrap: 'wrap' }}>\r\n          <div style={{ flex: 1, minWidth: '300px' }}>\r\n            <SearchInput\r\n              placeholder=\"Search wage plans...\"\r\n              value={searchTerm}\r\n              onChange={(value) => setSearchTerm(value)}\r\n            />\r\n          </div>\r\n          <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n            <select\r\n              value={filterClassification}\r\n              onChange={(e) => setFilterClassification(e.target.value)}\r\n              style={{\r\n                padding: '0.5rem 1rem',\r\n                border: '1px solid #e2e8f0',\r\n                borderRadius: '6px',\r\n                background: 'white',\r\n                color: '#64748b',\r\n                cursor: 'pointer',\r\n              }}\r\n            >\r\n              <option value=\"\">All Classifications</option>\r\n              <option value=\"normal_staff\">Normal Staff</option>\r\n              <option value=\"supervisor\">Supervisor</option>\r\n              <option value=\"manager\">Manager</option>\r\n              <option value=\"senior_executive\">Senior Executive</option>\r\n            </select>\r\n            <button\r\n              onClick={() => setFilterActive(null)}\r\n              style={{\r\n                padding: '0.5rem 1rem',\r\n                border: '1px solid #e2e8f0',\r\n                borderRadius: '6px',\r\n                background: filterActive === null ? '#3b82f6' : 'white',\r\n                color: filterActive === null ? 'white' : '#64748b',\r\n                cursor: 'pointer',\r\n              }}\r\n            >\r\n              All\r\n            </button>\r\n            <button\r\n              onClick={() => setFilterActive(true)}\r\n              style={{\r\n                padding: '0.5rem 1rem',\r\n                border: '1px solid #e2e8f0',\r\n                borderRadius: '6px',\r\n                background: filterActive === true ? '#10b981' : 'white',\r\n                color: filterActive === true ? 'white' : '#64748b',\r\n                cursor: 'pointer',\r\n              }}\r\n            >\r\n              Active\r\n            </button>\r\n            <button\r\n              onClick={() => setFilterActive(false)}\r\n              style={{\r\n                padding: '0.5rem 1rem',\r\n                border: '1px solid #e2e8f0',\r\n                borderRadius: '6px',\r\n                background: filterActive === false ? '#ef4444' : 'white',\r\n                color: filterActive === false ? 'white' : '#64748b',\r\n                cursor: 'pointer',\r\n              }}\r\n            >\r\n              Inactive\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {!loading && filteredWagePlans.length === 0 ? (\r\n          <EmptyState\r\n            icon={Wallet}\r\n            title={searchTerm || filterClassification ? 'No wage plans match your filters' : 'No wage plans yet'}\r\n            description={searchTerm || filterClassification\r\n              ? 'Try adjusting your search or filter criteria'\r\n              : 'Create your first wage plan to get started'}\r\n            action={searchTerm || filterClassification ? undefined : {\r\n              label: 'Create Wage Plan',\r\n              onClick: () => {\r\n                resetForm();\r\n                setShowCreateModal(true);\r\n              },\r\n            }}\r\n          />\r\n        ) : (\r\n          <div style={{ display: 'flex', flexDirection: 'column', gap: '2rem' }}>\r\n            {Object.entries(groupedPlans).map(([classification, plans]) => (\r\n              <div key={classification}>\r\n                <div style={{ marginBottom: '1rem', paddingBottom: '0.5rem', borderBottom: '2px solid #e2e8f0' }}>\r\n                  <h2 style={{ margin: 0, color: '#1e293b', fontSize: '1.25rem', fontWeight: '600' }}>\r\n                    {roleClassificationLabels[classification]} ({plans.length})\r\n                  </h2>\r\n                </div>\r\n                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(350px, 1fr))', gap: '1.5rem' }}>\r\n                  {plans.map((plan) => (\r\n                    <div\r\n                      key={plan.id}\r\n                      style={{\r\n                        background: 'white',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '8px',\r\n                        padding: '1.5rem',\r\n                        boxShadow: '0 1px 3px rgba(0,0,0,0.1)',\r\n                      }}\r\n                    >\r\n                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1rem' }}>\r\n                        <div>\r\n                          <h3 style={{ margin: 0, color: '#1e293b', fontSize: '1.25rem', fontWeight: '600' }}>\r\n                            {plan.name}\r\n                          </h3>\r\n                          {plan.description && (\r\n                            <p style={{ margin: '0.5rem 0 0', color: '#64748b', fontSize: '0.875rem' }}>\r\n                              {plan.description}\r\n                            </p>\r\n                          )}\r\n                          {plan.role && (\r\n                            <p style={{ margin: '0.5rem 0 0', fontSize: '0.875rem', color: '#64748b' }}>\r\n                              Role: {plan.role}\r\n                            </p>\r\n                          )}\r\n                        </div>\r\n                        <span\r\n                          style={{\r\n                            padding: '0.25rem 0.75rem',\r\n                            borderRadius: '12px',\r\n                            fontSize: '0.75rem',\r\n                            fontWeight: '500',\r\n                            background: plan.isActive ? '#d1fae5' : '#fee2e2',\r\n                            color: plan.isActive ? '#065f46' : '#991b1b',\r\n                          }}\r\n                        >\r\n                          {plan.isActive ? 'Active' : 'Inactive'}\r\n                        </span>\r\n                      </div>\r\n\r\n                      <div style={{ marginBottom: '1rem' }}>\r\n                        <div style={{ display: 'flex', alignItems: 'baseline', gap: '0.5rem' }}>\r\n                          <span style={{ fontSize: '2rem', fontWeight: '700', color: '#1e293b' }}>\r\n                            {plan.currency} {plan.baseAmount.toLocaleString()}\r\n                          </span>\r\n                          <span style={{ color: '#64748b', fontSize: '0.875rem' }}>\r\n                            {wageTypeLabels[plan.wageType]}\r\n                          </span>\r\n                        </div>\r\n                        {plan.overtimeRate && (\r\n                          <p style={{ margin: '0.5rem 0 0', fontSize: '0.875rem', color: '#64748b' }}>\r\n                            Overtime: {plan.overtimeRate}x\r\n                          </p>\r\n                        )}\r\n                      </div>\r\n\r\n                      {plan.benefits && plan.benefits.length > 0 && (\r\n                        <div style={{ marginBottom: '1rem' }}>\r\n                          <p style={{ margin: '0 0 0.5rem', fontSize: '0.875rem', color: '#64748b', fontWeight: '500' }}>\r\n                            Benefits:\r\n                          </p>\r\n                          <ul style={{ margin: 0, paddingLeft: '1.25rem', fontSize: '0.875rem', color: '#64748b' }}>\r\n                            {plan.benefits.map((benefit: string, idx: number) => (\r\n                              <li key={idx}>{benefit}</li>\r\n                            ))}\r\n                          </ul>\r\n                        </div>\r\n                      )}\r\n\r\n                      <div style={{ display: 'flex', gap: '0.5rem', borderTop: '1px solid #e2e8f0', paddingTop: '1rem' }}>\r\n                        <button\r\n                          onClick={() => handleAssignClick(plan)}\r\n                          style={{\r\n                            flex: 1,\r\n                            padding: '0.5rem',\r\n                            border: '1px solid #e2e8f0',\r\n                            borderRadius: '6px',\r\n                            background: 'white',\r\n                            color: '#64748b',\r\n                            cursor: 'pointer',\r\n                            display: 'flex',\r\n                            alignItems: 'center',\r\n                            justifyContent: 'center',\r\n                            gap: '0.5rem',\r\n                            fontSize: '0.875rem',\r\n                          }}\r\n                          title=\"Assign to Staff\"\r\n                        >\r\n                          <Users size={16} />\r\n                          Assign\r\n                        </button>\r\n                        <button\r\n                          onClick={() => handleEditClick(plan)}\r\n                          style={{\r\n                            flex: 1,\r\n                            padding: '0.5rem',\r\n                            border: '1px solid #e2e8f0',\r\n                            borderRadius: '6px',\r\n                            background: 'white',\r\n                            color: '#64748b',\r\n                            cursor: 'pointer',\r\n                            display: 'flex',\r\n                            alignItems: 'center',\r\n                            justifyContent: 'center',\r\n                            gap: '0.5rem',\r\n                            fontSize: '0.875rem',\r\n                          }}\r\n                        >\r\n                          <Edit size={16} />\r\n                          Edit\r\n                        </button>\r\n                        <button\r\n                          onClick={() => handleDelete(plan.id)}\r\n                          disabled={deletingPlans.has(plan.id)}\r\n                          style={{\r\n                            flex: 1,\r\n                            padding: '0.5rem',\r\n                            border: '1px solid #fee2e2',\r\n                            borderRadius: '6px',\r\n                            background: 'white',\r\n                            color: deletingPlans.has(plan.id) ? '#94a3b8' : '#ef4444',\r\n                            cursor: deletingPlans.has(plan.id) ? 'not-allowed' : 'pointer',\r\n                            opacity: deletingPlans.has(plan.id) ? 0.6 : 1,\r\n                            display: 'flex',\r\n                            alignItems: 'center',\r\n                            justifyContent: 'center',\r\n                            gap: '0.5rem',\r\n                            fontSize: '0.875rem',\r\n                          }}\r\n                        >\r\n                          <Trash2 size={16} />\r\n                          {deletingPlans.has(plan.id) ? 'Deleting...' : 'Delete'}\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {/* Create Modal */}\r\n        {showCreateModal && (\r\n          <div\r\n            style={{\r\n              position: 'fixed',\r\n              top: 0,\r\n              left: 0,\r\n              right: 0,\r\n              bottom: 0,\r\n              background: 'rgba(0,0,0,0.5)',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              zIndex: 1000,\r\n            }}\r\n            onClick={() => setShowCreateModal(false)}\r\n          >\r\n            <div\r\n              style={{\r\n                background: 'white',\r\n                borderRadius: '8px',\r\n                padding: '2rem',\r\n                width: '90%',\r\n                maxWidth: '600px',\r\n                maxHeight: '90vh',\r\n                overflow: 'auto',\r\n              }}\r\n              onClick={(e) => e.stopPropagation()}\r\n            >\r\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n                <h2 style={{ margin: 0, color: '#1e293b' }}>Create Wage Plan</h2>\r\n                <button\r\n                  onClick={() => setShowCreateModal(false)}\r\n                  style={{\r\n                    background: 'none',\r\n                    border: 'none',\r\n                    cursor: 'pointer',\r\n                    padding: '0.5rem',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                  }}\r\n                >\r\n                  <X size={20} color=\"#64748b\" />\r\n                </button>\r\n              </div>\r\n\r\n              <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                    Plan Name *\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={formData.name}\r\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                    placeholder=\"e.g., Standard Chef Wage\"\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      fontSize: '1rem',\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                    Description\r\n                  </label>\r\n                  <textarea\r\n                    value={formData.description}\r\n                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      fontSize: '1rem',\r\n                      minHeight: '80px',\r\n                      resize: 'vertical',\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                    Role Classification *\r\n                  </label>\r\n                  <select\r\n                    value={formData.roleClassification}\r\n                    onChange={(e) => setFormData({ ...formData, roleClassification: e.target.value as any })}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      fontSize: '1rem',\r\n                    }}\r\n                  >\r\n                    <option value=\"normal_staff\">Normal Staff</option>\r\n                    <option value=\"supervisor\">Supervisor</option>\r\n                    <option value=\"manager\">Manager</option>\r\n                    <option value=\"senior_executive\">Senior Executive</option>\r\n                  </select>\r\n                </div>\r\n\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                    Specific Role (Optional)\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={formData.role}\r\n                    onChange={(e) => setFormData({ ...formData, role: e.target.value })}\r\n                    placeholder=\"e.g., Chef, Housekeeper (leave blank for general plan)\"\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      fontSize: '1rem',\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                      Wage Type *\r\n                    </label>\r\n                    <select\r\n                      value={formData.wageType}\r\n                      onChange={(e) => setFormData({ ...formData, wageType: e.target.value as any })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem',\r\n                      }}\r\n                    >\r\n                      <option value=\"hourly\">Hourly</option>\r\n                      <option value=\"daily\">Daily</option>\r\n                      <option value=\"weekly\">Weekly</option>\r\n                      <option value=\"monthly\">Monthly</option>\r\n                      <option value=\"annual\">Annual</option>\r\n                    </select>\r\n                  </div>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                      Currency\r\n                    </label>\r\n                    <select\r\n                      value={formData.currency}\r\n                      onChange={(e) => setFormData({ ...formData, currency: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem',\r\n                      }}\r\n                    >\r\n                      <option value=\"NGN\">NGN</option>\r\n                      <option value=\"USD\">USD</option>\r\n                      <option value=\"EUR\">EUR</option>\r\n                      <option value=\"GBP\">GBP</option>\r\n                    </select>\r\n                  </div>\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                      Base Amount *\r\n                    </label>\r\n                    <input\r\n                      type=\"number\"\r\n                      step=\"0.01\"\r\n                      value={formData.baseAmount}\r\n                      onChange={(e) => setFormData({ ...formData, baseAmount: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem',\r\n                      }}\r\n                      placeholder=\"0.00\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                      Overtime Rate (Multiplier)\r\n                    </label>\r\n                    <input\r\n                      type=\"number\"\r\n                      step=\"0.1\"\r\n                      value={formData.overtimeRate}\r\n                      onChange={(e) => setFormData({ ...formData, overtimeRate: e.target.value })}\r\n                      placeholder=\"e.g., 1.5 for 1.5x\"\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem',\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                    Benefits\r\n                  </label>\r\n                  <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '0.5rem' }}>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={formData.newBenefit}\r\n                      onChange={(e) => setFormData({ ...formData, newBenefit: e.target.value })}\r\n                      onKeyPress={(e) => {\r\n                        if (e.key === 'Enter') {\r\n                          e.preventDefault();\r\n                          addBenefit();\r\n                        }\r\n                      }}\r\n                      placeholder=\"Add benefit...\"\r\n                      style={{\r\n                        flex: 1,\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem',\r\n                      }}\r\n                    />\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={addBenefit}\r\n                      style={{\r\n                        padding: '0.75rem 1rem',\r\n                        border: 'none',\r\n                        borderRadius: '6px',\r\n                        background: '#3b82f6',\r\n                        color: 'white',\r\n                        cursor: 'pointer',\r\n                      }}\r\n                    >\r\n                      Add\r\n                    </button>\r\n                  </div>\r\n                  {formData.benefits.length > 0 && (\r\n                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>\r\n                      {formData.benefits.map((benefit, idx) => (\r\n                        <span\r\n                          key={idx}\r\n                          style={{\r\n                            padding: '0.5rem 0.75rem',\r\n                            background: '#f1f5f9',\r\n                            borderRadius: '6px',\r\n                            fontSize: '0.875rem',\r\n                            display: 'flex',\r\n                            alignItems: 'center',\r\n                            gap: '0.5rem',\r\n                          }}\r\n                        >\r\n                          {benefit}\r\n                          <button\r\n                            type=\"button\"\r\n                            onClick={() => removeBenefit(idx)}\r\n                            style={{\r\n                              background: 'none',\r\n                              border: 'none',\r\n                              cursor: 'pointer',\r\n                              padding: 0,\r\n                              display: 'flex',\r\n                              alignItems: 'center',\r\n                            }}\r\n                          >\r\n                            <X size={14} color=\"#ef4444\" />\r\n                          </button>\r\n                        </span>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                <div>\r\n                  <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={formData.isActive}\r\n                      onChange={(e) => setFormData({ ...formData, isActive: e.target.checked })}\r\n                    />\r\n                    <span style={{ color: '#1e293b' }}>Active</span>\r\n                  </label>\r\n                </div>\r\n\r\n                <div style={{ display: 'flex', gap: '1rem', marginTop: '1rem' }}>\r\n                  <button\r\n                    onClick={() => setShowCreateModal(false)}\r\n                    style={{\r\n                      flex: 1,\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      background: 'white',\r\n                      color: '#64748b',\r\n                      cursor: 'pointer',\r\n                      fontWeight: '500',\r\n                    }}\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                  <button\r\n                    onClick={handleCreate}\r\n                    style={{\r\n                      flex: 1,\r\n                      padding: '0.75rem',\r\n                      border: 'none',\r\n                      borderRadius: '6px',\r\n                      background: '#3b82f6',\r\n                      color: 'white',\r\n                      cursor: 'pointer',\r\n                      fontWeight: '500',\r\n                    }}\r\n                  >\r\n                    Create\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Edit Modal - Similar structure to Create Modal */}\r\n        {showEditModal && selectedWagePlan && (\r\n          <div\r\n            style={{\r\n              position: 'fixed',\r\n              top: 0,\r\n              left: 0,\r\n              right: 0,\r\n              bottom: 0,\r\n              background: 'rgba(0,0,0,0.5)',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              zIndex: 1000,\r\n            }}\r\n            onClick={() => {\r\n              setShowEditModal(false);\r\n              setSelectedWagePlan(null);\r\n            }}\r\n          >\r\n            <div\r\n              style={{\r\n                background: 'white',\r\n                borderRadius: '8px',\r\n                padding: '2rem',\r\n                width: '90%',\r\n                maxWidth: '600px',\r\n                maxHeight: '90vh',\r\n                overflow: 'auto',\r\n              }}\r\n              onClick={(e) => e.stopPropagation()}\r\n            >\r\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n                <h2 style={{ margin: 0, color: '#1e293b' }}>Edit Wage Plan</h2>\r\n                <button\r\n                  onClick={() => {\r\n                    setShowEditModal(false);\r\n                    setSelectedWagePlan(null);\r\n                  }}\r\n                  style={{\r\n                    background: 'none',\r\n                    border: 'none',\r\n                    cursor: 'pointer',\r\n                    padding: '0.5rem',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                  }}\r\n                >\r\n                  <X size={20} color=\"#64748b\" />\r\n                </button>\r\n              </div>\r\n\r\n              <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                    Plan Name *\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={formData.name}\r\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      fontSize: '1rem',\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                    Description\r\n                  </label>\r\n                  <textarea\r\n                    value={formData.description}\r\n                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      fontSize: '1rem',\r\n                      minHeight: '80px',\r\n                      resize: 'vertical',\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                    Role Classification *\r\n                  </label>\r\n                  <select\r\n                    value={formData.roleClassification}\r\n                    onChange={(e) => setFormData({ ...formData, roleClassification: e.target.value as any })}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      fontSize: '1rem',\r\n                    }}\r\n                  >\r\n                    <option value=\"normal_staff\">Normal Staff</option>\r\n                    <option value=\"supervisor\">Supervisor</option>\r\n                    <option value=\"manager\">Manager</option>\r\n                    <option value=\"senior_executive\">Senior Executive</option>\r\n                  </select>\r\n                </div>\r\n\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                    Specific Role (Optional)\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={formData.role}\r\n                    onChange={(e) => setFormData({ ...formData, role: e.target.value })}\r\n                    placeholder=\"Leave blank for general plan\"\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      fontSize: '1rem',\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                      Wage Type *\r\n                    </label>\r\n                    <select\r\n                      value={formData.wageType}\r\n                      onChange={(e) => setFormData({ ...formData, wageType: e.target.value as any })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem',\r\n                      }}\r\n                    >\r\n                      <option value=\"hourly\">Hourly</option>\r\n                      <option value=\"daily\">Daily</option>\r\n                      <option value=\"weekly\">Weekly</option>\r\n                      <option value=\"monthly\">Monthly</option>\r\n                      <option value=\"annual\">Annual</option>\r\n                    </select>\r\n                  </div>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                      Currency\r\n                    </label>\r\n                    <select\r\n                      value={formData.currency}\r\n                      onChange={(e) => setFormData({ ...formData, currency: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem',\r\n                      }}\r\n                    >\r\n                      <option value=\"NGN\">NGN</option>\r\n                      <option value=\"USD\">USD</option>\r\n                      <option value=\"EUR\">EUR</option>\r\n                      <option value=\"GBP\">GBP</option>\r\n                    </select>\r\n                  </div>\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                      Base Amount *\r\n                    </label>\r\n                    <input\r\n                      type=\"number\"\r\n                      step=\"0.01\"\r\n                      value={formData.baseAmount}\r\n                      onChange={(e) => setFormData({ ...formData, baseAmount: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem',\r\n                      }}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                      Overtime Rate\r\n                    </label>\r\n                    <input\r\n                      type=\"number\"\r\n                      step=\"0.1\"\r\n                      value={formData.overtimeRate}\r\n                      onChange={(e) => setFormData({ ...formData, overtimeRate: e.target.value })}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem',\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                    Benefits\r\n                  </label>\r\n                  <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '0.5rem' }}>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={formData.newBenefit}\r\n                      onChange={(e) => setFormData({ ...formData, newBenefit: e.target.value })}\r\n                      onKeyPress={(e) => {\r\n                        if (e.key === 'Enter') {\r\n                          e.preventDefault();\r\n                          addBenefit();\r\n                        }\r\n                      }}\r\n                      placeholder=\"Add benefit...\"\r\n                      style={{\r\n                        flex: 1,\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #e2e8f0',\r\n                        borderRadius: '6px',\r\n                        fontSize: '1rem',\r\n                      }}\r\n                    />\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={addBenefit}\r\n                      style={{\r\n                        padding: '0.75rem 1rem',\r\n                        border: 'none',\r\n                        borderRadius: '6px',\r\n                        background: '#3b82f6',\r\n                        color: 'white',\r\n                        cursor: 'pointer',\r\n                      }}\r\n                    >\r\n                      Add\r\n                    </button>\r\n                  </div>\r\n                  {formData.benefits.length > 0 && (\r\n                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>\r\n                      {formData.benefits.map((benefit, idx) => (\r\n                        <span\r\n                          key={idx}\r\n                          style={{\r\n                            padding: '0.5rem 0.75rem',\r\n                            background: '#f1f5f9',\r\n                            borderRadius: '6px',\r\n                            fontSize: '0.875rem',\r\n                            display: 'flex',\r\n                            alignItems: 'center',\r\n                            gap: '0.5rem',\r\n                          }}\r\n                        >\r\n                          {benefit}\r\n                          <button\r\n                            type=\"button\"\r\n                            onClick={() => removeBenefit(idx)}\r\n                            style={{\r\n                              background: 'none',\r\n                              border: 'none',\r\n                              cursor: 'pointer',\r\n                              padding: 0,\r\n                              display: 'flex',\r\n                              alignItems: 'center',\r\n                            }}\r\n                          >\r\n                            <X size={14} color=\"#ef4444\" />\r\n                          </button>\r\n                        </span>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                <div>\r\n                  <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={formData.isActive}\r\n                      onChange={(e) => setFormData({ ...formData, isActive: e.target.checked })}\r\n                    />\r\n                    <span style={{ color: '#1e293b' }}>Active</span>\r\n                  </label>\r\n                </div>\r\n\r\n                <div style={{ display: 'flex', gap: '1rem', marginTop: '1rem' }}>\r\n                  <button\r\n                    onClick={() => {\r\n                      setShowEditModal(false);\r\n                      setSelectedWagePlan(null);\r\n                    }}\r\n                    style={{\r\n                      flex: 1,\r\n                      padding: '0.75rem',\r\n                      border: '1px solid #e2e8f0',\r\n                      borderRadius: '6px',\r\n                      background: 'white',\r\n                      color: '#64748b',\r\n                      cursor: 'pointer',\r\n                      fontWeight: '500',\r\n                    }}\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                  <button\r\n                    onClick={handleEdit}\r\n                    disabled={saving}\r\n                    style={{\r\n                      flex: 1,\r\n                      padding: '0.75rem',\r\n                      border: 'none',\r\n                      borderRadius: '6px',\r\n                      background: saving ? '#94a3b8' : '#3b82f6',\r\n                      color: 'white',\r\n                      cursor: saving ? 'not-allowed' : 'pointer',\r\n                      opacity: saving ? 0.6 : 1,\r\n                      fontWeight: '500',\r\n                    }}\r\n                  >\r\n                    {saving ? 'Updating...' : 'Update'}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Assign Modal */}\r\n        {showAssignModal && selectedWagePlan && (\r\n          <div\r\n            style={{\r\n              position: 'fixed',\r\n              top: 0,\r\n              left: 0,\r\n              right: 0,\r\n              bottom: 0,\r\n              background: 'rgba(0,0,0,0.5)',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              zIndex: 1000,\r\n            }}\r\n            onClick={() => {\r\n              setShowAssignModal(false);\r\n              setSelectedWagePlan(null);\r\n            }}\r\n          >\r\n            <div\r\n              style={{\r\n                background: 'white',\r\n                borderRadius: '8px',\r\n                padding: '2rem',\r\n                width: '90%',\r\n                maxWidth: '500px',\r\n              }}\r\n              onClick={(e) => e.stopPropagation()}\r\n            >\r\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n                <h2 style={{ margin: 0, color: '#1e293b' }}>Assign Wage Plan</h2>\r\n                <button\r\n                  onClick={() => {\r\n                    setShowAssignModal(false);\r\n                    setSelectedWagePlan(null);\r\n                  }}\r\n                  style={{\r\n                    background: 'none',\r\n                    border: 'none',\r\n                    cursor: 'pointer',\r\n                    padding: '0.5rem',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                  }}\r\n                >\r\n                  <X size={20} color=\"#64748b\" />\r\n                </button>\r\n              </div>\r\n\r\n              <div style={{ marginBottom: '1rem' }}>\r\n                <p style={{ margin: '0 0 0.5rem', color: '#64748b' }}>Wage Plan:</p>\r\n                <p style={{ margin: 0, fontWeight: '600', color: '#1e293b' }}>{selectedWagePlan.name}</p>\r\n              </div>\r\n\r\n              <div style={{ marginBottom: '1.5rem' }}>\r\n                <label style={{ display: 'block', marginBottom: '0.5rem', color: '#1e293b', fontWeight: '500' }}>\r\n                  Select Staff Member *\r\n                </label>\r\n                <select\r\n                  value={selectedStaff}\r\n                  onChange={(e) => setSelectedStaff(e.target.value)}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    fontSize: '1rem',\r\n                  }}\r\n                >\r\n                  <option value=\"\">Select staff member...</option>\r\n                  {staff.filter(s => s.isActive).map((staffMember) => (\r\n                    <option key={staffMember.id} value={staffMember.id}>\r\n                      {staffMember.firstName} {staffMember.lastName} - {staffMember.role}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              <div style={{ display: 'flex', gap: '1rem' }}>\r\n                <button\r\n                  onClick={() => {\r\n                    setShowAssignModal(false);\r\n                    setSelectedWagePlan(null);\r\n                  }}\r\n                  style={{\r\n                    flex: 1,\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #e2e8f0',\r\n                    borderRadius: '6px',\r\n                    background: 'white',\r\n                    color: '#64748b',\r\n                    cursor: 'pointer',\r\n                    fontWeight: '500',\r\n                  }}\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  onClick={handleAssign}\r\n                  style={{\r\n                    flex: 1,\r\n                    padding: '0.75rem',\r\n                    border: 'none',\r\n                    borderRadius: '6px',\r\n                    background: '#3b82f6',\r\n                    color: 'white',\r\n                    cursor: 'pointer',\r\n                    fontWeight: '500',\r\n                  }}\r\n                >\r\n                  Assign\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </Layout>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\store\\authStore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\utils\\print.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\src\\vite-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\innsight\\frontend\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]}]